(function(bt){typeof define=="function"&&define.amd?define(bt):bt()})(function(){"use strict";var p6=Object.defineProperty;var WN=bt=>{throw TypeError(bt)};var E6=(bt,xn,us)=>xn in bt?p6(bt,xn,{enumerable:!0,configurable:!0,writable:!0,value:us}):bt[xn]=us;var $e=(bt,xn,us)=>E6(bt,typeof xn!="symbol"?xn+"":xn,us),YN=(bt,xn,us)=>xn.has(bt)||WN("Cannot "+us);var Ot=(bt,xn,us)=>(YN(bt,xn,"read from private field"),us?us.call(bt):xn.get(bt)),ia=(bt,xn,us)=>xn.has(bt)?WN("Cannot add the same private member more than once"):xn instanceof WeakSet?xn.add(bt):xn.set(bt,us),Ph=(bt,xn,us,vt)=>(YN(bt,xn,"write to private field"),vt?vt.call(bt,us):xn.set(bt,us),us);var Oi,Yo,to,Ga,Fa,Nd,Ys;var bt=typeof document<"u"?document.currentScript:null,xn=Object.defineProperty,us=(e,n,s)=>n in e?xn(e,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[n]=s,vt=(e,n,s)=>us(e,typeof n!="symbol"?n+"":n,s);function zN(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var V0={exports:{}};(function(e){var n=Object.prototype.hasOwnProperty,s="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(s=!1));function r(l,h,d){this.fn=l,this.context=h,this.once=d||!1}function o(l,h,d,p,E){if(typeof d!="function")throw new TypeError("The listener must be a function");var g=new r(d,p||l,E),T=s?s+h:h;return l._events[T]?l._events[T].fn?l._events[T]=[l._events[T],g]:l._events[T].push(g):(l._events[T]=g,l._eventsCount++),l}function a(l,h){--l._eventsCount===0?l._events=new i:delete l._events[h]}function c(){this._events=new i,this._eventsCount=0}c.prototype.eventNames=function(){var l=[],h,d;if(this._eventsCount===0)return l;for(d in h=this._events)n.call(h,d)&&l.push(s?d.slice(1):d);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(h)):l},c.prototype.listeners=function(l){var h=s?s+l:l,d=this._events[h];if(!d)return[];if(d.fn)return[d.fn];for(var p=0,E=d.length,g=new Array(E);p<E;p++)g[p]=d[p].fn;return g},c.prototype.listenerCount=function(l){var h=s?s+l:l,d=this._events[h];return d?d.fn?1:d.length:0},c.prototype.emit=function(l,h,d,p,E,g){var T=s?s+l:l;if(!this._events[T])return!1;var A=this._events[T],m=arguments.length,O,S;if(A.fn){switch(A.once&&this.removeListener(l,A.fn,void 0,!0),m){case 1:return A.fn.call(A.context),!0;case 2:return A.fn.call(A.context,h),!0;case 3:return A.fn.call(A.context,h,d),!0;case 4:return A.fn.call(A.context,h,d,p),!0;case 5:return A.fn.call(A.context,h,d,p,E),!0;case 6:return A.fn.call(A.context,h,d,p,E,g),!0}for(S=1,O=new Array(m-1);S<m;S++)O[S-1]=arguments[S];A.fn.apply(A.context,O)}else{var y=A.length,v;for(S=0;S<y;S++)switch(A[S].once&&this.removeListener(l,A[S].fn,void 0,!0),m){case 1:A[S].fn.call(A[S].context);break;case 2:A[S].fn.call(A[S].context,h);break;case 3:A[S].fn.call(A[S].context,h,d);break;case 4:A[S].fn.call(A[S].context,h,d,p);break;default:if(!O)for(v=1,O=new Array(m-1);v<m;v++)O[v-1]=arguments[v];A[S].fn.apply(A[S].context,O)}}return!0},c.prototype.on=function(l,h,d){return o(this,l,h,d,!1)},c.prototype.once=function(l,h,d){return o(this,l,h,d,!0)},c.prototype.removeListener=function(l,h,d,p){var E=s?s+l:l;if(!this._events[E])return this;if(!h)return a(this,E),this;var g=this._events[E];if(g.fn)g.fn===h&&(!p||g.once)&&(!d||g.context===d)&&a(this,E);else{for(var T=0,A=[],m=g.length;T<m;T++)(g[T].fn!==h||p&&!g[T].once||d&&g[T].context!==d)&&A.push(g[T]);A.length?this._events[E]=A.length===1?A[0]:A:a(this,E)}return this},c.prototype.removeAllListeners=function(l){var h;return l?(h=s?s+l:l,this._events[h]&&a(this,h)):(this._events=new i,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=s,c.EventEmitter=c,e.exports=c})(V0);var KN=V0.exports;class g6 extends KN.EventEmitter{constructor(){super(),vt(this,"timeOrigin"),vt(this,"elapsedTime"),vt(this,"state"),vt(this,"_rafId"),this.timeOrigin=performance.now(),this.elapsedTime=0,this._rafId=0,this.state="idle"}start(){(this.state==="idle"||this.state==="paused")&&(this.state="running",this.timeOrigin=performance.now(),this.tick())}seek(n){this.pause(),this.elapsedTime=n,this.emitTick()}pause(){this.state==="running"&&(this.state="paused",window.cancelAnimationFrame(this._rafId))}reset(){this.elapsedTime=0,this.timeOrigin=performance.now(),this.state="idle"}tick(){this._rafId=window.requestAnimationFrame(()=>{this.elapsedTime=performance.now()-this.timeOrigin,this.emitTick(),this.tick()})}emitTick(){this.emit("tick",this.elapsedTime)}}var QN=4,ZN=.001,qN=1e-7,jN=10,jc=11,bh=1/(jc-1),JN=typeof Float32Array=="function";function H0(e,n){return 1-3*n+3*e}function W0(e,n){return 3*n-6*e}function Y0(e){return 3*e}function Uh(e,n,s){return((H0(n,s)*e+W0(n,s))*e+Y0(n))*e}function X0(e,n,s){return 3*H0(n,s)*e*e+2*W0(n,s)*e+Y0(n)}function $N(e,n,s,i,r){var o,a,c=0;do a=n+(s-n)/2,o=Uh(a,i,r)-e,o>0?s=a:n=a;while(Math.abs(o)>qN&&++c<jN);return a}function ex(e,n,s,i){for(var r=0;r<QN;++r){var o=X0(n,s,i);if(o===0)return n;var a=Uh(n,s,i)-e;n-=a/o}return n}function tx(e){return e}var nx=function(e,n,s,i){if(!(0<=e&&e<=1&&0<=s&&s<=1))throw new Error("bezier x values must be in [0, 1] range");if(e===n&&s===i)return tx;for(var r=JN?new Float32Array(jc):new Array(jc),o=0;o<jc;++o)r[o]=Uh(o*bh,e,s);function a(c){for(var l=0,h=1,d=jc-1;h!==d&&r[h]<=c;++h)l+=bh;--h;var p=(c-r[h])/(r[h+1]-r[h]),E=l+p*bh,g=X0(E,e,s);return g>=ZN?ex(c,E,e,s):g===0?E:$N(c,l,l+bh,e,s)}return function(c){return c===0?0:c===1?1:Uh(a(c),n,i)}};const sx=zN(nx),ix=[0,0,1,1],z0=(e,n)=>{if(n<=e[0].time)return{startFrame:e[0],endFrame:e[0],progress:0};if(n>=e[e.length-1].time){const a=e[e.length-1];return{startFrame:a,endFrame:a,progress:1}}const s=e.findIndex((a,c)=>{const l=e[c+1];return l?n>=a.time&&n<=l.time:!1}),i=e[s],r=e[s+1],o=(n-i.time)/(r.time-i.time);return{startFrame:i,endFrame:r,progress:o}},rx=(e,n,s)=>{switch(n){case 0:return Math.min(1,Math.ceil(s*e)/e);case 1:return Math.min(1,Math.floor(s*e)/e);case 2:{if(s<=0)return 0;if(s>=1)return 1;const i=Math.floor(s*e),r=s*e-i;return Math.min(1,(r>=.5?i+1:i)/e)}}},ox=(e,n)=>{switch(e.length){case 2:return rx(...e,n);case 4:return sx(...e)(n)}};class ax{constructor(n,s,i,r,o){vt(this,"sortedKeyframes"),vt(this,"duration"),this.interpolator=s,this.middlewares=i,this.registry=r,this.sortedKeyframes=n,this.duration=o===void 0?n[n.length-1].time:o}interpolate(n){const s=Math.max(0,Math.min(1,n))*this.duration,{startFrame:i,endFrame:r,progress:o}=z0(this.sortedKeyframes,s),a=r.easing?ox(r.easing,o):o,c={keyframes:this.sortedKeyframes,rawProgress:o,easedProgress:a,startFrame:i,endFrame:r,value:this.interpolator(a,i.value,r.value,r.easing||ix,this.registry)};return this.middlewares.reduce((l,h)=>h(l),c).value}insertKF(n){const s=this.sortedKeyframes.findIndex(o=>o.time===n.time);if(s!==-1)return this.sortedKeyframes[s].value=n.value,this;const{progress:i}=z0(this.sortedKeyframes,n.time),r=this.sortedKeyframes.findIndex(o=>o.time>n.time);if(r!==0&&r!==-1){const o=this.sortedKeyframes[r];if(o.easing)if(o.easing.length===4){const a=o.easing,c=i,l=0,h=0,d=a[0],p=a[1],E=a[2],g=a[3],T=1,A=1,m=1-c,O=m*l+c*d,S=m*h+c*p,y=m*d+c*E,v=m*p+c*g,R=m*E+c*T,M=m*g+c*A,L=m*O+c*y,P=m*S+c*v,k=m*y+c*R,Q=m*v+c*M,b=m*L+c*k,X=m*P+c*Q,K=[l,h,O,S,L,P,b,X],V=[b,X,k,Q,R,M,T,A],J=K[6]-K[0],ge=K[7]-K[1],se=[K[2]/J,K[3]/ge,K[4]/J,K[5]/ge],ue=V[6]-V[0],te=V[7]-V[1],ie=[(V[2]-V[0])/ue,(V[3]-V[1])/te,(V[4]-V[0])/ue,(V[5]-V[1])/te];n.easing=se,o.easing=ie}else o.easing.length}return r===-1?this.sortedKeyframes.push(n):this.sortedKeyframes.splice(r,0,n),this}}class cx{constructor({registry:n,middlewares:s=[]}){vt(this,"middlewares",[]),vt(this,"registry"),this.registry=n,this.middlewares=s}compose(n,s,i){if(s.length===0)throw new Error("At least one keyframe is required");const r=this.registry.get(n),o=[...s].sort((a,c)=>a.time-c.time);if(o[0].time<0)throw new Error("First keyframe time must be greater than 0");return new ax(o,r.interpolate,this.middlewares,this.registry,i)}}const K0=e=>e;class lx{constructor(){vt(this,"interpolators",new Map);const n=K0({name:"number",interpolate:this.lerp});this.register(n)}register(n){this.interpolators.set(n.name,n)}lerp(n,s,i){return s+(i-s)*n}interpolate(n,s,i,r,o){return this.get(n).interpolate(s,r,o,i,this)}get(n){const s=this.interpolators.get(n);if(!s)throw new Error(`Interpolator '${n}' not found`);return s}has(n){return this.interpolators.has(n)}}class hx{constructor(n,s){vt(this,"animationId"),vt(this,"trackData"),vt(this,"state"),vt(this,"playbackRate"),vt(this,"currentTime"),vt(this,"startTime"),vt(this,"_baseTime"),vt(this,"createdAt"),this.animationId=n,this.trackData=s,this.state=Ms.IDLE,this.playbackRate=1,this.currentTime=0,this.startTime=0,this._baseTime=0,this.createdAt=performance.now()}getPropTrack(n){const s=this.trackData.tracks.get(n);if(!s)throw new Error(`Property track not found for key: ${n}`);return JSON.parse(JSON.stringify(s))}forward(){this._baseTime=this.currentTime,this.state=Ms.RUNNING,this.playbackRate=Math.abs(this.playbackRate),this.startTime=performance.now()}pause(){this.state=Ms.PAUSED}backward(){this.currentTime===0&&this.seekToEnd(),this._baseTime=this.currentTime,this.state=Ms.RUNNING,this.playbackRate=-Math.abs(this.playbackRate),this.startTime=performance.now()}seek(n){this.currentTime=Math.max(0,Math.min(this.trackData.duration,n))}seekToEnd(){this.currentTime=this.trackData.duration}isForward(){return this.state===Ms.RUNNING&&this.playbackRate>0}isBackward(){return this.state===Ms.RUNNING&&this.playbackRate<0}isPaused(){return this.state===Ms.PAUSED}isEnded(){return this.state===Ms.PAUSED&&this.currentTime===0}isCompleted(){return this.state===Ms.PAUSED&&this.currentTime===this.trackData.duration}getStatus(n){const s=n-this.startTime;if(this.isForward()){const i=this._baseTime+s;return i>=this.trackData.duration?{state:Ms.PAUSED,time:this.trackData.duration}:{state:Ms.RUNNING,time:i}}else if(this.isBackward()){const i=this._baseTime-s;return i<=0?{state:Ms.PAUSED,time:0}:{state:Ms.RUNNING,time:i}}else{const i=this._baseTime+s;return{state:this.state,time:Math.max(0,Math.min(this.trackData.duration,i))}}}}class ux{constructor(n,s){vt(this,"AC"),vt(this,"key"),vt(this,"animations"),vt(this,"interpolator"),this.AC=n,this.key=s,this.animations=[],this.interpolator=null}addAnimation(n,s){this.animations.some(i=>i.animationId===s.animationId)||this.animations.push(s),this.sortAnimations(),this.interpolator=this.resolve(n,this.animations.length>1)}deleteAnimation(n,s){const i=this.animations.indexOf(s);i!==-1&&this.animations.splice(i,1),this.animations.length!==0&&(this.interpolator=this.resolve(n,!0))}animationStateUpdated(n){this.interpolator=this.resolve(n,this.animations.length>1)}sortAnimations(){this.animations.sort((n,s)=>s.createdAt-n.createdAt)}isPaused(){return this.getHighestAnimation().isPaused()}getProgress(){const n=this.animations[0];return n.currentTime/n.trackData.duration}getHighestAnimation(){return this.animations[0]}resolve(n,s=!1){const i=this._resolve(n,s);return console.log("resolve",this.key,i),i}_resolve(n,s=!1){if(this.animations.length===0)throw new Error(`No animations found for this PropEffect: ${this.key}`);const i=this.animations[0],{duration:r}=i.trackData,o=i.getPropTrack(this.key),{type:a,kfs:c}=o,l=c.some(E=>E.time===0),h=c.some(E=>E.time===i.currentTime),d=this.AC.getBaseValue(this.key),p=this.AC.getComputedData(this.key);if(this.animations.length===1){const E=l?c:[{time:0,value:d},...c],g=this.AC.keyframeComposer.compose(a,E,r);return s&&!h&&g.insertKF({time:i.currentTime,value:p}),g}if(this.animations.length>1){if(i.isForward()){const E=l?c:[{time:0,value:d},...c],g=this.AC.keyframeComposer.compose(a,E,r);return h||g.insertKF({time:i.currentTime,value:p}),g}else if(i.isBackward()){const E=n+i.currentTime,g=_f(this.AC,E,this.key,this.animations,1),T=l?c:[{time:0,value:g},...c],A=this.AC.keyframeComposer.compose(a,T,r);return h||A.insertKF({time:i.currentTime,value:p}),A}else if(i.isPaused()){const E=l?c:[{time:0,value:d},...c],g=this.AC.keyframeComposer.compose(a,E,r);return h||g.insertKF({time:i.currentTime,value:p}),g}}throw new Error("unsupported state")}}const _f=(e,n,s,i,r)=>{const o=e.getBaseValue(s);if(r>=i.length)return o;const a=i[r],{duration:c}=a.trackData,{time:l,state:h}=a.getStatus(n),d=a.getPropTrack(s),{type:p,kfs:E}=d,g=E.some(T=>T.time===0);if(a.isForward())return e.keyframeComposer.compose(p,g?E:[{time:0,value:o},...E],c).interpolate(l/c);if(a.isBackward()){if(l===0&&h===Ms.PAUSED)return _f(e,n,s,i,r+1);{const T=n+l,A=_f(e,T,s,i,r+1);return e.keyframeComposer.compose(p,g?E:[{time:0,value:A},...E],c).interpolate(l/c)}}else{if(a.isPaused())return e.keyframeComposer.compose(p,g?E:[{time:0,value:o},...E],c).interpolate(l/c);throw new Error("unsupported state")}},Ms={IDLE:"idle",RUNNING:"running",PAUSED:"paused"};class dx{constructor(n){vt(this,"baseValueCache"),vt(this,"computedValueCache"),vt(this,"sourceAnimationTracks"),vt(this,"animations"),vt(this,"propertyEffects"),vt(this,"isPlaying"),vt(this,"startTime"),vt(this,"previousTime"),vt(this,"currentTime"),vt(this,"_rafId",null),vt(this,"keyframeComposer"),this.sourceAnimationTracks=new Map,this.animations=new Map,this.propertyEffects=new Map,this.isPlaying=!1,this.startTime=0,this.previousTime=0,this.currentTime=0,this.baseValueCache=new Map,this.computedValueCache=new Map,this.keyframeComposer=new cx({registry:n})}deinit(){this.pause(),this.sourceAnimationTracks.clear(),this.animations.clear(),this.propertyEffects.clear(),this.baseValueCache.clear(),this.computedValueCache.clear()}setComputedData(n,s){if(s===void 0){console.warn(`Trying to set undefined value for key: ${n}`);return}this.computedValueCache.set(n,s)}deleteComputedData(n){this.computedValueCache.delete(n)}cacheBaseValue(n,s){this.baseValueCache.set(n,s)}getPropertyEffect(n){return this.propertyEffects.get(n)||(console.warn(`Property effect not found: ${n}`),null)}tick(){if(!this.isPlaying)return null;this.previousTime=this.currentTime,this.currentTime=performance.now();const n=new Map;for(const[s,i]of this.animations){if(i.isEnded()&&this.deleteAnimation(s),i.isPaused())continue;const{time:r,state:o}=i.getStatus(this.currentTime);i.seek(r),n.set(s,o)}for(const[,s]of this.propertyEffects)if(s.interpolator){const i=s.getProgress();if(!s.isPaused()){const r=s.interpolator.interpolate(i);this.setComputedData(s.key,r)}}else console.warn("interpolator not found");for(const[s,i]of this.animations){const r=n.get(s);r===Ms.PAUSED&&r!==i.state&&this.pauseAnimation(s)}}start(){if(this.isPlaying)return;this.isPlaying=!0,this.startTime=performance.now();const n=()=>{this.tick(),this._rafId=window.requestAnimationFrame(n)};this._rafId=window.requestAnimationFrame(n)}pause(){this.isPlaying=!1,this._rafId!==null&&(window.cancelAnimationFrame(this._rafId),this._rafId=null)}getComputedData(n){return console.log(this.computedValueCache),this.computedValueCache.has(n)?(console.log(this.computedValueCache.get(n)),this.computedValueCache.get(n)):this.getBaseValue(n)}getBaseValue(n){return this.baseValueCache.get(n)}loadAnimationTrack(n,s){if(s.duration<=0){console.warn("Failed to load animation track: duration must be greater than 0",n);return}this.sourceAnimationTracks.has(n)&&console.warn("track already exists or id conflict",n);for(const[i,r]of s.tracks)this.cacheBaseValue(i,r.baseValue);this.sourceAnimationTracks.set(n,s)}hasAnimation(n){return this.animations.has(n)}getAnimation(n){return this.animations.get(n)||(console.warn(`Animation not found: ${n}`),null)}playAnimation(n,s){let i=this.animations.get(n);if(i&&!s.backward&&(i.isForward()||i.isCompleted())&&this.deleteAnimation(n),i=this.animations.get(n),!i){const r=this.sourceAnimationTracks.get(n);if(!r){console.warn(`Animation track data not found for ${n}`);return}i=new hx(n,r),this.animations.set(n,i)}s.backward?i.backward():i.forward();for(const[r]of i.trackData.tracks){if(!this.propertyEffects.has(r)){const a=new ux(this,r);this.propertyEffects.set(r,a)}const o=this.getPropertyEffect(r);o&&o.addAnimation(this.currentTime,i)}}pauseAnimation(n){const s=this.getAnimation(n);if(s){s.pause();for(const[i]of s.trackData.tracks){const r=this.getPropertyEffect(i);if(!r)continue;const o=r.getHighestAnimation();o!==s&&o.isBackward()&&r.animationStateUpdated(this.currentTime)}}}deleteAnimation(n){const s=this.getAnimation(n);if(s){this.animations.delete(n);for(const[i]of s.trackData.tracks){const r=this.getPropertyEffect(i);r&&(r.deleteAnimation(this.currentTime,s),r.animations.length===0&&(this.setComputedData(i,this.getBaseValue(i)),this.propertyEffects.delete(i)))}}}}var Q0=1e-6,Za=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var e=0,n=arguments.length;n--;)e+=arguments[n]*arguments[n];return Math.sqrt(e)});function fx(){var e=new Za(6);return Za!=Float32Array&&(e[1]=0,e[2]=0,e[4]=0,e[5]=0),e[0]=1,e[3]=1,e}function Z0(e,n,s,i,r,o,a){return e[0]=n,e[1]=s,e[2]=i,e[3]=r,e[4]=o,e[5]=a,e}function px(){var e=new Za(4);return Za!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function q0(e,n,s,i,r){return e[0]=n,e[1]=s,e[2]=i,e[3]=r,e}(function(){var e=px();return function(n,s,i,r,o,a){var c,l;for(s||(s=4),i||(i=0),r?l=Math.min(r*s+i,n.length):l=n.length,c=i;c<l;c+=s)e[0]=n[c],e[1]=n[c+1],e[2]=n[c+2],e[3]=n[c+3],o(e,e,a),n[c]=e[0],n[c+1]=e[1],n[c+2]=e[2],n[c+3]=e[3];return n}})();function j0(){var e=new Za(2);return Za!=Float32Array&&(e[0]=0,e[1]=0),e}function po(e,n,s){return e[0]=n,e[1]=s,e}function vi(e,n,s){return e[0]=n[0]+s[0],e[1]=n[1]+s[1],e}function es(e,n,s){return e[0]=n[0]-s[0],e[1]=n[1]-s[1],e}function Tf(e,n,s){return e[0]=Math.min(n[0],s[0]),e[1]=Math.min(n[1],s[1]),e}function Af(e,n,s){return e[0]=Math.max(n[0],s[0]),e[1]=Math.max(n[1],s[1]),e}function Pr(e,n,s){return e[0]=n[0]*s,e[1]=n[1]*s,e}function mf(e){var n=e[0],s=e[1];return Math.hypot(n,s)}function Jc(e,n){var s=n[0],i=n[1],r=s*s+i*i;return r>0&&(r=1/Math.sqrt(r)),e[0]=n[0]*r,e[1]=n[1]*r,e}function Ex(e,n,s,i){var r=n[0],o=n[1];return e[0]=r+i*(s[0]-r),e[1]=o+i*(s[1]-o),e}function $c(e,n,s){var i=n[0],r=n[1];return e[0]=s[0]*i+s[2]*r+s[4],e[1]=s[1]*i+s[3]*r+s[5],e}function gx(e,n){var s=e[0],i=e[1],r=n[0],o=n[1];return Math.abs(s-r)<=Q0*Math.max(1,Math.abs(s),Math.abs(r))&&Math.abs(i-o)<=Q0*Math.max(1,Math.abs(i),Math.abs(o))}var br=mf,ra=es;(function(){var e=j0();return function(n,s,i,r,o,a){var c,l;for(s||(s=2),i||(i=0),r?l=Math.min(r*s+i,n.length):l=n.length,c=i;c<l;c+=s)e[0]=n[c],e[1]=n[c+1],o(e,e,a),n[c]=e[0],n[c+1]=e[1];return n}})();const vn=1e-4;fx();function _x(e,n){return(e%n+n)%n}function J0(e,n,s){const i=s-n;return((e-n)%i+i)%i+n}function Ue(e){return e==null}function ee(e){return!Ue(e)}function be(e){return typeof e=="number"}function qa(e){return e&&e.length===2&&typeof e[0]=="number"&&typeof e[1]=="number"}function Ji(e){return e&&e.constructor===String}function Gh(e){return Array.isArray(e)}function Tx(e){return e&&e.constructor===Map}function $0(e){return e&&e.constructor===Function}function Ax(e,n,s=(i,r)=>i===r){if(e===n)return!0;if(Ue(e)||Ue(n)||e.length!==n.length)return!1;for(let i=0;i<e.length;++i)if(!s(e[i],n[i]))return!1;return!0}function e_(e,n){const s=new Map;for(const[i,r]of e)s.set(...n(i,r,e));return s}function mx(e,n){for(const s of e)if(n(s,e))return s}function oa(e,n,s=vn){const i=e[0],r=e[1],o=n[0],a=n[1];return Math.abs(i-o)<=s*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(r-a)<=s*Math.max(1,Math.abs(r),Math.abs(a))}function t_(e,n,s){return e[0]=n[0]+s,e[1]=n[1]+s,e}function Ox(e,n,s){const i=e[0];return(s[0]-i)/(n[0]-i)}function Ix(e,n,s=vn){const i=e[0],r=e[1],o=e[2],a=e[3],c=n[0],l=n[1],h=n[2],d=n[3];return Math.abs(i-c)<=s*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(r-l)<=s*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(o-h)<=s*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(a-d)<=s*Math.max(1,Math.abs(a),Math.abs(d))}function Sx(e,n,s=vn){const i=e[0],r=e[1],o=e[2],a=e[3],c=e[4],l=e[5],h=n[0],d=n[1],p=n[2],E=n[3],g=n[4],T=n[5];return Math.abs(i-h)<=s*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(r-d)<=s*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(o-p)<=s*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(a-E)<=s*Math.max(1,Math.abs(a),Math.abs(E))&&Math.abs(c-g)<=s*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(l-T)<=s*Math.max(1,Math.abs(l),Math.abs(T))}function yx(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=0,e[5]=0,e}const Cx=(e,n=Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER)=>Math.max(Math.min(e,s),n),aa=(e,n,s)=>e+(n-e)*s;class ne extends Float32Array{constructor(n,s){super(2),typeof n=="number"&&typeof s=="number"?po(this,n,s):this.copy(n)}copy(n){if(Ue(n))return;let s=ee(n[0])?n[0]:n.x;Ue(s)&&(s=n.width);let i=ee(n[1])?n[1]:n.y;if(Ue(i)&&(i=n.height),be(s)&&be(i))po(this,s,i);else throw new Error("Trying to copy NaN to Vector2");return this}eq(n,s=vn){if(Ue(n))return!1;let i=ee(n[0])?n[0]:n.x;Ue(i)&&(i=n.width);let r=ee(n[1])?n[1]:n.y;return Ue(r)&&(r=n.height),oa(this,[i,r],s)}get x(){return this[0]}set x(n){if(isNaN(n))throw new Error("Trying to assign NaN to x component of Vector2");this[0]=n}get y(){return this[1]}set y(n){if(isNaN(n))throw new Error("Trying to assign NaN to y component of Vector2");this[1]=n}get width(){return this[0]}set width(n){if(isNaN(n))throw new Error("Trying to assign NaN to width component of Vector2");this[0]=n}get height(){return this[1]}set height(n){if(isNaN(n))throw new Error("Trying to assign NaN to height component of Vector2");this[1]=n}}ne.ZERO=new ne(0,0),ne.ONE=new ne(1,1);const n_=(e,n,s,i,r)=>[e*(i-n)+n,e*(r-s)+s],Nx=(e,n,s,i,r,o,a)=>{const c=1-e,l=c**2,h=2*e*c,d=e**2;return[l*n+h*i+d*o,l*s+h*r+d*a]},xx=(e,n,s,i,r,o,a,c,l)=>{const h=1-e,d=h**3,p=3*e*h**2,E=3*h*e**2,g=e**3;return[d*n+p*i+E*o+g*c,d*s+p*r+E*a+g*l]},s_=(e,n,s,i,r)=>{let o;if(s&&i)o=xx(e,n.x,n.y,s.x,s.y,i.x,i.y,r.x,r.y);else if(s||i){const a=s||i;o=Nx(e,n.x,n.y,a.x,a.y,r.x,r.y)}else o=n_(e,n.x,n.y,r.x,r.y);return new ne(o[0],o[1])};var i_;(function(e){e.PERSONAL="u",e.TEAM="t"})(i_||(i_={}));var ci;(function(e){e.BASE="bs",e.ELEMENT="el",e.PROPERTY_COMPONENT="pc",e.INTERACTION_MANAGER_COMPONENT="im",e.LAYER="ly",e.MESH="ms",e.TRANSITION_MANAGER_COMPONENT="tm",e.ELEMENT_INTERACTION="ei"})(ci||(ci={}));var r_;(function(e){e[e.PIXEL=0]="PIXEL",e[e.PERCENT=1]="PERCENT"})(r_||(r_={}));var qt;(function(e){e[e.PIXEL=0]="PIXEL",e[e.PERCENT=1]="PERCENT"})(qt||(qt={}));var ja;(function(e){e[e.PIXEL=0]="PIXEL",e[e.PERCENT=1]="PERCENT",e[e.INCH=2]="INCH",e[e.CM=3]="CM",e[e.MM=4]="MM"})(ja||(ja={}));var gr;(function(e){e[e.PROPERTY=0]="PROPERTY",e[e.ENTITY=1]="ENTITY"})(gr||(gr={}));var me;(function(e){e.BASE_CHANGES="BASE_CHANGES",e.DEFAULT_CHANGES="CHANGES",e.EDITOR_CHANGES="EDITOR_CHANGES",e.EFFECT_LIST_CHANGES="EFFECT_LIST_CHANGES",e.ELEMENT_INTERACTION_CHANGES="ELEMENT_INTERACTION_CHANGES",e.GROUP_ADD_CHILDREN="GROUP_ADD_CHILDREN",e.GROUP_REMOVE_CHILDREN="GROUP_REMOVE_CHILDREN",e.GUIDELINES_CHANGES="GUIDELINES_CHANGES",e.IMAGE_CHANGES="IMAGE_CHANGES",e.INTERACTION_CHANGES="INTERACTION_CHANGES",e.KFINFO_CHANGES="KFINFO_CHANGES",e.LAYER_LIST_CHANGES="LAYER_LIST_CHANGES",e.LIBRARY_CHANGES="LIBRARY_CHANGES",e.LOAD="LOAD",e.LOAD_START="LOAD_START",e.MESH_CHANGES="MESH_CHANGES",e.MODIFIER_KEY_CHANGES="MODIFIER_KEY_CHANGES",e.PRESET_LIST_CHANGES="PRESET_LIST_CHANGES",e.PROPERTY_PANEL_UPDATE_NEEDED="PROPERTY_PANEL_UPDATE_NEEDED",e.SCENE_TREE_CHANGES="SCENE_TREE_CHANGES",e.SELECT="SELECT",e.SELECT_CELL="SELECT_CELL",e.TRANSACTION="TRANSACTION",e.TRIGGER_VECTOR_FORCE_UPDATE="TRIGGER_VECTOR_FORCE_UPDATE",e.UI_STATE_CHANGES="UI_STATE_CHANGES",e.WORKSPACE_CHANGE="WORKSPACE_CHANGE",e.WORKSPACE_CHANGE_WATCH="WORKSPACE_CHANGE_WATCH",e.WORKSPACE_LIST_CHANGES="WORKSPACE_LIST_CHANGES",e.SELECT_TEXT_RANGE="SELECT_TEXT_RANGE",e.DATA_STORE_CLEAR="DATA_STORE_CLEAR",e.VIEWPORT_ZOOM_CHANGE="VIEWPORT_ZOOM_CHANGE",e.UNDO_CHECKPOINT_CROSSED="UNDO_CHECKPOINT_CROSSED",e.VIEWPORT_RESIZE="VIEWPORT_RESIZE"})(me||(me={}));var Fh;(function(e){e[e.SOLID=0]="SOLID",e[e.LINEAR=1]="LINEAR",e[e.RADIAL=2]="RADIAL",e[e.ANGULAR=3]="ANGULAR",e[e.DIAMOND=4]="DIAMOND",e[e.SHAPE=5]="SHAPE",e[e.ACROSS=6]="ACROSS",e[e.ALONG=7]="ALONG"})(Fh||(Fh={}));var Ps;(function(e){e[e.TOP=0]="TOP",e[e.BOTTOM=1]="BOTTOM",e[e.MIDDLE=2]="MIDDLE"})(Ps||(Ps={}));var Ri;(function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e[e.CENTER=2]="CENTER",e[e.JUSTIFIED=3]="JUSTIFIED"})(Ri||(Ri={}));var o_;(function(e){e[e.NORMAL=0]="NORMAL",e[e.UPPER=1]="UPPER",e[e.LOWER=2]="LOWER",e[e.TITLE=3]="TITLE"})(o_||(o_={}));var a_;(function(e){e[e.NORMAL=0]="NORMAL",e[e.SUPERSCRIPT=1]="SUPERSCRIPT",e[e.SUBSCRIPT=2]="SUBSCRIPT"})(a_||(a_={}));var kh;(function(e){e[e.LTR=0]="LTR",e[e.RTL=1]="RTL"})(kh||(kh={}));var kt;(function(e){e[e.AUTO_WIDTH=0]="AUTO_WIDTH",e[e.AUTO_HEIGHT=1]="AUTO_HEIGHT",e[e.FIXED=2]="FIXED"})(kt||(kt={}));var Oe;(function(e){e[e.SOLID=0]="SOLID",e[e.IMAGE=1]="IMAGE",e[e.GRADIENT_LINEAR=2]="GRADIENT_LINEAR",e[e.GRADIENT_RADIAL=3]="GRADIENT_RADIAL",e[e.GRADIENT_ANGULAR=4]="GRADIENT_ANGULAR",e[e.GRADIENT_DIAMOND=5]="GRADIENT_DIAMOND"})(Oe||(Oe={}));var Ut;(function(e){e[e.PASS_THROUGH=0]="PASS_THROUGH",e[e.NORMAL=1]="NORMAL",e[e.DARKEN=2]="DARKEN",e[e.MULTIPLY=3]="MULTIPLY",e[e.COLOR_BURN=4]="COLOR_BURN",e[e.LIGHTEN=5]="LIGHTEN",e[e.SCREEN=6]="SCREEN",e[e.COLOR_DODGE=7]="COLOR_DODGE",e[e.OVERLAY=8]="OVERLAY",e[e.SOFT_LIGHT=9]="SOFT_LIGHT",e[e.HARD_LIGHT=10]="HARD_LIGHT",e[e.DIFFERENCE=11]="DIFFERENCE",e[e.EXCLUSION=12]="EXCLUSION",e[e.HUE=13]="HUE",e[e.SATURATION=14]="SATURATION",e[e.COLOR=15]="COLOR",e[e.LUMINOSITY=16]="LUMINOSITY",e[e.DIVIDE=17]="DIVIDE",e[e.ADD=18]="ADD",e[e.SUBTRACT=19]="SUBTRACT",e[e.DISSOLVE=20]="DISSOLVE"})(Ut||(Ut={}));var _r;(function(e){e[e.FILL=0]="FILL",e[e.STRETCH=1]="STRETCH",e[e.FIT=2]="FIT"})(_r||(_r={}));var c_;(function(e){e[e.TOP_LEFT=0]="TOP_LEFT",e[e.TOP=1]="TOP",e[e.TOP_RIGHT=2]="TOP_RIGHT",e[e.LEFT=3]="LEFT",e[e.CENTER=4]="CENTER",e[e.RIGHT=5]="RIGHT",e[e.BOTTOM_LEFT=6]="BOTTOM_LEFT",e[e.BOTTOM=7]="BOTTOM",e[e.BOTTOM_RIGHT=8]="BOTTOM_RIGHT"})(c_||(c_={}));var l_;(function(e){e[e.NORMAL=0]="NORMAL",e[e.SPACE=1]="SPACE"})(l_||(l_={}));var h_;(function(e){e[e.ZERO=0]="ZERO",e[e.NINETY=1]="NINETY",e[e.ONE_EIGHTY=2]="ONE_EIGHTY",e[e.TWO_SEVENTY=3]="TWO_SEVENTY"})(h_||(h_={}));var Ja;(function(e){e[e.INSIDE=0]="INSIDE",e[e.CENTER=1]="CENTER",e[e.OUTSIDE=2]="OUTSIDE"})(Ja||(Ja={}));var on;(function(e){e[e.NONE=0]="NONE",e[e.ROUND=1]="ROUND",e[e.LINE_ARROW=2]="LINE_ARROW",e[e.TRIANGLE_ARROW_SOLID=3]="TRIANGLE_ARROW_SOLID",e[e.TRIANGLE_ARROW_OUTLINE=4]="TRIANGLE_ARROW_OUTLINE",e[e.CIRCLE_SOLID=5]="CIRCLE_SOLID",e[e.CIRCLE_OUTLINE=6]="CIRCLE_OUTLINE",e[e.SQUARE_SOLID=7]="SQUARE_SOLID",e[e.SQUARE_OUTLINE=8]="SQUARE_OUTLINE"})(on||(on={}));var bs;(function(e){e[e.MITER=0]="MITER",e[e.CONCAVE=1]="CONCAVE",e[e.ROUND=2]="ROUND",e[e.BEVEL=3]="BEVEL",e[e.NONE=4]="NONE"})(bs||(bs={}));var ca;(function(e){e[e.STRAIGHT=0]="STRAIGHT",e[e.ROUND=1]="ROUND"})(ca||(ca={}));var u_;(function(e){e[e.HORIZONTAL=0]="HORIZONTAL",e[e.VERTICAL=1]="VERTICAL"})(u_||(u_={}));var an;(function(e){e[e.NONE=0]="NONE",e[e.UNION=1]="UNION",e[e.SUBTRACT=2]="SUBTRACT",e[e.INTERSECT=3]="INTERSECT",e[e.DIFFERENCE=4]="DIFFERENCE"})(an||(an={}));var Us;(function(e){e[e.DOCUMENT=0]="DOCUMENT",e[e.DATA_STORE=1]="DATA_STORE",e[e.SELECTION=2]="SELECTION",e[e.WATCHER=3]="WATCHER",e[e.WORKSPACE=4]="WORKSPACE",e[e.ELEMENT=5]="ELEMENT",e[e.GEOMETRY=6]="GEOMETRY",e[e.ELEMENT_COMPONENT=7]="ELEMENT_COMPONENT",e[e.PROP_COMPONENT=8]="PROP_COMPONENT",e[e.LAYER=9]="LAYER",e[e.BASE=10]="BASE",e[e.COMPUTED_STYLE=11]="COMPUTED_STYLE",e[e.COMPUTED_LAYER=12]="COMPUTED_LAYER",e[e.IMAGE_RESOURCE=13]="IMAGE_RESOURCE",e[e.IMAGE_EXPORT=14]="IMAGE_EXPORT",e[e.IMAGE_PRESET=15]="IMAGE_PRESET",e[e.EFFECT=16]="EFFECT",e[e.COMPUTED_EFFECT=17]="COMPUTED_EFFECT"})(Us||(Us={}));var Le;(function(e){e[e.TEXT=0]="TEXT",e[e.PATH=1]="PATH",e[e.GROUP=2]="GROUP",e[e.CONTAINER=3]="CONTAINER",e[e.GEOMETRY_GROUP=4]="GEOMETRY_GROUP",e[e.SCREEN=5]="SCREEN",e[e.BOOLEAN_CONTAINER=6]="BOOLEAN_CONTAINER",e[e.MASK_CONTAINER=7]="MASK_CONTAINER",e[e.NORMAL_GROUP=8]="NORMAL_GROUP"})(Le||(Le={}));var d_;(function(e){e[e.ELEMENT=0]="ELEMENT",e[e.COMPONENT=1]="COMPONENT"})(d_||(d_={}));var Of;(function(e){e[e.CONTAINER=3]="CONTAINER",e[e.MASK_CONTAINER=7]="MASK_CONTAINER",e[e.BOOLEAN_CONTAINER=6]="BOOLEAN_CONTAINER",e[e.NORMAL_GROUP=8]="NORMAL_GROUP"})(Of||(Of={}));var gn;(function(e){e[e.RECTANGLE=0]="RECTANGLE",e[e.ELLIPSE=1]="ELLIPSE",e[e.POLYGON=2]="POLYGON",e[e.REGULAR_POLYGON=3]="REGULAR_POLYGON",e[e.STAR=4]="STAR",e[e.LINE=5]="LINE",e[e.TEXT=6]="TEXT"})(gn||(gn={}));var Re;(function(e){e[e.TRANSLATE=0]="TRANSLATE",e[e.DIMENSIONS=1]="DIMENSIONS",e[e.ROTATION=2]="ROTATION",e[e.OPACITY=3]="OPACITY",e[e.FILL=4]="FILL",e[e.STROKE=5]="STROKE",e[e.SHADOW=6]="SHADOW",e[e.INNER_SHADOW=7]="INNER_SHADOW",e[e.FONT=8]="FONT",e[e.TEXT_ALIGNMENT=9]="TEXT_ALIGNMENT",e[e.TEXT_DECORATION=10]="TEXT_DECORATION",e[e.TEXT_DIRECTION=11]="TEXT_DIRECTION",e[e.TEXT_SPACING=12]="TEXT_SPACING",e[e.SCALE=13]="SCALE",e[e.SKEW=14]="SKEW",e[e.ORIGIN=15]="ORIGIN",e[e.OVERFLOW=16]="OVERFLOW",e[e.BLUR_GAUSSIAN=17]="BLUR_GAUSSIAN",e[e.PAINT=18]="PAINT",e[e.IMAGE=19]="IMAGE",e[e.CORNER_RADIUS=20]="CORNER_RADIUS",e[e.CONTENT_ANCHOR=21]="CONTENT_ANCHOR",e[e.EFFECT=22]="EFFECT",e[e.REFERENCE_POINT=23]="REFERENCE_POINT"})(Re||(Re={}));var Tr;(function(e){e[e.FILL=4]="FILL",e[e.STROKE=5]="STROKE",e[e.SHADOW=6]="SHADOW",e[e.INNER_SHADOW=7]="INNER_SHADOW"})(Tr||(Tr={}));var f_;(function(e){e[e.FONT=8]="FONT",e[e.TEXT_ALIGNMENT=9]="TEXT_ALIGNMENT",e[e.TEXT_DECORATION=10]="TEXT_DECORATION",e[e.TEXT_DIRECTION=11]="TEXT_DIRECTION"})(f_||(f_={}));var p_;(function(e){e[e.SCALE=13]="SCALE",e[e.SKEW=14]="SKEW",e[e.BLUR_GAUSSIAN=17]="BLUR_GAUSSIAN"})(p_||(p_={}));var Ye;(function(e){e[e.FILL=4]="FILL",e[e.STROKE=5]="STROKE",e[e.SHADOW=6]="SHADOW",e[e.INNER_SHADOW=7]="INNER_SHADOW"})(Ye||(Ye={}));var E_;(function(e){e[e.VERTEX=0]="VERTEX",e[e.EDGE=1]="EDGE",e[e.CONTOUR=2]="CONTOUR"})(E_||(E_={}));var pe;(function(e){e[e.NONE=0]="NONE",e[e.ANGLE=1]="ANGLE",e[e.ANGLE_AND_LENGTH=2]="ANGLE_AND_LENGTH",e[e.INDEPENDENT=3]="INDEPENDENT"})(pe||(pe={}));var wi;(function(e){e[e.TRIM_PATH=0]="TRIM_PATH"})(wi||(wi={}));var $i;(function(e){e[e.SIMULTANEOUSLY=0]="SIMULTANEOUSLY",e[e.INDIVIDUALLY=1]="INDIVIDUALLY"})($i||($i={}));var g_;(function(e){e[e.ACTION=0]="ACTION",e[e.RESPONSE=1]="RESPONSE",e[e.TRIGGER=2]="TRIGGER",e[e.CONDITION=3]="CONDITION",e[e.ELEMENT_TRACK=4]="ELEMENT_TRACK",e[e.PROPERTY_TRACK=5]="PROPERTY_TRACK",e[e.KEY_FRAME=6]="KEY_FRAME",e[e.ANIMATION_PRESET=7]="ANIMATION_PRESET",e[e.TRANSFER=8]="TRANSFER"})(g_||(g_={}));var __;(function(e){e[e.START=0]="START",e[e.DURING=1]="DURING",e[e.END=2]="END",e[e.START_AND_END=3]="START_AND_END"})(__||(__={}));var T_;(function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e[e.MULTI=2]="MULTI"})(T_||(T_={}));var A_;(function(e){e.A="A",e.B="B",e.C="C",e.D="D",e.E="E",e.F="F",e.G="G",e.H="H",e.I="I",e.J="J",e.K="K",e.L="L",e.M="M",e.N="N",e.O="O",e.P="P",e.Q="Q",e.R="R",e.S="S",e.T="T",e.U="U",e.V="V",e.W="W",e.X="X",e.Y="Y",e.Z="Z",e.NUM_0="0",e.NUM_1="1",e.NUM_2="2",e.NUM_3="3",e.NUM_4="4",e.NUM_5="5",e.NUM_6="6",e.NUM_7="7",e.NUM_8="8",e.NUM_9="9"})(A_||(A_={}));var li;(function(e){e[e.CLICK=0]="CLICK",e[e.DOUBLE_CLICK=1]="DOUBLE_CLICK",e[e.DRAG=2]="DRAG",e[e.EDGE_SWIPE=3]="EDGE_SWIPE",e[e.FORCE_TAP=4]="FORCE_TAP",e[e.HOVER=5]="HOVER",e[e.MOUSE_ENTER=6]="MOUSE_ENTER",e[e.MOUSE_LEAVE=7]="MOUSE_LEAVE",e[e.MOUSE_UP=8]="MOUSE_UP",e[e.MOUSE_DOWN=9]="MOUSE_DOWN",e[e.KEY_PRESS=10]="KEY_PRESS",e[e.LOAD=11]="LOAD",e[e.LONG_PRESS=12]="LONG_PRESS",e[e.MANY_CLICK=13]="MANY_CLICK",e[e.MOUSE_MOVE=14]="MOUSE_MOVE",e[e.PINCH=15]="PINCH",e[e.PRESS=16]="PRESS",e[e.ROTATE=17]="ROTATE",e[e.SCROLL=18]="SCROLL",e[e.SWIPE=19]="SWIPE"})(li||(li={}));var m_;(function(e){e[e.AND=0]="AND",e[e.OR=1]="OR"})(m_||(m_={}));var O_;(function(e){e[e.NONE=0]="NONE"})(O_||(O_={}));var If;(function(e){e[e.EXPLICIT=0]="EXPLICIT",e[e.INITIAL=1]="INITIAL"})(If||(If={}));var Sf;(function(e){e.EXPLICIT="EXPLICIT",e.INITIAL="INITIAL",e.TWEEN="TWEEN",e.NON_EDITABLE="NON_EDITABLE"})(Sf||(Sf={}));var ut;(function(e){e[e.ANY=0]="ANY",e[e.CLOCKWISE=1]="CLOCKWISE",e[e.COUNTERCLOCKWISE=2]="COUNTERCLOCKWISE",e[e.INWARD=3]="INWARD",e[e.OUTWARD=4]="OUTWARD",e[e.HORIZONTAL=5]="HORIZONTAL",e[e.VERTICAL=6]="VERTICAL",e[e.LEFT=7]="LEFT",e[e.RIGHT=8]="RIGHT",e[e.UP=9]="UP",e[e.DOWN=10]="DOWN",e[e.START=11]="START",e[e.END=12]="END"})(ut||(ut={}));var Te;(function(e){e[e.LINEAR=0]="LINEAR",e[e.EASE=1]="EASE",e[e.EASE_IN=2]="EASE_IN",e[e.EASE_OUT=3]="EASE_OUT",e[e.EASE_IN_OUT=4]="EASE_IN_OUT",e[e.EASE_IN_SIN=5]="EASE_IN_SIN",e[e.EASE_OUT_SINE=6]="EASE_OUT_SINE",e[e.EASE_IN_OUT_SINE=7]="EASE_IN_OUT_SINE",e[e.EASE_IN_QUAD=8]="EASE_IN_QUAD",e[e.EASE_OUT_QUAD=9]="EASE_OUT_QUAD",e[e.EASE_IN_OUT_QUAD=10]="EASE_IN_OUT_QUAD",e[e.EASE_IN_CUBIC=11]="EASE_IN_CUBIC",e[e.EASE_OUT_CUBIC=12]="EASE_OUT_CUBIC",e[e.EASE_IN_OUT_CUBIC=13]="EASE_IN_OUT_CUBIC",e[e.EASE_IN_QUART=14]="EASE_IN_QUART",e[e.EASE_OUT_QUART=15]="EASE_OUT_QUART",e[e.EASE_IN_OUT_QUART=16]="EASE_IN_OUT_QUART",e[e.EASE_IN_QUINT=17]="EASE_IN_QUINT",e[e.EASE_OUT_QUINT=18]="EASE_OUT_QUINT",e[e.EASE_IN_OUT_QUINT=19]="EASE_IN_OUT_QUINT",e[e.EASE_IN_EXPO=20]="EASE_IN_EXPO",e[e.EASE_OUT_EXPO=21]="EASE_OUT_EXPO",e[e.EASE_IN_OUT_EXPO=22]="EASE_IN_OUT_EXPO",e[e.EASE_IN_CIRC=23]="EASE_IN_CIRC",e[e.EASE_OUT_CIRC=24]="EASE_OUT_CIRC",e[e.EASE_IN_OUT_CIRC=25]="EASE_IN_OUT_CIRC",e[e.EASE_IN_BACK=26]="EASE_IN_BACK",e[e.EASE_OUT_BACK=27]="EASE_OUT_BACK",e[e.EASE_IN_OUT_BACK=28]="EASE_IN_OUT_BACK",e[e.CUSTOM=29]="CUSTOM",e[e.STEP=30]="STEP",e[e.STEP_START=31]="STEP_START",e[e.STEP_MIDDLE=32]="STEP_MIDDLE",e[e.STEP_END=33]="STEP_END",e[e.STEP_CUSTOM=34]="STEP_CUSTOM",e[e.HOP_IN=35]="HOP_IN",e[e.HOP_OUT=36]="HOP_OUT",e[e.HOP_IN_OUT=37]="HOP_IN_OUT"})(Te||(Te={}));var I_;(function(e){e[e.START=0]="START",e[e.END=1]="END"})(I_||(I_={}));var Rn;(function(e){e[e.FADE_IN=0]="FADE_IN",e[e.FADE_OUT=1]="FADE_OUT",e[e.MOVE_IN=2]="MOVE_IN",e[e.MOVE_OUT=3]="MOVE_OUT",e[e.SCALE_IN=4]="SCALE_IN",e[e.SCALE_OUT=5]="SCALE_OUT",e[e.SPIN_IN=6]="SPIN_IN",e[e.SPIN_OUT=7]="SPIN_OUT",e[e.TRIM_IN=8]="TRIM_IN",e[e.TRIM_OUT=9]="TRIM_OUT"})(Rn||(Rn={}));var S_;(function(e){e.ELEMENT_LIST="element_list",e.ACTION_LIST="action_list"})(S_||(S_={}));var Qs;(function(e){e.EDITING="EDITING",e.VIEWING="VIEWING",e.INSPECTING="INSPECTING",e.VERSIONING="VERSIONING",e.PROTOTYPING="PROTOTYPING"})(Qs||(Qs={}));var Bh;(function(e){e[e.SINGLE=0]="SINGLE",e[e.TABLE=1]="TABLE",e[e.SITEMAP=2]="SITEMAP"})(Bh||(Bh={}));var wn;(function(e){e[e.ELEMENT=0]="ELEMENT",e[e.SHAPE=1]="SHAPE",e[e.TEXT=2]="TEXT",e[e.MOTION_PATH=3]="MOTION_PATH"})(wn||(wn={}));var Dn;(function(e){e[e.DESIGN=0]="DESIGN",e[e.ACTION=1]="ACTION"})(Dn||(Dn={}));var y_;(function(e){e.DESIGN_MODE="DESIGN_MODE",e.ACTION_MODE="ACTION_MODE",e.PROTOTYPE_MODE="PROTOTYPE_MODE",e.INSPECT_MODE="INSPECT_MODE",e.VERSION_MODE="VERSION_MODE",e.VIEW_MODE="VIEW_MODE",e.SELECTOR_MODE="SELECTOR_MODE"})(y_||(y_={}));var C_;(function(e){e.EDITING_STATE="EDITING_STATE",e.VERSIONING_STATE="VERSIONING_STATE"})(C_||(C_={}));var et;(function(e){e[e.SELECT=0]="SELECT",e[e.SCALE=1]="SCALE",e[e.HAND=2]="HAND",e[e.RECTANGLE=3]="RECTANGLE",e[e.ELLIPSE=4]="ELLIPSE",e[e.POLYGON=5]="POLYGON",e[e.STAR=6]="STAR",e[e.LINE=7]="LINE",e[e.ARROW=8]="ARROW",e[e.CONTAINER=9]="CONTAINER",e[e.PEN=10]="PEN",e[e.EYE_DROPPER=11]="EYE_DROPPER",e[e.COMMENT=12]="COMMENT",e[e.INSERT=13]="INSERT",e[e.PROTOTYPE=14]="PROTOTYPE",e[e.ADD_ACTION=15]="ADD_ACTION",e[e.TEXT=16]="TEXT"})(et||(et={}));var N_;(function(e){e[e.SELECT=0]="SELECT",e[e.SCALE=1]="SCALE"})(N_||(N_={}));var x_;(function(e){e[e.RECTANGLE=3]="RECTANGLE",e[e.ELLIPSE=4]="ELLIPSE",e[e.POLYGON=5]="POLYGON",e[e.STAR=6]="STAR",e[e.LINE=7]="LINE",e[e.ARROW=8]="ARROW",e[e.CONTAINER=9]="CONTAINER",e[e.PEN=10]="PEN",e[e.TEXT=16]="TEXT"})(x_||(x_={}));var jt;(function(e){e[e.TOP=0]="TOP",e[e.MIDDLE=1]="MIDDLE",e[e.BOTTOM=2]="BOTTOM",e[e.LEFT=3]="LEFT",e[e.CENTER=4]="CENTER",e[e.RIGHT=5]="RIGHT"})(jt||(jt={}));var $a;(function(e){e[e.HORIZONTAL=0]="HORIZONTAL",e[e.VERTICAL=1]="VERTICAL"})($a||($a={}));var v_;(function(e){e[e.IN_PROGRESS=0]="IN_PROGRESS",e[e.COMPLETED=1]="COMPLETED",e[e.SKIPPED=2]="SKIPPED"})(v_||(v_={}));var R_;(function(e){e[e.INITIAL=0]="INITIAL",e[e.WAITING=1]="WAITING",e[e.FINISHED=2]="FINISHED"})(R_||(R_={}));var Eo;(function(e){e[e.GIF=0]="GIF",e[e.MP4=1]="MP4",e[e.LOTTIE=2]="LOTTIE",e[e.DOTLOTTIE=3]="DOTLOTTIE"})(Eo||(Eo={}));var la;(function(e){e[e.ULTRA=0]="ULTRA",e[e.HIGH=1]="HIGH",e[e.MEDIUM=2]="MEDIUM",e[e.LOW=3]="LOW"})(la||(la={}));var w_;(function(e){e[e.IMPORT_LOTTIE_REMINDER_DIALOG_IN_ACTION=0]="IMPORT_LOTTIE_REMINDER_DIALOG_IN_ACTION",e[e.IMPORT_DOTLOTTIE_MULTIPLE_ANIMATIONS_DIALOG_IN_ACTION=1]="IMPORT_DOTLOTTIE_MULTIPLE_ANIMATIONS_DIALOG_IN_ACTION"})(w_||(w_={}));var Vh;(function(e){e[e.CONTENT=0]="CONTENT",e[e.POSITION=1]="POSITION"})(Vh||(Vh={}));var Un;(function(e){e[e.STOP=0]="STOP",e[e.GRADIENT=1]="GRADIENT",e[e.HANDLE=2]="HANDLE",e[e.ASPECT_RATIO=3]="ASPECT_RATIO",e[e.REFERENCE=4]="REFERENCE"})(Un||(Un={}));var D_;(function(e){e[e.BOTH=0]="BOTH",e[e.HORIZONTAL=1]="HORIZONTAL",e[e.VERTICAL=2]="VERTICAL"})(D_||(D_={}));var L_;(function(e){e.GUEST="GUEST",e.MEMBER="MEMBER",e.ADMIN="ADMIN",e.OWNER="OWNER"})(L_||(L_={}));var er;(function(e){e.FROM_MESH_CHANGE="FROM_MESH_CHANGE",e.FROM_PARENT_EDIT="FROM_PARENT_EDIT",e.FROM_CHILDREN_CHANGE="FROM_CHILDREN_CHANGE",e.FROM_ANIMATION="FROM_ANIMATION",e.FROM_CHANGE_CONTAINER_TYPE="FROM_CHANGE_CONTAINER_TYPE",e.FROM_DRAG_DUPLICATE="FROM_DRAG_DUPLICATE",e.FROM_DATA_SYNC="FROM_DATA_SYNC",e.FROM_INTERACTION_CONTINUOUSLY_CHANGE="FROM_INTERACTION_CONTINUOUSLY_CHANGE",e.FROM_ELEMENT_CREATE="FROM_ELEMENT_CREATE",e.SHOW_SCOPE_CHANGE_MODAL="SHOW_SCOPE_CHANGE_MODAL",e.FROM_SYSTEM="FROM_SYSTEM",e.FROM_TEXT_EDIT="FROM_TEXT_EDIT"})(er||(er={}));var Gs;(function(e){e.USER_EDITING="USER_EDITING",e.UNDO_REDO="UNDO_REDO",e.ANIMATING="ANIMATING",e.OTHER="OTHER"})(Gs||(Gs={}));var ds;(function(e){e[e.NONE=0]="NONE",e[e.UPDATE=1]="UPDATE",e[e.UPDATE_ALL=2]="UPDATE_ALL",e[e.UPDATE_NEED_BBOX_RECALC=3]="UPDATE_NEED_BBOX_RECALC",e[e.UPDATE_ALL_NEED_BBOX_RECALC=4]="UPDATE_ALL_NEED_BBOX_RECALC"})(ds||(ds={}));var Gt;(function(e){e.NONE="NONE",e.ELEMENT="ELEMENT",e.RESIZE_HANDLE="RESIZE_HANDLE",e.ROTATE_HANDLE="ROTATE_HANDLE",e.GRADIENT_STOP_HANDLE="GRADIENT_STOP_HANDLE",e.GRADIENT_TRANSFORM_START_HANDLE="GRADIENT_TRANSFORM_START_HANDLE",e.GRADIENT_TRANSFORM_END_HANDLE="GRADIENT_TRANSFORM_END_HANDLE",e.GRADIENT_TRANSFORM_SHAPE_HANDLE="GRADIENT_TRANSFORM_SHAPE_HANDLE",e.GRADIENT_TRANSFORM_REFERENCE_LINE="GRADIENT_TRANSFORM_REFERENCE_LINE",e.SCROLLBAR="SCROLLBAR",e.CURVE_CONTROL="CURVE_CONTROL",e.VERTEX="VERTEX",e.ENDPOINT="ENDPOINT",e.EDGE="EDGE",e.ORIGIN="ORIGIN",e.MULTIPLE_SELECTION_BOUND="MULTIPLE_SELECTION_BOUND",e.MOTION_POINT="MOTION_POINT",e.MOTION_SEGMENT="MOTION_SEGMENT",e.RULER="RULER",e.GUIDELINE="GUIDELINE"})(Gt||(Gt={}));var Y;(function(e){e.ACTIVATE_ARROW_TOOL="ACTIVATE_ARROW_TOOL",e.ACTIVATE_COMMENT_TOOL="ACTIVATE_COMMENT_TOOL",e.ACTIVATE_CONTAINER_TOOL="ACTIVATE_CONTAINER_TOOL",e.ACTIVATE_EDIT_GRADIENT="ACTIVATE_EDIT_GRADIENT",e.ACTIVATE_ELLIPSE_TOOL="ACTIVATE_ELLIPSE_TOOL",e.ACTIVATE_EXCLUDE_TOOL="ACTIVATE_EXCLUDE_TOOL",e.ACTIVATE_EYE_DROPPER_TOOL="ACTIVATE_EYE_DROPPER_TOOL",e.ACTIVATE_GRADIENT_HANDLES_MODE="ACTIVATE_GRADIENT_HANDLES_MODE",e.ACTIVATE_HAND_TOOL="ACTIVATE_HAND_TOOL",e.ACTIVATE_INTERSECT_TOOL="ACTIVATE_INTERSECT_TOOL",e.ACTIVATE_LINE_TOOL="ACTIVATE_LINE_TOOL",e.ACTIVATE_PAN="ACTIVATE_PAN",e.ACTIVATE_PEN_TOOL="ACTIVATE_PEN_TOOL",e.ACTIVATE_POLYGON_TOOL="ACTIVATE_POLYGON_TOOL",e.ACTIVATE_RECTANGLE_TOOL="ACTIVATE_RECTANGLE_TOOL",e.ACTIVATE_SCALE_TOOL="ACTIVATE_SCALE_TOOL",e.ACTIVATE_SELECTOR_MODE="ACTIVATE_SELECTOR_MODE",e.ACTIVATE_SELECT_TOOL="ACTIVATE_SELECT_TOOL",e.ACTIVATE_SHAPE_MODE="ACTIVATE_SHAPE_MODE",e.ACTIVATE_STAR_TOOL="ACTIVATE_STAR_TOOL",e.ACTIVATE_SUBTRACT_TOOL="ACTIVATE_SUBTRACT_TOOL",e.ACTIVATE_TEXT_EDIT_MODE="ACTIVATE_TEXT_EDIT_MODE",e.ACTIVATE_TEXT_MODE="ACTIVATE_TEXT_MODE",e.ACTIVATE_TEXT_TOOL="ACTIVATE_TEXT_TOOL",e.ACTIVATE_UNION_TOOL="ACTIVATE_UNION_TOOL",e.ADD_ACTION="ADD_ACTION",e.ADD_LAYER="ADD_LAYER",e.ADD_NEW_GRADIENT_STOP="ADD_NEW_GRADIENT_STOP",e.ALIGN="ALIGN",e.ALL="*",e.APPEND_ELEMENT="APPEND_ELEMENT",e.BOOLEAN_GROUP_ELEMENTS="BOOLEAN_GROUP_ELEMENTS",e.BRING_TO_FRONT="BRING_TO_FRONT",e.CANCEL_EXPORT_MEDIA="CANCEL_EXPORT_MEDIA",e.CANCEL_SELECTOR_MODE="CANCEL_SELECTOR_MODE",e.CHANGE_TEXT_CARET="CHANGE_TEXT_CARET",e.CLOSE_MODAL="CLOSE_MODAL",e.COMMENT_DEACTIVATE_PAN="COMMENT_DEACTIVATE_PAN",e.CONFIRM_SELECTOR_MODE="CONFIRM_SELECTOR_MODE",e.CONVERT_ELEMENT_TO_CONTAINER="CONVERT_ELEMENT_TO_CONTAINER",e.CONVERT_ELEMENT_TO_GROUP="CONVERT_ELEMENT_TO_GROUP",e.CONVERT_ELEMENT_TO_PATH="CONVERT_ELEMENT_TO_PATH",e.CONVERT_SHAPE_TO_PATH="CONVERT_SHAPE_TO_PATH",e.COPY="COPY",e.CREATE_ELEMENT_W_DEFAULT_SIZE="CREATE_ELEMENT_W_DEFAULT_SIZE",e.CUT="CUT",e.DEACTIVATE_GRADIENT_HANDLES_MODE="DEACTIVATE_GRADIENT_HANDLES_MODE",e.DEACTIVATE_PAN="DEACTIVATE_PAN",e.DEACTIVATE_SELECTOR_MODE="DEACTIVATE_SELECTOR_MODE",e.DEACTIVATE_SHAPE_MODE="DEACTIVATE_SHAPE_MODE",e.DEACTIVATE_TEXT_EDIT_MODE="DEACTIVATE_TEXT_EDIT_MODE",e.DEACTIVATE_TEXT_MODE="DEACTIVATE_TEXT_MODE",e.DEACTIVATE_MOTION_PATH_MODE="DEACTIVATE_MOTION_PATH_MODE",e.DECREASE_CORNER_RADIUS="DECREASE_CORNER_RADIUS",e.DELETE_CELL="DELETE_CELL",e.DELETE_ELEMENT="DELETE_ELEMENT",e.DELETE_GRADIENT_STOP="DELETE_GRADIENT_STOP",e.DELETE_GUIDELINES="DELETE_GUIDELINES",e.DELETE_KEYFRAME="DELETE_KEYFRAME",e.DELETE_LAYER="DELETE_LAYER",e.DELETE_MOTION_POINT="DELETE_MOTION_POINT",e.DELETE_TEXT="DELETE_TEXT",e.DERECTLY_SELECT_GUIDE="DERECTLY_SELECT_GUIDE",e.DESELECT_CELL="DESELECT_CELL",e.DESELECT_ELEMENT="DESELECT_ELEMENT",e.DESELECT_KEYFRAME="DESELECT_KEYFRAME",e.DESELECT_MOTION_POINT="DESELECT_MOTION_POINT",e.DIRECTLY_SELECT_GUIDE="DIRECTLY_SELECT_GUIDE",e.DISTRIBUTE="DISTRIBUTE",e.DOUBLE_LEFT_CLICK="DOUBLE_LEFT_CLICK",e.DOWNLOAD_FILE="DOWNLOAD_FILE",e.DRAG_END="DRAG_END",e.DRAG_OVER="DRAG_OVER",e.DROP_WITH_FILES="DROP_WITH_FILES",e.DUPLICATE_CELL="DUPLICATE_CELL",e.DUPLICATE_ELEMENT="DUPLICATE_ELEMENT",e.DUPLICATE_KEYFRAME="DUPLICATE_KEYFRAME",e.EDIT_NEXT_TEXT_ELEMENT="EDIT_NEXT_TEXT_ELEMENT",e.EDIT_ORIGIN="EDIT_ORIGIN",e.EDIT_PREVIOUS_TEXT_ELEMENT="EDIT_PREVIOUS_TEXT_ELEMENT",e.EDIT_SELECTOR="EDIT_SELECTOR",e.END_AREA_SELECT_CELL="END_AREA_SELECT_CELL",e.END_AREA_SELECT_ELEMENT="END_AREA_SELECT_ELEMENT",e.END_CREATE_ELEMENT="END_CREATE_ELEMENT",e.END_CREATE_GUIDE="END_CREATE_GUIDE",e.END_DRAG_CELL="END_DRAG_CELL",e.END_DRAG_ELEMENT="END_DRAG_ELEMENT",e.END_DRAG_GRADIENT_HANDLE="END_DRAG_GRADIENT_HANDLE",e.END_DRAG_MOTION_POINT="END_DRAG_MOTION_POINT",e.END_DRAG_MOTION_SEGMENT="END_DRAG_MOTION_SEGMENT",e.END_DRAG_MULTI_ELEMENTS="END_DRAG_MULTI_ELEMENTS",e.END_DRAG_ORIGIN="END_DRAG_ORIGIN",e.END_DRAG_SCROLLBAR="END_DRAG_SCROLLBAR",e.END_DRAW_PATH="END_DRAW_PATH",e.END_DRAW_PATH_ON_EDGE="END_DRAW_PATH_ON_EDGE",e.END_DRAW_PATH_ON_VERTEX="END_DRAW_PATH_ON_VERTEX",e.END_EXPAND_TEXT_SELECTION="END_EXPAND_TEXT_SELECTION",e.END_LEFT_CLICK_MOVE="END_LEFT_CLICK_MOVE",e.END_MOVE_GUIDE="END_MOVE_GUIDE",e.END_MOVE_GUIDE_WO_SELECT="END_MOVE_GUIDE_WO_SELECT",e.END_MOVE_SCROLLBAR="END_MOVE_SCROLLBAR",e.END_MOVE_TEXT_CARET="END_MOVE_TEXT_CARET",e.END_PANNING="END_PANNING",e.END_RESIZE_ELEMENT="END_RESIZE_ELEMENT",e.END_RIGHT_CLICK_MOVE="END_RIGHT_CLICK_MOVE",e.END_ROTATE_ELEMENT="END_ROTATE_ELEMENT",e.END_SCALE_ELEMENT="END_SCALE_ELEMENT",e.END_ZOOM_TO_SELECTION="END_ZOOM_TO_SELECTION",e.ENTER_PROTOTYPE_MODE="ENTER_PROTOTYPE_MODE",e.ENTER_PROTOTYPE_MODE_FULL_SCREEN="ENTER_PROTOTYPE_MODE_FULL_SCREEN",e.EXIT_EDITOR="EXIT_EDITOR",e.EXIT_PROTOTYPE_MODE="EXIT_PROTOTYPE_MODE",e.EXPAND_TEXT_SELECTION="EXPAND_TEXT_SELECTION",e.EXPAND_TEXT_SELECTION_KEY="EXPAND_TEXT_SELECTION_KEY",e.EXPAND_TEXT_SELECTION_TO_LINE_START="EXPAND_TEXT_SELECTION_TO_LINE_START",e.EXPAND_TEXT_SELECTION_TO_NEXT_WORD_KEY="EXPAND_TEXT_SELECTION_TO_NEXT_WORD_KEY",e.EXPAND_TEXT_SELECTION_TO_TEXT_START="EXPAND_TEXT_SELECTION_TO_TEXT_START",e.EXPORT_FINISH="EXPORT_FINISH",e.EXPORT_MEDIA="EXPORT_MEDIA",e.EXPORT_PROGRESS="EXPORT_PROGRESS",e.GROUP_ELEMENTS="GROUP_ELEMENTS",e.HOVER_BOX_HANDLE="HOVER_BOX_HANDLE",e.HOVER_CELL="HOVER_CELL",e.HOVER_CELL_WITH_SELECTION="HOVER_CELL_WITH_SELECTION",e.HOVER_CREATE_PATH="HOVER_CREATE_PATH",e.HOVER_DEEP_ELEMENT="HOVER_DEEP_ELEMENT",e.HOVER_ELEMENT="HOVER_ELEMENT",e.HOVER_GRADIENT_HANDLE="HOVER_GRADIENT_HANDLE",e.HOVER_GUIDELINE="HOVER_GUIDELINE",e.HOVER_MOTION_POINT="HOVER_MOTION_POINT",e.HOVER_MOTION_SEGMENT="HOVER_MOTION_SEGMENT",e.HOVER_ORIGIN="HOVER_ORIGIN",e.HOVER_RULER="HOVER_RULER",e.HOVER_SCROLLBAR="HOVER_SCROLLBAR",e.INCREASE_CORNER_RADIUS="INCREASE_CORNER_RADIUS",e.INSERT_ELEMENT="INSERT_ELEMENT",e.INSERT_IMAGE="INSERT_IMAGE",e.INSERT_SVG="INSERT_SVG",e.LEAVE_VERSION_PREVIEW="LEAVE_VERSION_PREVIEW",e.MAC_ZOOM_TO_POINTER="MAC_ZOOM_TO_POINTER",e.MASK_GROUP_ELEMENTS="MASK_GROUP_ELEMENTS",e.MOBILE_PINCH_ZOOM_TO_POINTER="MOBILE_PINCH_ZOOM_TO_POINTER",e.MOBILE_TOUCH_PAN="MOBILE_TOUCH_PAN",e.MOVE_BACKWARD="MOVE_BACKWARD",e.MOVE_CELL_SELECTION_KEY="MOVE_CELL_SELECTION_KEY",e.MOVE_ELEMENT_SELECTION_KEY="MOVE_ELEMENT_SELECTION_KEY",e.MOVE_FORWARD="MOVE_FORWARD",e.MOVE_GRADIENT_HANDLE_KEY="MOVE_GRADIENT_HANDLE_KEY",e.MOVE_MOTION_POINTS_SELECTION_KEY="MOVE_MOTION_POINTS_SELECTION_KEY",e.MOVE_TEXT_CARET_KEY="MOVE_TEXT_CARET_KEY",e.MOVE_TEXT_CARET_TO_LINE_START="MOVE_TEXT_CARET_TO_LINE_START",e.MOVE_TEXT_CARET_TO_NEXT_WORD_KEY="MOVE_TEXT_CARET_TO_NEXT_WORD_KEY",e.MOVE_TEXT_CARET_TO_TEXT_START="MOVE_TEXT_CARET_TO_TEXT_START",e.MOVE_VIEWPORT_KEY="MOVE_VIEWPORT_KEY",e.MOVE_VIEWPORT_WHEEL="MOVE_VIEWPORT_WHEEL",e.OPEN_CANVAS_CONTEXT_MENU="OPEN_CANVAS_CONTEXT_MENU",e.OPEN_ELEMENT_CONTEXT_MENU="OPEN_ELEMENT_CONTEXT_MENU",e.PASTE="PASTE",e.PASTE_WITH_FILES="PASTE_WITH_FILES",e.PAUSE_ANIMATION="PAUSE_ANIMATION",e.PLAY_ANIMATION="PLAY_ANIMATION",e.REDO="REDO",e.RENAME_ELEMENT="RENAME_ELEMENT",e.RESET_ANIMATION="RESET_ANIMATION",e.RESET_GRADIENT_STOP_ACTIVE_INDEX="RESET_GRADIENT_STOP_ACTIVE_INDEX",e.RESTART_PROTOTYPE="RESTART_PROTOTYPE",e.RESUME_TEXT_EDIT_MODE="RESUME_TEXT_EDIT_MODE",e.SELECT_ALL_CELLS="SELECT_ALL_CELLS",e.SELECT_ALL_ELEMENTS="SELECT_ALL_ELEMENTS",e.SELECT_ALL_MOTION_POINTS="SELECT_ALL_MOTION_POINTS",e.SELECT_ALL_TEXT="SELECT_ALL_TEXT",e.SELECT_CELL="SELECT_CELL",e.SELECT_CHILD_ELEMENT="SELECT_CHILD_ELEMENT",e.SELECT_ELEMENT="SELECT_ELEMENT",e.SELECT_FIRST_ELEMENT="SELECT_FIRST_ELEMENT",e.SELECT_GRADIENT_HANDLE="SELECT_GRADIENT_HANDLE",e.SELECT_MOTION_POINT="SELECT_MOTION_POINT",e.SELECT_NEXT_ELEMENT="SELECT_NEXT_ELEMENT",e.SELECT_PARENT_ELEMENT="SELECT_PARENT_ELEMENT",e.SELECT_PREVIOUS_ELEMENT="SELECT_PREVIOUS_ELEMENT",e.SEND_TO_BACK="SEND_TO_BACK",e.SET_CURSOR_OVERLAY="SET_CURSOR_OVERLAY",e.SET_LOCK_GUIDES="SET_LOCK_GUIDES",e.SHOW_CONFIRMATION="SHOW_CONFIRMATION",e.SHOW_NOTIFICATION="SHOW_NOTIFICATION",e.START_AREA_SELECT_CELL="START_AREA_SELECT_CELL",e.START_AREA_SELECT_ELEMENT="START_AREA_SELECT_ELEMENT",e.START_CREATE_ELEMENT="START_CREATE_ELEMENT",e.START_CREATE_GUIDE="START_CREATE_GUIDE",e.START_DRAG_CELL="START_DRAG_CELL",e.START_DRAG_ELEMENT="START_DRAG_ELEMENT",e.START_DRAG_GRADIENT_HANDLE="START_DRAG_GRADIENT_HANDLE",e.START_DRAG_MOTION_POINT="START_DRAG_MOTION_POINT",e.START_DRAG_MOTION_SEGMENT="START_DRAG_MOTION_SEGMENT",e.START_DRAG_MULTI_ELEMENTS="START_DRAG_MULTI_ELEMENTS",e.START_DRAG_ORIGIN="START_DRAG_ORIGIN",e.START_DRAG_SCROLLBAR="START_DRAG_SCROLLBAR",e.START_DRAW_PATH="START_DRAW_PATH",e.START_DRAW_PATH_ON_EDGE="START_DRAW_PATH_ON_EDGE",e.START_DRAW_PATH_ON_VERTEX="START_DRAW_PATH_ON_VERTEX",e.START_EXPAND_TEXT_SELECTION="START_EXPAND_TEXT_SELECTION",e.START_LEFT_CLICK_MOVE="START_LEFT_CLICK_MOVE",e.START_MOVE_GUIDE="START_MOVE_GUIDE",e.START_MOVE_GUIDE_WO_SELECT="START_MOVE_GUIDE_WO_SELECT",e.START_MOVE_SCROLLBAR="START_MOVE_SCROLLBAR",e.START_MOVE_TEXT_CARET="START_MOVE_TEXT_CARET",e.START_PANNING="START_PANNING",e.START_RESIZE_ELEMENT="START_RESIZE_ELEMENT",e.START_RIGHT_CLICK_MOVE="START_RIGHT_CLICK_MOVE",e.START_ROTATE_ELEMENT="START_ROTATE_ELEMENT",e.START_SCALE_ELEMENT="START_SCALE_ELEMENT",e.START_ZOOM_TO_SELECTION="START_ZOOM_TO_SELECTION",e.STOP_ANIMATION="STOP_ANIMATION",e.SWITCH_BEND_TOOL="SWITCH_BEND_TOOL",e.SWITCH_DOCUMENT_MODE="SWITCH_DOCUMENT_MODE",e.SWITCH_MODE="SWITCH_MODE",e.SWITCH_TEXT_ELEMENT="SWITCH_TEXT_ELEMENT",e.SWITCH_VIEW_MODE="SWITCH_VIEW_MODE",e.TEXT_INSERT_NEW_LINE="TEXT_INSERT_NEW_LINE",e.TOGGLE_ACTION_PANEL="TOGGLE_ACTION_PANEL",e.TOGGLE_CELL_SELECTION="TOGGLE_CELL_SELECTION",e.TOGGLE_COMMENT_VISIBILITY="TOGGLE_COMMENT_VISIBILITY",e.TOGGLE_EXPAND="TOGGLE_EXPAND",e.TOGGLE_INSPECTING="TOGGLE_INSPECTING",e.TOGGLE_INTERFACE="TOGGLE_INTERFACE",e.TOGGLE_LOCK="TOGGLE_LOCK",e.TOGGLE_ORIGIN="TOGGLE_ORIGIN",e.TOGGLE_PRESENCE="TOGGLE_PRESENCE",e.TOGGLE_RULER="TOGGLE_RULER",e.TOGGLE_SNAP_TO_OBJECT="TOGGLE_SNAP_TO_OBJECT",e.TOGGLE_SNAP_TO_PIXEL_GRID="TOGGLE_SNAP_TO_PIXEL_GRID",e.TOGGLE_VISIBLE="TOGGLE_VISIBLE",e.TRACKPAD_ZOOM_TO_POINTER="TRACKPAD_ZOOM_TO_POINTER",e.UNDO="UNDO",e.UNGROUP_ELEMENTS="UNGROUP_ELEMENTS",e.UPDATE_AREA_SELECT_CELL="UPDATE_AREA_SELECT_CELL",e.UPDATE_AREA_SELECT_ELEMENT="UPDATE_AREA_SELECT_ELEMENT",e.UPDATE_CREATE_ELEMENT="UPDATE_CREATE_ELEMENT",e.UPDATE_CREATE_GUIDE="UPDATE_CREATE_GUIDE",e.UPDATE_DRAG_CELL="UPDATE_DRAG_CELL",e.UPDATE_DRAG_ELEMENT="UPDATE_DRAG_ELEMENT",e.UPDATE_DRAG_GRADIENT_HANDLE="UPDATE_DRAG_GRADIENT_HANDLE",e.UPDATE_DRAG_MOTION_POINT="UPDATE_DRAG_MOTION_POINT",e.UPDATE_DRAG_MOTION_SEGMENT="UPDATE_DRAG_MOTION_SEGMENT",e.UPDATE_DRAG_MULTI_ELEMENTS="UPDATE_DRAG_MULTI_ELEMENTS",e.UPDATE_DRAG_ORIGIN="UPDATE_DRAG_ORIGIN",e.UPDATE_DRAG_SCROLLBAR="UPDATE_DRAG_SCROLLBAR",e.UPDATE_DRAW_PATH="UPDATE_DRAW_PATH",e.UPDATE_DRAW_PATH_ON_EDGE="UPDATE_DRAW_PATH_ON_EDGE",e.UPDATE_DRAW_PATH_ON_VERTEX="UPDATE_DRAW_PATH_ON_VERTEX",e.UPDATE_EXPAND_TEXT_SELECTION="UPDATE_EXPAND_TEXT_SELECTION",e.UPDATE_LEFT_CLICK_MOVE="UPDATE_LEFT_CLICK_MOVE",e.UPDATE_MOVE_GUIDE="UPDATE_MOVE_GUIDE",e.UPDATE_MOVE_GUIDE_WO_SELECT="UPDATE_MOVE_GUIDE_WO_SELECT",e.UPDATE_MOVE_SCROLLBAR="UPDATE_MOVE_SCROLLBAR",e.UPDATE_MOVE_TEXT_CARET="UPDATE_MOVE_TEXT_CARET",e.UPDATE_PANNING="UPDATE_PANNING",e.UPDATE_RESIZE_ELEMENT="UPDATE_RESIZE_ELEMENT",e.UPDATE_RIGHT_CLICK_MOVE="UPDATE_RIGHT_CLICK_MOVE",e.UPDATE_ROTATE_ELEMENT="UPDATE_ROTATE_ELEMENT",e.UPDATE_SCALE_ELEMENT="UPDATE_SCALE_ELEMENT",e.UPDATE_ZOOM_TO_SELECTION="UPDATE_ZOOM_TO_SELECTION",e.WHEEL_PAN_VIEWPORT="WHEEL_PAN_VIEWPORT",e.WHEEL_ZOOM_TO_POINTER="WHEEL_ZOOM_TO_POINTER",e.ZOOM_CENTER_SELECTION="ZOOM_CENTER_SELECTION",e.ZOOM_FIT_CONTENT="ZOOM_FIT_CONTENT",e.ZOOM_FIT_HEIGHT="ZOOM_FIT_HEIGHT",e.ZOOM_FIT_SELECTION="ZOOM_FIT_SELECTION",e.ZOOM_FIT_WIDTH="ZOOM_FIT_WIDTH",e.ZOOM_IN="ZOOM_IN",e.ZOOM_OUT="ZOOM_OUT",e.ZOOM_RESET="ZOOM_RESET",e.ZOOM_TO_POINTER="ZOOM_TO_POINTER",e.ZOOM_TO_VALUE="ZOOM_TO_VALUE"})(Y||(Y={}));var yf;(function(e){e.NONE="NONE",e.SCREEN="SCREEN",e.CONTAINER="CONTAINER",e.TEXT="TEXT",e.RECTANGLE="RECTANGLE",e.ELLIPSE="ELLIPSE",e.POLYGON="POLYGON",e.REGULAR_POLYGON="REGULAR_POLYGON",e.STAR="STAR",e.LINE="LINE",e.MULTIPLE="MULTIPLE"})(yf||(yf={}));const{abs:el,cos:Ur,sin:ec,acos:vx,atan2:tl,sqrt:go,pow:Di}=Math;function nl(e){return e<0?-Di(-e,1/3):Di(e,1/3)}const M_=Math.PI,Hh=2*M_,_o=M_/2,Rx=1e-6,Cf=Number.MAX_SAFE_INTEGER||9007199254740991,Nf=Number.MIN_SAFE_INTEGER||-9007199254740991,wx={x:0,y:0,z:0},_e={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(e,n){const s=n(e);let i=s.x*s.x+s.y*s.y;return typeof s.z<"u"&&(i+=s.z*s.z),go(i)},compute:function(e,n,s){if(e===0)return n[0].t=0,n[0];const i=n.length-1;if(e===1)return n[i].t=1,n[i];const r=1-e;let o=n;if(i===0)return n[0].t=e,n[0];if(i===1){const c={x:r*o[0].x+e*o[1].x,y:r*o[0].y+e*o[1].y,t:e};return s&&(c.z=r*o[0].z+e*o[1].z),c}if(i<4){let c=r*r,l=e*e,h,d,p,E=0;i===2?(o=[o[0],o[1],o[2],wx],h=c,d=r*e*2,p=l):i===3&&(h=c*r,d=c*e*3,p=r*l*3,E=e*l);const g={x:h*o[0].x+d*o[1].x+p*o[2].x+E*o[3].x,y:h*o[0].y+d*o[1].y+p*o[2].y+E*o[3].y,t:e};return s&&(g.z=h*o[0].z+d*o[1].z+p*o[2].z+E*o[3].z),g}const a=JSON.parse(JSON.stringify(n));for(;a.length>1;){for(let c=0;c<a.length-1;c++)a[c]={x:a[c].x+(a[c+1].x-a[c].x)*e,y:a[c].y+(a[c+1].y-a[c].y)*e},typeof a[c].z<"u"&&(a[c].z=a[c].z+(a[c+1].z-a[c].z)*e);a.splice(a.length-1,1)}return a[0].t=e,a[0]},computeWithRatios:function(e,n,s,i){const r=1-e,o=s,a=n;let c=o[0],l=o[1],h=o[2],d=o[3],p;if(c*=r,l*=e,a.length===2)return p=c+l,{x:(c*a[0].x+l*a[1].x)/p,y:(c*a[0].y+l*a[1].y)/p,z:i?(c*a[0].z+l*a[1].z)/p:!1,t:e};if(c*=r,l*=2*r,h*=e*e,a.length===3)return p=c+l+h,{x:(c*a[0].x+l*a[1].x+h*a[2].x)/p,y:(c*a[0].y+l*a[1].y+h*a[2].y)/p,z:i?(c*a[0].z+l*a[1].z+h*a[2].z)/p:!1,t:e};if(c*=r,l*=1.5*r,h*=3*r,d*=e*e*e,a.length===4)return p=c+l+h+d,{x:(c*a[0].x+l*a[1].x+h*a[2].x+d*a[3].x)/p,y:(c*a[0].y+l*a[1].y+h*a[2].y+d*a[3].y)/p,z:i?(c*a[0].z+l*a[1].z+h*a[2].z+d*a[3].z)/p:!1,t:e}},derive:function(e,n){const s=[];for(let i=e,r=i.length,o=r-1;r>1;r--,o--){const a=[];for(let c=0,l;c<o;c++)l={x:o*(i[c+1].x-i[c].x),y:o*(i[c+1].y-i[c].y)},n&&(l.z=o*(i[c+1].z-i[c].z)),a.push(l);s.push(a),i=a}return s},between:function(e,n,s){return n<=e&&e<=s||_e.approximately(e,n)||_e.approximately(e,s)},approximately:function(e,n,s){return el(e-n)<=(s||Rx)},length:function(e){const s=_e.Tvalues.length;let i=0;for(let r=0,o;r<s;r++)o=.5*_e.Tvalues[r]+.5,i+=_e.Cvalues[r]*_e.arcfn(o,e);return .5*i},map:function(e,n,s,i,r){const o=s-n,a=r-i,c=e-n,l=c/o;return i+a*l},lerp:function(e,n,s){const i={x:n.x+e*(s.x-n.x),y:n.y+e*(s.y-n.y)};return n.z!==void 0&&s.z!==void 0&&(i.z=n.z+e*(s.z-n.z)),i},pointToString:function(e){let n=e.x+"/"+e.y;return typeof e.z<"u"&&(n+="/"+e.z),n},pointsToString:function(e){return"["+e.map(_e.pointToString).join(", ")+"]"},copy:function(e){return JSON.parse(JSON.stringify(e))},angle:function(e,n,s){const i=n.x-e.x,r=n.y-e.y,o=s.x-e.x,a=s.y-e.y,c=i*a-r*o,l=i*o+r*a;return tl(c,l)},round:function(e,n){const s=""+e,i=s.indexOf(".");return parseFloat(s.substring(0,i+1+n))},dist:function(e,n){const s=e.x-n.x,i=e.y-n.y;return go(s*s+i*i)},closest:function(e,n){let s=Di(2,63),i,r;return e.forEach(function(o,a){r=_e.dist(n,o),r<s&&(s=r,i=a)}),{mdist:s,mpos:i}},abcratio:function(e,n){if(n!==2&&n!==3)return!1;if(typeof e>"u")e=.5;else if(e===0||e===1)return e;const s=Di(e,n)+Di(1-e,n),i=s-1;return el(i/s)},projectionratio:function(e,n){if(n!==2&&n!==3)return!1;if(typeof e>"u")e=.5;else if(e===0||e===1)return e;const s=Di(1-e,n),i=Di(e,n)+s;return s/i},lli8:function(e,n,s,i,r,o,a,c){const l=(e*i-n*s)*(r-a)-(e-s)*(r*c-o*a),h=(e*i-n*s)*(o-c)-(n-i)*(r*c-o*a),d=(e-s)*(o-c)-(n-i)*(r-a);return d==0?!1:{x:l/d,y:h/d}},lli4:function(e,n,s,i){const r=e.x,o=e.y,a=n.x,c=n.y,l=s.x,h=s.y,d=i.x,p=i.y;return _e.lli8(r,o,a,c,l,h,d,p)},lli:function(e,n){return _e.lli4(e,e.c,n,n.c)},makeline:function(e,n){return new Bt(e.x,e.y,(e.x+n.x)/2,(e.y+n.y)/2,n.x,n.y)},findbbox:function(e){let n=Cf,s=Cf,i=Nf,r=Nf;return e.forEach(function(o){const a=o.bbox();n>a.x.min&&(n=a.x.min),s>a.y.min&&(s=a.y.min),i<a.x.max&&(i=a.x.max),r<a.y.max&&(r=a.y.max)}),{x:{min:n,mid:(n+i)/2,max:i,size:i-n},y:{min:s,mid:(s+r)/2,max:r,size:r-s}}},shapeintersections:function(e,n,s,i,r){if(!_e.bboxoverlap(n,i))return[];const o=[],a=[e.startcap,e.forward,e.back,e.endcap],c=[s.startcap,s.forward,s.back,s.endcap];return a.forEach(function(l){l.virtual||c.forEach(function(h){if(h.virtual)return;const d=l.intersects(h,r);d.length>0&&(d.c1=l,d.c2=h,d.s1=e,d.s2=s,o.push(d))})}),o},makeshape:function(e,n,s){const i=n.points.length,r=e.points.length,o=_e.makeline(n.points[i-1],e.points[0]),a=_e.makeline(e.points[r-1],n.points[0]),c={startcap:o,forward:e,back:n,endcap:a,bbox:_e.findbbox([o,e,n,a])};return c.intersections=function(l){return _e.shapeintersections(c,c.bbox,l,l.bbox,s)},c},getminmax:function(e,n,s){if(!s)return{min:0,max:0};let i=Cf,r=Nf,o,a;s.indexOf(0)===-1&&(s=[0].concat(s)),s.indexOf(1)===-1&&s.push(1);for(let c=0,l=s.length;c<l;c++)o=s[c],a=e.get(o),a[n]<i&&(i=a[n]),a[n]>r&&(r=a[n]);return{min:i,mid:(i+r)/2,max:r,size:r-i}},align:function(e,n){const s=n.p1.x,i=n.p1.y,r=-tl(n.p2.y-i,n.p2.x-s),o=function(a){return{x:(a.x-s)*Ur(r)-(a.y-i)*ec(r),y:(a.x-s)*ec(r)+(a.y-i)*Ur(r)}};return e.map(o)},roots:function(e,n){n=n||{p1:{x:0,y:0},p2:{x:1,y:0}};const s=e.length-1,i=_e.align(e,n),r=function(L){return 0<=L&&L<=1};if(s===2){const L=i[0].y,P=i[1].y,k=i[2].y,Q=L-2*P+k;if(Q!==0){const b=-go(P*P-L*k),X=-L+P,K=-(b+X)/Q,V=-(-b+X)/Q;return[K,V].filter(r)}else if(P!==k&&Q===0)return[(2*P-k)/(2*P-2*k)].filter(r);return[]}const o=i[0].y,a=i[1].y,c=i[2].y,l=i[3].y;let h=-o+3*a-3*c+l,d=3*o-6*a+3*c,p=-3*o+3*a,E=o;if(_e.approximately(h,0)){if(_e.approximately(d,0))return _e.approximately(p,0)?[]:[-E/p].filter(r);const L=go(p*p-4*d*E),P=2*d;return[(L-p)/P,(-p-L)/P].filter(r)}d/=h,p/=h,E/=h;const g=(3*p-d*d)/3,T=g/3,A=(2*d*d*d-9*d*p+27*E)/27,m=A/2,O=m*m+T*T*T;let S,y,v,R,M;if(O<0){const L=-g/3,P=L*L*L,k=go(P),Q=-A/(2*k),b=Q<-1?-1:Q>1?1:Q,X=vx(b),K=nl(k),V=2*K;return v=V*Ur(X/3)-d/3,R=V*Ur((X+Hh)/3)-d/3,M=V*Ur((X+2*Hh)/3)-d/3,[v,R,M].filter(r)}else{if(O===0)return S=m<0?nl(-m):-nl(m),v=2*S-d/3,R=-S-d/3,[v,R].filter(r);{const L=go(O);return S=nl(-m+L),y=nl(m+L),[S-y-d/3].filter(r)}}},droots:function(e){if(e.length===3){const n=e[0],s=e[1],i=e[2],r=n-2*s+i;if(r!==0){const o=-go(s*s-n*i),a=-n+s,c=-(o+a)/r,l=-(-o+a)/r;return[c,l]}else if(s!==i&&r===0)return[(2*s-i)/(2*(s-i))];return[]}if(e.length===2){const n=e[0],s=e[1];return n!==s?[n/(n-s)]:[]}return[]},curvature:function(e,n,s,i,r){let o,a,c,l,h=0,d=0;const p=_e.compute(e,n),E=_e.compute(e,s),g=p.x*p.x+p.y*p.y;if(i?(o=go(Di(p.y*E.z-E.y*p.z,2)+Di(p.z*E.x-E.z*p.x,2)+Di(p.x*E.y-E.x*p.y,2)),a=Di(g+p.z*p.z,3/2)):(o=p.x*E.y-p.y*E.x,a=Di(g,3/2)),o===0||a===0)return{k:0,r:0};if(h=o/a,d=a/o,!r){const T=_e.curvature(e-.001,n,s,i,!0).k,A=_e.curvature(e+.001,n,s,i,!0).k;l=(A-h+(h-T))/2,c=(el(A-h)+el(h-T))/2}return{k:h,r:d,dk:l,adk:c}},inflections:function(e){if(e.length<4)return[];const n=_e.align(e,{p1:e[0],p2:e.slice(-1)[0]}),s=n[2].x*n[1].y,i=n[3].x*n[1].y,r=n[1].x*n[2].y,o=n[3].x*n[2].y,a=18*(-3*s+2*i+3*r-o),c=18*(3*s-i-3*r),l=18*(r-s);if(_e.approximately(a,0)){if(!_e.approximately(c,0)){let E=-l/c;if(0<=E&&E<=1)return[E]}return[]}const h=2*a;if(_e.approximately(h,0))return[];const d=c*c-4*a*l;if(d<0)return[];const p=Math.sqrt(d);return[(p-c)/h,-(c+p)/h].filter(function(E){return 0<=E&&E<=1})},bboxoverlap:function(e,n){const s=["x","y"],i=s.length;for(let r=0,o,a,c,l;r<i;r++)if(o=s[r],a=e[o].mid,c=n[o].mid,l=(e[o].size+n[o].size)/2,el(a-c)>=l)return!1;return!0},expandbox:function(e,n){n.x.min<e.x.min&&(e.x.min=n.x.min),n.y.min<e.y.min&&(e.y.min=n.y.min),n.z&&n.z.min<e.z.min&&(e.z.min=n.z.min),n.x.max>e.x.max&&(e.x.max=n.x.max),n.y.max>e.y.max&&(e.y.max=n.y.max),n.z&&n.z.max>e.z.max&&(e.z.max=n.z.max),e.x.mid=(e.x.min+e.x.max)/2,e.y.mid=(e.y.min+e.y.max)/2,e.z&&(e.z.mid=(e.z.min+e.z.max)/2),e.x.size=e.x.max-e.x.min,e.y.size=e.y.max-e.y.min,e.z&&(e.z.size=e.z.max-e.z.min)},pairiteration:function(e,n,s){const i=e.bbox(),r=n.bbox(),o=1e5,a=s||.5;if(i.x.size+i.y.size<a&&r.x.size+r.y.size<a)return[(o*(e._t1+e._t2)/2|0)/o+"/"+(o*(n._t1+n._t2)/2|0)/o];let c=e.split(.5),l=n.split(.5),h=[{left:c.left,right:l.left},{left:c.left,right:l.right},{left:c.right,right:l.right},{left:c.right,right:l.left}];h=h.filter(function(p){return _e.bboxoverlap(p.left.bbox(),p.right.bbox())});let d=[];return h.length===0||(h.forEach(function(p){d=d.concat(_e.pairiteration(p.left,p.right,a))}),d=d.filter(function(p,E){return d.indexOf(p)===E})),d},getccenter:function(e,n,s){const i=n.x-e.x,r=n.y-e.y,o=s.x-n.x,a=s.y-n.y,c=i*Ur(_o)-r*ec(_o),l=i*ec(_o)+r*Ur(_o),h=o*Ur(_o)-a*ec(_o),d=o*ec(_o)+a*Ur(_o),p=(e.x+n.x)/2,E=(e.y+n.y)/2,g=(n.x+s.x)/2,T=(n.y+s.y)/2,A=p+c,m=E+l,O=g+h,S=T+d,y=_e.lli8(p,E,A,m,g,T,O,S),v=_e.dist(y,e);let R=tl(e.y-y.y,e.x-y.x),M=tl(n.y-y.y,n.x-y.x),L=tl(s.y-y.y,s.x-y.x),P;return R<L?((R>M||M>L)&&(R+=Hh),R>L&&(P=L,L=R,R=P)):L<M&&M<R?(P=L,L=R,R=P):L+=Hh,y.s=R,y.e=L,y.r=v,y},numberSort:function(e,n){return e-n}};class sl{constructor(n){this.curves=[],this._3d=!1,n&&(this.curves=n,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map(function(n){return _e.pointsToString(n.points)}).join(", ")+"]"}addCurve(n){this.curves.push(n),this._3d=this._3d||n._3d}length(){return this.curves.map(function(n){return n.length()}).reduce(function(n,s){return n+s})}curve(n){return this.curves[n]}bbox(){const n=this.curves;for(var s=n[0].bbox(),i=1;i<n.length;i++)_e.expandbox(s,n[i].bbox());return s}offset(n){const s=[];return this.curves.forEach(function(i){s.push(...i.offset(n))}),new sl(s)}}const{abs:il,min:P_,max:b_,cos:Dx,sin:Lx,acos:Mx,sqrt:rl}=Math,Px=Math.PI;class Bt{constructor(n){let s=n&&n.forEach?n:Array.from(arguments).slice(),i=!1;if(typeof s[0]=="object"){i=s.length;const g=[];s.forEach(function(T){["x","y","z"].forEach(function(A){typeof T[A]<"u"&&g.push(T[A])})}),s=g}let r=!1;const o=s.length;if(i){if(i>4){if(arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");r=!0}}else if(o!==6&&o!==8&&o!==9&&o!==12&&arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const a=this._3d=!r&&(o===9||o===12)||n&&n[0]&&typeof n[0].z<"u",c=this.points=[];for(let g=0,T=a?3:2;g<o;g+=T){var l={x:s[g],y:s[g+1]};a&&(l.z=s[g+2]),c.push(l)}const h=this.order=c.length-1,d=this.dims=["x","y"];a&&d.push("z"),this.dimlen=d.length;const p=_e.align(c,{p1:c[0],p2:c[h]}),E=_e.dist(c[0],c[h]);this._linear=p.reduce((g,T)=>g+il(T.y),0)<E/50,this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(n,s,i,r){if(typeof r>"u"&&(r=.5),r===0)return new Bt(s,s,i);if(r===1)return new Bt(n,s,s);const o=Bt.getABC(2,n,s,i,r);return new Bt(n,o.A,i)}static cubicFromPoints(n,s,i,r,o){typeof r>"u"&&(r=.5);const a=Bt.getABC(3,n,s,i,r);typeof o>"u"&&(o=_e.dist(s,a.C));const c=o*(1-r)/r,l=_e.dist(n,i),h=(i.x-n.x)/l,d=(i.y-n.y)/l,p=o*h,E=o*d,g=c*h,T=c*d,A={x:s.x-p,y:s.y-E},m={x:s.x+g,y:s.y+T},O=a.A,S={x:O.x+(A.x-O.x)/(1-r),y:O.y+(A.y-O.y)/(1-r)},y={x:O.x+(m.x-O.x)/r,y:O.y+(m.y-O.y)/r},v={x:n.x+(S.x-n.x)/r,y:n.y+(S.y-n.y)/r},R={x:i.x+(y.x-i.x)/(1-r),y:i.y+(y.y-i.y)/(1-r)};return new Bt(n,v,R,i)}static getUtils(){return _e}getUtils(){return Bt.getUtils()}static get PolyBezier(){return sl}valueOf(){return this.toString()}toString(){return _e.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const n=this.points,s=n[0].x,i=n[0].y,r=["M",s,i,this.order===2?"Q":"C"];for(let o=1,a=n.length;o<a;o++)r.push(n[o].x),r.push(n[o].y);return r.join(" ")}setRatios(n){if(n.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=n,this._lut=[]}verify(){const n=this.coordDigest();n!==this._print&&(this._print=n,this.update())}coordDigest(){return this.points.map(function(n,s){return""+s+n.x+n.y+(n.z?n.z:0)}).join("")}update(){this._lut=[],this.dpoints=_e.derive(this.points,this._3d),this.computedirection()}computedirection(){const n=this.points,s=_e.angle(n[0],n[this.order],n[1]);this.clockwise=s>0}length(){return _e.length(this.derivative.bind(this))}static getABC(n=2,s,i,r,o=.5){const a=_e.projectionratio(o,n),c=1-a,l={x:a*s.x+c*r.x,y:a*s.y+c*r.y},h=_e.abcratio(o,n);return{A:{x:i.x+(i.x-l.x)/h,y:i.y+(i.y-l.y)/h},B:i,C:l,S:s,E:r}}getABC(n,s){s=s||this.get(n);let i=this.points[0],r=this.points[this.order];return Bt.getABC(this.order,i,s,r,n)}getLUT(n){if(this.verify(),n=n||100,this._lut.length===n+1)return this._lut;this._lut=[],n++,this._lut=[];for(let s=0,i,r;s<n;s++)r=s/(n-1),i=this.compute(r),i.t=r,this._lut.push(i);return this._lut}on(n,s){s=s||5;const i=this.getLUT(),r=[];for(let o=0,a,c=0;o<i.length;o++)a=i[o],_e.dist(a,n)<s&&(r.push(a),c+=o/i.length);return r.length?t/=r.length:!1}project(n){const s=this.getLUT(),i=s.length-1,r=_e.closest(s,n),o=r.mpos,a=(o-1)/i,c=(o+1)/i,l=.1/i;let h=r.mdist,d=a,p=d,E;h+=1;for(let g;d<c+l;d+=l)E=this.compute(d),g=_e.dist(n,E),g<h&&(h=g,p=d);return p=p<0?0:p>1?1:p,E=this.compute(p),E.t=p,E.d=h,E}get(n){return this.compute(n)}point(n){return this.points[n]}compute(n){return this.ratios?_e.computeWithRatios(n,this.points,this.ratios,this._3d):_e.compute(n,this.points,this._3d,this.ratios)}raise(){const n=this.points,s=[n[0]],i=n.length;for(let r=1,o,a;r<i;r++)o=n[r],a=n[r-1],s[r]={x:(i-r)/i*o.x+r/i*a.x,y:(i-r)/i*o.y+r/i*a.y};return s[i]=n[i-1],new Bt(s)}derivative(n){return _e.compute(n,this.dpoints[0],this._3d)}dderivative(n){return _e.compute(n,this.dpoints[1],this._3d)}align(){let n=this.points;return new Bt(_e.align(n,{p1:n[0],p2:n[n.length-1]}))}curvature(n){return _e.curvature(n,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return _e.inflections(this.points)}normal(n){return this._3d?this.__normal3(n):this.__normal2(n)}__normal2(n){const s=this.derivative(n),i=rl(s.x*s.x+s.y*s.y);return{t:n,x:-s.y/i,y:s.x/i}}__normal3(n){const s=this.derivative(n),i=this.derivative(n+.01),r=rl(s.x*s.x+s.y*s.y+s.z*s.z),o=rl(i.x*i.x+i.y*i.y+i.z*i.z);s.x/=r,s.y/=r,s.z/=r,i.x/=o,i.y/=o,i.z/=o;const a={x:i.y*s.z-i.z*s.y,y:i.z*s.x-i.x*s.z,z:i.x*s.y-i.y*s.x},c=rl(a.x*a.x+a.y*a.y+a.z*a.z);a.x/=c,a.y/=c,a.z/=c;const l=[a.x*a.x,a.x*a.y-a.z,a.x*a.z+a.y,a.x*a.y+a.z,a.y*a.y,a.y*a.z-a.x,a.x*a.z-a.y,a.y*a.z+a.x,a.z*a.z];return{t:n,x:l[0]*s.x+l[1]*s.y+l[2]*s.z,y:l[3]*s.x+l[4]*s.y+l[5]*s.z,z:l[6]*s.x+l[7]*s.y+l[8]*s.z}}hull(n){let s=this.points,i=[],r=[],o=0;for(r[o++]=s[0],r[o++]=s[1],r[o++]=s[2],this.order===3&&(r[o++]=s[3]);s.length>1;){i=[];for(let a=0,c,l=s.length-1;a<l;a++)c=_e.lerp(n,s[a],s[a+1]),r[o++]=c,i.push(c);s=i}return r}split(n,s){if(n===0&&s)return this.split(s).left;if(s===1)return this.split(n).right;const i=this.hull(n),r={left:this.order===2?new Bt([i[0],i[3],i[5]]):new Bt([i[0],i[4],i[7],i[9]]),right:this.order===2?new Bt([i[5],i[4],i[2]]):new Bt([i[9],i[8],i[6],i[3]]),span:i};return r.left._t1=_e.map(0,0,1,this._t1,this._t2),r.left._t2=_e.map(n,0,1,this._t1,this._t2),r.right._t1=_e.map(n,0,1,this._t1,this._t2),r.right._t2=_e.map(1,0,1,this._t1,this._t2),s?(s=_e.map(s,n,1,0,1),r.right.split(s).left):r}extrema(){const n={};let s=[];return this.dims.forEach((function(i){let r=function(a){return a[i]},o=this.dpoints[0].map(r);n[i]=_e.droots(o),this.order===3&&(o=this.dpoints[1].map(r),n[i]=n[i].concat(_e.droots(o))),n[i]=n[i].filter(function(a){return a>=0&&a<=1}),s=s.concat(n[i].sort(_e.numberSort))}).bind(this)),n.values=s.sort(_e.numberSort).filter(function(i,r){return s.indexOf(i)===r}),n}bbox(){const n=this.extrema(),s={};return this.dims.forEach((function(i){s[i]=_e.getminmax(this,i,n[i])}).bind(this)),s}overlaps(n){const s=this.bbox(),i=n.bbox();return _e.bboxoverlap(s,i)}offset(n,s){if(typeof s<"u"){const i=this.get(n),r=this.normal(n),o={c:i,n:r,x:i.x+r.x*s,y:i.y+r.y*s};return this._3d&&(o.z=i.z+r.z*s),o}if(this._linear){const i=this.normal(0),r=this.points.map(function(o){const a={x:o.x+n*i.x,y:o.y+n*i.y};return o.z&&i.z&&(a.z=o.z+n*i.z),a});return[new Bt(r)]}return this.reduce().map(function(i){return i._linear?i.offset(n)[0]:i.scale(n)})}simple(){if(this.order===3){const r=_e.angle(this.points[0],this.points[3],this.points[1]),o=_e.angle(this.points[0],this.points[3],this.points[2]);if(r>0&&o<0||r<0&&o>0)return!1}const n=this.normal(0),s=this.normal(1);let i=n.x*s.x+n.y*s.y;return this._3d&&(i+=n.z*s.z),il(Mx(i))<Px/3}reduce(){let n,s=0,i=0,r=.01,o,a=[],c=[],l=this.extrema().values;for(l.indexOf(0)===-1&&(l=[0].concat(l)),l.indexOf(1)===-1&&l.push(1),s=l[0],n=1;n<l.length;n++)i=l[n],o=this.split(s,i),o._t1=s,o._t2=i,a.push(o),s=i;return a.forEach(function(h){for(s=0,i=0;i<=1;)for(i=s+r;i<=1+r;i+=r)if(o=h.split(s,i),!o.simple()){if(i-=r,il(s-i)<r)return[];o=h.split(s,i),o._t1=_e.map(s,0,1,h._t1,h._t2),o._t2=_e.map(i,0,1,h._t1,h._t2),c.push(o),s=i;break}s<1&&(o=h.split(s,1),o._t1=_e.map(s,0,1,h._t1,h._t2),o._t2=h._t2,c.push(o))}),c}translate(n,s,i){i=typeof i=="number"?i:s;const r=this.order;let o=this.points.map((a,c)=>(1-c/r)*s+c/r*i);return new Bt(this.points.map((a,c)=>({x:a.x+n.x*o[c],y:a.y+n.y*o[c]})))}scale(n){const s=this.order;let i=!1;if(typeof n=="function"&&(i=n),i&&s===2)return this.raise().scale(i);const r=this.clockwise,o=this.points;if(this._linear)return this.translate(this.normal(0),i?i(0):n,i?i(1):n);const a=i?i(0):n,c=i?i(1):n,l=[this.offset(0,10),this.offset(1,10)],h=[],d=_e.lli4(l[0],l[0].c,l[1],l[1].c);if(!d)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach(function(p){const E=h[p*s]=_e.copy(o[p*s]);E.x+=(p?c:a)*l[p].n.x,E.y+=(p?c:a)*l[p].n.y}),i?([0,1].forEach(function(p){if(!(s===2&&p)){var E=o[p+1],g={x:E.x-d.x,y:E.y-d.y},T=i?i((p+1)/s):n;i&&!r&&(T=-T);var A=rl(g.x*g.x+g.y*g.y);g.x/=A,g.y/=A,h[p+1]={x:E.x+T*g.x,y:E.y+T*g.y}}}),new Bt(h)):([0,1].forEach(p=>{if(s===2&&p)return;const E=h[p*s],g=this.derivative(p),T={x:E.x+g.x,y:E.y+g.y};h[p+1]=_e.lli4(E,T,d,o[p+1])}),new Bt(h))}outline(n,s,i,r){if(s=s===void 0?n:s,this._linear){const R=this.normal(0),M=this.points[0],L=this.points[this.points.length-1];let P,k,Q;i===void 0&&(i=n,r=s),P={x:M.x+R.x*n,y:M.y+R.y*n},Q={x:L.x+R.x*i,y:L.y+R.y*i},k={x:(P.x+Q.x)/2,y:(P.y+Q.y)/2};const b=[P,k,Q];P={x:M.x-R.x*s,y:M.y-R.y*s},Q={x:L.x-R.x*r,y:L.y-R.y*r},k={x:(P.x+Q.x)/2,y:(P.y+Q.y)/2};const X=[Q,k,P],K=_e.makeline(X[2],b[0]),V=_e.makeline(b[2],X[0]),J=[K,new Bt(b),V,new Bt(X)];return new sl(J)}const o=this.reduce(),a=o.length,c=[];let l=[],h,d=0,p=this.length();const E=typeof i<"u"&&typeof r<"u";function g(R,M,L,P,k){return function(Q){const b=P/L,X=(P+k)/L,K=M-R;return _e.map(Q,0,1,R+b*K,R+X*K)}}o.forEach(function(R){const M=R.length();E?(c.push(R.scale(g(n,i,p,d,M))),l.push(R.scale(g(-s,-r,p,d,M)))):(c.push(R.scale(n)),l.push(R.scale(-s))),d+=M}),l=l.map(function(R){return h=R.points,h[3]?R.points=[h[3],h[2],h[1],h[0]]:R.points=[h[2],h[1],h[0]],R}).reverse();const T=c[0].points[0],A=c[a-1].points[c[a-1].points.length-1],m=l[a-1].points[l[a-1].points.length-1],O=l[0].points[0],S=_e.makeline(m,T),y=_e.makeline(A,O),v=[S].concat(c).concat([y]).concat(l);return new sl(v)}outlineshapes(n,s,i){s=s||n;const r=this.outline(n,s).curves,o=[];for(let a=1,c=r.length;a<c/2;a++){const l=_e.makeshape(r[a],r[c-a],i);l.startcap.virtual=a>1,l.endcap.virtual=a<c/2-1,o.push(l)}return o}intersects(n,s){return n?n.p1&&n.p2?this.lineIntersects(n):(n instanceof Bt&&(n=n.reduce()),this.curveintersects(this.reduce(),n,s)):this.selfintersects(s)}lineIntersects(n){const s=P_(n.p1.x,n.p2.x),i=P_(n.p1.y,n.p2.y),r=b_(n.p1.x,n.p2.x),o=b_(n.p1.y,n.p2.y);return _e.roots(this.points,n).filter(a=>{var c=this.get(a);return _e.between(c.x,s,r)&&_e.between(c.y,i,o)})}selfintersects(n){const s=this.reduce(),i=s.length-2,r=[];for(let o=0,a,c,l;o<i;o++)c=s.slice(o,o+1),l=s.slice(o+2),a=this.curveintersects(c,l,n),r.push(...a);return r}curveintersects(n,s,i){const r=[];n.forEach(function(a){s.forEach(function(c){a.overlaps(c)&&r.push({left:a,right:c})})});let o=[];return r.forEach(function(a){const c=_e.pairiteration(a.left,a.right,i);c.length>0&&(o=o.concat(c))}),o}arcs(n){return n=n||.5,this._iterate(n,[])}_error(n,s,i,r){const o=(r-i)/4,a=this.get(i+o),c=this.get(r-o),l=_e.dist(n,s),h=_e.dist(n,a),d=_e.dist(n,c);return il(h-l)+il(d-l)}_iterate(n,s){let i=0,r=1,o;do{o=0,r=1;let a=this.get(i),c,l,h,d,p=!1,E=!1,g,T=r,A=1;do if(E=p,d=h,T=(i+r)/2,c=this.get(T),l=this.get(r),h=_e.getccenter(a,c,l),h.interval={start:i,end:r},p=this._error(h,a,i,r)<=n,g=E&&!p,g||(A=r),p){if(r>=1){if(h.interval.end=A=1,d=h,r>1){let O={x:h.x+h.r*Dx(h.e),y:h.y+h.r*Lx(h.e)};h.e+=_e.angle({x:h.x,y:h.y},O,this.get(1))}break}r=r+(r-i)/2}else r=T;while(!g&&o++<100);if(o>=100)break;d=d||h,s.push(d),i=A}while(r<1);return s}}class ts extends Float32Array{constructor(n,s,i,r){super(4),typeof n=="number"&&typeof s=="number"&&typeof i=="number"&&typeof r=="number"?q0(this,n,s,i,r):this.copy(n)}copy(n){if(Ue(n))return;let s=ee(n[0])?n[0]:n.x;Ue(s)&&(s=n.r);let i=ee(n[1])?n[1]:n.y;Ue(i)&&(i=n.g);let r=ee(n[2])?n[2]:n.z;Ue(r)&&(r=ee(n.b)?n.b:n.width);let o=ee(n[3])?n[3]:n.w;Ue(o)&&(o=ee(n.a)?n.a:n.height),be(s)&&be(i)&&be(r)&&be(o)&&q0(this,s,i,r,o)}eq(n,s=vn){if(Ue(n))return!1;let i=ee(n[0])?n[0]:n.x;Ue(i)&&(i=n.r);let r=ee(n[1])?n[1]:n.y;Ue(r)&&(r=n.g);let o=ee(n[2])?n[2]:n.z;Ue(o)&&(o=ee(n.b)?n.b:n.width);let a=ee(n[3])?n[3]:n.w;return Ue(a)&&(a=ee(n.a)?n.a:n.height),Ix(this,[i,r,o,a],s)}get x(){return this[0]}set x(n){if(isNaN(n))throw new Error("Trying to assign NaN to x component of Vector4");this[0]=n}get y(){return this[1]}set y(n){if(isNaN(n))throw new Error("Trying to assign NaN to y component of Vector4");this[1]=n}get z(){return this[2]}set z(n){if(isNaN(n))throw new Error("Trying to assign NaN to z component of Vector4");this[2]=n}get w(){return this[3]}set w(n){if(isNaN(n))throw new Error("Trying to assign NaN to w component of Vector4");this[3]=n}get r(){return this[0]}set r(n){if(isNaN(n))throw new Error("Trying to assign NaN to r component of Vector4");this[0]=n}get g(){return this[1]}set g(n){if(isNaN(n))throw new Error("Trying to assign NaN to g component of Vector4");this[1]=n}get b(){return this[2]}set b(n){if(isNaN(n))throw new Error("Trying to assign NaN to b component of Vector4");this[2]=n}get a(){return this[3]}set a(n){if(isNaN(n))throw new Error("Trying to assign NaN to a component of Vector4");this[3]=n}get width(){return this[2]}set width(n){if(isNaN(n))throw new Error("Trying to assign NaN to width component of Vector4");this[2]=n}get height(){return this[3]}set height(n){if(isNaN(n))throw new Error("Trying to assign NaN to height component of Vector4");this[3]=n}}ts.ZERO=new ts(0,0,0,0),ts.ONE=new ts(1,1,1,1);class Gn{constructor(n,s,i,r){Ue(n)?(this.min=new ne(1/0,1/0),this.max=new ne(-1/0,-1/0)):n.min?(this.min=new ne(n.min),this.max=new ne(n.max)):n.x&&Ue(s)?(this.min=new ne(n.x,n.y),this.max=new ne(n.x+n.width,n.y+n.height)):!Ue(s)&&Ue(i)?(this.min=new ne(n),this.max=new ne(s)):(this.min=new ne(n,s),this.max=new ne(n+i,s+r))}copy(n){if(Ue(n))return;const{min:s,max:i,x:r,y:o,width:a,height:c}=n;return qa(s)&&qa(i)?(this.min.copy(s),this.max.copy(i)):be(r)&&be(o)&&be(a)&&be(c)&&(this.min.x=r,this.min.y=o,this.max.x=r+a,this.max.y=o+c),this}eq(n,s=vn){if(Ue(n))return!1;const i=qa(n.min)?n.min:[n.x,n.y],r=qa(n.max)?n.max:[n.x+n.width,n.y+n.height];return this.min.eq(i,s)&&this.max.eq(r,s)}save(){return{min:[...this.min],max:[...this.max]}}get isInfinite(){return this.min.x===1/0&&this.min.y===1/0&&this.max.x===-1/0&&this.max.y===-1/0}get isZero(){return this.min.eq(ne.ZERO)&&this.max.eq(ne.ZERO)}get size(){return ra(new ne,this.max,this.min)}get position(){return this.min}get x(){return this.min.x}get y(){return this.min.y}get width(){return this.max.x-this.min.x}get height(){return this.max.y-this.min.y}get topLeft(){return this.min}get bottomRight(){return this.max}get topRight(){return new ne(this.max.x,this.min.y)}get bottomLeft(){return new ne(this.min.x,this.max.y)}get left(){return this.min.x}get top(){return this.min.y}get right(){return this.max.x}get bottom(){return this.max.y}get center(){return new ne(this.x+this.width/2,this.y+this.height/2)}translate(n,s=!0){const i=s?new Gn:this;return vi(i.min,this.min,n),vi(i.max,this.max,n),i}moveTo(n,s=!0){const i=s?new Gn:this,r=this.width,o=this.height;return po(i.min,n[0],n[1]),po(i.max,n[0]+r,n[1]+o),i}transform(n,s=!0){const i=s?new Gn:this,r=this.rect().map(o=>$c(o,o,n));return s||i.reset(),r.forEach(o=>i.minMax(o)),i}resizeBy(n,s=!0){const i=s?new Gn(this):this;return ra(i.min,this.min,n),vi(i.max,this.max,n),i}resizeByScalar(n,s=!0){const i=s?new Gn(this):this;return t_(i.min,this.min,-n),t_(i.max,this.max,n),i}transformMinMax(n,s=!0){const i=s?new Gn:this;return $c(i.min,this.min,n),$c(i.max,this.max,n),i.minMax(),i}intersects(n,s,i,r){let o,a,c,l;return typeof n=="number"&&typeof s=="number"&&typeof i=="number"&&typeof r=="number"?(o=n,a=s,c=n+i,l=s+r):(o=Ue(n.left)?n.x:n.left,a=Ue(n.top)?n.y:n.top,c=Ue(n.right)?n.x+n.width:n.right,l=Ue(n.bottom)?n.y+n.height:n.bottom),o<this.right&&c>this.left&&a<this.bottom&&l>this.top}containedWithin(n,s,i,r){let o,a,c,l;return typeof n=="number"&&typeof s=="number"&&typeof i=="number"&&typeof r=="number"?(o=n,a=s,c=n+i,l=s+r):(o=Ue(n.left)?n.x:n.left,a=Ue(n.top)?n.y:n.top,c=Ue(n.right)?n.x+n.width:n.right,l=Ue(n.bottom)?n.y+n.height:n.bottom),this.left>=o&&this.right<=c&&this.top>=a&&this.bottom<=l}containsPoint(n,s){let i=n,r=s;return Ue(n.x)||(i=n.x,r=n.y),i>=this.left&&i<=this.right&&r>=this.top&&r<=this.bottom}rect(){return[new ne(this.min),new ne(this.max[0],this.min[1]),new ne(this.max),new ne(this.min[0],this.max[1])]}minMax(n){if(Ue(n)){const s=Math.min(this.min[0],this.max[0]),i=Math.min(this.min[1],this.max[1]),r=Math.max(this.min[0],this.max[0]),o=Math.max(this.min[1],this.max[1]);po(this.min,s,i),po(this.max,r,o)}else!Ue(n.min)&&!Ue(n.max)?(Tf(this.min,this.min,n.min),Af(this.max,this.max,n.max)):Ue(n.aabb)?(Tf(this.min,this.min,n),Af(this.max,this.max,n)):this.minMax(n.aabb)}intersectWith(n,s=!0){const i=s?new Gn:this;return Af(i.min,this.min,n.min),Tf(i.max,this.max,n.max),i.max.y<i.min.y&&(this.min.y=0,this.max.y=0),i.max.x<i.min.x&&(this.min.x=0,this.max.x=0),i}union(n,s=!0){const i=s?new Gn:this;return i.min.x=Math.min(this.min.x,n.min.x),i.min.y=Math.min(this.min.y,n.min.y),i.max.x=Math.max(this.max.x,n.max.x),i.max.y=Math.max(this.max.y,n.max.y),i}intersect(n,s=!0){const i=s?new Gn:this;return i.min.x=Math.max(this.min.x,n.min.x),i.min.y=Math.max(this.min.y,n.min.y),i.max.x=Math.min(this.max.x,n.max.x),i.max.y=Math.min(this.max.y,n.max.y),i}reset(){return po(this.min,1/0,1/0),po(this.max,-1/0,-1/0),this}}var ol=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function bx(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var U_={exports:{}};(function(e){var n=Object.prototype.hasOwnProperty,s="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(s=!1));function r(l,h,d){this.fn=l,this.context=h,this.once=d||!1}function o(l,h,d,p,E){if(typeof d!="function")throw new TypeError("The listener must be a function");var g=new r(d,p||l,E),T=s?s+h:h;return l._events[T]?l._events[T].fn?l._events[T]=[l._events[T],g]:l._events[T].push(g):(l._events[T]=g,l._eventsCount++),l}function a(l,h){--l._eventsCount===0?l._events=new i:delete l._events[h]}function c(){this._events=new i,this._eventsCount=0}c.prototype.eventNames=function(){var h=[],d,p;if(this._eventsCount===0)return h;for(p in d=this._events)n.call(d,p)&&h.push(s?p.slice(1):p);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(d)):h},c.prototype.listeners=function(h){var d=s?s+h:h,p=this._events[d];if(!p)return[];if(p.fn)return[p.fn];for(var E=0,g=p.length,T=new Array(g);E<g;E++)T[E]=p[E].fn;return T},c.prototype.listenerCount=function(h){var d=s?s+h:h,p=this._events[d];return p?p.fn?1:p.length:0},c.prototype.emit=function(h,d,p,E,g,T){var A=s?s+h:h;if(!this._events[A])return!1;var m=this._events[A],O=arguments.length,S,y;if(m.fn){switch(m.once&&this.removeListener(h,m.fn,void 0,!0),O){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,d),!0;case 3:return m.fn.call(m.context,d,p),!0;case 4:return m.fn.call(m.context,d,p,E),!0;case 5:return m.fn.call(m.context,d,p,E,g),!0;case 6:return m.fn.call(m.context,d,p,E,g,T),!0}for(y=1,S=new Array(O-1);y<O;y++)S[y-1]=arguments[y];m.fn.apply(m.context,S)}else{var v=m.length,R;for(y=0;y<v;y++)switch(m[y].once&&this.removeListener(h,m[y].fn,void 0,!0),O){case 1:m[y].fn.call(m[y].context);break;case 2:m[y].fn.call(m[y].context,d);break;case 3:m[y].fn.call(m[y].context,d,p);break;case 4:m[y].fn.call(m[y].context,d,p,E);break;default:if(!S)for(R=1,S=new Array(O-1);R<O;R++)S[R-1]=arguments[R];m[y].fn.apply(m[y].context,S)}}return!0},c.prototype.on=function(h,d,p){return o(this,h,d,p,!1)},c.prototype.once=function(h,d,p){return o(this,h,d,p,!0)},c.prototype.removeListener=function(h,d,p,E){var g=s?s+h:h;if(!this._events[g])return this;if(!d)return a(this,g),this;var T=this._events[g];if(T.fn)T.fn===d&&(!E||T.once)&&(!p||T.context===p)&&a(this,g);else{for(var A=0,m=[],O=T.length;A<O;A++)(T[A].fn!==d||E&&!T[A].once||p&&T[A].context!==p)&&m.push(T[A]);m.length?this._events[g]=m.length===1?m[0]:m:a(this,g)}return this},c.prototype.removeAllListeners=function(h){var d;return h?(d=s?s+h:h,this._events[d]&&a(this,d)):(this._events=new i,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=s,c.EventEmitter=c,e.exports=c})(U_);var al=U_.exports;const Ux=bx(al),Gx=["before","after","index","toIndex","fromIndex"];let tn=class{constructor(n){let s;for(s of Gx)s in n&&(this[s]=n[s])}};class tc extends Map{constructor(n){super(n),this.type=gr.PROPERTY}update(n,s){if(!(s instanceof tn))throw Error("Expect class: Change");if(this.has(n)){const i=this.get(n);s.before=i.before}return this.set(n,s)}isEmpty(){return this.size===0}}class cl{constructor({CREATE:n,UPDATE:s,DELETE:i}={}){this.type=gr.ENTITY,this.CREATE=new Set(n),this.UPDATE=new Map(s),this.UPDATE.forEach((r,o)=>{this.UPDATE.set(o,new tc(r))}),this.DELETE=new Set(i)}create(n){for(const s of n)this.CREATE.add(s),this.DELETE.delete(s)}update(n,s,i){this.DELETE.delete(n),this.UPDATE.has(n)||this.UPDATE.set(n,new tc),this.UPDATE.get(n).update(s,i)}delete(n){for(const s of n)this.CREATE.delete(s),this.DELETE.add(s)}removeFromCreate(n){let s;for(s of n)this.CREATE.delete(s)}isEmpty(){return this.CREATE.size===0&&this.DELETE.size===0&&this.UPDATE.size===0}clear(){this.CREATE.clear(),this.UPDATE.clear(),this.DELETE.clear()}}function Fx(e){const{before:n,after:s,index:i,fromIndex:r,toIndex:o}=e;return new tn({before:s,after:n,index:i,fromIndex:o,toIndex:r})}function G_(e){return new tc([...e.entries()].map(([n,s])=>[n,Fx(s)]))}function F_(e){const n=new Map;return e.UPDATE.forEach((s,i)=>{n.set(i,G_(s))}),new cl({CREATE:new Set([...e.DELETE].reverse()),DELETE:new Set([...e.CREATE].reverse()),UPDATE:n})}function kx(e,n){return e.after=n.after,n.toIndex&&(e.toIndex=n.toIndex),!0}function k_(e,n){let s;for(s of n.keys())e.has(s)?kx(e.get(s),n.get(s)):e.set(s,n.get(s));return!0}function Bx(e,n){let s;for(s of n.CREATE)e.CREATE.add(s),e.DELETE.delete(s);for(s of n.DELETE)e.CREATE.has(s)||e.DELETE.add(s),e.UPDATE.delete(s),e.CREATE.delete(s);for(s of n.UPDATE.keys())e.DELETE.delete(s),e.UPDATE.has(s)?k_(e.UPDATE.get(s),n.UPDATE.get(s)):e.UPDATE.set(s,n.UPDATE.get(s));return!0}const xf={[gr.PROPERTY]:tc,[gr.ENTITY]:cl};class B_ extends Ux{constructor(n,s,i){super(),this.undoer=n,this.changeType=s,this.eventName=i||me.DEFAULT_CHANGES,this.undoEvents=new Set([this.eventName]),this.changes=new xf[this.changeType]}emit(n,s){super.emit(this.eventName,n,s)}fire(n=!0,s){this.changes.isEmpty()||(this.emit(this.changes,s),n&&this.undoer&&this.undoer.addUndo&&this.undoer.addUndo(this,this.eventName,this.changes),this.changes=new xf[this.changeType])}renewChanges(){this.changes.isEmpty()||(this.changes=new xf[this.changeType])}undo(n){n instanceof tc&&this.emit(G_(n)),n instanceof cl&&this.emit(F_(n))}redo(n,s){n instanceof tc&&this.emit(n,s),n instanceof cl&&this.emit(n,s)}combineUndo(n,s,i){if(s.type!==i.type)return!1;switch(s.type){case gr.ENTITY:return Bx(s,i);case gr.PROPERTY:return k_(s,i)}}}const Vx="isMix",To=.1,Ao=Object.freeze({CURVE_CONTROL:"__FAKE_IND_CURVE_CONTROL__"}),dt=Object.freeze({spacingMultiple:3,size:20,dashSize:4,color:16777215,alpha:.6,borderColor:2039586,background:855052,fontSize:10,originModeColour:1863400,originModeBorderWidth:2,guidelineColor:14437212,overlapAlpha:[.15,.3,.45,.6]}),Hx="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let Wx=(e=21)=>{let n="",s=crypto.getRandomValues(new Uint8Array(e|=0));for(;e--;)n+=Hx[s[e]&63];return n};const ha="default",V_=0,vf="-",Yx=["el","bs","pc","im","ly","ms","tm","ei"],Rf=(e,n,s)=>{if(e===ha)return`${n}`;const i=[];return e&&i.push(e),i.push(n),s&&i.push(s),i.join(vf)},Xx=()=>{const e=Yx.reduce((n,s)=>(n[s]=Rf(s,V_),n),{});return e[ha]=`${V_}`,e};class zx{constructor(){this._counter=Xx(),this.suffixKey=Wx(4)}getCurrentCount(n){const s=this._getPrefixKey(n);return this._getNumber(s)}getIdBy(n){const s=this._getPrefixKey(n);return this._counter[s]}create(n){const s=this._getPrefixKey(n),i=this._getNumber(s);return this._counter[s]=Rf(s,i+1,this.suffixKey),this._counter[s]}load(n,s){const i=this._getPrefixKey(s),r=this._getNumber(i),o=this._getNumber(i,n),a=Math.max(r,o);this._counter[i]=Rf(i,a)}_getPrefixKey(n){return this._counter[n]?n:ha}_getNumber(n,s){if(s&&!this.isInCounter(s,n))return parseInt(this._counter[ha]);const i=this._getPrefixKey(n),r=s||this._counter[i],o=isNaN(Number(r))?this._counter[ha]:r,a=i===ha?o:r.split(vf)[1];return parseInt(a)}isInCounter(n,s){if(!n||typeof n!="string"&&typeof n!="number")return!1;let i=n.toString();typeof n=="number"&&(i=`${n}`);const r=this._getPrefixKey(s);let o=i;if(r!==ha){const a=i.split(vf);if(a.length<2||a[0]!==r)return!1;o=a[1]}return!isNaN(Number(o))}}const H_=new zx;function Gr(e=""){return H_.create(e)}function W_(e,n=""){H_.load(e,n)}const Ge=Object.freeze({SELECTED:1,CURVE_VERT:2,CONNECT_SELECTED:4});class wf{constructor(n=null){this.id=n===null?Gr(ci.MESH):n,this.upperTierIDs=new Set,this.type="undefined",this.flags=0,this.index=0}static fromData({id:n}){W_(n,ci.MESH)}isFlagged(n){return(this.flags&1<<n)!==0}flag(n){this.flags|=1<<n}removeFlag(n){this.flags&=~(1<<n)}save(){throw new Error("must be implemented by subclass!")}}class mo extends wf{constructor(n=!1){super(),this.pos=new ne,this.cornerRadius=null,this.cap=null,this.end=null,this.join=null,this.mirror=pe.NONE,this.inHalves=new Set,this.outHalves=new Set,this.virtualInHalves=new Set,this.virtualOutHalves=new Set,this.isVirtual=n,this.type="Vertex",this.unlinkedCurveControl=null,this.controllingEdge=null,this.adjacentMainVertex=null}static fromData({id:n,pos:s,cornerRadius:i=null,cap:r=null,end:o=null,join:a=null,mirror:c=pe.NONE}){super.fromData({id:n});const l=new mo;return l.id=n,l.pos=new ne(s),l.cornerRadius=i,l.cap=r,l.end=o,l.join=a,l.mirror=c,l.type="Vertex",l}set({pos:n,cornerRadius:s,cap:i,join:r,mirror:o,end:a}){let c=!1;if(qa(n)&&(this.pos=new ne(n),c=!0),s===null?this.cornerRadius=null:this.cornerRadius=s>=0?s:this.cornerRadius,i===null?this.cap=null:this.cap=i in on?i:this.cap,a===null?this.end=null:this.end=a in ca?a:this.end,r===null?this.join=null:this.join=r in bs?r:this.join,this.mirror=o in pe?o:this.mirror,c)for(const l of this.getEdges({virtual:this.isVirtual}))l.updateBounds()}copy(){const n=new mo;return n.pos.x=this.pos.x,n.pos.y=this.pos.y,n.cornerRadius=this.cornerRadius,n.cap=this.cap,n.end=this.end,n.join=this.join,n.mirror=this.mirror,n.adjacentMainVertex=this.adjacentMainVertex,n.unlinkedCurveControl=this.unlinkedCurveControl,n.flags=this.flags,n}eq(n){return n&&this.pos.eq(n)}save(){var s;const n={};return n.id=this.id,n.pos=[this.pos[0],this.pos[1]],n.cornerRadius=this.cornerRadius,n.cap=this.cap,n.end=this.end,n.join=this.join,n.mirror=this.mirror,n.adjMainId=(s=this.adjacentMainVertex)==null?void 0:s.id,n}*getOutHalves({virtual:n=!1,all:s=!1}={}){if(s||!n)for(const i of this.outHalves)yield i;if(s||n)for(const i of this.virtualOutHalves)yield i}*getInHalves({virtual:n=!1,all:s=!1}={}){if(s||!n)for(const i of this.inHalves)yield i;if(s||n)for(const i of this.virtualInHalves)yield i}*getEdges(n){for(const s of this.getOutHalves(n))yield s.edge}*getNeighbours(n){const s=new Set;for(const i of this.getOutHalves(n))s.has(i.w)||(s.add(i.w),yield i.w)}*findOutHalves(n,s){for(const i of this.getOutHalves(s))i.w===n&&(yield i)}connectEdge(n){let s,i;return n.v===this?(s=n.halves[0],i=n.halves[1]):n.w===this&&(s=n.halves[1],i=n.halves[0]),!s||!i?!1:(this.upperTierIDs.add(n.id),n.isVirtual?(this.virtualOutHalves.add(s),this.virtualInHalves.add(i)):(this.outHalves.add(s),this.inHalves.add(i)),!0)}disconnectEdge(n){this.upperTierIDs.delete(n.id),n.v===this?n.isVirtual?(this.virtualOutHalves.delete(n.halves[0]),this.virtualInHalves.delete(n.halves[1])):(this.outHalves.delete(n.halves[0]),this.inHalves.delete(n.halves[1])):n.w===this&&(n.isVirtual?(this.virtualOutHalves.delete(n.halves[1]),this.virtualInHalves.delete(n.halves[0])):(this.outHalves.delete(n.halves[1]),this.inHalves.delete(n.halves[0])))}}class Y_{constructor(n,s){if(Ue(n)||Ue(s))throw new Error("Trying to create HalfEdge with no parent edge or undefined origin");this.edge=n,this.v=s,this.contours=new Set,this.twin=void 0}get isVirtual(){return this.edge.isVirtual}get index(){return this.edge.getHalfIndex(this)}get w(){return this.twin.v}get next(){return this.w.getOutHalves()}get prev(){return this.v.getInHalves()}get bounds(){return this.edge.bounds}has(n){const s=this.v.pos,i=this.w.pos;return(i[0]-s[0])*(n[1]-s[1])===(n[0]-s[0])*(i[1]-s[1])&&Math.abs(s[0]-i[0])>vn?s[0]<n[0]&&n[0]<i[0]||i[0]<n[0]&&n[0]<s[0]:s[1]<n[1]&&n[1]<i[1]||i[1]<n[1]&&n[1]<s[1]}addContour(n){this.contours.add(n)}removeContour(n){this.contours.delete(n)}hasMatchingCurve(n,s=vn){if(!n||!this.edge.isCurve)return!1;const i=this.index,r=this.edge.curve;return oa(r[i===0?0:1].pos,n[0],s)&&oa(r[i===0?1:0].pos,n[1],s)}hasVirtualEdges(){return this.edge.hasVirtualEdges()}}class Li extends wf{constructor(n=!1){super(),this.halves=[],this.curve=[],this.virtualEdges=new Set,this.bounds=new Gn,this.isVirtual=n,this._bezier=null,this.type="Edge"}static fromData({id:n,v:s,cpV:i,cpW:r,w:o},a=!1){super.fromData({id:n});const c=new Li;return c.id=n,c._createHalves(s,o),c.setCurve(i,r,a),c.updateBounds(),c.type="Edge",c}set({v:n,cpV:s,cpW:i,w:r},o=!1){Ue(n)||Ue(r)||!n.pos||!r.pos||Ue(s)||Ue(i)||!s.pos||!i.pos||(this._createHalves(n,r),this.setCurve(s,i,o),this.updateBounds())}setCurve(n,s,i=!1){this.curve=[n,s];for(let r=0;r<2;r++){const o=this.halves[r].v;i||this.curve[r].set(o),this.curve[r].flag(Ge.CURVE_VERT),this.curve[r].adjacentMainVertex=o,this.curve[r].cornerRadius=o.cornerRadius,this.curve[r].controllingEdge=this}this.isCurve||(this._bezier=null)}copy(n,s,i,r){const o=new Li;return o.set({v:n,cpV:s,cpW:i,w:r},!0),o.bounds.copy(this.bounds),o}get v(){return this.halves[0].v}get w(){return this.halves[1].v}save(n=!1){const s={};return s.id=this.id,s.v=this.v.id,s.w=this.w.id,n?s.curve=this.isCurve?[[...this.curve[0].pos],[...this.curve[1].pos]]:null:(s.curveIds=[this.curve[0].id,this.curve[1].id],s.curve=this.isCurve?[[this.curve[0].pos[0],this.curve[0].pos[1]],[this.curve[1].pos[0],this.curve[1].pos[1]]]:null),s}get cpV(){return this.curve[0]}get cpW(){return this.curve[1]}get isStraight(){return Math.abs(this.cpV.pos[0]-this.v.pos[0])<vn&&Math.abs(this.cpV.pos[1]-this.v.pos[1])<vn&&Math.abs(this.cpW.pos[0]-this.w.pos[0])<vn&&Math.abs(this.cpW.pos[1]-this.w.pos[1])<vn}get isCurve(){return!this.isStraight}*getContours(){for(const n of this.halves)for(const s of n.contours)yield s}disconnect(){this.v.disconnectEdge(this),this.w.disconnectEdge(this);const n=[];for(const s of this.halves){for(const i of s.contours)i.removeHalfEdge(s),n.push(i);s.contours=new Set}return n}getHalfIndex(n){return this.halves[0]===n?0:this.halves[1]===n?1:-1}getHalf(n,s){if(this.v===n&&this.w===s)return this.halves[0];if(this.w===n&&this.v===s)return this.halves[1]}getOtherEnd(n){if(this.v===n)return this.w;if(this.w===n)return this.v}hasPoint(n){return oa(this.v.pos,n)||oa(this.w.pos,n)?!0:Pf(this.v.pos,this.w.pos,n)}hasVirtualEdges(){return this.virtualEdges.size>0}hasIntersectionWith(n){if(!this.isCurve&&!n.isCurve){const r=n instanceof Li?n.v.pos:n[0],o=n instanceof Li?n.w.pos:n[1];return X_(this.v.pos,this.w.pos,r,o)[0].length>0}if(this.isCurve&&n.isCurve)return this._bezier.intersects(n._bezier).length>0;const s=this.isCurve?{p1:n instanceof Li?n.v.pos:n[0],p2:n instanceof Li?n.w.pos:n[1]}:{p1:this.v.pos,p2:this.w.pos};return(this.isCurve?this._bezier:n._bezier).intersects(s).length>0}intersect(n){if(!n&&this.isCurve)return this._bezier.intersects().slice(0,1).map(a=>a.split("/").map(c=>parseFloat(c)));if(!this.isCurve&&!n.isCurve)return X_(this.v.pos,this.w.pos,n.v.pos,n.w.pos);if(this.isCurve&&n.isCurve)return this._bezier.intersects(n._bezier).map(a=>a.split("/").map(c=>parseFloat(c))).reduce((a,c,l)=>((l===0||Math.abs(a[0][a[0].length-1]-c[0])>.05&&Math.abs(a[1][a[1].length-1]-c[1])>.05)&&(a[0].push(c[0]),a[1].push(c[1])),a),[[],[]]);const s=this.isCurve?{p1:n.v.pos,p2:n.w.pos}:{p1:this.v.pos,p2:this.w.pos},i=n.isCurve?n._bezier:this._bezier,r=i.intersects(s).sort(),o=r.map(a=>Ox(n.v.pos,n.w.pos,new ne(i.get(a))));return this.isCurve?[r,o]:[o,r]}split(n){let s,i;if(!n||n.length===0)return{atPositions:[],newCurves:[]};if(this.isCurve){const r=this._bezier;i=n.map(o=>new ne(r.get(o))),s=Kx(r,n)}else i=n.map(r=>Ex(new ne,this.v.pos,this.w.pos,r)),s=[];return{atPositions:i,newCurves:s}}addVirtualEdges(n){for(const s of n)s.isVirtual&&this.virtualEdges.add(s)}removeVirtualEdges(n){if(!n){this.virtualEdges.clear();return}for(const s of n)this.virtualEdges.delete(s)}updateBounds(){if(this.bounds.reset(),this.isCurve){this._updateBezier();const n=this._bezier.bbox();this.bounds.minMax({min:new ne(n.x.min,n.y.min),max:new ne(n.x.max,n.y.max)})}else this.bounds.minMax(this.v.pos),this.bounds.minMax(this.w.pos)}_createHalves(n,s){const i=[new Y_(this,n),new Y_(this,s)];i[0].twin=i[1],i[1].twin=i[0],this.halves=i,n.connectEdge(this),s.connectEdge(this)}_updateBezier(){this._bezier?(this._bezier.points[0].x=this.v.pos[0],this._bezier.points[0].y=this.v.pos[1],this._bezier.points[1].x=this.cpV.pos[0],this._bezier.points[1].y=this.cpV.pos[1],this._bezier.points[2].x=this.cpW.pos[0],this._bezier.points[2].y=this.cpW.pos[1],this._bezier.points[3].x=this.w.pos[0],this._bezier.points[3].y=this.w.pos[1],this._bezier.update()):this._bezier=new Bt(...this.v.pos,...this.cpV.pos,...this.cpW.pos,...this.w.pos)}}function Kx(e,n){const s=[];e.split(0,n[0]),s.push(Df(e.split(0,n[0])));for(let i=0;i<n.length-1;i++)s.push(Df(e.split(n[i],n[i+1])));return s.push(Df(e.split(n[n.length-1],1))),s}function Df(e){return[new ne(e.points[1]),new ne(e.points[2])]}const Qx=1e-6;function X_(e,n,s,i){const r=[[],[]],o=n[0]-e[0],a=n[1]-e[1],c=i[0]-s[0],l=i[1]-s[1],h=o*l-c*a;if(Math.abs(h)<Qx)return r;const d=e[0]-s[0],p=e[1]-s[1],E=o*p-a*d;if(E<0==h>0)return r;const g=c*p-l*d;return g<0==h>0||E>h==h>0||g>h==h>0||(r[0].push(g/h),r[1].push(E/h)),r}const Zx=10;class ua extends wf{constructor(n=!1){super(),this.isClosed=!1,this.isFilled=!1,this.isHole=!1,this.isSimple=!0,this.halves=new Set,this.isVirtual=n,this.bounds=new Gn,this._vertices=null,this.type="Contour"}static fromData({id:n,isClosed:s=!1,isFilled:i=!1,isHole:r=!1}){super.fromData({id:n});const o=new ua;return o.id=n,o.isClosed=s,o.isFilled=i,o.isHole=r,o.type="Contour",o}set({isClosed:n,isFilled:s,isHole:i,halves:r}){ee(n)&&(this.isClosed=n),ee(s)&&(this.isFilled=s),ee(i)&&(this.isHole=i),ee(r)&&(r instanceof Set?(this.halves=r,this.halves.forEach(o=>{o.v.upperTierIDs.size>2&&(this.isSimple=!1),o.addContour(this)}),this.updateBounds()):Gh(r)&&(this.halves.clear(),this.bounds.reset(),this.addHalfEdgeList(r)))}copy(){const n=new ua;return n.isFilled=this.isFilled,n.isClosed=this.isClosed,n}eq(n){return n&&this.isClosed===n.isClosed&&this.isFilled===n.isFilled&&this.isHole===n.isHole}save(){const n={};n.id=this.id,n.isClosed=this.isClosed,n.isFilled=this.isFilled,n.isHole=this.isHole;const s=[...this.halves];return n.halves=[s.map(i=>i.edge.id),s.map(i=>i.index)],n}disconnect(){for(const n of this.halves)n.removeContour(this),this.halves.delete(n)}addHalfEdge(n){n.v.upperTierIDs.size>2&&(this.isSimple=!1),this.halves.add(n),n.contours.add(this),this.bounds.minMax(n.bounds)}addHalfEdgeList(n){for(const s of n)this.addHalfEdge(s)}removeHalfEdge(n){const s=this.halves.delete(n);return s&&this.isClosed&&(this.isClosed=!1),s&&this.updateBounds(),s}get numEdges(){return this.halves.size}get numPoints(){return this.isClosed?this.halves.size:this.halves.size+1}get vertices(){if(!this._vertices){this._vertices=new Set;for(const n of this.halves)this._vertices.add(n.v)}return this._vertices}getVertexList(){const n=new Map;for(const s of this.halves){const i=n.get(s.v),r=n.get(s.w);if(i&&r)i!==r&&(i.push(...r),n.set(s.w,i),n.set(i[i.length-1],i));else if(i)i.push(s.w),n.set(s.w,i);else if(r)r.unshift(s.v),n.set(s.v,r);else{const o=[s.v,s.w];n.set(s.v,o),n.set(s.w,o)}}return n.values().next().value}getEdgeList(){const n=new Map;for(const s of this.halves){const i=n.get(s.v),r=n.get(s.w);if(i&&r)i.push(s),i!==r&&(i.push(...r),n.set(s.w,i),n.set(i[i.length-1].w,i));else if(i)i.push(s),n.set(s.w,i);else if(r)r.unshift(s),n.set(s.v,r);else{const o=[s];n.set(s.v,o),n.set(s.w,o)}}return n.values().next().value}getPointList(){return this.getVertexList().map(n=>n.pos)}hasVertex(n){for(const s of this.halves)if(s.v===n)return!0;return!1}hasPoint(n,s=!1){if(!qa(n)||!this.bounds.containsPoint(n))return!1;const i=[n,new ne(this.bounds.max[0]+Zx,n[1])];let r=0;for(const o of this.halves){if(s&&o.edge.hasPoint(n))return!0;r+=Number(o.edge.hasIntersectionWith(i))}return r%2===1}updateBounds(){this.bounds.reset();for(const n of this.halves)this.bounds.minMax(n.bounds)}}class qx{constructor(n){this.mesh=n}findContours(n=!1){return new jx(this.mesh).find(n)}selfIntersect(){const n=this._findIntersections();this._createVirtualStructures(n)}_findIntersections(){const n=this.mesh,s=new Set,i=new Map,r=(a,c,l)=>{let h=i.get(a);h||(h=[],i.set(a,h)),h.push(...c[l])};let o;for(const a of n.getEdges()){o=a.intersect(),r(a,o,0);for(const c of n.getEdges())a!==c&&(s.has(`${a.id},${c.id}`)||(s.add(`${c.id},${a.id}`),o=a.intersect(c),o[0].length!==0&&[a,c].forEach((l,h)=>{r(l,o,h)})))}return i}_createVirtualStructures(n){const s={virtual:!0};for(const[i,r]of n)this.mesh.splitEdge(i,r,s);for(const i of this.findContours(!0))this.mesh.addContour(i,s)}}class jx{constructor(n){this.mesh=n,this.vertices=[],this.adjMap=new Map,this.realEdgesMap=new Map,this.loopHalfEdgeSets=[]}makeAdjacencyMap(n,s=!1){for(const i of n.getVertices({virtual:s})){this.vertices.push(i);const r=[];for(const o of i.getOutHalves({all:s}))o.w===i||o.hasVirtualEdges()||r.push(o.w);this.adjMap.set(i,r)}for(const i of n.getEdges()){if(i.hasVirtualEdges())continue;if(i.v===i.w){this.dealWithLoops(i);continue}if(!i.isCurve)continue;const r=this.makeVirtualCurveSplit(i);this.vertices.push(r),this.adjMap.set(r,[i.v,i.w]);let o=this.adjMap.get(i.v);o.splice(o.indexOf(i.w),1,r),o=this.adjMap.get(i.w),o=o.splice(o.indexOf(i.v),1,r)}}dealWithLoops(n){this.loopHalfEdgeSets.push(new Set([n.halves[0]]))}makeVirtualCurveSplit(n){const s=this.mesh,i=n.split([.5]),r={virtual:!0},o=s.addVertex(i.atPositions[0],r);return this.realEdgesMap.set(o,n),o}convertToHalfEdgeSets(n){const s=[];for(const i of n){const r=new Set;let o=this.realEdgesMap.get(i[0]);o&&i.unshift(i.pop());for(let a=0;a<i.length;a++){const c=i[a],l=i[J0(a+1,0,i.length)];let h;if(o=this.realEdgesMap.get(l),o?(h=o.getHalf(c,i[J0(a+2,0,i.length)]),a++):h=mx(c.getOutHalves(),d=>!d.edge.isCurve&&d.w===l),!h)throw new Error("Failed to find matching HalfEdge. This should not happen.");r.add(h)}s.push(r)}for(const[i]of this.realEdgesMap)this.mesh.deleteVertex(i);for(const i of this.loopHalfEdgeSets)s.push(i);return s}find(n=!1){this.makeAdjacencyMap(this.mesh,n);const s=[];let i=this.vertices;for(;i.length>0;){const r=this.leftBottomVertex(i),o=this.reduceWalk(this.closedWalkFrom(r));o.length>2&&s.push(o),this.removeEdge(o[0],o[1]),i=this.removeFilamentAt(o[0],i),i=this.removeFilamentAt(o[1],i)}return this.convertToHalfEdgeSets(s)}leftBottomVertex(n){return n.reduce((s,i)=>{const r=s.pos,o=i.pos,a=o[0]-r[0];return a<0?i:a>0||o[1]-r[1]<0?s:i})}closedWalkFrom(n){const s=[];let i=n,r;do s.push(i),[i,r]=this.getNext(i,r);while(i&&i!==n);return s}reduceWalk(n){for(let s=1;s<n.length;s++){const i=n.lastIndexOf(n[s]);i>s&&n.splice(s+1,i-s)}return n}removeEdge(n,s){this.adjMap.set(n,this.withoutVertex(s,this.adjMap.get(n))),this.adjMap.set(s,this.withoutVertex(n,this.adjMap.get(s)))}removeFilamentAt(n,s){let i=n,r=s,o;for(;i&&this.adjMap.get(i).length<2;)r=this.withoutVertex(i,r),o=this.adjMap.get(i)[0],o&&this.removeEdge(i,o),i=o;return r}withoutVertex(n,s){return!s||!s.length?[]:s.filter(i=>i!==n)}getNext(n,s){const i=this.adjMap.get(n);return!i||!i.length?[]:[i.length===1?i[0]:this.bestByKind(s,n,s?"ccw":"cw"),n]}bestByKind(n,s,i){let r,o=this.adjMap.get(s);return n?(r=this.vsub(s,n),o=this.withoutVertex(n,o)):r=new ne(0,-1),o.reduce((a,c)=>this.betterByKind(c,a,s,r,i),null)}betterByKind(n,s,i,r,o){if(!s)return n;const a=this.vsub(n,i),c=this.vsub(s,i),l=this.dotPerp(c,r)>0,h=this.dotPerp(r,a),d=this.dotPerp(c,a);let p;return o==="cw"?p=l&&(h>=0||d>=0)||!l&&h>=0&&d>=0:p=!l&&(h<0||d<0)||l&&h<0&&d<0,p?n:s}vsub(n,s){return ra(new ne,n.pos,s.pos)}dotPerp(n,s){return n.x*s.y-s.x*n.y}}const fs=1e-5,Xn=1e-12,Lf=112e-18,Fs=1e-8,tr=1e-7,Jx=1e-5,$x=180/Math.PI,ev=Math.PI/180,tv=Math.PI/2,z_=Math.PI*2,ns={0:0,15:Math.PI/12,45:Math.PI/4,90:Math.PI/2,180:Math.PI};class nc{static processVertices(n,s,i=!1){const r=new Set;i&&n.vertices.forEach(a=>r.add(a.id));const o={};for(const a of s){const c=mo.fromData(a);if(i&&r.has(a.id)){const l=n.cellTable.get(a.id);n.vertices.delete(l)}n.vertices.add(c),n.cellTable.set(c.id,c),o[c.id]=c}for(let a=0;a<s.length;a++){const c=s[a];if(!c.adjMainId)continue;const l=o[c.id];l.adjacentMainVertex=o[c.adjMainId],l.flag(Ge.CURVE_VERT)}return o}static processEdges(n,s,i,r=!1){const o=r?new Set([...n.edges.values()].map(l=>l.id)):null,a={},c=new Set(Object.keys(i));for(const l of s){let h,d;const p=i[l.v],E=i[l.w];if(l.curveIds&&(h=i[l.curveIds[0]],d=i[l.curveIds[1]]),h||(h=n._createAndRecordVertex()),d||(d=n._createAndRecordVertex()),r){if(o.has(l.id)){const A=n.cellTable.get(l.id);n.edges.delete(A)}}else l.curve&&(h.set({pos:new ne(l.curve[0])}),d.set({pos:new ne(l.curve[1])}));const g=l.curve!=null,T=Li.fromData({...l,v:p,cpV:h,cpW:d,w:E},g);n.edges.add(T),a[T.id]=T,n.cellTable.set(T.id,T),c.delete(p.id),c.delete(h.id),c.delete(d.id),c.delete(E.id)}for(const l of c){const h=n.cellTable.get(l);h.isFlagged(Ge.CURVE_VERT)&&(h.adjacentMainVertex.unlinkedCurveControl=h.id)}return a}static processContours(n,s,i){for(const r of s){const o=ua.fromData(r);for(let a=0;a<r.halves[0].length;a++){const c=i[r.halves[0][a]];if(!c){console.warn(`Edge ${r.halves[0][a]} not found`);continue}const l=c.halves[r.halves[1][a]];l.edge.upperTierIDs.add(o.id),o.addHalfEdge(l)}n.contours.add(o),n.cellTable.set(o.id,o)}}}function nv(e,n){let s=e.pos[0];e.pos[0]=n.pos[0],n.pos[0]=s,s=e.pos[1],e.pos[1]=n.pos[1],n.pos[1]=s}function K_(e,n){for(const[s,i]of n)if(e.has(s)){const r=e.get(s);nv(r,i)}}class Wh extends B_{constructor({autoIncrementIds:n=!1}={}){super(void 0,gr.ENTITY,me.MESH_CHANGES),this.cellTable=new Map,this.vertices=new sc,this.edges=new sc,this.contours=new sc,this.bounds=new Gn,this.virtualVertices=new sc,this.virtualEdges=new sc,this.virtualContours=new sc,n&&(this._ids={vertices:0,edges:0,contours:0}),this._meshHelper=new qx(this),this._isCollinear=!1,this.id=Gr(ci.MESH)}get isEmpty(){return this.bounds.isInfinite}get isCollinear(){return this._isCollinear}static addFromData(n,{vertices:s,edges:i,contours:r}){const o=nc.processVertices(n,s,!0),a=nc.processEdges(n,i,o,!0);nc.processContours(n,r,a),n.recalculateBounds()}static fromData({vertices:n,edges:s,contours:i}){const r=new Wh,o=nc.processVertices(r,n),a=nc.processEdges(r,s,o);return nc.processContours(r,i,a),r.recalculateBounds(),r}copy(n=!1,s){const i=new Wh,r=new Map,o=new Map;for(const a of this.vertices){const c=a.copy();if(n&&(c.id=a.id),s&&s.has(a.id)){const l=s.get(a.id);c.pos.x=l.pos[0],c.pos.y=l.pos[1],c.mirror=l.mirror}r.set(a,c),i.vertices.add(c),i.cellTable.set(c.id,c)}for(const a of i.vertices)a.unlinkedCurveControl!=null&&(a.unlinkedCurveControl=r.get(a.unlinkedCurveControl)),a.adjacentMainVertex!=null&&(a.adjacentMainVertex=r.get(a.adjacentMainVertex));for(const a of this.edges){const c=r.get(a.v),l=r.get(a.cpV),h=r.get(a.cpW),d=r.get(a.w);if(!c||!l||!h||!d){console.warn("The edge can not get its own vertex in the mesh, please check your duplicate function or mesh id in case the instance of mesh is replaced incorrectly");continue}const p=a.copy(r.get(a.v),r.get(a.cpV),r.get(a.cpW),r.get(a.w));n&&(p.id=a.id),o.set(a.halves[0],p.halves[0]),o.set(a.halves[1],p.halves[1]),i.edges.add(p),i.cellTable.set(p.id,p)}for(const a of this.contours){const c=a.copy();if(n&&(c.id=a.id),[...a.halves].some(l=>!o.get(l)||!o.get(l).edge)){console.warn("The contour can not get its own edge in the mesh, please check your duplicate function or mesh id in case the instance of mesh is replaced incorrectly");continue}c.halves=new Set([...a.halves].map(l=>o.get(l))),i.contours.add(c),i.cellTable.set(c.id,c)}return i.bounds.copy(this.bounds),i}saveFigmaData(){return{vertices:[...this.vertices].filter(n=>!n.isFlagged(Ge.CURVE_VERT)).map(n=>{const s=n.save(!0);if(n.upperTierIDs.size===1){const i=this.cellTable.get(n.upperTierIDs.values().next().value);s.mirror=i&&i.id&&i.isCurve?pe.INDEPENDENT:pe.NONE}return s}),edges:[...this.edges].map(n=>n.save(!0)),contours:[...this.contours].map(n=>n.save())}}save(n){const s=new Array,i=new Array,r=new Array;n&&K_(this.cellTable,n);for(const o of this.vertices)s.push(o.save());for(const o of this.edges)i.push(o.save());for(const o of this.contours)r.push(o.save());return n&&K_(this.cellTable,n),{vertices:s,edges:i,contours:r}}*getVertices({virtual:n=!1,all:s=!1}={}){if(s||!n)for(const i of this.vertices)i.isFlagged(Ge.CURVE_VERT)||(yield i);if(s||n)for(const i of this.virtualVertices)yield i}*getEdges({virtual:n=!1,all:s=!1}={}){if(s||!n)for(const i of this.edges)yield i;if(s||n)for(const i of this.virtualEdges)yield i}*getContours({virtual:n=!1,all:s=!1}={}){if(s||!n)for(const i of this.contours)yield i;if(s||n)for(const i of this.virtualContours)yield i}getNumVertices({virtual:n=!1,all:s=!1}={}){let i=0;return(s||!n)&&(i+=this.vertices.size),(s||n)&&(i+=this.virtualVertices.size),i}getNumEdges({virtual:n=!1,all:s=!1}={}){let i=0;return(s||!n)&&(i+=this.edges.size),(s||n)&&(i+=this.virtualEdges.size),i}getNumContours({virtual:n=!1,all:s=!1}={}){let i=0;return(s||!n)&&(i+=this.contours.size),(s||n)&&(i+=this.virtualContours.size),i}findVertex(n,s={epsilon:vn}){return this.findVertices(n,s).next().value}*findVertices(n,{epsilon:s=vn,virtual:i=!1,all:r=!1}={epsilon:vn}){if(r||!i)for(const o of this.vertices.values())oa(o.pos,n,s)&&(yield o);if(r||i)for(const o of this.virtualVertices.values())oa(o.pos,n,s)&&(yield o)}detectContours(){for(const n of this.contours)n.disconnect(),this._deleteContour(n);for(const n of this._meshHelper.findContours())this.addContour(n)}selfIntersect(){this.deleteVirtualStructures(),this._meshHelper.selfIntersect()}recalculateBounds(){this.bounds.reset();for(const n of this.getVertices())n.isFlagged(Ge.CURVE_VERT)||this.bounds.minMax(n.pos);this._isCollinear=!0;for(const n of this.edges)lv(this,n)||(this._isCollinear=!1,n.updateBounds(),this._updateBounds(n.bounds));return this._isCollinear&&this._validateCollinear(),this.bounds}_validateCollinear(){const n=Array.from(this.edges.values());if(n.length<2)return;const s=n[0].v.pos,i=n[0].w.pos,r=[i.x-s.x,i.y-s.y];for(let o=1;o<n.length;o++){const a=n[o].v.pos,c=n[o].w.pos,l=[c.x-a.x,c.y-a.y];if(!Yh(r[0],r[1],l[0],l[1])){this._isCollinear=!1;return}}}hasVertex(n){return this.vertices.has(n)||this.virtualVertices.has(n)}hasEdge(n){return this.edges.has(n)||this.virtualEdges.has(n)}hasContour(n){return this.contours.has(n)||this.virtualContours.has(n)}addVertex(n,{data:s=void 0,virtual:i=!1,findExisting:r=!1,epsilon:o=vn}={epsilon:vn}){let a;return r?a=this.findVertices(n,{epsilon:o,virtual:i}):(a=new mo(i),this._ids&&(a.id=Gr(ci.MESH)),a.set({...s,pos:n}),this._addVertex(a),this.cellTable.set(a.id,a)),a}addEdge(n,s,{curve:i=null,virtual:r=!1}={curve:null}){if(!n||!s||!this.hasVertex(n))return;if(!r&&(n.isVirtual||s.isVirtual))throw new Error("Not allowed to add a real edge to virtual vertices");const o=this.hasVertex(s)?s:this.addVertex(s,r),a=new Li(r);this._ids&&(a.id=Gr(ci.MESH));const c=this.addVertex(i?i[0]:n.pos,r);this.cellTable.set(c.id,c);const l=this.addVertex(i?i[1]:s.pos,r);return this.cellTable.set(l.id,l),a.set({v:n,cpV:c,cpW:l,w:o},i!==null),this._addEdge(a),this._updateBounds(a.bounds),this.cellTable.set(a.id,a),a}addContour(n,{virtual:s=!1}={}){const i=new ua(s);return this._ids&&(i.id=Gr(ci.MESH)),i.set({isClosed:!0,halves:n}),this._addContour(i),i}splitEdge(n,s,{virtual:i=!1,findExisting:r=!1}={virtual:!1,findExisting:!1}){if(!n||!s||s.length===0)return;const{atPositions:o,newCurves:a}=n.split(s),c=[];for(const h of o)c.push(this.addVertex(h,{virtual:i,findExisting:r}));const l=[];l.push(this.addEdge(n.v,c[0],{curve:a[0],virtual:i}));for(let h=0;h<c.length-1;h++)l.push(this.addEdge(c[h],c[h+1],{curve:a[h],virtual:i}));return l.push(this.addEdge(c[c.length-1],n.w,{curve:a[a.length-1],virtual:i})),i?n.addVirtualEdges(l):(n.disconnect(),this._deleteEdge(n)),l}deleteVertex(n){let s;if(n.isVirtual?s=this.virtualVertices.delete(n):s=this.vertices.delete(n),s)for(const i of n.getEdges())i.disconnect(),i.isVirtual?this.virtualEdges.delete(i):this.edges.delete(i)}deleteCellsByVertex(n,s=!0){const i=new Set,r=[],o=new Set;for(const h of n)if(h.isFlagged(Ge.CURVE_VERT))o.add(h);else{for(const d of h.upperTierIDs)i.add(d),r.push(this.cellTable.get(d));h.unlinkedCurveControl&&i.add(h.unlinkedCurveControl),this.cellTable.has(Ao.CURVE_CONTROL)&&i.add(this.cellTable.get(Ao.CURVE_CONTROL).id),i.add(h.id)}const a=new Map;for(const h of r){i.add(h.cpV.id),i.add(h.cpW.id);const d=i.has(h.v.id)?h.w:h.v;let p=0;a.has(d.id)&&(p=a.get(d.id)),p++,p===d.upperTierIDs.size?(i.add(d.id),d.unlinkedCurveControl&&i.add(d.unlinkedCurveControl)):a.set(d.id,p);for(const E of h.upperTierIDs)i.add(E)}const c=this.changes,l=[];for(const h of o){const d=h.adjacentMainVertex;l.push(d);const p=new tn({before:new ne(h.pos),after:new ne(d.pos)});c.update(h.id,"pos",p)}for(const h of l){let d=!0;for(const g of h.upperTierIDs)if(this.cellTable.get(g).isCurve){d=!1;break}let p=null;h.unlinkedCurveControl&&this.cellTable.has(h.unlinkedCurveControl)&&(p=this.cellTable.get(h.unlinkedCurveControl)),p&&this.vertices.has(p)&&!i.has(h.unlinkedCurveControl)&&p.pos.eq(h.pos)&&(d=!1);const E=new tn({before:h.mirror,after:d?pe.NONE:pe.INDEPENDENT});c.update(h.id,"mirror",E)}c.delete(i),this.applyChanges(this.changes),this.fire(s)}deleteEdge(){}deleteContour(){}deleteVirtualStructures(){const n={virtual:!0};for(const s of this.getContours(n))s.disconnect(),this._deleteContour(s);for(const s of this.getEdges(n))s.disconnect(),this._deleteEdge(s);for(const s of this.getVertices(n))this._deleteVertex(s)}trim(){const n=new ne(this.bounds.min);if(!gx(n,ne.ZERO))for(const s of this.vertices){const i=ra(s.pos,s.pos,n);s.set({pos:i})}this.recalculateBounds()}_updateBounds(n){this.bounds.minMax(n)}_addVertex(n){n.isVirtual?this.virtualVertices.add(n):this.vertices.add(n)}_addEdge(n){n.isVirtual?this.virtualEdges.add(n):this.edges.add(n)}_addContour(n){n.isVirtual?this.virtualContours.add(n):this.contours.add(n)}_deleteVertex(n){n.isVirtual?this.virtualVertices.delete(n):this.vertices.delete(n)}_deleteEdge(n){n.isVirtual?this.virtualEdges.delete(n):this.edges.delete(n)}_deleteContour(n){n.isVirtual?this.virtualContours.delete(n):this.contours.delete(n)}moveVertex(n,s,i,r=!0,o=!0){if(!n||!(n.length>0)){console.warn("Empty parameter of moveVertex");return}const a=new ne(s,i);Math.abs(s)<To&&Math.abs(this.bounds.width)<To&&(a.x=0),Math.abs(i)<To&&Math.abs(this.bounds.height)<To&&(a.y=0),this._changePointShapesWhenMoving(n);for(const c of n)this._preparePositionUpdate(c.id,a),c.isFlagged(Ge.CURVE_VERT)?this._prepareMirrorCurveUpdates(c,a):this._prepareConnectedCurveUpdates(c,a);this.applyChanges(this.changes),o&&this.fire(r)}situateVertexToPos(n,s,i){const r=new ne(s,i),o=new tn({before:new ne(n.pos),after:r});this.changes.update(n.id,"pos",o);const c=new ne(r.x-n.pos.x,r.y-n.pos.y);n.isFlagged(Ge.CURVE_VERT)?this._prepareMirrorCurveUpdates(n,c):this._prepareConnectedCurveUpdates(n,c)}_changePointShapesWhenMoving(n){Mf.clear();for(const s of n){if(!s.isFlagged(Ge.CURVE_VERT))continue;const i=s.adjacentMainVertex;if(n.indexOf(i)===-1)if(Mf.has(i.id)&&i.mirror!==pe.INDEPENDENT||i.upperTierIDs.size>2){const r=new tn({before:i.mirror,after:pe.INDEPENDENT});this.changes.update(i.id,"mirror",r)}else Mf.add(i.id)}}_prepareMirrorCurveUpdates(n,s){const i=n.adjacentMainVertex,r=i.mirror!==pe.ANGLE_AND_LENGTH&&i.mirror!==pe.ANGLE,o=i.upperTierIDs.size>2;if(r||o)return;let a=null;switch(i.upperTierIDs.size){case 1:if(!i.unlinkedCurveControl||i.unlinkedCurveControl===n.id)a=i.upperTierIDs.values().next().value;else{this._moveMirrorCurveControl(this.cellTable.get(i.unlinkedCurveControl),s,n,i);return}break;case 2:i.unlinkedCurveControl&&console.warn("Unexpected unlinkedCurveControl detected; check the loading process."),a=Array.from(i.upperTierIDs).find(l=>l!==n.controllingEdge.id);break}if(a){const c=this.cellTable.get(a),l=c.v===i,h=c.curve[l?0:1];this._moveMirrorCurveControl(h,s,n,i)}}_moveMirrorCurveControl(n,s,i,r){const o=new ne;if(vi(o,i.pos,s),ra(o,o,r.pos),o.x*=-1,o.y*=-1,r.mirror===pe.ANGLE){ra(Q_,n.pos,r.pos);const l=mf(Q_);Jc(o,o),o.x*=l,o.y*=l}const a=new ne;vi(a,r.pos,o);const c=new tn({before:new ne(n.pos),after:a});this.changes.update(n.id,"pos",c)}_prepareConnectedCurveUpdates(n,s){n.unlinkedCurveControl&&this._preparePositionUpdate(n.unlinkedCurveControl,s);for(const i of n.upperTierIDs){const r=this.cellTable.get(i),o=r.v.id===n.id?0:1;this._preparePositionUpdate(r.curve[o].id,s)}}applyCreateChanges(n){const s=new Map;s.set("Vertex",new Set),s.set("Edge",new Set),s.set("Contour",new Set);for(const i of n.CREATE){const r=this.cellTable.get(i);s.get(r.type).add(r)}for(const i of s.get("Vertex"))this.vertices.add(i);for(const i of s.get("Edge")){this.edges.add(i);const r=i;r.v.connectEdge(r),r.w.connectEdge(r)}for(const i of s.get("Contour")){this.contours.add(i);const r=i;for(const o of r.halves)o.edge.upperTierIDs.add(r.id)}}applyDeleteChanges(n){const s=new Map;s.set("Vertex",new Set),s.set("Edge",new Set),s.set("Contour",new Set);for(const i of n.DELETE){const r=this.cellTable.get(i);s.get(r.type).add(r)}for(const i of s.get("Contour")){this.contours.delete(i);const r=i;for(const o of r.halves)o.edge.upperTierIDs.delete(r.id)}for(const i of s.get("Edge")){this.edges.delete(i);const r=i;r.v.disconnectEdge(r),r.w.disconnectEdge(r)}for(const i of s.get("Vertex"))this.vertices.delete(i)}applyUpdateChanges(n){const s=new Set,i=new Set;for(const[r,o]of n.UPDATE){const a=this.cellTable.get(r);for(const[c,l]of o)c==="pos"?(a[c].copy(l.after),i.add(a)):a[c]=l.after}for(const r of i)if(r.isFlagged(Ge.CURVE_VERT))r.controllingEdge&&s.add(r.controllingEdge.id);else for(const o of r.upperTierIDs)s.add(o);for(const r of s)this.cellTable.get(r).updateBounds()}applyChanges(n){n.CREATE.size!==0&&this.applyCreateChanges(n),n.DELETE.size!==0&&this.applyDeleteChanges(n),n.UPDATE.size!==0&&this.applyUpdateChanges(n),this.recalculateBounds()}applyVerticesPosition(n){const s=new cl;for(const i of n){const r=this.cellTable.get(i.id);if(!r){console.warn(`Vertex ${i.id} not found when applying position change`);continue}i.mirror!==void 0&&i.mirror!==null&&s.update(i.id,"mirror",new tn({before:r.mirror,after:i.mirror})),i.x!==void 0&&i.y!==void 0&&s.update(i.id,"pos",new tn({before:new ne(r.pos),after:new ne(i.x,i.y)}))}this.applyChanges(s)}undo(n){const s=F_(n);this.applyChanges(s),this.changes=s,this.fire(!1,{undoable:!1,interaction:!1})}redo(n){this.applyChanges(n),this.changes=n,this.fire(!1)}getVertPos(n,s=null){const i=this.cellTable.get(n),r=s||new ne;if(!i)return console.trace(),console.warn("invalid vertex id ocurred when get vertex position"),r;const o=i.pos;return r[0]=o.x-this.bounds.min.x,r[1]=o.y-this.bounds.min.y,r}getEdgeCurve(n,s=null){const i=this.cellTable.get(n),r=s||[new ne,new ne],[o,a]=i.curve;return this.getVertPos(o.id,r[0]),this.getVertPos(a.id,r[1]),r}closure(n,s=new Set,i=new Map){const r=[n];for(;r.length>0;){const o=r.pop();if(s.add(o),o.type==="Edge"){const a=o;s.add(a.v),s.add(a.w)}for(const a of o.upperTierIDs){const c=this.cellTable.get(a);s.has(c)||(o.type==="Edge"?(i.set(c,i.get(c)?i.get(c)+1:1),c.numEdges-i.get(c)===0&&r.push(c)):r.push(c))}}return s}closureOfCells(n){const s=new Set,i=new Map;for(const r of n)this.closure(r,s,i);return s}duplicateCells(n,s={},i=!0){const r=new Map;r.set("Contour",[]),r.set("Edge",[]),r.set("Vertex",[]);for(let g=0;g<n.length;g++){const T=n[g].type;r.get(T).push(n[g])}const o={},a={},c=[],l=[],h=r.get("Vertex");for(const g of h){const T=mo.fromData(g);this.cellTable.has(T.id)&&(T.id=Gr(ci.MESH)),s[g.id]&&T.pos.copy(s[g.id]),c.push(T.id),this.cellTable.set(T.id,T),l.push(T),o[g.id]=T}const d=r.get("Edge");for(const g of d){const T=Li.fromData({id:Gr(ci.MESH),v:o[g.v],cpV:this._createAndRecordVertex(c),cpW:this._createAndRecordVertex(c),w:o[g.w]},!1);if(s[g.id])for(let A=0;A<2;A++){const m=new tn({before:new ne(T.curve[A].pos),after:new ne(s[g.id][A][0],s[g.id][A][1])});this.changes.update(T.curve[A].id,"pos",m)}c.push(T.id),this.cellTable.set(T.id,T),a[g.id]=T}const p=r.get("Contour");for(const g of p){const T=ua.fromData({id:Gr(ci.MESH),isClosed:g.isClosed,isFilled:g.isFilled,isHole:g.isHole});for(let A=0;A<g.halves[0].length;A++){const m=a[g.halves[0][A]].halves[g.halves[1][A]];m.edge.upperTierIDs.add(T.id),T.addHalfEdge(m)}c.push(T.id),this.cellTable.set(T.id,T)}return this.changes.create(c),this.applyChanges(this.changes),this.fire(i),l}startNewPath(n,s,i=!0){const r=[],o=this._createAndRecordVertex(r),a=new ne;return this.isEmpty?(a.x=0,a.y=0,this.bounds.minMax(a)):(a.x=n,a.y=s),o.set({pos:a}),this.changes.create(r),this.applyChanges(this.changes),this.fire(i),o}appendLine(n,s,i,r,o=!0){const a=[],c=this.cellTable.get(n),l=this._createAndRecordVertex(a),h=new ne(s,i);l.set({pos:h});const[d,p]=this._setupEdgeCurves(c,l,r,a),E=new Li;E.set({v:c,cpV:d,cpW:p,w:l},!0),this.cellTable.set(E.id,E),a.push(E.id);const g=E.curve;if(c.upperTierIDs.size===1&&!g[0].pos.eq(c.pos)&&c.mirror===pe.ANGLE_AND_LENGTH){const A=this._createAndRecordVertex(a);A.set({pos:c.pos,cap:c.cap,end:c.end,join:c.join,mirror:pe.ANGLE_AND_LENGTH}),A.cornerRadius=c.cornerRadius,A.flag(Ge.CURVE_VERT),A.adjacentMainVertex=c;const m=new tn({before:c.unlinkedCurveControl,after:A.id});this.changes.update(c.id,"unlinkedCurveControl",m);const O=new ne;es(O,c.pos,g[0].pos);const S=new ne;vi(S,c.pos,O);const y=new tn({before:new ne(A.pos),after:S});this.changes.update(A.id,"pos",y)}return this.changes.create(a),this.applyChanges(this.changes),this.fire(o),{vertex:l,edge:E,curveCtrl:g[1]}}connectVertices(n,s,i,r=!0){if(n===s)return null;let o=[];const a=[],c=this.cellTable.get(n),l=this.cellTable.get(s);for(const g of c.upperTierIDs){const T=this.cellTable.get(g);if((T.w.id===l.id||T.v.id===l.id)&&T.isStraight&&!c.unlinkedCurveControl)return null}if(l.unlinkedCurveControl){const g=new tn({before:l.mirror,after:l.upperTierIDs.size===1&&i?pe.ANGLE_AND_LENGTH:pe.INDEPENDENT});this.changes.update(l.id,"mirror",g)}const[h,d]=this._setupEdgeCurves(c,l,i,o),p=new Li;p.set({v:c,cpV:h,cpW:d,w:l},!0),this.cellTable.set(p.id,p),o.push(p.id);const E=p.curve;this.changes.create(o),this.applyChanges(this.changes),this.fire(r),o=[];for(const g of this.contours)a.push(g.id);for(const g of this._meshHelper.findContours()){const T=new ua(!1);T.set({isClosed:!0,isFilled:!0,halves:g}),this.cellTable.set(T.id,T),o.push(T.id)}return this.changes.create(o),this.changes.delete(a),this.applyChanges(this.changes),this.fire(r),{vertex:null,edge:p,curveCtrl:E[1]}}_setupEdgeCurves(n,s,i,r){const o=[n,s],a=[];for(let c=0;c<2;c++){const l=o[c];if(l.unlinkedCurveControl){a.push(this.cellTable.get(l.unlinkedCurveControl));const h=new tn({before:l.unlinkedCurveControl,after:null});this.changes.update(l.id,"unlinkedCurveControl",h),i||this.changes.update(a[c].id,"pos",new tn({before:new ne(a[c].pos),after:new ne(l.pos)}))}else{const h=this._createAndRecordVertex(r);h.set({pos:l.pos}),a.push(h)}}return a}prepareVertexPropertyChanges(n,s,i){const r=this.cellTable.get(n);if(!r){console.error(`constructVertexPropertiesChanges: Unknown vertex id: ${n}`);return}if(!this.vertices.has(r)){console.warn(`constructVertexPropertiesChanges: Invisible vertex id: ${n}`);return}const o=new tn({before:r[s],after:i});switch(s){case"cornerRadius":this._spreadVertProp(r,s,o,n);break;case"mirror":{let a=r;r.isFlagged(Ge.CURVE_VERT)&&(a=r.adjacentMainVertex),this.changes.update(a.id,"mirror",o),this.processPointShape(a,i)}break;default:console.warn(`Unexpected key ${s} for constructVertexPropertiesChanges`)}}processPointShape(n,s){n.isFlagged(Ge.CURVE_VERT)||(n.upperTierIDs.size===1?this._processPointShapeEndpoint(n,s):n.upperTierIDs.size===2?this._processPointShapeRegular(n,s):this._processPointShapeVectorNetworks(n,s))}_processPointShapeVectorNetworks(n,s){if(n.mirror!==pe.NONE&&s===pe.NONE)for(const i of n.upperTierIDs){const r=this.cellTable.get(i);this._setCurveControlPos(r,n,r.v===n?r.v.pos:r.w.pos)}else if(n.mirror===pe.NONE&&s!==pe.NONE){let i=0;if(s===pe.ANGLE_AND_LENGTH)for(const a of n.upperTierIDs){const c=this.cellTable.get(a),l=new ne;es(l,(c.v===n?c.w:c.v).pos,n.pos),i=Math.max(i,br(l))}let r=0;const o=Math.PI*2/n.upperTierIDs.size;for(const a of n.upperTierIDs){const c=this.cellTable.get(a),l=new ne;let h;if(s===pe.ANGLE_AND_LENGTH)h=.2*i;else{const d=new ne;es(d,(c.v===n?c.w:c.v).pos,n.pos),h=.2*br(d)}l.x=Math.sin(r*o),l.y=Math.cos(r*o),Pr(l,l,h),es(l,n.pos,l),this._setCurveControlPos(c,n,l),r++}}else if(n.mirror!==pe.ANGLE_AND_LENGTH&&s===pe.ANGLE_AND_LENGTH){let i=0;for(const a of n.upperTierIDs){const c=this.cellTable.get(a),l=new ne;es(l,(c.v===n?c.w:c.v).pos,n.pos);const h=this.cellTable.get(c.curve[c.v===n?0:1]);es(l,h.pos,n.pos),i=Math.max(i,br(l))}let r=0;const o=Math.PI*2/n.upperTierIDs.size;for(const a of n.upperTierIDs){const c=this.cellTable.get(a),l=new ne;l.x=Math.sin(r*o),l.y=Math.cos(r*o),Pr(l,l,i),es(l,n.pos,l),this._setCurveControlPos(c,n,l),r++}}else if(n.mirror!==pe.ANGLE&&n.mirror!==pe.ANGLE_AND_LENGTH&&s===pe.ANGLE){let i=0;const r=Math.PI*2/n.upperTierIDs.size;for(const o of n.upperTierIDs){const a=this.cellTable.get(o),c=new ne;let l;const h=a.curve[a.v===n?0:1];if(h&&this.vertices.has(h)){const d=new ne;es(d,h.pos,n.pos),l=br(d)}else{const d=new ne;es(d,(a.v===n?a.w:a.v).pos,n.pos),l=.2*br(d)}c.x=Math.sin(i*r),c.y=Math.cos(i*r),Pr(c,c,l),es(c,n.pos,c),this._setCurveControlPos(a,n,c),i++}}}_processPointShapeEndpoint(n,s){const i=n.upperTierIDs.values(),r=this.cellTable.get(i.next().value);if(n.mirror!==pe.NONE&&s===pe.NONE){if(this._setCurveControlPos(r,n,r.v===n?r.v.pos:r.w.pos),n.unlinkedCurveControl){const o=this.cellTable.get(n.unlinkedCurveControl),a=new tn({before:new ne(o.pos),after:new ne(n.pos.x,n.pos.y)});this.changes.update(o.id,"pos",a)}}else if(n.mirror===pe.NONE&&s!==pe.NONE){const o=new ne;es(o,(r.v===n?r.w:r.v).pos,n.pos);const a=br(o);Jc(o,o),Pr(o,o,a*.2),vi(o,n.pos,o),this._setCurveControlPos(r,n,o),es(o,n.pos,(r.v===n?r.w:r.v).pos),Jc(o,o),Pr(o,o,a*(s===pe.ANGLE_AND_LENGTH?.2:.3));const c=new ne;vi(c,n.pos,o);const l=this._ensureIndCurveExist(n),h=new tn({before:new ne(l.pos),after:c});this.changes.update(l.id,"pos",h)}else if(n.mirror===pe.INDEPENDENT&&s!==pe.INDEPENDENT){const o=this._ensureIndCurveExist(n),a=r.curve[r.v===n?0:1];if(s===pe.ANGLE){const c=new ne;es(c,n.pos,(r.v===n?r.w:r.v).pos);const l=mf(c);this._alignExistingCurves(a,n,o,s,l*.2)}else this._alignExistingCurves(a,n,o,s)}}_processPointShapeRegular(n,s){const i=n.upperTierIDs.values(),r=this.cellTable.get(i.next().value),o=this.cellTable.get(i.next().value);if(n.mirror!==pe.NONE&&s===pe.NONE)this._setCurveControlPos(r,n,r.v===n?r.v.pos:r.w.pos),this._setCurveControlPos(o,n,o.v===n?o.v.pos:o.w.pos);else if(n.mirror===pe.NONE){if(s===pe.ANGLE||s===pe.INDEPENDENT||s===pe.ANGLE_AND_LENGTH){const a=r.v===n?r.w:r.v,c=o.v===n?o.w:o.v;let l,h;if(a.pos.eq(c.pos)){const d=new ne;es(d,n.pos,a.pos);const p=br(d);Pr(d,d,1/p);const E=d.x;d.x=d.y,d.y=-E,l=new ne,Pr(d,d,p*.2),vi(l,n.pos,d),h=new ne,Pr(d,d,-1),vi(h,n.pos,d),r.index>o.index&&([l,h]=[h,l])}else{const d=ic(a.pos,n.pos,c.pos);l=d.e1,h=d.e2,s===pe.ANGLE_AND_LENGTH&&sv(l,n.pos,h)}this._setCurveControlPos(r,n,l),this._setCurveControlPos(o,n,h)}}else if(n.mirror===pe.ANGLE&&s===pe.ANGLE_AND_LENGTH){const a=r.curve[r.v===n?0:1],c=o.curve[o.v===n?0:1];this._alignExistingCurves(a,n,c,s)}else if(n.mirror===pe.INDEPENDENT&&s===pe.ANGLE_AND_LENGTH){const a=r.curve[r.v===n?0:1],c=o.curve[o.v===n?0:1];this._alignExistingCurves(a,n,c,s)}else if(n.mirror===pe.INDEPENDENT&&s===pe.ANGLE){let a=0;if(r.curve[r.v===n?0:1].pos.eq(r.v===n?r.v:r.w)){const h=r.v===n?r.w:r.v,d=o.v===n?o.w:o.v,{e1:p}=ic(h.pos,n.pos,d.pos);a=Math.sqrt(Math.pow(p.x-n.pos.x,2)+Math.pow(p.y-n.pos.y,2)),this._setCurveControlPos(r,n,p)}else if(o.curve[o.v===n?0:1].pos.eq(o.v===n?o.v:o.w)){const h=r.v===n?r.w:r.v,d=o.v===n?o.w:o.v,{e2:p}=ic(h.pos,n.pos,d.pos);a=Math.sqrt(Math.pow(p.x-n.pos.x,2)+Math.pow(p.y-n.pos.y,2)),this._setCurveControlPos(o,n,p)}const c=r.curve[r.v===n?0:1],l=o.curve[o.v===n?0:1];this._alignExistingCurves(c,n,l,s,a)}}_alignExistingCurves(n,s,i,r,o=0){const a=new ne;es(a,s.pos,n.pos);const c=new ne;es(c,s.pos,i.pos);let l,h,d;const p=br(a),E=br(c);p<E?(l=i,h=n,d=r===pe.ANGLE_AND_LENGTH?E:p):(l=n,h=i,d=r===pe.ANGLE_AND_LENGTH?p:E),d<1e-5&&(d=o),es(a,l.pos,s.pos),a.x=-1*(l.pos.x-s.pos.x),a.y=-1*(l.pos.y-s.pos.y),Jc(a,a),Pr(a,a,d);const g=new ne;vi(g,s.pos,a);const T=new tn({before:new ne(h.pos),after:g});this.changes.update(h.id,"pos",T)}_spreadVertProp(n,s,i){const r=n.isFlagged(Ge.CURVE_VERT)?n.adjacentMainVertex:n;this.changes.update(r.id,s,i);for(const o of r.upperTierIDs){const a=this.cellTable.get(o),c=a.curve[a.v===r?0:1];this.changes.update(c.id,s,i)}}_setCurveControlPos(n,s,i){const r=n.curve[n.v===s?0:1],o=new tn({before:new ne(r.pos),after:new ne(i.x,i.y)});this.changes.update(r.id,"pos",o)}addIndpendentCurveCtrl(n,s,i=!0){const r=this._ensureIndCurveExist(n,s);return(this.changes.CREATE.size!==0||this.changes.UPDATE.size!==0)&&(this.applyChanges(this.changes),this.fire(i)),r}_ensureIndCurveExist(n,s){if(n.unlinkedCurveControl){const a=this.cellTable.get(n.unlinkedCurveControl);if(this.vertices.has(a)||this.changes.create([a.id]),s&&n.mirror!==s){const c=new tn({before:n.mirror,after:s});this.changes.update(n.id,"mirror",c)}return a}const i=[],r=this._createAndRecordVertex(i);r.set({pos:n.pos,cap:n.cap,end:n.end,join:n.join,mirror:pe.ANGLE_AND_LENGTH}),r.flag(Ge.CURVE_VERT),this.cellTable.set(r.id,r),r.adjacentMainVertex=n,r.cornerRadius=n.cornerRadius;const o=new tn({before:n.unlinkedCurveControl,after:r.id});if(this.changes.update(n.id,"unlinkedCurveControl",o),s&&n.mirror!==s){const a=new tn({before:n.mirror,after:s});this.changes.update(n.id,"mirror",a)}return this.changes.create(i),r}falsifyIndCurveCtrl(n){if(!this.cellTable.has(Ao.CURVE_CONTROL)){const i=new mo;i.id=Ao.CURVE_CONTROL,i.flag(Ge.CURVE_VERT),this.cellTable.set(Ao.CURVE_CONTROL,i)}const s=this.cellTable.get(Ao.CURVE_CONTROL);return s.adjacentMainVertex=n,s.set({pos:n.pos,cap:n.cap,join:n.join,mirror:n.mirror}),s.cornerRadius=n.cornerRadius,this.vertices.add(s),s}hideFakeIndCurveCtrl(){if(!this.cellTable.has(Ao.CURVE_CONTROL))return;const n=this.cellTable.get(Ao.CURVE_CONTROL);this.vertices.has(n)&&this.vertices.delete(n)}moveIndCurveControl(n,s,i,r,o,a=!0){if(!n.isFlagged(Ge.CURVE_VERT)){console.warn("The dragging object isn't a curve control");return}const c=new ne(r,o),l=new ne;l.copy(c);const h=new tn({before:new ne(n.pos),after:l});if(this.changes.update(n.id,"pos",h),i){const p=new ne;p.x=l.x-s.pos.x,p.y=l.y-s.pos.y,p.x=p.x*-1+s.pos.x,p.y=p.y*-1+s.pos.y;const E=new tn({before:new ne(i.pos),after:p});this.changes.update(i.id,"pos",E)}this.applyChanges(this.changes),this.fire(a)}_createAndRecordVertex(n){const s=new mo;return this.cellTable.set(s.id,s),n&&n.push(s.id),s}_preparePositionUpdate(n,s){const i=this.cellTable.get(n),r=new ne(i.pos),o=new ne;vi(o,i.pos,s);const a=new tn({before:r,after:o});this.changes.update(n,"pos",a)}}function sv(e,n,s){let i=e.x-n.x,r=e.y-n.y,o=s.x-n.x,a=s.y-n.y;const c=Math.sqrt(i*i+r*r),l=Math.sqrt(o*o+a*a);c<l?(i=i/c*l,r=r/c*l,e.x=n.x+i,e.y=n.y+r):(o=o/l*c,a=a/l*c,s.x=n.x+o,s.y=n.y+a)}class sc extends Set{constructor(){super(),this.currIndex=0}add(n){return n.index=this.currIndex++,super.add(n)}delete(n){return n.index=-1,super.delete(n)}}const Q_=new ne,Mf=new Set;class ks extends Float32Array{constructor(n,s,i,r,o,a){super(6),typeof n=="number"&&typeof s=="number"&&typeof i=="number"&&typeof r=="number"&&typeof o=="number"&&typeof a=="number"?(this[0]=n,this[1]=s,this[2]=i,this[3]=r,this[4]=o,this[5]=a):n?this.copy(n):(this[0]=1,this[3]=1)}fromArray(n){Ue(n)||Z0(this,...n)}clone(){return new ks(...this)}copy(n){if(Ue(n))return;const s=ee(n[0])?n[0]:n.a,i=ee(n[1])?n[1]:n.b,r=ee(n[2])?n[2]:n.c,o=ee(n[3])?n[3]:n.d,a=ee(n[4])?n[4]:n.tx,c=ee(n[5])?n[5]:n.ty;return be(s)&&be(i)&&be(r)&&be(o)&&be(a)&&be(c)&&Z0(this,s,i,r,o,a,c),this}eq(n,s=vn){if(Ue(n))return!1;const i=[ee(n[0])?n[0]:n.a,ee(n[1])?n[1]:n.b,ee(n[2])?n[2]:n.c,ee(n[3])?n[3]:n.d,ee(n[4])?n[4]:n.tx,ee(n[5])?n[5]:n.ty];return Sx(this,i,s)}basis(){return yx(new ks,this)}get a(){return this[0]}set a(n){this[0]=n}get b(){return this[1]}set b(n){this[1]=n}get c(){return this[2]}set c(n){this[2]=n}get d(){return this[3]}set d(n){this[3]=n}get tx(){return this[4]}set tx(n){this[4]=n}get ty(){return this[5]}set ty(n){this[5]=n}save(){return[this[0],this[1],this[2],this[3],this[4],this[5]]}}ks.IDENTITY=new ks,ks.ZERO=new ks(0,0,0,0,0,0);function iv(e,n){const s=ra(j0(),n,e);return rv(s,!0)}function rv(e,n=!1){const s=new ne(e[1],-e[0]);return n&&Jc(s,s),s}function Pf(e,n,s){return Yh(s[0]-e[0],s[1]-e[1],s[0]-n[0],s[1]-n[1])?s[0]>=Math.min(e[0],n[0])&&s[0]<=Math.max(e[0],n[0])&&s[1]>=Math.min(e[1],n[1])&&s[1]<=Math.max(e[1],n[1]):!1}new ne,new ne,new ne;const ll=Bt.getUtils();function ic(e,n,s){const i=ll.dist(e,n),r=ll.dist(s,n),o=i/(i+r),{A:a,C:c}=Bt.getABC(3,e,n,s,o);return ov(o,a,n,c,e,s)}function ov(e,n,s,i,r,o){const a=Math.atan2(o.y-r.y,o.x-r.x)-Math.atan2(s.y-r.y,s.x-r.x),c=(a<0||a>Math.PI?-1:1)*ll.dist(r,o)/3,l=e*c,h=(1-e)*c;if(Math.abs(a)<vn){const R={x:s.x+.5*(r.x-s.x),y:s.y+.5*(r.y-s.y)},M={x:s.x+.5*(o.x-s.x),y:s.y+.5*(o.y-s.y)};return{e1:R,e2:M}}const d=ll.getccenter(r,s,o),p=[{x:s.x-(s.y-d.y),y:s.y+(s.x-d.x)},{x:s.x+(s.y-d.y),y:s.y-(s.x-d.x)}],E=ll.dist(p[0],p[1]),g=(p[1].x-p[0].x)/E,T=(p[1].y-p[0].y)/E,A={x:s.x+l*g,y:s.y+l*T},m={x:s.x-h*g,y:s.y-h*T},O={x:n.x+(A.x-n.x)/(1-e),y:n.y+(A.y-n.y)/(1-e)},S={x:n.x+(m.x-n.x)/e,y:n.y+(m.y-n.y)/e},y={x:r.x+(O.x-r.x)/e,y:r.y+(O.y-r.y)/e},v={x:o.x+(S.x-o.x)/(1-e),y:o.y+(S.y-o.y)/(1-e)};return{e1:A,e2:m,C1:y,C2:v}}function av(e){const n=new Map,s=new Map,i=new Set,r=new Set,o=new Set,a=new Set,c=new Map,l=new Map;for(const[m,O]of e.UPDATE.entries()){if(!O.has("children"))continue;const{before:S,after:y}=O.get("children");if(c.set(m,S),l.set(m,y),!S||!y){console.warn(`Invalid Scene Tree Changes of ${m}`);continue}for(const v of S)n.has(v)?console.warn(`Child ${v} has multiple old parents: ${n.get(v)} and ${m}`):(n.set(v,m),i.add(v));for(const v of y)i.has(v)?(i.delete(v),n.get(v)!==m?(o.add(v),s.set(v,m)):(a.add(v),s.set(v,m))):(r.add(v),s.set(v,m))}const h=[];for(const m of r)i.has(m)&&(i.delete(m),h.push(m));for(const m of h)r.delete(m),o.add(m);const d=new Set,p=new Set;function E(m){return c.get(m)||[]}function g(m){return l.get(m)||[]}const T=new Set;for(const m of i)bf(m,E,T,d,i);const A=new Set;for(const m of a)bf(m,g,A,p,a);return{oldParents:n,newParents:s,removed:d,added:r,moved:o,reordered:p}}function bf(e,n,s,i,r){if(s.has(e))return;s.add(e);const o=n(e);for(const a of o)bf(a,n,s,i,r);r.has(e)&&i.add(e)}const cv=(e,n,s)=>{let i=-1,r=-1;for(let a=0;a<e.length;a++){const c=e[a];c.position<=s&&(i===-1||e[i].position<c.position)&&(i=a),c.position>=s&&(r===-1||e[r].position>c.position)&&(r=a)}let o=e[n].color;if(i===-1)o=e[r].color;else if(r===-1)o=e[i].color;else{const a=e[i],c=e[r],l=(s-a.position)/(c.position-a.position),h=aa(a.color.r,c.color.r,l),d=aa(a.color.g,c.color.g,l),p=aa(a.color.b,c.color.b,l),E=aa(a.color.a,c.color.a,l);o=new ts(h,d,p,E)}return o},Yh=(e,n,s,i)=>Math.abs(e*i-n*s)<=Math.sqrt((e*e+n*n)*(s*s+i*i))*vn;function lv(e,n){if(n.isStraight)return!0;if(!Pf(n.v.pos,n.w.pos,n.cpV.pos)||!Pf(n.v.pos,n.w.pos,n.cpW.pos))return!1;if(n.v.unlinkedCurveControl!=null&&e.cellTable.has(n.v.unlinkedCurveControl)){const s=e.cellTable.get(n.v.unlinkedCurveControl).pos;if(!Yh(n.v.pos[0]-s[0],n.v.pos[1]-s[1],n.w.pos[0]-s[0],n.w.pos[1]-s[1]))return!1}if(n.w.unlinkedCurveControl!=null&&e.cellTable.has(n.w.unlinkedCurveControl)){const s=e.cellTable.get(n.w.unlinkedCurveControl).pos;if(!Yh(n.v.pos[0]-s[0],n.v.pos[1]-s[1],n.w.pos[0]-s[0],n.w.pos[1]-s[1]))return!1}return!0}const _n={commit:!1},Xh={fire:!1},Uf={interaction:!1},Z_={undoable:!1},hv={...Z_,...Uf},uv={...Xh,..._n};({..._n});const dv={commit:!1,fire:!1,flags:er.FROM_DRAG_DUPLICATE};class fv{constructor(n={}){this.enum=n.enum,this.type=n.type,this.itemType=n.itemType}copy(n){if(this.type)return this.type===Map?e_(n,(s,i)=>[s,this.itemType?new this.itemType(i):i]):this.type===Array?n.map(s=>this.itemType?new this.itemType(s):s):new this.type(n)}eq(n,s){return n===s?!0:Ue(n)||Ue(s)?!1:$0(n.eq)?n.eq(s):this.type===Array?Ax(n,s,(i,r)=>i&&$0(i.eq)?i.eq(r):i===r):this.type===Map?!1:n===s}save(n){if(Tx(n))return[...e_(n,(s,i)=>[s,i.save&&i.save.constructor===Function?i.save():i])];if(Gh(n))return[...n.map(s=>s.save&&s.save.constructor===Function?s.save():s)]}get isIterable(){return this.type===Array||this.type===Map}}function rc(e){const n={};for(const s in e)e.hasOwnProperty(s)&&(n[s]=new fv(e[s]));return n}const ps={Equal(e,n,s=1e-4){return Math.abs(e-n)<s},clamp(e,n,s){return e>s?s:e<n?n:e},lerp(e,n,s){return e*(1-s)+n*s},lerp_angle(e,n,s){const i=(n-e)%(Math.PI*2),r=i*2%(Math.PI*2)-i;return e+r*s},IsPowerOf2(e){return(e&e-1)===0},NearestPowerOf2(e){if(e===0)return 0;let n=e;return n--,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n+1},map(e,n,s,i,r){return i+(r-i)*((e-n)/(s-n))}},q_=1e-5,j_=1e-8;function N(e=0,n=0){this.x=e,this.y=n,this._array=null}N.isOrthogonal=(e,n,s,i)=>Math.abs(e*s+n*i)<=Math.sqrt((e*e+n*n)*(s*s+i*i))*j_,N.isCollinear=(e,n,s,i)=>Math.abs(e*i-n*s)<=Math.sqrt((e*e+n*n)*(s*s+i*i))*j_,N.getThirds=function(e,n){const s=n.clone().subtract(e);return{oneThird:e.clone().add(s.clone().scale(1/3)),twoThirds:e.clone().add(s.clone().scale(2/3))}},N.prototype={constructor:N,get width(){return this.x},set width(e){this.x=e},set_width(e){this.x=e},get height(){return this.y},set height(e){this.y=e},set_height(e){this.y=e},set_x(e){this.x=e},set_y(e){this.y=e},as_array(e){if(!e&&!this._array)return this._array=[this.x,this.y],this._array;const n=e||this._array;return n[0]=this.x,n[1]=this.y,n},fromArray(e){return this.x=e[0],this.y=e[1],this},set(e=0,n=0){return this.x=e,this.y=n,this},copy(e){return this.x=e.x,this.y=e.y,this},mix_with(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this},clone(){return new N(this.x,this.y)},normalized(){return this.clone().normalize()},clamped(e){const n=this.length(),s=this.clone();return n>0&&e<n&&s.scale(e/n),s},rotated(e){return this.clone().rotate(e)},equals(e){const n=this.x,s=this.y,i=e.x,r=e.y;return Math.abs(n-i)<=q_*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(s-r)<=q_*Math.max(1,Math.abs(s),Math.abs(r))},exact_equals(e){return this.x===e.x&&this.y===e.y},add(e,n){return n===void 0?(this.x+=e.x,this.y+=e.y):(this.x+=e,this.y+=n),this},subtract(e,n){return n===void 0?(this.x-=e.x,this.y-=e.y):(this.x-=e,this.y-=n),this},sub(e,n){return n===void 0?(this.x-=e.x,this.y-=e.y):(this.x-=e,this.y-=n),this},multiply(e,n){return n===void 0?(this.x*=e.x,this.y*=e.y):(this.x*=e,this.y*=n),this},divide(e,n){return n===void 0?(this.x/=e.x,this.y/=e.y):(this.x/=e,this.y/=n),this},dot(e){return this.x*e.x+this.y*e.y},cross(e){return this.x*e.y-this.y*e.x},abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this},sign(){return this.x=Math.sign(this.x),this.y=Math.sign(this.y),this},ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},trunc(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this},clamp(e){const n=this.length();return n>0&&e<n&&this.scale(e/n),this},scale(e){return this.x*=e,this.y*=e,this},scale_with_center(e,n){return this.sub(n).scale(e).add(n),this},negate(){return this.x=-this.x,this.y=-this.y,this},inverse(){return this.x=1/this.x,this.y=1/this.y,this},swap(){const e=this.x;return this.x=this.y,this.y=e,this},normalize(){const e=this.x,n=this.y;let s=e*e+n*n;return s>0&&(s=1/Math.sqrt(s),this.x*=s,this.y*=s),this},rotate(e){const n=this.x,s=this.y,i=Math.cos(e),r=Math.sin(e);return this.x=n*i-s*r,this.y=n*r+s*i,this},perp(){const e=this.x;return this.x=this.y,this.y=-e,this},perp_inv(){const e=this.x;return this.x=-this.y,this.y=e,this},normal(e){return e.clone().sub(this).normalize().perp()},direction(e){return e.clone().sub(this).normalize()},plane_project(e,n){const s=this.clone();return n.clone().subtract(s.scale(this.dot(n)-e))},project(e){const n=this.dot(e)/e.length_squared();return this.x=n*e.x,this.y=n*e.y,this},project_n(e){const n=this.dot(e);return this.x=n*e.x,this.y=n*e.y,this},reflect(e){const n=this.dot(e);return this.x=2*e.x*n-this.x,this.y=2*e.y*n-this.y,this},bounce(e){return this.reflect(e).negate()},slide(e){return this.subtract(pv.copy(e).scale(this.dot(e)))},length(){const e=this.x,n=this.y;return Math.sqrt(e*e+n*n)},length_squared(){const e=this.x,n=this.y;return e*e+n*n},angle(){return Math.atan2(this.y,this.x)},angle_to(e){return Math.atan2(this.cross(e),this.dot(e))},angle_to_2(e){let n=this.angle_to(e);return n<0&&(n+=2*Math.PI),n},angle_to_ccw(e){let n=Math.atan2(this.y,this.x)-Math.atan2(e.y,e.x);return n<0&&(n+=2*Math.PI),n},angle_to_point(e){return Math.atan2(this.y-e.y,this.x-e.x)},distance_to(e){const n=e.x-this.x,s=e.y-this.y;return Math.sqrt(n*n+s*s)},distance_squared_to(e){const n=e.x-this.x,s=e.y-this.y;return n*n+s*s},tangent(e=new N){return e.set(this.y,-this.x)},aspect(){return this.x/this.y},is_zero(e=null){return e?J_(this.x,e)&&J_(this.y,e):this.x===0&&this.y===0},isOrthogonal(e){return N.isOrthogonal(this.x,this.y,e.x,e.y)},isCollinear(e){return N.isCollinear(this.x,this.y,e.x,e.y)},linear_interpolate(e,n){return this.x+=n*(e.x-this.x),this.y+=n*(e.y-this.y),this},cubic_interpolate(e,n,s,i){const r=i*i,o=r*i;return new N(.5*(this.x*2+(-n.x+e.x)*i+(2*n.x-5*this.x+4*e.x-s.x)*r+(-n.x+3*this.x-3*e.x+s.x)*o),.5*(this.y*2+(-n.y+e.y)*i+(2*n.y-5*this.y+4*e.y-s.y)*r+(-n.y+3*this.y-3*e.y+s.y)*o))},valid(){return!isNaN(this.x)&&!isNaN(this.y)},isClose(e,n){return this.getDistance(e)<=n},getDistance(e,n=!1){const s=e.x-this.x,i=e.y-this.y,r=s*s+i*i;return n?r:Math.sqrt(r)},isInside(e){return e.contains(this.x,this.y)},angleToPoint(e){return Math.atan2(this.y-e.y,this.x-e.x)},distance(e){return Math.hypot(this.x-e.x,this.y-e.y)}};const J_=(e,n)=>e>=-n&&e<=n;N.ZERO=Object.freeze(new N(0,0)),N.ONE=Object.freeze(new N(1,1)),N.INF=Object.freeze(new N(1/0,1/0)),N.LEFT=Object.freeze(new N(-1,0)),N.RIGHT=Object.freeze(new N(1,0)),N.UP=Object.freeze(new N(0,-1)),N.DOWN=Object.freeze(new N(0,1));const pv=new N,Ev=1e-5,ve={M:1,L:2,Q:3,C:4,Z:5},gv={[ve.M]:2,[ve.L]:2,[ve.Q]:4,[ve.C]:6};class Bs{constructor(n=[],s=[]){this.vertices=n,this.commands=s,this.metadata={},this.cornerRadiusOverrides={},this.hasOpenOrNetworkSubaths=!1}toSVGPathString(){let n="",s=0;for(let i=0;i<this.commands.length;++i)switch(this.commands[i]){case 1:{const r=this.vertices[s++],o=this.vertices[s++];n+=`M${r} ${o}`;break}case 2:{const r=this.vertices[s++],o=this.vertices[s++];n+=`L${r} ${o}`;break}case 3:{const r=this.vertices[s++],o=this.vertices[s++],a=this.vertices[s++],c=this.vertices[s++];n+=`Q${r} ${o} ${a} ${c}`;break}case 4:{const r=this.vertices[s++],o=this.vertices[s++],a=this.vertices[s++],c=this.vertices[s++],l=this.vertices[s++],h=this.vertices[s++];n+=`C${r} ${o} ${a} ${c} ${l} ${h}`;break}case 5:{n+="Z";break}}return n}attachMetadata(n,s,i){this.metadata[n]||(this.metadata[n]={}),this.metadata[n][s]=i}*iter(){const n=this.getSubpathBoundaries();for(let s=0;s<n.length-1;s++){const i=n[s][0],r=n[s+1][0],o=n[s][1],a=n[s+1][1];yield new _v(this,i,r,o,a)}}getSubpathBoundaries(){const n=[];let s=0;for(let i=0;i<this.commands.length;i++){const r=this.commands[i];r===ve.M&&n.push([i,s]),s+=gv[r]}return n.push([this.commands.length,this.vertices.length]),n}reverseSubpaths(){const n=this.getSubpathBoundaries();for(let s=0;s<n.length-1;s++){const i=n[s][0],r=n[s+1][0];for(let o=1;o<Math.ceil((r-i)/2);o++){const a=this.commands[i+o];this.commands[i+o]=this.commands[r-o],this.commands[r-o]=a}}for(let s=0;s<n.length-1;s++){const i=n[s][1],r=n[s+1][1]-1,o=r-i+1;for(let a=0;a<Math.floor(o/4);a++){const c=a*2,l=i+c,h=i+c+1,d=r-c-1,p=r-c,E=this.vertices[l],g=this.vertices[h];this.vertices[l]=this.vertices[d],this.vertices[h]=this.vertices[p],this.vertices[d]=E,this.vertices[p]=g}}}connectFirstAndLastSubpaths(n,s,i,r){this.vertices.pop(),this.vertices.pop();const o=this.commands.slice(i),a=this.vertices.slice(r);for(let c=i-1;c>=n;c--)this.commands[c+o.length-1]=this.commands[c];for(let c=r-1;c>=s;c--)this.vertices[c+a.length]=this.vertices[c];for(let c=0;c<o.length;c++)this.commands[n+c]=o[c];for(let c=0;c<a.length;c++)this.vertices[s+c]=a[c];this.commands.pop()}clear(){this.commands.length=0,this.vertices.length=0}applyXorm(n){const s=new Bs;s.commands=this.commands,s.vertices=[];const i=new N,r=new N;for(let o=0;o<this.vertices.length/2;o++)n.xform(i.set(this.vertices[o*2],this.vertices[o*2+1]),r),s.vertices.push(r.x,r.y);return s}get debugString(){let n="";n+=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
`,n+=`<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`,n+=`<svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg">
`;let s=0;for(let i=0;i<this.commands.length;++i)switch(this.commands[i]){case 1:{const r=this.vertices[s++],o=this.vertices[s++];i!==0&&(n+=`" stroke="black" style="fill:none"/>
`),n+=`<path d="M${r} ${o} `}break;case 2:{const r=this.vertices[s++],o=this.vertices[s++];n+=`L ${r} ${o} `}break;case 3:{const r=this.vertices[s++],o=this.vertices[s++],a=this.vertices[s++],c=this.vertices[s++];n+=`Q ${r} ${o} ${a} ${c} `}break;case 4:{const r=this.vertices[s++],o=this.vertices[s++],a=this.vertices[s++],c=this.vertices[s++],l=this.vertices[s++],h=this.vertices[s++];n+=`C ${r} ${o} ${a} ${c} ${l} ${h} `}break}return n+=`" stroke="black" style="fill:none"/>
`,n+="</svg>",n}}class Gf{constructor(){this.path=new Bs,this._started=!1,this.firstX=null,this.firstY=null,this.lastX=null,this.lastY=null}clear(){this.path.clear(),this._started=!1,this.firstX=null,this.firstY=null,this.lastX=null,this.lastY=null}start_vec(n){this.start(n.x,n.y)}line_vec(n){this.line(n.x,n.y)}assure_vec(n){this.assure(n.x,n.y)}quadratic_vec(n,s){this.quadratic(n.x,n.y,s.x,s.y)}cubic_vec(n,s,i){this.cubic(n.x,n.y,s.x,s.y,i.x,i.y)}start(n,s){this._started||(this._started=!0,this.path.commands.push(ve.M),this.path.vertices.push(n,s),this.firstX=n,this.firstY=s,this.lastX=n,this.lastY=s)}assure(n,s){this._started?ps.Equal(this.lastX,n)&&ps.Equal(this.lastY,s)||this.line(n,s):this.start(n,s)}line(n,s){this._started&&(this.path.commands.push(ve.L),this.path.vertices.push(n,s),this.lastX=n,this.lastY=s)}quadratic(n,s,i,r){this._started&&(this.path.commands.push(ve.Q),this.path.vertices.push(n,s,i,r),this.lastX=i,this.lastY=r)}cubic(n,s,i,r,o,a){this._started&&(this.path.commands.push(ve.C),this.path.vertices.push(n,s,i,r,o,a),this.lastX=o,this.lastY=a)}bezier(n){n.order===2?this.quadratic_vec(n.points[1],n.points[2]):n.order===3?this.cubic_vec(n.points[1],n.points[2],n.points[3]):console.warn("should not have happened")}bezier_assure_first_point(n){this.assure_vec(n.points[0]),this.bezier(n)}end(n=!1){this._started&&(this._started=!1,n&&this.path.commands.push(ve.Z))}copySubpath(n,s=!1,i=0,r=0,o=0,a=0){this.copy(n.path,s,n.cmdS+i,n.cmdE-r,n.verS+o,n.verE-a)}copy(n,s=!1,i=0,r=n.commands.length,o=0,a=n.vertices.length){for(let c=i;c<r;c++)s&&n.commands[c]===ve.M?this.path.commands.push(ve.L):this.path.commands.push(n.commands[c]);for(let c=o;c<a;c++)this.path.vertices.push(n.vertices[c])}}class _v{constructor(n,s,i,r,o){this.path=n,this.cmdS=s,this.cmdE=i,this.verS=r,this.verE=o,this.isClosed=this._isClosed(),this.metadata=n.metadata[s]||{},this.isEnd0Cap=this.metadata.isEnd0Cap===void 0?!0:this.metadata.isEnd0Cap,this.isEnd1Cap=this.metadata.isEnd1Cap===void 0?!0:this.metadata.isEnd1Cap}get hasCurves(){for(let n=this.cmdS+1;n<this.cmdE;n++)if(this.path.commands[n]!==ve.L)return!0;return!1}first(){const n=this.path.commands[this.cmdS+1],s=n===ve.Q||n===ve.C;let i=this.verS;const r=this.path.vertices[i++],o=this.path.vertices[i++];let a,c,l,h;s&&(a=this.path.vertices[i++],c=this.path.vertices[i++]),n===ve.C&&(l=this.path.vertices[i++],h=this.path.vertices[i++]);const d=this.path.vertices[i++],p=this.path.vertices[i];return new Ff(n,r,o,a,c,l,h,d,p,!0,this.cmdS+1===this.cmdE-1,this.path.cornerRadiusOverrides[this.verS],this.path.cornerRadiusOverrides[i-1])}last(){const n=this.path.commands[this.cmdE-1],s=n===ve.Q||n===ve.C;let i=this.verE-1;const r=this.path.vertices[i--],o=this.path.vertices[i--];let a,c,l,h;n===ve.C&&(h=this.path.vertices[i--],l=this.path.vertices[i--]),s&&(c=this.path.vertices[i--],a=this.path.vertices[i--]);const d=this.path.vertices[i--],p=this.path.vertices[i];return new Ff(n,p,d,a,c,l,h,o,r,this.cmdS===this.cmdE-1,!0,this.path.cornerRadiusOverrides[i],this.path.cornerRadiusOverrides[this.verE-2])}*iter(){let n=this.verS,s=this.path.vertices[n++],i=this.path.vertices[n++];for(let r=this.cmdS+1;r<this.cmdE;r++){if(n>=this.path.vertices.length)return;const o=this.path.commands[r],a=o===ve.Q||o===ve.C,c=this.path.cornerRadiusOverrides[n-2],l=s,h=i;let d,p,E,g;a&&(d=this.path.vertices[n++],p=this.path.vertices[n++]),o===ve.C&&(E=this.path.vertices[n++],g=this.path.vertices[n++]);const T=this.path.cornerRadiusOverrides[n],A=this.path.vertices[n++],m=this.path.vertices[n++];s=A,i=m,yield new Ff(o,l,h,d,p,E,g,A,m,r===this.cmdS+1,r===this.cmdE-1,c,T)}}forEach(n){const s=this.iter(),i=s.next().value;let r=i,o=!0;for(const a of s)n(r,a,o,!this.isClosed&&a.isLast),o=!1,r=a;this.isClosed&&n(r,i,o,!0)}_isClosed(){const n=this.path.vertices[this.verS],s=this.path.vertices[this.verS+1],i=this.path.vertices[this.verE-2],r=this.path.vertices[this.verE-1];return ps.Equal(n,i)&&ps.Equal(s,r)}}class Ff{constructor(n,s,i,r,o,a,c,l,h,d,p,E,g){this.cmd=n,this.p0=new N(s,i),this.cp0=r!==void 0&&new N(r,o),this.cp1=a!==void 0&&new N(a,c),this.p1=new N(l,h),this.isFirst=d,this.isLast=p,this.isCurve=n===ve.Q||n===ve.C,this.cornerRadiusOverride0=E,this.cornerRadiusOverride1=g}get tan0(){return this.p0.equals(this.cp0)?this.cmd===ve.C?this.cp1:this.p1:this.cp0}get tan1(){return this.cmd===ve.C?this.p1.equals(this.cp1)?this.cp0:this.cp1:this.p1.equals(this.cp0)?this.p0:this.cp0}bezier(){if(!this.isCurve)throw new Error("not a curve");if(this.cmd===ve.C){const n=this.p0.equals(this.cp0),s=this.p1.equals(this.cp1),i=n?$_(this.p0,this.cp1):this.cp0,r=s?$_(this.p1,this.cp0):this.cp1;return new Bt(this.p0.x,this.p0.y,i.x,i.y,r.x,r.y,this.p1.x,this.p1.y)}else return new Bt(this.p0.x,this.p0.y,this.cp0.x,this.cp0.y,this.p1.x,this.p1.y)}bezierData(){if(!this.isCurve)throw new Error("not a curve");return Tv(this.p0,this.cp0,this.cp1,this.p1)}}function Tv(e,n,s,i,r=256){const[o,a]=Av(e,n,s,i,r),c=d=>s_(d,e,n,s,i),l=d=>{if(d<=0)return 0;if(d>=a)return 1;for(let p=0;p<r;p++)if(o[p]>=d){const E=o[p],g=o[p+1],T=(d-E)/(g-E);return(p+T)/r}return 1};return{length:a,getPointAt:d=>c(l(d)),getTAt:l,getP:c}}function $_(e,n){return n.clone().sub(e).normalize().scale(Ev*100).add(e)}const Av=(e,n,s,i,r=256)=>{const o=new Array(r+1);o[0]=0;let a=0;const c=new N().copy(e);for(let l=1;l<=r;l++){const h=s_(l/r,e,n,s,i);a+=h.distance_to(c),o[l]=a,c.copy(h)}return[o,a]};function eT(e,n,s,i,r=!1,o=!1){const a=s.commands.length;let c=!1,l=null,h=null;for(const p of n){if(l===null){l=p.v,s.vertices.push(...i(e,l.id)),s.commands.push(ve.M);const T=p.v.inHalves.size>2;(T||o)&&s.attachMetadata(a,"isEnd0Cap",!1);const A=T?0:p.v.cornerRadius;A!==null&&(s.cornerRadiusOverrides[s.vertices.length-2]=A)}else h!==p.v&&console.warn("previous end vertex is not the same as current start vertex!");h=p.w,p.edge.isCurve?(h===p.edge.w?s.vertices.push(...i(e,p.edge.cpV.id),...i(e,p.edge.cpW.id),...i(e,h.id)):s.vertices.push(...i(e,p.edge.cpW.id),...i(e,p.edge.cpV.id),...i(e,h.id)),s.commands.push(ve.C)):(s.vertices.push(...i(e,h.id)),s.commands.push(ve.L));const E=p.w.inHalves.size>2;c=E,s.hasOpenOrNetworkSubaths||(s.hasOpenOrNetworkSubaths=E);const g=E?0:p.w.cornerRadius;g!==null&&(s.cornerRadiusOverrides[s.vertices.length-2]=g)}(c||o)&&s.attachMetadata(a,"isEnd1Cap",!1);const d=h!==l;d||s.commands.push(ve.Z),s.hasOpenOrNetworkSubaths||(s.hasOpenOrNetworkSubaths=d),d&&!r&&console.warn("first and last verticies should be the same!")}function zh(e){const n=new Set;tT(e,n);const s=new Bs,i=(r,o)=>r.getVertPos(o);for(const r of n)eT(e,r,s,i,!0);return s}function tT(e,n){const s=new Map;for(const i of e.getEdges()){const r=i.v,o=i.w,a=s.get(r),c=s.get(o);if(a&&c)if(a.path===c.path)a.last?a.path.push(i.halves[0]):a.path.push(i.halves[1]),s.delete(r),s.delete(o);else{let l;if(a.last&&c.last)l=a.path,l.push(i.halves[0]),mv(c.path,l);else if(!a.last&&!c.last){l=a.path,l.reverse();for(let h=0;h<l.length;h++)l[h]=l[h].twin;l.push(i.halves[0],...c.path)}else a.last&&!c.last?(l=a.path,l.push(i.halves[0],...c.path)):(l=c.path,l.push(i.halves[1],...a.path));s.delete(r),s.delete(o),n.delete(l===a.path?c.path:a.path),s.set(l[0].v,{path:l,last:!1}),s.set(l[l.length-1].w,{path:l,last:!0})}else if(a)a.last?a.path.push(i.halves[0]):a.path.unshift(i.halves[1]),s.delete(r),s.set(o,{path:a.path,last:a.last});else if(c)c.last?c.path.push(i.halves[1]):c.path.unshift(i.halves[0]),s.delete(o),s.set(r,{path:c.path,last:c.last});else{const l=[i.halves[0]];n.add(l),s.set(r,{path:l,last:!1}),s.set(o,{path:l,last:!0})}}}function mv(e,n){for(let s=e.length-1;s>=0;s--)n.push(e[s].twin)}let Ov=class XN{constructor(n,s,i,r){Ue(n)?(this.from=new ne,this.to=new ne):n.from&&n.to?(this.from=new ne(n.from),this.to=new ne(n.to)):n.x&&n.y&&s.x&&s.y?(this.from=new ne(n),this.to=new ne(s)):(this.from=new ne(n,s),this.to=new ne(i,r))}setP(n,s){return this.from=n,this.to=s,this}transform(n,s=!0){const i=s?new XN:this;return i.from=$c(i.from,this.from,n),i.to=$c(i.to,this.to,n),i}intersectsLine(n,s,i,r){let o=typeof n=="number"?n:void 0;o===void 0&&(o=ee(n.a)?n.a.x:n.x);let a=typeof s=="number"?s:void 0;a===void 0&&(a=ee(n.a)?n.a.y:n.y);let c=typeof i=="number"?i:void 0;c===void 0&&(c=ee(n.b)?n.b.x:s.x);let l=typeof r=="number"?r:void 0;l===void 0&&(l=ee(n.b)?n.b.y:s.y);const h=this.b.x-this.a.x,d=this.b.y-this.a.y,p=c-o,E=l-a,g=(-d*(this.a.x-o)+h*(this.a.y-a))/(-p*d+h*E),T=(p*(this.a.y-a)-E*(this.a.x-o))/(-p*d+h*E);return g>=0&&g<=1&&T>=0&&T<=1}intersectsBox(n,s,i,r){const o=new Gn(n,s,i,r),a=o.topLeft,c=o.topRight,l=o.bottomRight,h=o.bottomLeft;return this.intersectsLine(a,c)||this.intersectsLine(c,l)||this.intersectsLine(l,h)||this.intersectsLine(h,a)}normal(){return new ne(iv(this.from,this.to))}nearest(n){const s=this.a,i=this.getVector(),r=s.clone().add(i),o=i.dot(n.clone().sub(s)),a=i.dot(i);let c=0,l=0;return o<=0?(c=0,l=n.distance_squared_to(s)):o>=a?(c=1,l=n.distance_squared_to(r)):(c=o/a,l=this.eval(c).sub(n).length_squared()),{distance_sq:l,t:c}}getVector(){return this.to.clone().sub(this.from)}eval(n){const s=this.getVector();return this.from.clone().add(aa(0,s.x,n),aa(0,s.y,n))}get a(){return this.from}get b(){return this.to}};class kf{constructor({position:n,opacity:s}={}){typeof s=="number"&&typeof n=="number"?(this.position=n,this.opacity=s):this.copy(n)}copy(n){this.position=n.position,this.opacity=n.opacity}eq(n){return n&&this.position===n.position&&this.opacity===n.opacity}save(){const n={};return n.position=this.position,n.opacity=this.opacity,n}}class da{constructor({position:n,color:s}={}){if(Ue(n)||Ue(s))throw new Error("ColorStop position or color arguments are missing");this.position=n,this.color=new ts(s)}copy({position:n,color:s}={}){this.position=n,this.color=new ts(s)}eq(n){return n&&this.position===n.position&&this.color.eq(n.color)}save(){const n={};return n.position=this.position,n.color=[...this.color],n}}const Bf=5,Iv=!1;class Sv{constructor(){this._enabled=Iv,this._logger={},this._reset()}help(){console.log(`stats.activate(): enable the frame monitoring
`),console.log(`stats.deactivate(): disable the frame monitoring
`),console.log(`stats.dump(): get the monitoring result
`),console.log(`stats.help(): show the usage of this tool
`)}activate(){this._reset(),this._enabled=!0,console.log("The frame monitoring utility is activated.")}deactivate(){this._reset(),this._enabled=!1,console.log("The frame monitoring utility is deactivated.")}has(n){const[s,i]=this._getMetricNames(n),r=this.metricGroups[s];return r?!!r[i]:!1}get(n){if(!this.has(n))throw new Error(`The metrics "${n}" does not exist`);const[s,i]=this._getMetricNames(n);return this.metricGroups[s][i]}begin(n){if(!this._enabled)return;const[s,i]=this._getMetricNames(n);this.metricGroups[s]||(this.metricGroups[s]={}),this.metricGroups[s][i]||(this.metricGroups[s][i]={frameCounter:0,deltaTime:0,maxDeltaTime:0,minDeltaTime:1/0,deltaTimeBuffer:new Array(Bf).fill(0),useSubTimer:!1}),this.metricGroups[s][i].beginTime=performance.now(),this.metricGroups[s][i].deltaTime=0,this.metricGroups[s][i].useSubTimer=!1}end(n){if(!this._enabled)return;const s=this.get(n);return s.useSubTimer||(s.deltaTime=performance.now()-s.beginTime),this._recalculateAvgMinMax(s),s.deltaTime}beginSub(n){if(!this._enabled)return;const s=this.get(n);s.useSubTimer=!0,s.beginTime=performance.now()}endSub(n){if(!this._enabled)return;const s=this.get(n);s.deltaTime+=performance.now()-s.beginTime}log(n,s){this._enabled&&(this._logger[n]=s)}_getMetricNames(n){const s=n.split("/");return s.length<=1?["_",s[0]]:[s[0],s[1]]}_recalculateAvgMinMax(n){n.deltaTimeBuffer[n.frameCounter++%Bf]=n.deltaTime,n.maxDeltaTime=Math.max(n.maxDeltaTime,n.deltaTime),n.minDeltaTime=Math.min(n.minDeltaTime,n.deltaTime),n.avgDeltaTime=n.deltaTimeBuffer.reduce((s,i)=>s+i,0)/Bf}_reset(){this.metricGroups={_:{}},this._logger={}}dump(){const n=this._logger;return Object.keys(this.metricGroups).reduce((s,i)=>{const r=this.metricGroups[i],o=Object.keys(r).reduce((a,c)=>a+r[c].avgDeltaTime,0);return s[i]=Object.keys(r).reduce((a,c)=>(a[c]={frames:r[c].frameCounter,avg:r[c].avgDeltaTime,min:r[c].minDeltaTime,max:r[c].maxDeltaTime,pct:100*(r[c].avgDeltaTime/o)},a),{}),s},n)}}const Yt=new Sv;typeof window<"u"&&(window.stats=Yt);const yv="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiB2aWV3Qm94PSIwIDAgOCA4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8ZyBjbGlwLXBhdGg9InVybCgjY2xpcDBfMjYxMF8xODU5KSI+CjxwYXRoIGQ9Ik0yIDBIMFYySDJWMFoiIGZpbGw9ImJsYWNrIi8+CjxwYXRoIGQ9Ik00IDBIMlYySDRWMFoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik02IDBINFYySDZWMFoiIGZpbGw9ImJsYWNrIi8+CjxwYXRoIGQ9Ik04IDBINlYySDhWMFoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik00IDJIMlY0SDRWMloiIGZpbGw9ImJsYWNrIi8+CjxwYXRoIGQ9Ik02IDJINFY0SDZWMloiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik04IDJINlY0SDhWMloiIGZpbGw9ImJsYWNrIi8+CjxwYXRoIGQ9Ik0yIDJIMFY0SDJWMloiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0yIDRIMFY2SDJWNFoiIGZpbGw9ImJsYWNrIi8+CjxwYXRoIGQ9Ik00IDRIMlY2SDRWNFoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik02IDRINFY2SDZWNFoiIGZpbGw9ImJsYWNrIi8+CjxwYXRoIGQ9Ik04IDRINlY2SDhWNFoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik00IDZIMlY4SDRWNloiIGZpbGw9ImJsYWNrIi8+CjxwYXRoIGQ9Ik02IDZINFY4SDZWNloiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik04IDZINlY4SDhWNloiIGZpbGw9ImJsYWNrIi8+CjxwYXRoIGQ9Ik0yIDZIMFY4SDJWNloiIGZpbGw9IndoaXRlIi8+CjwvZz4KPGRlZnM+CjxjbGlwUGF0aCBpZD0iY2xpcDBfMjYxMF8xODU5Ij4KPHJlY3Qgd2lkdGg9IjgiIGhlaWdodD0iOCIgZmlsbD0id2hpdGUiLz4KPC9jbGlwUGF0aD4KPC9kZWZzPgo8L3N2Zz4K";var Cv=Object.defineProperty,Nv=(e,n,s)=>n in e?Cv(e,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[n]=s,Xe=(e,n,s)=>Nv(e,typeof n!="symbol"?n+"":n,s),nT={exports:{}};(function(e){var n=Object.prototype.hasOwnProperty,s="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(s=!1));function r(l,h,d){this.fn=l,this.context=h,this.once=d||!1}function o(l,h,d,p,E){if(typeof d!="function")throw new TypeError("The listener must be a function");var g=new r(d,p||l,E),T=s?s+h:h;return l._events[T]?l._events[T].fn?l._events[T]=[l._events[T],g]:l._events[T].push(g):(l._events[T]=g,l._eventsCount++),l}function a(l,h){--l._eventsCount===0?l._events=new i:delete l._events[h]}function c(){this._events=new i,this._eventsCount=0}c.prototype.eventNames=function(){var l=[],h,d;if(this._eventsCount===0)return l;for(d in h=this._events)n.call(h,d)&&l.push(s?d.slice(1):d);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(h)):l},c.prototype.listeners=function(l){var h=s?s+l:l,d=this._events[h];if(!d)return[];if(d.fn)return[d.fn];for(var p=0,E=d.length,g=new Array(E);p<E;p++)g[p]=d[p].fn;return g},c.prototype.listenerCount=function(l){var h=s?s+l:l,d=this._events[h];return d?d.fn?1:d.length:0},c.prototype.emit=function(l,h,d,p,E,g){var T=s?s+l:l;if(!this._events[T])return!1;var A=this._events[T],m=arguments.length,O,S;if(A.fn){switch(A.once&&this.removeListener(l,A.fn,void 0,!0),m){case 1:return A.fn.call(A.context),!0;case 2:return A.fn.call(A.context,h),!0;case 3:return A.fn.call(A.context,h,d),!0;case 4:return A.fn.call(A.context,h,d,p),!0;case 5:return A.fn.call(A.context,h,d,p,E),!0;case 6:return A.fn.call(A.context,h,d,p,E,g),!0}for(S=1,O=new Array(m-1);S<m;S++)O[S-1]=arguments[S];A.fn.apply(A.context,O)}else{var y=A.length,v;for(S=0;S<y;S++)switch(A[S].once&&this.removeListener(l,A[S].fn,void 0,!0),m){case 1:A[S].fn.call(A[S].context);break;case 2:A[S].fn.call(A[S].context,h);break;case 3:A[S].fn.call(A[S].context,h,d);break;case 4:A[S].fn.call(A[S].context,h,d,p);break;default:if(!O)for(v=1,O=new Array(m-1);v<m;v++)O[v-1]=arguments[v];A[S].fn.apply(A[S].context,O)}}return!0},c.prototype.on=function(l,h,d){return o(this,l,h,d,!1)},c.prototype.once=function(l,h,d){return o(this,l,h,d,!0)},c.prototype.removeListener=function(l,h,d,p){var E=s?s+l:l;if(!this._events[E])return this;if(!h)return a(this,E),this;var g=this._events[E];if(g.fn)g.fn===h&&(!p||g.once)&&(!d||g.context===d)&&a(this,E);else{for(var T=0,A=[],m=g.length;T<m;T++)(g[T].fn!==h||p&&!g[T].once||d&&g[T].context!==d)&&A.push(g[T]);A.length?this._events[E]=A.length===1?A[0]:A:a(this,E)}return this},c.prototype.removeAllListeners=function(l){var h;return l?(h=s?s+l:l,this._events[h]&&a(this,h)):(this._events=new i,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=s,c.EventEmitter=c,e.exports=c})(nT);var sT=nT.exports;const Kh=navigator.userAgent.includes("Mac"),xv=Kh?"Mac":"Other",vv="+",Rv={ControlLeft:"Control",ControlRight:"Control",MetaLeft:"Modifier",MetaRight:"Modifier",ShiftLeft:"Shift",ShiftRight:"Shift",AltLeft:"Alt",AltRight:"Alt",Digit0:"0",Digit1:"1",Digit2:"2",Digit3:"3",Digit4:"4",Digit5:"5",Digit6:"6",Digit7:"7",Digit8:"8",Digit9:"9",Numpad0:"0",Numpad1:"1",Numpad2:"2",Numpad3:"3",Numpad4:"4",Numpad5:"5",Numpad6:"6",Numpad7:"7",Numpad8:"8",Numpad9:"9",KeyA:"A",KeyB:"B",KeyC:"C",KeyD:"D",KeyE:"E",KeyF:"F",KeyG:"G",KeyH:"H",KeyI:"I",KeyJ:"J",KeyK:"K",KeyL:"L",KeyM:"M",KeyN:"N",KeyO:"O",KeyP:"P",KeyQ:"Q",KeyR:"R",KeyS:"S",KeyT:"T",KeyU:"U",KeyV:"V",KeyW:"W",KeyX:"X",KeyY:"Y",KeyZ:"Z",Equal:"=",NumpadAdd:"=",Minus:"-",NumpadSubtract:"-",Period:".",NumpadDecimal:".",Slash:"/",NumpadDivide:"/",Backslash:"\\",BracketRight:"]",BracketLeft:"[",Quote:"'",Semicolon:";",Comma:",",Backquote:"`",NumLock:"Clear",Help:"Insert",Space:"Space"},Ee={LEFT_CLICK:"LEFT_CLICK",LEFT_CLICK_MOVE:"LEFT_CLICK_MOVE",LEFT_CLICK_DOWN:"LEFT_CLICK_DOWN",LEFT_CLICK_UP:"LEFT_CLICK_UP",SPACE:"SPACE",MIDDLE_CLICK_MOVE:"MIDDLE_CLICK_MOVE",RIGHT_CLICK_MOVE:"RIGHT_CLICK_MOVE",MOUSE_MOVE:"MOUSE_MOVE",MOUSE_ENTER:"MOUSE_ENTER",MOUSE_LEAVE:"MOUSE_LEAVE",DOUBLE_LEFT_CLICK:"DOUBLE_LEFT_CLICK",DRAG_OVER:"DRAG_OVER",DRAG_END:"DRAG_END",DROP:"DROP",SELECT_PREVIOUS_ELEMENT:"SELECT_PREVIOUS_ELEMENT",SELECT_NEXT_ELEMENT:"SELECT_NEXT_ELEMENT",TEXT_MOVE_CARET_TO_LINE_START:"TEXT_MOVE_CARET_TO_LINE_START",TEXT_MOVE_CARET_TO_TEXT_START:"TEXT_MOVE_CARET_TO_TEXT_START",TEXT_EXPAND_SELECTION_TO_LINE_START:"TEXT_EXPAND_SELECTION_TO_LINE_START",TEXT_EXPAND_SELECTION_TO_TEXT_START:"TEXT_EXPAND_SELECTION_TO_TEXT_START",TEXT_MOVE_CARET_TO_LINE_END:"TEXT_MOVE_CARET_TO_LINE_END",TEXT_MOVE_CARET_TO_TEXT_END:"TEXT_MOVE_CARET_TO_TEXT_END",TEXT_EXPAND_SELECTION_TO_LINE_END:"TEXT_EXPAND_SELECTION_TO_LINE_END",TEXT_EXPAND_SELECTION_TO_TEXT_END:"TEXT_EXPAND_SELECTION_TO_TEXT_END",ENTER:"ENTER",ENTER_SHIFT:"ENTER_SHIFT",ESCAPE:"ESCAPE",DELETE:"DELETE",MOVE_RIGHT:"MOVE_RIGHT",MOVE_LEFT:"MOVE_LEFT",MOVE_UP:"MOVE_UP",MOVE_DOWN:"MOVE_DOWN",UNDO:"UNDO",REDO:"REDO",ZOOM_OUT:"ZOOM_OUT",ZOOM_IN:"ZOOM_IN",ZOOM_RESET:"ZOOM_RESET",ZOOM_FIT_CONTENT:"ZOOM_FIT_CONTENT",ZOOM_FIT_SELECTION:"ZOOM_FIT_SELECTION",ZOOM_CENTER_SELECTION:"ZOOM_CENTER_SELECTION",COPY:"COPY",PASTE:"PASTE",CUT:"CUT",DUPLICATE:"DUPLICATE",SELECT_ALL:"SELECT_ALL",TOGGLE_ANIMATE_MODE:"TOGGLE_ANIMATE_MODE",ACTIVATE_SELECT_TOOL:"ACTIVATE_SELECT_TOOL",ACTIVATE_SCALE_TOOL:"ACTIVATE_SCALE_TOOL",ACTIVATE_HAND_TOOL:"ACTIVATE_HAND_TOOL",ACTIVATE_RECTANGLE_TOOL:"ACTIVATE_RECTANGLE_TOOL",RESTART_PROTOTYPE:"RESTART_PROTOTYPE",TOGGLE_PROTOTYPE_MODE:"TOGGLE_PROTOTYPE_MODE",EXIT_PROTOTYPE_MODE:"EXIT_PROTOTYPE_MODE",ENTER_PROTOTYPE_MODE_FULL_SCREEN:"ENTER_PROTOTYPE_MODE_FULL_SCREEN",ACTIVATE_CONTAINER_TOOL:"ACTIVATE_CONTAINER_TOOL",ACTIVATE_ELLIPSE_TOOL:"ACTIVATE_ELLIPSE_TOOL",ACTIVATE_PEN_TOOL:"ACTIVATE_PEN_TOOL",ACTIVATE_COMMENT_TOOL:"ACTIVATE_COMMENT_TOOL",ACTIVATE_TEXT_TOOL:"ACTIVATE_TEXT_TOOL",TOGGLE_EYE_DROPPER_TOOL:"TOGGLE_EYE_DROPPER_TOOL",INCREASE_CORNER_RADIUS:"INCREASE_CORNER_RADIUS",DECREASE_CORNER_RADIUS:"DECREASE_CORNER_RADIUS",GROUP_ELEMENTS:"GROUP_ELEMENTS",UNGROUP_ELEMENT:"UNGROUP_ELEMENT",TOGGLE_EXPAND:"TOGGLE_EXPAND",WHEEL_PAN_VIEWPORT:"WHEEL_PAN_VIEWPORT",WHEEL_ZOOM_TO_POINTER:"WHEEL_ZOOM_TO_POINTER",TRACKPAD_ZOOM_TO_POINTER:"TRACKPAD_ZOOM_TO_POINTER",MOBILE_PINCH_ZOOM_TO_POINTER:"MOBILE_PINCH_ZOOM_TO_POINTER",MOBILE_TOUCH_PAN:"MOBILE_TOUCH_PAN",ALIGN_LEFT:"ALIGN_LEFT",ALIGN_CENTER:"ALIGN_CENTER",ALIGN_RIGHT:"ALIGN_RIGHT",ALIGN_TOP:"ALIGN_TOP",ALIGN_MIDDLE:"ALIGN_MIDDLE",ALIGN_BOTTOM:"ALIGN_BOTTOM",DISTRIBUTE_HORIZONTAL:"DISTRIBUTE_HORIZONTAL",DISTRIBUTE_VERTICAL:"DISTRIBUTE_VERTICAL",TOGGLE_ORIGIN:"TOGGLE_ORIGIN",TOGGLE_RULER:"TOGGLE_RULER",TOGGLE_ACTION_PANEL:"TOGGLE_ACTION_PANEL",ADD_ACTION:"ADD_ACTION",TOGGLE_INTERFACE:"TOGGLE_INTERFACE",TOGGLE_COMMENT_VISIBILITY:"TOGGLE_COMMENT_VISIBILITY",TOGGLE_VISIBLE:"TOGGLE_VISIBLE",TOGGLE_LOCK:"TOGGLE_LOCK",BRING_TO_FRONT:"BRING_TO_FRONT",SEND_TO_BACK:"SEND_TO_BACK",MOVE_FORWARD:"MOVE_FORWARD",MOVE_BACKWARD:"MOVE_BACKWARD",MASK_SELECTION:"MASK_SELECTION",TOGGLE_PRESENCE:"TOGGLE_PRESENCE",EDIT_ORIGIN:"EDIT_ORIGIN",TOGGLE_INSPECTING:"TOGGLE_INSPECTING",KEY_DOWN:"KEY_DOWN",KEY_UP:"KEY_UP"},iT=new Map,rT=e=>{if(!e)return null;const n=iT.get(e);if(n)return n;const s=new Vf(e);return iT.set(e,s),s};class Vf{constructor(n){Xe(this,"sourceStr"),Xe(this,"triggerKeyCode"),Xe(this,"modifiers"),this.sourceStr=n;const s=Vf._splitStr(n,vv);this.triggerKeyCode=s.pop()||"",this.modifiers=s.reduce((i,r)=>(i[r.toLowerCase()]=!0,i),{modifier:!1,ctrl:!1,shift:!1,alt:!1})}static _splitStr(n,s){const i=n.replace(/ /g,"");let r="";const o=[];for(let a=0;a<i.length;a++){if(a!==i.length-1&&i[a+1]===s){r+=i[a]==="\\"?s:i[a],o.push(r),r="",a++;continue}r+=i[a]}return r&&o.push(r),o}shouldTrigger(n,s=!1){return n.key!==this.triggerKeyCode?!1:s?!0:Object.entries(this.modifiers).every(([i,r])=>{if(n.modifiers[i]===r)return!0;if(!Kh)switch(i){case"ctrl":return n.modifiers.modifier===this.modifiers.modifier;case"modifier":return n.modifiers.modifier||n.modifiers.ctrl}})}}class oT extends sT.EventEmitter{constructor(n,s,i,r=!1){super(),Xe(this,"name"),Xe(this,"fallback"),Xe(this,"defaultKeyCombos"),Xe(this,"context"),Xe(this,"_keyCombos"),Xe(this,"_active"),Xe(this,"_pressed"),this.name=n,this.context=i,this.fallback=r,this.defaultKeyCombos=s,this._keyCombos=s.map(o=>rT(o)).filter(o=>o!==null),this._active=!0,this._pressed=!1}get active(){return this._active}set active(n){this._active=n,this._pressed&&(this._pressed=!1)}get keyCombos(){return this._keyCombos.map(n=>n&&n.sourceStr)}set keyCombos(n){!this.active&&n.length!==0&&(this.active=!0),n.length===0&&(this.active=!1),this._keyCombos=n.map(s=>rT(s)).filter(s=>s!==null)}get pressed(){return this._pressed}get usesDefaultKeyCombo(){return this.keyCombos.every((n,s)=>n===this.defaultKeyCombos[s])}_press(n,s){if(this._active)return n.handled=!0,this._pressed?this.emit("update",n,s.modifiers):(!this.emit("trigger",n,s.modifiers)&&!this.emit("start",n,s.modifiers)&&(n.handled=!1),n.handled&&(this._pressed=this.listeners("end").length!==0)),n.handled}end(){this._active&&(this._pressed=!1,this.emit("end"))}trigger(n,s){return this.shouldTrigger(n)&&this._press(s,n)}transitionTo(n,s,i){return n.canBeActive(s)?(n._pressed=!0,n._press(i,s),this._pressed=!1,!0):!1}shouldTrigger(n){return this.canBeActive(n)}canBeActive(n){return this._keyCombos.some(s=>s.shouldTrigger(n,this.fallback))}hasKeyCode(n){return this._keyCombos.some(s=>n===s.triggerKeyCode)}resetKeyCombo(){this.keyCombos=this.defaultKeyCombos}}var oc=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var e=0,n=arguments.length;n--;)e+=arguments[n]*arguments[n];return Math.sqrt(e)});function wv(){var e=new oc(6);return oc!=Float32Array&&(e[1]=0,e[2]=0,e[4]=0,e[5]=0),e[0]=1,e[3]=1,e}function aT(e,n,s,i,r,o,a){return e[0]=n,e[1]=s,e[2]=i,e[3]=r,e[4]=o,e[5]=a,e}function Dv(){var e=new oc(4);return oc!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function cT(e,n,s,i,r){return e[0]=n,e[1]=s,e[2]=i,e[3]=r,e}(function(){var e=Dv();return function(n,s,i,r,o,a){var c,l;for(s||(s=4),i||(i=0),r?l=Math.min(r*s+i,n.length):l=n.length,c=i;c<l;c+=s)e[0]=n[c],e[1]=n[c+1],e[2]=n[c+2],e[3]=n[c+3],o(e,e,a),n[c]=e[0],n[c+1]=e[1],n[c+2]=e[2],n[c+3]=e[3];return n}})();function Lv(){var e=new oc(2);return oc!=Float32Array&&(e[0]=0,e[1]=0),e}function lT(e,n,s){return e[0]=n,e[1]=s,e}(function(){var e=Lv();return function(n,s,i,r,o,a){var c,l;for(s||(s=2),i||(i=0),r?l=Math.min(r*s+i,n.length):l=n.length,c=i;c<l;c+=s)e[0]=n[c],e[1]=n[c+1],o(e,e,a),n[c]=e[0],n[c+1]=e[1];return n}})();const ac=1e-4;wv();function Hn(e){return e==null}function Jt(e){return!Hn(e)}function Mi(e){return typeof e=="number"}function Mv(e,n,s=ac){const i=e[0],r=e[1],o=n[0],a=n[1];return Math.abs(i-o)<=s*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(r-a)<=s*Math.max(1,Math.abs(r),Math.abs(a))}function Pv(e,n,s=ac){const i=e[0],r=e[1],o=e[2],a=e[3],c=n[0],l=n[1],h=n[2],d=n[3];return Math.abs(i-c)<=s*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(r-l)<=s*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(o-h)<=s*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(a-d)<=s*Math.max(1,Math.abs(a),Math.abs(d))}function bv(e,n,s=ac){const i=e[0],r=e[1],o=e[2],a=e[3],c=e[4],l=e[5],h=n[0],d=n[1],p=n[2],E=n[3],g=n[4],T=n[5];return Math.abs(i-h)<=s*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(r-d)<=s*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(o-p)<=s*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(a-E)<=s*Math.max(1,Math.abs(a),Math.abs(E))&&Math.abs(c-g)<=s*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(l-T)<=s*Math.max(1,Math.abs(l),Math.abs(T))}function Uv(e,n){return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=0,e[5]=0,e}class Oo extends Float32Array{constructor(n,s){super(2),typeof n=="number"&&typeof s=="number"?lT(this,n,s):this.copy(n)}copy(n){if(Hn(n))return;let s=Jt(n[0])?n[0]:n.x;Hn(s)&&(s=n.width);let i=Jt(n[1])?n[1]:n.y;if(Hn(i)&&(i=n.height),Mi(s)&&Mi(i))lT(this,s,i);else throw new Error("Trying to copy NaN to Vector2");return this}eq(n,s=ac){if(Hn(n))return!1;let i=Jt(n[0])?n[0]:n.x;Hn(i)&&(i=n.width);let r=Jt(n[1])?n[1]:n.y;return Hn(r)&&(r=n.height),Mv(this,[i,r],s)}get x(){return this[0]}set x(n){if(isNaN(n))throw new Error("Trying to assign NaN to x component of Vector2");this[0]=n}get y(){return this[1]}set y(n){if(isNaN(n))throw new Error("Trying to assign NaN to y component of Vector2");this[1]=n}get width(){return this[0]}set width(n){if(isNaN(n))throw new Error("Trying to assign NaN to width component of Vector2");this[0]=n}get height(){return this[1]}set height(n){if(isNaN(n))throw new Error("Trying to assign NaN to height component of Vector2");this[1]=n}}Oo.ZERO=new Oo(0,0),Oo.ONE=new Oo(1,1);var hT;(function(e){e.PERSONAL="u",e.TEAM="t"})(hT||(hT={}));var uT;(function(e){e.BASE="bs",e.ELEMENT="el",e.PROPERTY_COMPONENT="pc",e.INTERACTION_MANAGER_COMPONENT="im",e.LAYER="ly",e.MESH="ms",e.TRANSITION_MANAGER_COMPONENT="tm",e.ELEMENT_INTERACTION="ei"})(uT||(uT={}));var dT;(function(e){e[e.PIXEL=0]="PIXEL",e[e.PERCENT=1]="PERCENT"})(dT||(dT={}));var fT;(function(e){e[e.PIXEL=0]="PIXEL",e[e.PERCENT=1]="PERCENT"})(fT||(fT={}));var pT;(function(e){e[e.PIXEL=0]="PIXEL",e[e.PERCENT=1]="PERCENT",e[e.INCH=2]="INCH",e[e.CM=3]="CM",e[e.MM=4]="MM"})(pT||(pT={}));var Qh;(function(e){e[e.PROPERTY=0]="PROPERTY",e[e.ENTITY=1]="ENTITY"})(Qh||(Qh={}));var hl;(function(e){e.BASE_CHANGES="BASE_CHANGES",e.DEFAULT_CHANGES="CHANGES",e.EDITOR_CHANGES="EDITOR_CHANGES",e.EFFECT_LIST_CHANGES="EFFECT_LIST_CHANGES",e.ELEMENT_INTERACTION_CHANGES="ELEMENT_INTERACTION_CHANGES",e.GROUP_ADD_CHILDREN="GROUP_ADD_CHILDREN",e.GROUP_REMOVE_CHILDREN="GROUP_REMOVE_CHILDREN",e.GUIDELINES_CHANGES="GUIDELINES_CHANGES",e.IMAGE_CHANGES="IMAGE_CHANGES",e.INTERACTION_CHANGES="INTERACTION_CHANGES",e.KFINFO_CHANGES="KFINFO_CHANGES",e.LAYER_LIST_CHANGES="LAYER_LIST_CHANGES",e.LIBRARY_CHANGES="LIBRARY_CHANGES",e.LOAD="LOAD",e.LOAD_START="LOAD_START",e.MESH_CHANGES="MESH_CHANGES",e.MODIFIER_KEY_CHANGES="MODIFIER_KEY_CHANGES",e.PRESET_LIST_CHANGES="PRESET_LIST_CHANGES",e.PROPERTY_PANEL_UPDATE_NEEDED="PROPERTY_PANEL_UPDATE_NEEDED",e.SCENE_TREE_CHANGES="SCENE_TREE_CHANGES",e.SELECT="SELECT",e.SELECT_CELL="SELECT_CELL",e.TRANSACTION="TRANSACTION",e.TRIGGER_VECTOR_FORCE_UPDATE="TRIGGER_VECTOR_FORCE_UPDATE",e.UI_STATE_CHANGES="UI_STATE_CHANGES",e.WORKSPACE_CHANGE="WORKSPACE_CHANGE",e.WORKSPACE_CHANGE_WATCH="WORKSPACE_CHANGE_WATCH",e.WORKSPACE_LIST_CHANGES="WORKSPACE_LIST_CHANGES",e.SELECT_TEXT_RANGE="SELECT_TEXT_RANGE",e.DATA_STORE_CLEAR="DATA_STORE_CLEAR",e.VIEWPORT_ZOOM_CHANGE="VIEWPORT_ZOOM_CHANGE",e.UNDO_CHECKPOINT_CROSSED="UNDO_CHECKPOINT_CROSSED",e.VIEWPORT_RESIZE="VIEWPORT_RESIZE"})(hl||(hl={}));var ET;(function(e){e[e.SOLID=0]="SOLID",e[e.LINEAR=1]="LINEAR",e[e.RADIAL=2]="RADIAL",e[e.ANGULAR=3]="ANGULAR",e[e.DIAMOND=4]="DIAMOND",e[e.SHAPE=5]="SHAPE",e[e.ACROSS=6]="ACROSS",e[e.ALONG=7]="ALONG"})(ET||(ET={}));var gT;(function(e){e[e.TOP=0]="TOP",e[e.BOTTOM=1]="BOTTOM",e[e.MIDDLE=2]="MIDDLE"})(gT||(gT={}));var _T;(function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e[e.CENTER=2]="CENTER",e[e.JUSTIFIED=3]="JUSTIFIED"})(_T||(_T={}));var TT;(function(e){e[e.NORMAL=0]="NORMAL",e[e.UPPER=1]="UPPER",e[e.LOWER=2]="LOWER",e[e.TITLE=3]="TITLE"})(TT||(TT={}));var AT;(function(e){e[e.NORMAL=0]="NORMAL",e[e.SUPERSCRIPT=1]="SUPERSCRIPT",e[e.SUBSCRIPT=2]="SUBSCRIPT"})(AT||(AT={}));var mT;(function(e){e[e.LTR=0]="LTR",e[e.RTL=1]="RTL"})(mT||(mT={}));var OT;(function(e){e[e.AUTO_WIDTH=0]="AUTO_WIDTH",e[e.AUTO_HEIGHT=1]="AUTO_HEIGHT",e[e.FIXED=2]="FIXED"})(OT||(OT={}));var IT;(function(e){e[e.SOLID=0]="SOLID",e[e.IMAGE=1]="IMAGE",e[e.GRADIENT_LINEAR=2]="GRADIENT_LINEAR",e[e.GRADIENT_RADIAL=3]="GRADIENT_RADIAL",e[e.GRADIENT_ANGULAR=4]="GRADIENT_ANGULAR",e[e.GRADIENT_DIAMOND=5]="GRADIENT_DIAMOND"})(IT||(IT={}));var ST;(function(e){e[e.PASS_THROUGH=0]="PASS_THROUGH",e[e.NORMAL=1]="NORMAL",e[e.DARKEN=2]="DARKEN",e[e.MULTIPLY=3]="MULTIPLY",e[e.COLOR_BURN=4]="COLOR_BURN",e[e.LIGHTEN=5]="LIGHTEN",e[e.SCREEN=6]="SCREEN",e[e.COLOR_DODGE=7]="COLOR_DODGE",e[e.OVERLAY=8]="OVERLAY",e[e.SOFT_LIGHT=9]="SOFT_LIGHT",e[e.HARD_LIGHT=10]="HARD_LIGHT",e[e.DIFFERENCE=11]="DIFFERENCE",e[e.EXCLUSION=12]="EXCLUSION",e[e.HUE=13]="HUE",e[e.SATURATION=14]="SATURATION",e[e.COLOR=15]="COLOR",e[e.LUMINOSITY=16]="LUMINOSITY",e[e.DIVIDE=17]="DIVIDE",e[e.ADD=18]="ADD",e[e.SUBTRACT=19]="SUBTRACT",e[e.DISSOLVE=20]="DISSOLVE"})(ST||(ST={}));var yT;(function(e){e[e.FILL=0]="FILL",e[e.STRETCH=1]="STRETCH",e[e.FIT=2]="FIT"})(yT||(yT={}));var CT;(function(e){e[e.TOP_LEFT=0]="TOP_LEFT",e[e.TOP=1]="TOP",e[e.TOP_RIGHT=2]="TOP_RIGHT",e[e.LEFT=3]="LEFT",e[e.CENTER=4]="CENTER",e[e.RIGHT=5]="RIGHT",e[e.BOTTOM_LEFT=6]="BOTTOM_LEFT",e[e.BOTTOM=7]="BOTTOM",e[e.BOTTOM_RIGHT=8]="BOTTOM_RIGHT"})(CT||(CT={}));var NT;(function(e){e[e.NORMAL=0]="NORMAL",e[e.SPACE=1]="SPACE"})(NT||(NT={}));var xT;(function(e){e[e.ZERO=0]="ZERO",e[e.NINETY=1]="NINETY",e[e.ONE_EIGHTY=2]="ONE_EIGHTY",e[e.TWO_SEVENTY=3]="TWO_SEVENTY"})(xT||(xT={}));var vT;(function(e){e[e.INSIDE=0]="INSIDE",e[e.CENTER=1]="CENTER",e[e.OUTSIDE=2]="OUTSIDE"})(vT||(vT={}));var RT;(function(e){e[e.NONE=0]="NONE",e[e.ROUND=1]="ROUND",e[e.LINE_ARROW=2]="LINE_ARROW",e[e.TRIANGLE_ARROW_SOLID=3]="TRIANGLE_ARROW_SOLID",e[e.TRIANGLE_ARROW_OUTLINE=4]="TRIANGLE_ARROW_OUTLINE",e[e.CIRCLE_SOLID=5]="CIRCLE_SOLID",e[e.CIRCLE_OUTLINE=6]="CIRCLE_OUTLINE",e[e.SQUARE_SOLID=7]="SQUARE_SOLID",e[e.SQUARE_OUTLINE=8]="SQUARE_OUTLINE"})(RT||(RT={}));var wT;(function(e){e[e.MITER=0]="MITER",e[e.CONCAVE=1]="CONCAVE",e[e.ROUND=2]="ROUND",e[e.BEVEL=3]="BEVEL",e[e.NONE=4]="NONE"})(wT||(wT={}));var DT;(function(e){e[e.STRAIGHT=0]="STRAIGHT",e[e.ROUND=1]="ROUND"})(DT||(DT={}));var LT;(function(e){e[e.HORIZONTAL=0]="HORIZONTAL",e[e.VERTICAL=1]="VERTICAL"})(LT||(LT={}));var MT;(function(e){e[e.NONE=0]="NONE",e[e.UNION=1]="UNION",e[e.SUBTRACT=2]="SUBTRACT",e[e.INTERSECT=3]="INTERSECT",e[e.DIFFERENCE=4]="DIFFERENCE"})(MT||(MT={}));var PT;(function(e){e[e.DOCUMENT=0]="DOCUMENT",e[e.DATA_STORE=1]="DATA_STORE",e[e.SELECTION=2]="SELECTION",e[e.WATCHER=3]="WATCHER",e[e.WORKSPACE=4]="WORKSPACE",e[e.ELEMENT=5]="ELEMENT",e[e.GEOMETRY=6]="GEOMETRY",e[e.ELEMENT_COMPONENT=7]="ELEMENT_COMPONENT",e[e.PROP_COMPONENT=8]="PROP_COMPONENT",e[e.LAYER=9]="LAYER",e[e.BASE=10]="BASE",e[e.COMPUTED_STYLE=11]="COMPUTED_STYLE",e[e.COMPUTED_LAYER=12]="COMPUTED_LAYER",e[e.IMAGE_RESOURCE=13]="IMAGE_RESOURCE",e[e.IMAGE_EXPORT=14]="IMAGE_EXPORT",e[e.IMAGE_PRESET=15]="IMAGE_PRESET",e[e.EFFECT=16]="EFFECT",e[e.COMPUTED_EFFECT=17]="COMPUTED_EFFECT"})(PT||(PT={}));var bT;(function(e){e[e.TEXT=0]="TEXT",e[e.PATH=1]="PATH",e[e.GROUP=2]="GROUP",e[e.CONTAINER=3]="CONTAINER",e[e.GEOMETRY_GROUP=4]="GEOMETRY_GROUP",e[e.SCREEN=5]="SCREEN",e[e.BOOLEAN_CONTAINER=6]="BOOLEAN_CONTAINER",e[e.MASK_CONTAINER=7]="MASK_CONTAINER",e[e.NORMAL_GROUP=8]="NORMAL_GROUP"})(bT||(bT={}));var UT;(function(e){e[e.ELEMENT=0]="ELEMENT",e[e.COMPONENT=1]="COMPONENT"})(UT||(UT={}));var GT;(function(e){e[e.CONTAINER=3]="CONTAINER",e[e.MASK_CONTAINER=7]="MASK_CONTAINER",e[e.BOOLEAN_CONTAINER=6]="BOOLEAN_CONTAINER",e[e.NORMAL_GROUP=8]="NORMAL_GROUP"})(GT||(GT={}));var FT;(function(e){e[e.RECTANGLE=0]="RECTANGLE",e[e.ELLIPSE=1]="ELLIPSE",e[e.POLYGON=2]="POLYGON",e[e.REGULAR_POLYGON=3]="REGULAR_POLYGON",e[e.STAR=4]="STAR",e[e.LINE=5]="LINE",e[e.TEXT=6]="TEXT"})(FT||(FT={}));var kT;(function(e){e[e.TRANSLATE=0]="TRANSLATE",e[e.DIMENSIONS=1]="DIMENSIONS",e[e.ROTATION=2]="ROTATION",e[e.OPACITY=3]="OPACITY",e[e.FILL=4]="FILL",e[e.STROKE=5]="STROKE",e[e.SHADOW=6]="SHADOW",e[e.INNER_SHADOW=7]="INNER_SHADOW",e[e.FONT=8]="FONT",e[e.TEXT_ALIGNMENT=9]="TEXT_ALIGNMENT",e[e.TEXT_DECORATION=10]="TEXT_DECORATION",e[e.TEXT_DIRECTION=11]="TEXT_DIRECTION",e[e.TEXT_SPACING=12]="TEXT_SPACING",e[e.SCALE=13]="SCALE",e[e.SKEW=14]="SKEW",e[e.ORIGIN=15]="ORIGIN",e[e.OVERFLOW=16]="OVERFLOW",e[e.BLUR_GAUSSIAN=17]="BLUR_GAUSSIAN",e[e.PAINT=18]="PAINT",e[e.IMAGE=19]="IMAGE",e[e.CORNER_RADIUS=20]="CORNER_RADIUS",e[e.CONTENT_ANCHOR=21]="CONTENT_ANCHOR",e[e.EFFECT=22]="EFFECT",e[e.REFERENCE_POINT=23]="REFERENCE_POINT"})(kT||(kT={}));var BT;(function(e){e[e.FILL=4]="FILL",e[e.STROKE=5]="STROKE",e[e.SHADOW=6]="SHADOW",e[e.INNER_SHADOW=7]="INNER_SHADOW"})(BT||(BT={}));var VT;(function(e){e[e.FONT=8]="FONT",e[e.TEXT_ALIGNMENT=9]="TEXT_ALIGNMENT",e[e.TEXT_DECORATION=10]="TEXT_DECORATION",e[e.TEXT_DIRECTION=11]="TEXT_DIRECTION"})(VT||(VT={}));var HT;(function(e){e[e.SCALE=13]="SCALE",e[e.SKEW=14]="SKEW",e[e.BLUR_GAUSSIAN=17]="BLUR_GAUSSIAN"})(HT||(HT={}));var WT;(function(e){e[e.FILL=4]="FILL",e[e.STROKE=5]="STROKE",e[e.SHADOW=6]="SHADOW",e[e.INNER_SHADOW=7]="INNER_SHADOW"})(WT||(WT={}));var YT;(function(e){e[e.VERTEX=0]="VERTEX",e[e.EDGE=1]="EDGE",e[e.CONTOUR=2]="CONTOUR"})(YT||(YT={}));var XT;(function(e){e[e.NONE=0]="NONE",e[e.ANGLE=1]="ANGLE",e[e.ANGLE_AND_LENGTH=2]="ANGLE_AND_LENGTH",e[e.INDEPENDENT=3]="INDEPENDENT"})(XT||(XT={}));var zT;(function(e){e[e.TRIM_PATH=0]="TRIM_PATH"})(zT||(zT={}));var KT;(function(e){e[e.SIMULTANEOUSLY=0]="SIMULTANEOUSLY",e[e.INDIVIDUALLY=1]="INDIVIDUALLY"})(KT||(KT={}));var QT;(function(e){e[e.ACTION=0]="ACTION",e[e.RESPONSE=1]="RESPONSE",e[e.TRIGGER=2]="TRIGGER",e[e.CONDITION=3]="CONDITION",e[e.ELEMENT_TRACK=4]="ELEMENT_TRACK",e[e.PROPERTY_TRACK=5]="PROPERTY_TRACK",e[e.KEY_FRAME=6]="KEY_FRAME",e[e.ANIMATION_PRESET=7]="ANIMATION_PRESET",e[e.TRANSFER=8]="TRANSFER"})(QT||(QT={}));var ZT;(function(e){e[e.START=0]="START",e[e.DURING=1]="DURING",e[e.END=2]="END",e[e.START_AND_END=3]="START_AND_END"})(ZT||(ZT={}));var qT;(function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e[e.MULTI=2]="MULTI"})(qT||(qT={}));var jT;(function(e){e.A="A",e.B="B",e.C="C",e.D="D",e.E="E",e.F="F",e.G="G",e.H="H",e.I="I",e.J="J",e.K="K",e.L="L",e.M="M",e.N="N",e.O="O",e.P="P",e.Q="Q",e.R="R",e.S="S",e.T="T",e.U="U",e.V="V",e.W="W",e.X="X",e.Y="Y",e.Z="Z",e.NUM_0="0",e.NUM_1="1",e.NUM_2="2",e.NUM_3="3",e.NUM_4="4",e.NUM_5="5",e.NUM_6="6",e.NUM_7="7",e.NUM_8="8",e.NUM_9="9"})(jT||(jT={}));var JT;(function(e){e[e.CLICK=0]="CLICK",e[e.DOUBLE_CLICK=1]="DOUBLE_CLICK",e[e.DRAG=2]="DRAG",e[e.EDGE_SWIPE=3]="EDGE_SWIPE",e[e.FORCE_TAP=4]="FORCE_TAP",e[e.HOVER=5]="HOVER",e[e.MOUSE_ENTER=6]="MOUSE_ENTER",e[e.MOUSE_LEAVE=7]="MOUSE_LEAVE",e[e.MOUSE_UP=8]="MOUSE_UP",e[e.MOUSE_DOWN=9]="MOUSE_DOWN",e[e.KEY_PRESS=10]="KEY_PRESS",e[e.LOAD=11]="LOAD",e[e.LONG_PRESS=12]="LONG_PRESS",e[e.MANY_CLICK=13]="MANY_CLICK",e[e.MOUSE_MOVE=14]="MOUSE_MOVE",e[e.PINCH=15]="PINCH",e[e.PRESS=16]="PRESS",e[e.ROTATE=17]="ROTATE",e[e.SCROLL=18]="SCROLL",e[e.SWIPE=19]="SWIPE"})(JT||(JT={}));var $T;(function(e){e[e.AND=0]="AND",e[e.OR=1]="OR"})($T||($T={}));var eA;(function(e){e[e.NONE=0]="NONE"})(eA||(eA={}));var tA;(function(e){e[e.EXPLICIT=0]="EXPLICIT",e[e.INITIAL=1]="INITIAL"})(tA||(tA={}));var nA;(function(e){e.EXPLICIT="EXPLICIT",e.INITIAL="INITIAL",e.TWEEN="TWEEN",e.NON_EDITABLE="NON_EDITABLE"})(nA||(nA={}));var sA;(function(e){e[e.ANY=0]="ANY",e[e.CLOCKWISE=1]="CLOCKWISE",e[e.COUNTERCLOCKWISE=2]="COUNTERCLOCKWISE",e[e.INWARD=3]="INWARD",e[e.OUTWARD=4]="OUTWARD",e[e.HORIZONTAL=5]="HORIZONTAL",e[e.VERTICAL=6]="VERTICAL",e[e.LEFT=7]="LEFT",e[e.RIGHT=8]="RIGHT",e[e.UP=9]="UP",e[e.DOWN=10]="DOWN",e[e.START=11]="START",e[e.END=12]="END"})(sA||(sA={}));var iA;(function(e){e[e.LINEAR=0]="LINEAR",e[e.EASE=1]="EASE",e[e.EASE_IN=2]="EASE_IN",e[e.EASE_OUT=3]="EASE_OUT",e[e.EASE_IN_OUT=4]="EASE_IN_OUT",e[e.EASE_IN_SIN=5]="EASE_IN_SIN",e[e.EASE_OUT_SINE=6]="EASE_OUT_SINE",e[e.EASE_IN_OUT_SINE=7]="EASE_IN_OUT_SINE",e[e.EASE_IN_QUAD=8]="EASE_IN_QUAD",e[e.EASE_OUT_QUAD=9]="EASE_OUT_QUAD",e[e.EASE_IN_OUT_QUAD=10]="EASE_IN_OUT_QUAD",e[e.EASE_IN_CUBIC=11]="EASE_IN_CUBIC",e[e.EASE_OUT_CUBIC=12]="EASE_OUT_CUBIC",e[e.EASE_IN_OUT_CUBIC=13]="EASE_IN_OUT_CUBIC",e[e.EASE_IN_QUART=14]="EASE_IN_QUART",e[e.EASE_OUT_QUART=15]="EASE_OUT_QUART",e[e.EASE_IN_OUT_QUART=16]="EASE_IN_OUT_QUART",e[e.EASE_IN_QUINT=17]="EASE_IN_QUINT",e[e.EASE_OUT_QUINT=18]="EASE_OUT_QUINT",e[e.EASE_IN_OUT_QUINT=19]="EASE_IN_OUT_QUINT",e[e.EASE_IN_EXPO=20]="EASE_IN_EXPO",e[e.EASE_OUT_EXPO=21]="EASE_OUT_EXPO",e[e.EASE_IN_OUT_EXPO=22]="EASE_IN_OUT_EXPO",e[e.EASE_IN_CIRC=23]="EASE_IN_CIRC",e[e.EASE_OUT_CIRC=24]="EASE_OUT_CIRC",e[e.EASE_IN_OUT_CIRC=25]="EASE_IN_OUT_CIRC",e[e.EASE_IN_BACK=26]="EASE_IN_BACK",e[e.EASE_OUT_BACK=27]="EASE_OUT_BACK",e[e.EASE_IN_OUT_BACK=28]="EASE_IN_OUT_BACK",e[e.CUSTOM=29]="CUSTOM",e[e.STEP=30]="STEP",e[e.STEP_START=31]="STEP_START",e[e.STEP_MIDDLE=32]="STEP_MIDDLE",e[e.STEP_END=33]="STEP_END",e[e.STEP_CUSTOM=34]="STEP_CUSTOM",e[e.HOP_IN=35]="HOP_IN",e[e.HOP_OUT=36]="HOP_OUT",e[e.HOP_IN_OUT=37]="HOP_IN_OUT"})(iA||(iA={}));var rA;(function(e){e[e.START=0]="START",e[e.END=1]="END"})(rA||(rA={}));var oA;(function(e){e[e.FADE_IN=0]="FADE_IN",e[e.FADE_OUT=1]="FADE_OUT",e[e.MOVE_IN=2]="MOVE_IN",e[e.MOVE_OUT=3]="MOVE_OUT",e[e.SCALE_IN=4]="SCALE_IN",e[e.SCALE_OUT=5]="SCALE_OUT",e[e.SPIN_IN=6]="SPIN_IN",e[e.SPIN_OUT=7]="SPIN_OUT",e[e.TRIM_IN=8]="TRIM_IN",e[e.TRIM_OUT=9]="TRIM_OUT"})(oA||(oA={}));var aA;(function(e){e.ELEMENT_LIST="element_list",e.ACTION_LIST="action_list"})(aA||(aA={}));var cA;(function(e){e.EDITING="EDITING",e.VIEWING="VIEWING",e.INSPECTING="INSPECTING",e.VERSIONING="VERSIONING",e.PROTOTYPING="PROTOTYPING"})(cA||(cA={}));var lA;(function(e){e[e.SINGLE=0]="SINGLE",e[e.TABLE=1]="TABLE",e[e.SITEMAP=2]="SITEMAP"})(lA||(lA={}));var hA;(function(e){e[e.ELEMENT=0]="ELEMENT",e[e.SHAPE=1]="SHAPE",e[e.TEXT=2]="TEXT",e[e.MOTION_PATH=3]="MOTION_PATH"})(hA||(hA={}));var uA;(function(e){e[e.DESIGN=0]="DESIGN",e[e.ACTION=1]="ACTION"})(uA||(uA={}));var C;(function(e){e.DESIGN_MODE="DESIGN_MODE",e.ACTION_MODE="ACTION_MODE",e.PROTOTYPE_MODE="PROTOTYPE_MODE",e.INSPECT_MODE="INSPECT_MODE",e.VERSION_MODE="VERSION_MODE",e.VIEW_MODE="VIEW_MODE",e.SELECTOR_MODE="SELECTOR_MODE"})(C||(C={}));var dA;(function(e){e.EDITING_STATE="EDITING_STATE",e.VERSIONING_STATE="VERSIONING_STATE"})(dA||(dA={}));var fA;(function(e){e[e.SELECT=0]="SELECT",e[e.SCALE=1]="SCALE",e[e.HAND=2]="HAND",e[e.RECTANGLE=3]="RECTANGLE",e[e.ELLIPSE=4]="ELLIPSE",e[e.POLYGON=5]="POLYGON",e[e.STAR=6]="STAR",e[e.LINE=7]="LINE",e[e.ARROW=8]="ARROW",e[e.CONTAINER=9]="CONTAINER",e[e.PEN=10]="PEN",e[e.EYE_DROPPER=11]="EYE_DROPPER",e[e.COMMENT=12]="COMMENT",e[e.INSERT=13]="INSERT",e[e.PROTOTYPE=14]="PROTOTYPE",e[e.ADD_ACTION=15]="ADD_ACTION",e[e.TEXT=16]="TEXT"})(fA||(fA={}));var pA;(function(e){e[e.SELECT=0]="SELECT",e[e.SCALE=1]="SCALE"})(pA||(pA={}));var EA;(function(e){e[e.RECTANGLE=3]="RECTANGLE",e[e.ELLIPSE=4]="ELLIPSE",e[e.POLYGON=5]="POLYGON",e[e.STAR=6]="STAR",e[e.LINE=7]="LINE",e[e.ARROW=8]="ARROW",e[e.CONTAINER=9]="CONTAINER",e[e.PEN=10]="PEN",e[e.TEXT=16]="TEXT"})(EA||(EA={}));var gA;(function(e){e[e.TOP=0]="TOP",e[e.MIDDLE=1]="MIDDLE",e[e.BOTTOM=2]="BOTTOM",e[e.LEFT=3]="LEFT",e[e.CENTER=4]="CENTER",e[e.RIGHT=5]="RIGHT"})(gA||(gA={}));var _A;(function(e){e[e.HORIZONTAL=0]="HORIZONTAL",e[e.VERTICAL=1]="VERTICAL"})(_A||(_A={}));var TA;(function(e){e[e.IN_PROGRESS=0]="IN_PROGRESS",e[e.COMPLETED=1]="COMPLETED",e[e.SKIPPED=2]="SKIPPED"})(TA||(TA={}));var AA;(function(e){e[e.INITIAL=0]="INITIAL",e[e.WAITING=1]="WAITING",e[e.FINISHED=2]="FINISHED"})(AA||(AA={}));var mA;(function(e){e[e.GIF=0]="GIF",e[e.MP4=1]="MP4",e[e.LOTTIE=2]="LOTTIE",e[e.DOTLOTTIE=3]="DOTLOTTIE"})(mA||(mA={}));var OA;(function(e){e[e.ULTRA=0]="ULTRA",e[e.HIGH=1]="HIGH",e[e.MEDIUM=2]="MEDIUM",e[e.LOW=3]="LOW"})(OA||(OA={}));var IA;(function(e){e[e.IMPORT_LOTTIE_REMINDER_DIALOG_IN_ACTION=0]="IMPORT_LOTTIE_REMINDER_DIALOG_IN_ACTION",e[e.IMPORT_DOTLOTTIE_MULTIPLE_ANIMATIONS_DIALOG_IN_ACTION=1]="IMPORT_DOTLOTTIE_MULTIPLE_ANIMATIONS_DIALOG_IN_ACTION"})(IA||(IA={}));var SA;(function(e){e[e.CONTENT=0]="CONTENT",e[e.POSITION=1]="POSITION"})(SA||(SA={}));var yA;(function(e){e[e.STOP=0]="STOP",e[e.GRADIENT=1]="GRADIENT",e[e.HANDLE=2]="HANDLE",e[e.ASPECT_RATIO=3]="ASPECT_RATIO",e[e.REFERENCE=4]="REFERENCE"})(yA||(yA={}));var CA;(function(e){e[e.BOTH=0]="BOTH",e[e.HORIZONTAL=1]="HORIZONTAL",e[e.VERTICAL=2]="VERTICAL"})(CA||(CA={}));var NA;(function(e){e.GUEST="GUEST",e.MEMBER="MEMBER",e.ADMIN="ADMIN",e.OWNER="OWNER"})(NA||(NA={}));var Hf;(function(e){e.FROM_MESH_CHANGE="FROM_MESH_CHANGE",e.FROM_PARENT_EDIT="FROM_PARENT_EDIT",e.FROM_CHILDREN_CHANGE="FROM_CHILDREN_CHANGE",e.FROM_ANIMATION="FROM_ANIMATION",e.FROM_CHANGE_CONTAINER_TYPE="FROM_CHANGE_CONTAINER_TYPE",e.FROM_DRAG_DUPLICATE="FROM_DRAG_DUPLICATE",e.FROM_DATA_SYNC="FROM_DATA_SYNC",e.FROM_INTERACTION_CONTINUOUSLY_CHANGE="FROM_INTERACTION_CONTINUOUSLY_CHANGE",e.FROM_ELEMENT_CREATE="FROM_ELEMENT_CREATE",e.SHOW_SCOPE_CHANGE_MODAL="SHOW_SCOPE_CHANGE_MODAL",e.FROM_SYSTEM="FROM_SYSTEM",e.FROM_TEXT_EDIT="FROM_TEXT_EDIT"})(Hf||(Hf={}));var xA;(function(e){e.USER_EDITING="USER_EDITING",e.UNDO_REDO="UNDO_REDO",e.ANIMATING="ANIMATING",e.OTHER="OTHER"})(xA||(xA={}));var vA;(function(e){e[e.NONE=0]="NONE",e[e.UPDATE=1]="UPDATE",e[e.UPDATE_ALL=2]="UPDATE_ALL",e[e.UPDATE_NEED_BBOX_RECALC=3]="UPDATE_NEED_BBOX_RECALC",e[e.UPDATE_ALL_NEED_BBOX_RECALC=4]="UPDATE_ALL_NEED_BBOX_RECALC"})(vA||(vA={}));var RA;(function(e){e.NONE="NONE",e.ELEMENT="ELEMENT",e.RESIZE_HANDLE="RESIZE_HANDLE",e.ROTATE_HANDLE="ROTATE_HANDLE",e.GRADIENT_STOP_HANDLE="GRADIENT_STOP_HANDLE",e.GRADIENT_TRANSFORM_START_HANDLE="GRADIENT_TRANSFORM_START_HANDLE",e.GRADIENT_TRANSFORM_END_HANDLE="GRADIENT_TRANSFORM_END_HANDLE",e.GRADIENT_TRANSFORM_SHAPE_HANDLE="GRADIENT_TRANSFORM_SHAPE_HANDLE",e.GRADIENT_TRANSFORM_REFERENCE_LINE="GRADIENT_TRANSFORM_REFERENCE_LINE",e.SCROLLBAR="SCROLLBAR",e.CURVE_CONTROL="CURVE_CONTROL",e.VERTEX="VERTEX",e.ENDPOINT="ENDPOINT",e.EDGE="EDGE",e.ORIGIN="ORIGIN",e.MULTIPLE_SELECTION_BOUND="MULTIPLE_SELECTION_BOUND",e.MOTION_POINT="MOTION_POINT",e.MOTION_SEGMENT="MOTION_SEGMENT",e.RULER="RULER",e.GUIDELINE="GUIDELINE"})(RA||(RA={}));var wA;(function(e){e.ACTIVATE_ARROW_TOOL="ACTIVATE_ARROW_TOOL",e.ACTIVATE_COMMENT_TOOL="ACTIVATE_COMMENT_TOOL",e.ACTIVATE_CONTAINER_TOOL="ACTIVATE_CONTAINER_TOOL",e.ACTIVATE_EDIT_GRADIENT="ACTIVATE_EDIT_GRADIENT",e.ACTIVATE_ELLIPSE_TOOL="ACTIVATE_ELLIPSE_TOOL",e.ACTIVATE_EXCLUDE_TOOL="ACTIVATE_EXCLUDE_TOOL",e.ACTIVATE_EYE_DROPPER_TOOL="ACTIVATE_EYE_DROPPER_TOOL",e.ACTIVATE_GRADIENT_HANDLES_MODE="ACTIVATE_GRADIENT_HANDLES_MODE",e.ACTIVATE_HAND_TOOL="ACTIVATE_HAND_TOOL",e.ACTIVATE_INTERSECT_TOOL="ACTIVATE_INTERSECT_TOOL",e.ACTIVATE_LINE_TOOL="ACTIVATE_LINE_TOOL",e.ACTIVATE_PAN="ACTIVATE_PAN",e.ACTIVATE_PEN_TOOL="ACTIVATE_PEN_TOOL",e.ACTIVATE_POLYGON_TOOL="ACTIVATE_POLYGON_TOOL",e.ACTIVATE_RECTANGLE_TOOL="ACTIVATE_RECTANGLE_TOOL",e.ACTIVATE_SCALE_TOOL="ACTIVATE_SCALE_TOOL",e.ACTIVATE_SELECTOR_MODE="ACTIVATE_SELECTOR_MODE",e.ACTIVATE_SELECT_TOOL="ACTIVATE_SELECT_TOOL",e.ACTIVATE_SHAPE_MODE="ACTIVATE_SHAPE_MODE",e.ACTIVATE_STAR_TOOL="ACTIVATE_STAR_TOOL",e.ACTIVATE_SUBTRACT_TOOL="ACTIVATE_SUBTRACT_TOOL",e.ACTIVATE_TEXT_EDIT_MODE="ACTIVATE_TEXT_EDIT_MODE",e.ACTIVATE_TEXT_MODE="ACTIVATE_TEXT_MODE",e.ACTIVATE_TEXT_TOOL="ACTIVATE_TEXT_TOOL",e.ACTIVATE_UNION_TOOL="ACTIVATE_UNION_TOOL",e.ADD_ACTION="ADD_ACTION",e.ADD_LAYER="ADD_LAYER",e.ADD_NEW_GRADIENT_STOP="ADD_NEW_GRADIENT_STOP",e.ALIGN="ALIGN",e.ALL="*",e.APPEND_ELEMENT="APPEND_ELEMENT",e.BOOLEAN_GROUP_ELEMENTS="BOOLEAN_GROUP_ELEMENTS",e.BRING_TO_FRONT="BRING_TO_FRONT",e.CANCEL_EXPORT_MEDIA="CANCEL_EXPORT_MEDIA",e.CANCEL_SELECTOR_MODE="CANCEL_SELECTOR_MODE",e.CHANGE_TEXT_CARET="CHANGE_TEXT_CARET",e.CLOSE_MODAL="CLOSE_MODAL",e.COMMENT_DEACTIVATE_PAN="COMMENT_DEACTIVATE_PAN",e.CONFIRM_SELECTOR_MODE="CONFIRM_SELECTOR_MODE",e.CONVERT_ELEMENT_TO_CONTAINER="CONVERT_ELEMENT_TO_CONTAINER",e.CONVERT_ELEMENT_TO_GROUP="CONVERT_ELEMENT_TO_GROUP",e.CONVERT_ELEMENT_TO_PATH="CONVERT_ELEMENT_TO_PATH",e.CONVERT_SHAPE_TO_PATH="CONVERT_SHAPE_TO_PATH",e.COPY="COPY",e.CREATE_ELEMENT_W_DEFAULT_SIZE="CREATE_ELEMENT_W_DEFAULT_SIZE",e.CUT="CUT",e.DEACTIVATE_GRADIENT_HANDLES_MODE="DEACTIVATE_GRADIENT_HANDLES_MODE",e.DEACTIVATE_PAN="DEACTIVATE_PAN",e.DEACTIVATE_SELECTOR_MODE="DEACTIVATE_SELECTOR_MODE",e.DEACTIVATE_SHAPE_MODE="DEACTIVATE_SHAPE_MODE",e.DEACTIVATE_TEXT_EDIT_MODE="DEACTIVATE_TEXT_EDIT_MODE",e.DEACTIVATE_TEXT_MODE="DEACTIVATE_TEXT_MODE",e.DEACTIVATE_MOTION_PATH_MODE="DEACTIVATE_MOTION_PATH_MODE",e.DECREASE_CORNER_RADIUS="DECREASE_CORNER_RADIUS",e.DELETE_CELL="DELETE_CELL",e.DELETE_ELEMENT="DELETE_ELEMENT",e.DELETE_GRADIENT_STOP="DELETE_GRADIENT_STOP",e.DELETE_GUIDELINES="DELETE_GUIDELINES",e.DELETE_KEYFRAME="DELETE_KEYFRAME",e.DELETE_LAYER="DELETE_LAYER",e.DELETE_MOTION_POINT="DELETE_MOTION_POINT",e.DELETE_TEXT="DELETE_TEXT",e.DERECTLY_SELECT_GUIDE="DERECTLY_SELECT_GUIDE",e.DESELECT_CELL="DESELECT_CELL",e.DESELECT_ELEMENT="DESELECT_ELEMENT",e.DESELECT_KEYFRAME="DESELECT_KEYFRAME",e.DESELECT_MOTION_POINT="DESELECT_MOTION_POINT",e.DIRECTLY_SELECT_GUIDE="DIRECTLY_SELECT_GUIDE",e.DISTRIBUTE="DISTRIBUTE",e.DOUBLE_LEFT_CLICK="DOUBLE_LEFT_CLICK",e.DOWNLOAD_FILE="DOWNLOAD_FILE",e.DRAG_END="DRAG_END",e.DRAG_OVER="DRAG_OVER",e.DROP_WITH_FILES="DROP_WITH_FILES",e.DUPLICATE_CELL="DUPLICATE_CELL",e.DUPLICATE_ELEMENT="DUPLICATE_ELEMENT",e.DUPLICATE_KEYFRAME="DUPLICATE_KEYFRAME",e.EDIT_NEXT_TEXT_ELEMENT="EDIT_NEXT_TEXT_ELEMENT",e.EDIT_ORIGIN="EDIT_ORIGIN",e.EDIT_PREVIOUS_TEXT_ELEMENT="EDIT_PREVIOUS_TEXT_ELEMENT",e.EDIT_SELECTOR="EDIT_SELECTOR",e.END_AREA_SELECT_CELL="END_AREA_SELECT_CELL",e.END_AREA_SELECT_ELEMENT="END_AREA_SELECT_ELEMENT",e.END_CREATE_ELEMENT="END_CREATE_ELEMENT",e.END_CREATE_GUIDE="END_CREATE_GUIDE",e.END_DRAG_CELL="END_DRAG_CELL",e.END_DRAG_ELEMENT="END_DRAG_ELEMENT",e.END_DRAG_GRADIENT_HANDLE="END_DRAG_GRADIENT_HANDLE",e.END_DRAG_MOTION_POINT="END_DRAG_MOTION_POINT",e.END_DRAG_MOTION_SEGMENT="END_DRAG_MOTION_SEGMENT",e.END_DRAG_MULTI_ELEMENTS="END_DRAG_MULTI_ELEMENTS",e.END_DRAG_ORIGIN="END_DRAG_ORIGIN",e.END_DRAG_SCROLLBAR="END_DRAG_SCROLLBAR",e.END_DRAW_PATH="END_DRAW_PATH",e.END_DRAW_PATH_ON_EDGE="END_DRAW_PATH_ON_EDGE",e.END_DRAW_PATH_ON_VERTEX="END_DRAW_PATH_ON_VERTEX",e.END_EXPAND_TEXT_SELECTION="END_EXPAND_TEXT_SELECTION",e.END_LEFT_CLICK_MOVE="END_LEFT_CLICK_MOVE",e.END_MOVE_GUIDE="END_MOVE_GUIDE",e.END_MOVE_GUIDE_WO_SELECT="END_MOVE_GUIDE_WO_SELECT",e.END_MOVE_SCROLLBAR="END_MOVE_SCROLLBAR",e.END_MOVE_TEXT_CARET="END_MOVE_TEXT_CARET",e.END_PANNING="END_PANNING",e.END_RESIZE_ELEMENT="END_RESIZE_ELEMENT",e.END_RIGHT_CLICK_MOVE="END_RIGHT_CLICK_MOVE",e.END_ROTATE_ELEMENT="END_ROTATE_ELEMENT",e.END_SCALE_ELEMENT="END_SCALE_ELEMENT",e.END_ZOOM_TO_SELECTION="END_ZOOM_TO_SELECTION",e.ENTER_PROTOTYPE_MODE="ENTER_PROTOTYPE_MODE",e.ENTER_PROTOTYPE_MODE_FULL_SCREEN="ENTER_PROTOTYPE_MODE_FULL_SCREEN",e.EXIT_EDITOR="EXIT_EDITOR",e.EXIT_PROTOTYPE_MODE="EXIT_PROTOTYPE_MODE",e.EXPAND_TEXT_SELECTION="EXPAND_TEXT_SELECTION",e.EXPAND_TEXT_SELECTION_KEY="EXPAND_TEXT_SELECTION_KEY",e.EXPAND_TEXT_SELECTION_TO_LINE_START="EXPAND_TEXT_SELECTION_TO_LINE_START",e.EXPAND_TEXT_SELECTION_TO_NEXT_WORD_KEY="EXPAND_TEXT_SELECTION_TO_NEXT_WORD_KEY",e.EXPAND_TEXT_SELECTION_TO_TEXT_START="EXPAND_TEXT_SELECTION_TO_TEXT_START",e.EXPORT_FINISH="EXPORT_FINISH",e.EXPORT_MEDIA="EXPORT_MEDIA",e.EXPORT_PROGRESS="EXPORT_PROGRESS",e.GROUP_ELEMENTS="GROUP_ELEMENTS",e.HOVER_BOX_HANDLE="HOVER_BOX_HANDLE",e.HOVER_CELL="HOVER_CELL",e.HOVER_CELL_WITH_SELECTION="HOVER_CELL_WITH_SELECTION",e.HOVER_CREATE_PATH="HOVER_CREATE_PATH",e.HOVER_DEEP_ELEMENT="HOVER_DEEP_ELEMENT",e.HOVER_ELEMENT="HOVER_ELEMENT",e.HOVER_GRADIENT_HANDLE="HOVER_GRADIENT_HANDLE",e.HOVER_GUIDELINE="HOVER_GUIDELINE",e.HOVER_MOTION_POINT="HOVER_MOTION_POINT",e.HOVER_MOTION_SEGMENT="HOVER_MOTION_SEGMENT",e.HOVER_ORIGIN="HOVER_ORIGIN",e.HOVER_RULER="HOVER_RULER",e.HOVER_SCROLLBAR="HOVER_SCROLLBAR",e.INCREASE_CORNER_RADIUS="INCREASE_CORNER_RADIUS",e.INSERT_ELEMENT="INSERT_ELEMENT",e.INSERT_IMAGE="INSERT_IMAGE",e.INSERT_SVG="INSERT_SVG",e.LEAVE_VERSION_PREVIEW="LEAVE_VERSION_PREVIEW",e.MAC_ZOOM_TO_POINTER="MAC_ZOOM_TO_POINTER",e.MASK_GROUP_ELEMENTS="MASK_GROUP_ELEMENTS",e.MOBILE_PINCH_ZOOM_TO_POINTER="MOBILE_PINCH_ZOOM_TO_POINTER",e.MOBILE_TOUCH_PAN="MOBILE_TOUCH_PAN",e.MOVE_BACKWARD="MOVE_BACKWARD",e.MOVE_CELL_SELECTION_KEY="MOVE_CELL_SELECTION_KEY",e.MOVE_ELEMENT_SELECTION_KEY="MOVE_ELEMENT_SELECTION_KEY",e.MOVE_FORWARD="MOVE_FORWARD",e.MOVE_GRADIENT_HANDLE_KEY="MOVE_GRADIENT_HANDLE_KEY",e.MOVE_MOTION_POINTS_SELECTION_KEY="MOVE_MOTION_POINTS_SELECTION_KEY",e.MOVE_TEXT_CARET_KEY="MOVE_TEXT_CARET_KEY",e.MOVE_TEXT_CARET_TO_LINE_START="MOVE_TEXT_CARET_TO_LINE_START",e.MOVE_TEXT_CARET_TO_NEXT_WORD_KEY="MOVE_TEXT_CARET_TO_NEXT_WORD_KEY",e.MOVE_TEXT_CARET_TO_TEXT_START="MOVE_TEXT_CARET_TO_TEXT_START",e.MOVE_VIEWPORT_KEY="MOVE_VIEWPORT_KEY",e.MOVE_VIEWPORT_WHEEL="MOVE_VIEWPORT_WHEEL",e.OPEN_CANVAS_CONTEXT_MENU="OPEN_CANVAS_CONTEXT_MENU",e.OPEN_ELEMENT_CONTEXT_MENU="OPEN_ELEMENT_CONTEXT_MENU",e.PASTE="PASTE",e.PASTE_WITH_FILES="PASTE_WITH_FILES",e.PAUSE_ANIMATION="PAUSE_ANIMATION",e.PLAY_ANIMATION="PLAY_ANIMATION",e.REDO="REDO",e.RENAME_ELEMENT="RENAME_ELEMENT",e.RESET_ANIMATION="RESET_ANIMATION",e.RESET_GRADIENT_STOP_ACTIVE_INDEX="RESET_GRADIENT_STOP_ACTIVE_INDEX",e.RESTART_PROTOTYPE="RESTART_PROTOTYPE",e.RESUME_TEXT_EDIT_MODE="RESUME_TEXT_EDIT_MODE",e.SELECT_ALL_CELLS="SELECT_ALL_CELLS",e.SELECT_ALL_ELEMENTS="SELECT_ALL_ELEMENTS",e.SELECT_ALL_MOTION_POINTS="SELECT_ALL_MOTION_POINTS",e.SELECT_ALL_TEXT="SELECT_ALL_TEXT",e.SELECT_CELL="SELECT_CELL",e.SELECT_CHILD_ELEMENT="SELECT_CHILD_ELEMENT",e.SELECT_ELEMENT="SELECT_ELEMENT",e.SELECT_FIRST_ELEMENT="SELECT_FIRST_ELEMENT",e.SELECT_GRADIENT_HANDLE="SELECT_GRADIENT_HANDLE",e.SELECT_MOTION_POINT="SELECT_MOTION_POINT",e.SELECT_NEXT_ELEMENT="SELECT_NEXT_ELEMENT",e.SELECT_PARENT_ELEMENT="SELECT_PARENT_ELEMENT",e.SELECT_PREVIOUS_ELEMENT="SELECT_PREVIOUS_ELEMENT",e.SEND_TO_BACK="SEND_TO_BACK",e.SET_CURSOR_OVERLAY="SET_CURSOR_OVERLAY",e.SET_LOCK_GUIDES="SET_LOCK_GUIDES",e.SHOW_CONFIRMATION="SHOW_CONFIRMATION",e.SHOW_NOTIFICATION="SHOW_NOTIFICATION",e.START_AREA_SELECT_CELL="START_AREA_SELECT_CELL",e.START_AREA_SELECT_ELEMENT="START_AREA_SELECT_ELEMENT",e.START_CREATE_ELEMENT="START_CREATE_ELEMENT",e.START_CREATE_GUIDE="START_CREATE_GUIDE",e.START_DRAG_CELL="START_DRAG_CELL",e.START_DRAG_ELEMENT="START_DRAG_ELEMENT",e.START_DRAG_GRADIENT_HANDLE="START_DRAG_GRADIENT_HANDLE",e.START_DRAG_MOTION_POINT="START_DRAG_MOTION_POINT",e.START_DRAG_MOTION_SEGMENT="START_DRAG_MOTION_SEGMENT",e.START_DRAG_MULTI_ELEMENTS="START_DRAG_MULTI_ELEMENTS",e.START_DRAG_ORIGIN="START_DRAG_ORIGIN",e.START_DRAG_SCROLLBAR="START_DRAG_SCROLLBAR",e.START_DRAW_PATH="START_DRAW_PATH",e.START_DRAW_PATH_ON_EDGE="START_DRAW_PATH_ON_EDGE",e.START_DRAW_PATH_ON_VERTEX="START_DRAW_PATH_ON_VERTEX",e.START_EXPAND_TEXT_SELECTION="START_EXPAND_TEXT_SELECTION",e.START_LEFT_CLICK_MOVE="START_LEFT_CLICK_MOVE",e.START_MOVE_GUIDE="START_MOVE_GUIDE",e.START_MOVE_GUIDE_WO_SELECT="START_MOVE_GUIDE_WO_SELECT",e.START_MOVE_SCROLLBAR="START_MOVE_SCROLLBAR",e.START_MOVE_TEXT_CARET="START_MOVE_TEXT_CARET",e.START_PANNING="START_PANNING",e.START_RESIZE_ELEMENT="START_RESIZE_ELEMENT",e.START_RIGHT_CLICK_MOVE="START_RIGHT_CLICK_MOVE",e.START_ROTATE_ELEMENT="START_ROTATE_ELEMENT",e.START_SCALE_ELEMENT="START_SCALE_ELEMENT",e.START_ZOOM_TO_SELECTION="START_ZOOM_TO_SELECTION",e.STOP_ANIMATION="STOP_ANIMATION",e.SWITCH_BEND_TOOL="SWITCH_BEND_TOOL",e.SWITCH_DOCUMENT_MODE="SWITCH_DOCUMENT_MODE",e.SWITCH_MODE="SWITCH_MODE",e.SWITCH_TEXT_ELEMENT="SWITCH_TEXT_ELEMENT",e.SWITCH_VIEW_MODE="SWITCH_VIEW_MODE",e.TEXT_INSERT_NEW_LINE="TEXT_INSERT_NEW_LINE",e.TOGGLE_ACTION_PANEL="TOGGLE_ACTION_PANEL",e.TOGGLE_CELL_SELECTION="TOGGLE_CELL_SELECTION",e.TOGGLE_COMMENT_VISIBILITY="TOGGLE_COMMENT_VISIBILITY",e.TOGGLE_EXPAND="TOGGLE_EXPAND",e.TOGGLE_INSPECTING="TOGGLE_INSPECTING",e.TOGGLE_INTERFACE="TOGGLE_INTERFACE",e.TOGGLE_LOCK="TOGGLE_LOCK",e.TOGGLE_ORIGIN="TOGGLE_ORIGIN",e.TOGGLE_PRESENCE="TOGGLE_PRESENCE",e.TOGGLE_RULER="TOGGLE_RULER",e.TOGGLE_SNAP_TO_OBJECT="TOGGLE_SNAP_TO_OBJECT",e.TOGGLE_SNAP_TO_PIXEL_GRID="TOGGLE_SNAP_TO_PIXEL_GRID",e.TOGGLE_VISIBLE="TOGGLE_VISIBLE",e.TRACKPAD_ZOOM_TO_POINTER="TRACKPAD_ZOOM_TO_POINTER",e.UNDO="UNDO",e.UNGROUP_ELEMENTS="UNGROUP_ELEMENTS",e.UPDATE_AREA_SELECT_CELL="UPDATE_AREA_SELECT_CELL",e.UPDATE_AREA_SELECT_ELEMENT="UPDATE_AREA_SELECT_ELEMENT",e.UPDATE_CREATE_ELEMENT="UPDATE_CREATE_ELEMENT",e.UPDATE_CREATE_GUIDE="UPDATE_CREATE_GUIDE",e.UPDATE_DRAG_CELL="UPDATE_DRAG_CELL",e.UPDATE_DRAG_ELEMENT="UPDATE_DRAG_ELEMENT",e.UPDATE_DRAG_GRADIENT_HANDLE="UPDATE_DRAG_GRADIENT_HANDLE",e.UPDATE_DRAG_MOTION_POINT="UPDATE_DRAG_MOTION_POINT",e.UPDATE_DRAG_MOTION_SEGMENT="UPDATE_DRAG_MOTION_SEGMENT",e.UPDATE_DRAG_MULTI_ELEMENTS="UPDATE_DRAG_MULTI_ELEMENTS",e.UPDATE_DRAG_ORIGIN="UPDATE_DRAG_ORIGIN",e.UPDATE_DRAG_SCROLLBAR="UPDATE_DRAG_SCROLLBAR",e.UPDATE_DRAW_PATH="UPDATE_DRAW_PATH",e.UPDATE_DRAW_PATH_ON_EDGE="UPDATE_DRAW_PATH_ON_EDGE",e.UPDATE_DRAW_PATH_ON_VERTEX="UPDATE_DRAW_PATH_ON_VERTEX",e.UPDATE_EXPAND_TEXT_SELECTION="UPDATE_EXPAND_TEXT_SELECTION",e.UPDATE_LEFT_CLICK_MOVE="UPDATE_LEFT_CLICK_MOVE",e.UPDATE_MOVE_GUIDE="UPDATE_MOVE_GUIDE",e.UPDATE_MOVE_GUIDE_WO_SELECT="UPDATE_MOVE_GUIDE_WO_SELECT",e.UPDATE_MOVE_SCROLLBAR="UPDATE_MOVE_SCROLLBAR",e.UPDATE_MOVE_TEXT_CARET="UPDATE_MOVE_TEXT_CARET",e.UPDATE_PANNING="UPDATE_PANNING",e.UPDATE_RESIZE_ELEMENT="UPDATE_RESIZE_ELEMENT",e.UPDATE_RIGHT_CLICK_MOVE="UPDATE_RIGHT_CLICK_MOVE",e.UPDATE_ROTATE_ELEMENT="UPDATE_ROTATE_ELEMENT",e.UPDATE_SCALE_ELEMENT="UPDATE_SCALE_ELEMENT",e.UPDATE_ZOOM_TO_SELECTION="UPDATE_ZOOM_TO_SELECTION",e.WHEEL_PAN_VIEWPORT="WHEEL_PAN_VIEWPORT",e.WHEEL_ZOOM_TO_POINTER="WHEEL_ZOOM_TO_POINTER",e.ZOOM_CENTER_SELECTION="ZOOM_CENTER_SELECTION",e.ZOOM_FIT_CONTENT="ZOOM_FIT_CONTENT",e.ZOOM_FIT_HEIGHT="ZOOM_FIT_HEIGHT",e.ZOOM_FIT_SELECTION="ZOOM_FIT_SELECTION",e.ZOOM_FIT_WIDTH="ZOOM_FIT_WIDTH",e.ZOOM_IN="ZOOM_IN",e.ZOOM_OUT="ZOOM_OUT",e.ZOOM_RESET="ZOOM_RESET",e.ZOOM_TO_POINTER="ZOOM_TO_POINTER",e.ZOOM_TO_VALUE="ZOOM_TO_VALUE"})(wA||(wA={}));var DA;(function(e){e.NONE="NONE",e.SCREEN="SCREEN",e.CONTAINER="CONTAINER",e.TEXT="TEXT",e.RECTANGLE="RECTANGLE",e.ELLIPSE="ELLIPSE",e.POLYGON="POLYGON",e.REGULAR_POLYGON="REGULAR_POLYGON",e.STAR="STAR",e.LINE="LINE",e.MULTIPLE="MULTIPLE"})(DA||(DA={}));class Zh extends Float32Array{constructor(n,s,i,r){super(4),typeof n=="number"&&typeof s=="number"&&typeof i=="number"&&typeof r=="number"?cT(this,n,s,i,r):this.copy(n)}copy(n){if(Hn(n))return;let s=Jt(n[0])?n[0]:n.x;Hn(s)&&(s=n.r);let i=Jt(n[1])?n[1]:n.y;Hn(i)&&(i=n.g);let r=Jt(n[2])?n[2]:n.z;Hn(r)&&(r=Jt(n.b)?n.b:n.width);let o=Jt(n[3])?n[3]:n.w;Hn(o)&&(o=Jt(n.a)?n.a:n.height),Mi(s)&&Mi(i)&&Mi(r)&&Mi(o)&&cT(this,s,i,r,o)}eq(n,s=ac){if(Hn(n))return!1;let i=Jt(n[0])?n[0]:n.x;Hn(i)&&(i=n.r);let r=Jt(n[1])?n[1]:n.y;Hn(r)&&(r=n.g);let o=Jt(n[2])?n[2]:n.z;Hn(o)&&(o=Jt(n.b)?n.b:n.width);let a=Jt(n[3])?n[3]:n.w;return Hn(a)&&(a=Jt(n.a)?n.a:n.height),Pv(this,[i,r,o,a],s)}get x(){return this[0]}set x(n){if(isNaN(n))throw new Error("Trying to assign NaN to x component of Vector4");this[0]=n}get y(){return this[1]}set y(n){if(isNaN(n))throw new Error("Trying to assign NaN to y component of Vector4");this[1]=n}get z(){return this[2]}set z(n){if(isNaN(n))throw new Error("Trying to assign NaN to z component of Vector4");this[2]=n}get w(){return this[3]}set w(n){if(isNaN(n))throw new Error("Trying to assign NaN to w component of Vector4");this[3]=n}get r(){return this[0]}set r(n){if(isNaN(n))throw new Error("Trying to assign NaN to r component of Vector4");this[0]=n}get g(){return this[1]}set g(n){if(isNaN(n))throw new Error("Trying to assign NaN to g component of Vector4");this[1]=n}get b(){return this[2]}set b(n){if(isNaN(n))throw new Error("Trying to assign NaN to b component of Vector4");this[2]=n}get a(){return this[3]}set a(n){if(isNaN(n))throw new Error("Trying to assign NaN to a component of Vector4");this[3]=n}get width(){return this[2]}set width(n){if(isNaN(n))throw new Error("Trying to assign NaN to width component of Vector4");this[2]=n}get height(){return this[3]}set height(n){if(isNaN(n))throw new Error("Trying to assign NaN to height component of Vector4");this[3]=n}}Zh.ZERO=new Zh(0,0,0,0),Zh.ONE=new Zh(1,1,1,1),Qh.PROPERTY+"",Qh.ENTITY+"";const Gv="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let Fv=(e=21)=>{let n="",s=crypto.getRandomValues(new Uint8Array(e|=0));for(;e--;)n+=Gv[s[e]&63];return n};const fa="default",LA=0,Wf="-",kv=["el","bs","pc","im","ly","ms","tm","ei"],Yf=(e,n,s)=>{if(e===fa)return`${n}`;const i=[];return e&&i.push(e),i.push(n),s&&i.push(s),i.join(Wf)},Bv=()=>{const e=kv.reduce((n,s)=>(n[s]=Yf(s,LA),n),{});return e[fa]=`${LA}`,e};class Vv{constructor(){this._counter=Bv(),this.suffixKey=Fv(4)}getCurrentCount(n){const s=this._getPrefixKey(n);return this._getNumber(s)}getIdBy(n){const s=this._getPrefixKey(n);return this._counter[s]}create(n){const s=this._getPrefixKey(n),i=this._getNumber(s);return this._counter[s]=Yf(s,i+1,this.suffixKey),this._counter[s]}load(n,s){const i=this._getPrefixKey(s),r=this._getNumber(i),o=this._getNumber(i,n),a=Math.max(r,o);this._counter[i]=Yf(i,a)}_getPrefixKey(n){return this._counter[n]?n:fa}_getNumber(n,s){if(s&&!this.isInCounter(s,n))return parseInt(this._counter[fa]);const i=this._getPrefixKey(n),r=s||this._counter[i],o=isNaN(Number(r))?this._counter[fa]:r,a=i===fa?o:r.split(Wf)[1];return parseInt(a)}isInCounter(n,s){if(!n||typeof n!="string"&&typeof n!="number")return!1;let i=n.toString();typeof n=="number"&&(i=`${n}`);const r=this._getPrefixKey(s);let o=i;if(r!==fa){const a=i.split(Wf);if(a.length<2||a[0]!==r)return!1;o=a[1]}return!isNaN(Number(o))}}new Vv,new Oo;class pa extends Float32Array{constructor(n,s,i,r,o,a){super(6),typeof n=="number"&&typeof s=="number"&&typeof i=="number"&&typeof r=="number"&&typeof o=="number"&&typeof a=="number"?(this[0]=n,this[1]=s,this[2]=i,this[3]=r,this[4]=o,this[5]=a):n?this.copy(n):(this[0]=1,this[3]=1)}fromArray(n){Hn(n)||aT(this,...n)}clone(){return new pa(...this)}copy(n){if(Hn(n))return;const s=Jt(n[0])?n[0]:n.a,i=Jt(n[1])?n[1]:n.b,r=Jt(n[2])?n[2]:n.c,o=Jt(n[3])?n[3]:n.d,a=Jt(n[4])?n[4]:n.tx,c=Jt(n[5])?n[5]:n.ty;return Mi(s)&&Mi(i)&&Mi(r)&&Mi(o)&&Mi(a)&&Mi(c)&&aT(this,s,i,r,o,a,c),this}eq(n,s=ac){if(Hn(n))return!1;const i=[Jt(n[0])?n[0]:n.a,Jt(n[1])?n[1]:n.b,Jt(n[2])?n[2]:n.c,Jt(n[3])?n[3]:n.d,Jt(n[4])?n[4]:n.tx,Jt(n[5])?n[5]:n.ty];return bv(this,i,s)}basis(){return Uv(new pa,this)}get a(){return this[0]}set a(n){this[0]=n}get b(){return this[1]}set b(n){this[1]=n}get c(){return this[2]}set c(n){this[2]=n}get d(){return this[3]}set d(n){this[3]=n}get tx(){return this[4]}set tx(n){this[4]=n}get ty(){return this[5]}set ty(n){this[5]=n}save(){return[this[0],this[1],this[2],this[3],this[4],this[5]]}}pa.IDENTITY=new pa,pa.ZERO=new pa(0,0,0,0,0,0),new Oo,new Oo,new Oo,Hf.FROM_DRAG_DUPLICATE;const MA=1e-5,PA=1e-8;function Dt(e=0,n=0){this.x=e,this.y=n,this._array=null}Dt.isOrthogonal=(e,n,s,i)=>Math.abs(e*s+n*i)<=Math.sqrt((e*e+n*n)*(s*s+i*i))*PA,Dt.isCollinear=(e,n,s,i)=>Math.abs(e*i-n*s)<=Math.sqrt((e*e+n*n)*(s*s+i*i))*PA,Dt.getThirds=function(e,n){const s=n.clone().subtract(e);return{oneThird:e.clone().add(s.clone().scale(1/3)),twoThirds:e.clone().add(s.clone().scale(2/3))}},Dt.prototype={constructor:Dt,get width(){return this.x},set width(e){this.x=e},set_width(e){this.x=e},get height(){return this.y},set height(e){this.y=e},set_height(e){this.y=e},set_x(e){this.x=e},set_y(e){this.y=e},as_array(e){if(!e&&!this._array)return this._array=[this.x,this.y],this._array;const n=e||this._array;return n[0]=this.x,n[1]=this.y,n},fromArray(e){return this.x=e[0],this.y=e[1],this},set(e=0,n=0){return this.x=e,this.y=n,this},copy(e){return this.x=e.x,this.y=e.y,this},mix_with(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this},clone(){return new Dt(this.x,this.y)},normalized(){return this.clone().normalize()},clamped(e){const n=this.length(),s=this.clone();return n>0&&e<n&&s.scale(e/n),s},rotated(e){return this.clone().rotate(e)},equals(e){const n=this.x,s=this.y,i=e.x,r=e.y;return Math.abs(n-i)<=MA*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(s-r)<=MA*Math.max(1,Math.abs(s),Math.abs(r))},exact_equals(e){return this.x===e.x&&this.y===e.y},add(e,n){return n===void 0?(this.x+=e.x,this.y+=e.y):(this.x+=e,this.y+=n),this},subtract(e,n){return n===void 0?(this.x-=e.x,this.y-=e.y):(this.x-=e,this.y-=n),this},sub(e,n){return n===void 0?(this.x-=e.x,this.y-=e.y):(this.x-=e,this.y-=n),this},multiply(e,n){return n===void 0?(this.x*=e.x,this.y*=e.y):(this.x*=e,this.y*=n),this},divide(e,n){return n===void 0?(this.x/=e.x,this.y/=e.y):(this.x/=e,this.y/=n),this},dot(e){return this.x*e.x+this.y*e.y},cross(e){return this.x*e.y-this.y*e.x},abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this},sign(){return this.x=Math.sign(this.x),this.y=Math.sign(this.y),this},ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},trunc(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this},clamp(e){const n=this.length();return n>0&&e<n&&this.scale(e/n),this},scale(e){return this.x*=e,this.y*=e,this},scale_with_center(e,n){return this.sub(n).scale(e).add(n),this},negate(){return this.x=-this.x,this.y=-this.y,this},inverse(){return this.x=1/this.x,this.y=1/this.y,this},swap(){const e=this.x;return this.x=this.y,this.y=e,this},normalize(){const e=this.x,n=this.y;let s=e*e+n*n;return s>0&&(s=1/Math.sqrt(s),this.x*=s,this.y*=s),this},rotate(e){const n=this.x,s=this.y,i=Math.cos(e),r=Math.sin(e);return this.x=n*i-s*r,this.y=n*r+s*i,this},perp(){const e=this.x;return this.x=this.y,this.y=-e,this},perp_inv(){const e=this.x;return this.x=-this.y,this.y=e,this},normal(e){return e.clone().sub(this).normalize().perp()},direction(e){return e.clone().sub(this).normalize()},plane_project(e,n){const s=this.clone();return n.clone().subtract(s.scale(this.dot(n)-e))},project(e){const n=this.dot(e)/e.length_squared();return this.x=n*e.x,this.y=n*e.y,this},project_n(e){const n=this.dot(e);return this.x=n*e.x,this.y=n*e.y,this},reflect(e){const n=this.dot(e);return this.x=2*e.x*n-this.x,this.y=2*e.y*n-this.y,this},bounce(e){return this.reflect(e).negate()},slide(e){return this.subtract(Hv.copy(e).scale(this.dot(e)))},length(){const e=this.x,n=this.y;return Math.sqrt(e*e+n*n)},length_squared(){const e=this.x,n=this.y;return e*e+n*n},angle(){return Math.atan2(this.y,this.x)},angle_to(e){return Math.atan2(this.cross(e),this.dot(e))},angle_to_2(e){let n=this.angle_to(e);return n<0&&(n+=2*Math.PI),n},angle_to_ccw(e){let n=Math.atan2(this.y,this.x)-Math.atan2(e.y,e.x);return n<0&&(n+=2*Math.PI),n},angle_to_point(e){return Math.atan2(this.y-e.y,this.x-e.x)},distance_to(e){const n=e.x-this.x,s=e.y-this.y;return Math.sqrt(n*n+s*s)},distance_squared_to(e){const n=e.x-this.x,s=e.y-this.y;return n*n+s*s},tangent(e=new Dt){return e.set(this.y,-this.x)},aspect(){return this.x/this.y},is_zero(e=null){return e?bA(this.x,e)&&bA(this.y,e):this.x===0&&this.y===0},isOrthogonal(e){return Dt.isOrthogonal(this.x,this.y,e.x,e.y)},isCollinear(e){return Dt.isCollinear(this.x,this.y,e.x,e.y)},linear_interpolate(e,n){return this.x+=n*(e.x-this.x),this.y+=n*(e.y-this.y),this},cubic_interpolate(e,n,s,i){const r=i*i,o=r*i;return new Dt(.5*(this.x*2+(-n.x+e.x)*i+(2*n.x-5*this.x+4*e.x-s.x)*r+(-n.x+3*this.x-3*e.x+s.x)*o),.5*(this.y*2+(-n.y+e.y)*i+(2*n.y-5*this.y+4*e.y-s.y)*r+(-n.y+3*this.y-3*e.y+s.y)*o))},valid(){return!isNaN(this.x)&&!isNaN(this.y)},isClose(e,n){return this.getDistance(e)<=n},getDistance(e,n=!1){const s=e.x-this.x,i=e.y-this.y,r=s*s+i*i;return n?r:Math.sqrt(r)},isInside(e){return e.contains(this.x,this.y)},angleToPoint(e){return Math.atan2(this.y-e.y,this.x-e.x)},distance(e){return Math.hypot(this.x-e.x,this.y-e.y)}};const bA=(e,n)=>e>=-n&&e<=n;Dt.ZERO=Object.freeze(new Dt(0,0)),Dt.ONE=Object.freeze(new Dt(1,1)),Dt.INF=Object.freeze(new Dt(1/0,1/0)),Dt.LEFT=Object.freeze(new Dt(-1,0)),Dt.RIGHT=Object.freeze(new Dt(1,0)),Dt.UP=Object.freeze(new Dt(0,-1)),Dt.DOWN=Object.freeze(new Dt(0,1));const Hv=new Dt,Xf=5,Wv=!1;class Yv{constructor(){this._enabled=Wv,this._logger={},this._reset()}help(){console.log(`stats.activate(): enable the frame monitoring
`),console.log(`stats.deactivate(): disable the frame monitoring
`),console.log(`stats.dump(): get the monitoring result
`),console.log(`stats.help(): show the usage of this tool
`)}activate(){this._reset(),this._enabled=!0,console.log("The frame monitoring utility is activated.")}deactivate(){this._reset(),this._enabled=!1,console.log("The frame monitoring utility is deactivated.")}has(n){const[s,i]=this._getMetricNames(n),r=this.metricGroups[s];return r?!!r[i]:!1}get(n){if(!this.has(n))throw new Error(`The metrics "${n}" does not exist`);const[s,i]=this._getMetricNames(n);return this.metricGroups[s][i]}begin(n){if(!this._enabled)return;const[s,i]=this._getMetricNames(n);this.metricGroups[s]||(this.metricGroups[s]={}),this.metricGroups[s][i]||(this.metricGroups[s][i]={frameCounter:0,deltaTime:0,maxDeltaTime:0,minDeltaTime:1/0,deltaTimeBuffer:new Array(Xf).fill(0),useSubTimer:!1}),this.metricGroups[s][i].beginTime=performance.now(),this.metricGroups[s][i].deltaTime=0,this.metricGroups[s][i].useSubTimer=!1}end(n){if(!this._enabled)return;const s=this.get(n);return s.useSubTimer||(s.deltaTime=performance.now()-s.beginTime),this._recalculateAvgMinMax(s),s.deltaTime}beginSub(n){if(!this._enabled)return;const s=this.get(n);s.useSubTimer=!0,s.beginTime=performance.now()}endSub(n){if(!this._enabled)return;const s=this.get(n);s.deltaTime+=performance.now()-s.beginTime}log(n,s){this._enabled&&(this._logger[n]=s)}_getMetricNames(n){const s=n.split("/");return s.length<=1?["_",s[0]]:[s[0],s[1]]}_recalculateAvgMinMax(n){n.deltaTimeBuffer[n.frameCounter++%Xf]=n.deltaTime,n.maxDeltaTime=Math.max(n.maxDeltaTime,n.deltaTime),n.minDeltaTime=Math.min(n.minDeltaTime,n.deltaTime),n.avgDeltaTime=n.deltaTimeBuffer.reduce((s,i)=>s+i,0)/Xf}_reset(){this.metricGroups={_:{}},this._logger={}}dump(){const n=this._logger;return Object.keys(this.metricGroups).reduce((s,i)=>{const r=this.metricGroups[i],o=Object.keys(r).reduce((a,c)=>a+r[c].avgDeltaTime,0);return s[i]=Object.keys(r).reduce((a,c)=>(a[c]={frames:r[c].frameCounter,avg:r[c].avgDeltaTime,min:r[c].minDeltaTime,max:r[c].maxDeltaTime,pct:100*(r[c].avgDeltaTime/o)},a),{}),s},n)}}const Xv=new Yv;typeof window<"u"&&(window.stats=Xv);const zf=new Set(["Alt","Shift","Modifier","Control"]),Ea={0:"LeftClick",1:"MiddleClick",2:"RightClick"},Kf=e=>{const n=e.target;if(!n||(n.tagName==="INPUT"||n.tagName==="TEXTAREA"||n.tagName==="BUTTON")&&(!n.classList.contains("input-system-handle-event")||n.classList.contains("input-system-no-handle")))return!0},zv=(e,n)=>{const s=e.clientX-n.clientX,i=e.clientY-n.clientY;return Math.sqrt(s*s+i*i)},Kv=(e,n)=>{const s=(e.clientX+n.clientX)/2,i=(e.clientY+n.clientY)/2;return new Dt(s,i)};class Qv extends sT.EventEmitter{constructor(n=window){super(),Xe(this,"_paused"),Xe(this,"_targetElement"),Xe(this,"_actions"),Xe(this,"_keys"),Xe(this,"_keyCode"),Xe(this,"_mouseKeyCode"),Xe(this,"_modifiers"),Xe(this,"_activeActionSet"),Xe(this,"_lastLeftClick"),Xe(this,"startPos"),Xe(this,"_touchId",null),Xe(this,"_activeTouches",new Map),Xe(this,"_pinchState",{active:!1,initialDistance:0,initialScale:1,center:new Dt,lastScale:1}),Xe(this,"_touchPanState",{active:!1,startPos:new Dt,lastPos:new Dt,threshold:10}),Xe(this,"_hoverElementsBoundsMap"),Xe(this,"_eventOpts"),Xe(this,"pressedMouseButton",null),Xe(this,"mousePos"),Xe(this,"wheelDelta"),Xe(this,"dataTransfer"),Xe(this,"event"),Xe(this,"ro"),Xe(this,"inputContext"),Xe(this,"handleVisibilityChange",()=>{this.releaseAllKeys()}),Xe(this,"handleMouseDown",s=>{const i=s;if(this._setMousePosition(i),this.startPos.x=i.clientX,this.startPos.y=i.clientY,i.button in Ea){const r=Ea[i.button];this.pressedMouseButton=i.button,this._mouseKeyCode=r,this._trigger(`${r}Down`,i),this._trigger(r,i)}}),Xe(this,"handleMouseMove",s=>{const i=s;this._setMousePosition(i);const r=s.target===this._targetElement;if(this.pressedMouseButton===null)this._mouseKeyCode=null,this._trigger("MouseMove",i,r);else{const o=Ea[this.pressedMouseButton];this._mouseKeyCode=`${o}Move`,this._trigger(`${o}Move`,i)}}),Xe(this,"handleKeyDown",s=>{if(!s.key||Kf(s))return;const i=this.preprocessKeyboardEvent(s);if(this.checkModifierState(s),this._keyCode=i,zf.has(i)){if(this._keyCode=null,s.repeat)return;this.emit(hl.MODIFIER_KEY_CHANGES,this._modifiers)}this._trigger(this._keyCode,s)}),Xe(this,"handleKeyUp",s=>{if(!s.key)return;const i=this.preprocessKeyboardEvent(s);this.checkModifierState(s),(this._keyCode===i||zf.has(i))&&(this._keyCode=null,zf.has(i)&&this.emit(hl.MODIFIER_KEY_CHANGES,this._modifiers)),this._trigger(this._keyCode,s)}),Xe(this,"handleMouseEnter",s=>{const i=s;this._setMousePosition(i);const r=i.target===this._targetElement;this._trigger("MouseEnter",i,r)}),Xe(this,"handleMouseLeave",s=>{const i=s;this._setMousePosition(i);const r=s.target===this._targetElement;this._trigger("MouseLeave",i,r)}),Xe(this,"handleMouseUp",s=>{if(this.pressedMouseButton!==s.button)return;this._setMousePosition(s),this.pressedMouseButton=null;const i=Ea[s.button],r=s.target===this._targetElement;if(this._mouseKeyCode=null,this._trigger(`${i}Up`,s,r),i==="LeftClick"){const o=performance.now();o-this._lastLeftClick.timestamp<500&&this._lastLeftClick.pos.equals(this.mousePos)?(this._lastLeftClick.timestamp=0,this._trigger("DoubleLeftClick",s,r)):(this._lastLeftClick.timestamp=o,this._lastLeftClick.pos.copy(this.mousePos))}}),Xe(this,"handleWheel",s=>{const i=s;if(this.checkModifierState(i),i.deltaX!==0){const r=Math.sign(i.deltaX)===1?"WheelXPositive":"WheelXNegative";this.wheelDelta.set(i.deltaX,0),this._trigger(r,i)}if(i.deltaY!==0){const r=Math.sign(i.deltaY)===1?"WheelYPositive":"WheelYNegative";this.wheelDelta.set(0,i.deltaY),this._trigger(r,i)}}),Xe(this,"handleTouchEnd",s=>{const i=s;if(this._pinchState.active&&i.targetTouches.length<2){this._pinchState.active=!1,this._activeTouches.clear();return}if(this._touchId===null)return;this._touchId=null,this._setMousePosition(i);const r=Ea[0];this.pressedMouseButton=null,this._keyCode=null,this._trigger(r,i,!0),this._touchPanState.active&&(this._touchPanState.active=!1,this._trigger("TouchPanEnd",i,!0))}),Xe(this,"handleTouchStart",s=>{var i;const r=s;if(r.targetTouches.length===2){this._updatePinchState(r);return}if(this._touchId!==null&&((i=this.handleTouchEnd)==null||i.call(this,r)),r.targetTouches.length!==1)return;this._touchId=r.targetTouches[0].identifier,this._setMousePosition(r),this._touchPanState.startPos.copy(this.mousePos),this._touchPanState.lastPos.copy(this.mousePos),this._touchPanState.active=!1,this.pressedMouseButton=0;const o=Ea[0];this._keyCode=o,this._trigger(o,r)}),Xe(this,"handleTouchMove",s=>{const i=s;if(i.targetTouches.length===2){this._updatePinchState(i);return}if(i.targetTouches[0].identifier===this._touchId){if(this._setMousePosition(i),!this._touchPanState.active&&this.pressedMouseButton===0&&this.mousePos.distance_to(this._touchPanState.startPos)>this._touchPanState.threshold){this._touchPanState.active=!0,this._touchPanState.lastPos.copy(this.mousePos),this._trigger("TouchPan",i);return}if(this._touchPanState.active)this._touchPanState.lastPos.copy(this.mousePos),this._trigger("TouchPan",i);else if(this.pressedMouseButton===0){const r=Ea[0];this._trigger(r,i)}}}),Xe(this,"handlePaste",s=>{Kf(s)||(this._setDataTransfer(s),this._trigger("Paste",s))}),Xe(this,"handleCopy",s=>{Kf(s)||(this._setDataTransfer(s),this._trigger("Copy",s))}),Xe(this,"handleDragEnter",s=>{const i=s;this._setMousePosition(i);const r=i.target===this._targetElement;this._trigger("DragOver",i,r)}),Xe(this,"handleDragOver",s=>{const i=s;i.preventDefault(),this._setMousePosition(i);const r=s.target===this._targetElement;this._trigger("DragOver",i,r)}),Xe(this,"handleDragLeave",s=>{const i=s;this._setMousePosition(i);const r=i.target===this._targetElement;this._trigger("DragEnd",i,r)}),Xe(this,"handleDrop",s=>{const i=s;i.preventDefault(),this._setDataTransfer(i),this._setMousePosition(i);const r=i.target===this._targetElement;this._trigger("Drop",i,r)}),this._paused=!1,this._targetElement=null,this._actions=new Map,this._keys=new Map,this._keyCode=null,this._mouseKeyCode=null,this._modifiers={modifier:!1,ctrl:!1,shift:!1,alt:!1},this.startPos={x:0,y:0},this._activeActionSet=new Set,this._lastLeftClick={timestamp:0,pos:new Dt},this._hoverElementsBoundsMap=new Map,this._eventOpts={passive:!1},this.mousePos=new Dt,this.wheelDelta=new Dt,this.dataTransfer={files:[],items:[]},this.event={handled:!0,mousePos:this.mousePos,wheelDelta:this.wheelDelta,dataTransfer:this.dataTransfer,domEvent:null},this.inputContext=C.DESIGN_MODE,this.ro=new ResizeObserver(()=>{this._clearHoverElementsBounds()}),this.watch(n)}addAction(n){this._actions.set(n.name,n),this._updateActions()}getAction(n){return this._actions.get(n)}removeAction(n){this._actions.delete(n.name)}watch(n){this.stop(),this._targetElement=n,window.addEventListener("keydown",this.handleKeyDown,this._eventOpts),window.addEventListener("keyup",this.handleKeyUp,this._eventOpts),this._targetElement.addEventListener("mousedown",this.handleMouseDown,this._eventOpts),window.addEventListener("mousemove",this.handleMouseMove,this._eventOpts),window.addEventListener("mouseup",this.handleMouseUp,this._eventOpts),this._targetElement.addEventListener("mouseenter",this.handleMouseEnter,this._eventOpts),this._targetElement.addEventListener("mouseleave",this.handleMouseLeave,this._eventOpts),this._targetElement.addEventListener("wheel",this.handleWheel,this._eventOpts),this._targetElement.addEventListener("touchstart",this.handleTouchStart,this._eventOpts),this._targetElement.addEventListener("touchmove",this.handleTouchMove,this._eventOpts),this._targetElement.addEventListener("touchend",this.handleTouchEnd,this._eventOpts),document.body.addEventListener("dragenter",this.handleDragEnter,this._eventOpts),document.body.addEventListener("dragleave",this.handleDragLeave,this._eventOpts),document.body.addEventListener("dragover",this.handleDragOver,this._eventOpts),window.addEventListener("drop",this.handleDrop,this._eventOpts),document.addEventListener("paste",this.handlePaste,this._eventOpts),document.addEventListener("copy",this.handleCopy,this._eventOpts),this._targetElement.addEventListener("focus",this.handleVisibilityChange,this._eventOpts),this._targetElement.addEventListener("blur",this.handleVisibilityChange,this._eventOpts),document.addEventListener("visibilitychange",this.handleVisibilityChange,this._eventOpts),this._targetElement instanceof Element&&this.ro.observe(this._targetElement)}stop(){this._targetElement&&(window.removeEventListener("keydown",this.handleKeyDown,this._eventOpts),window.removeEventListener("keyup",this.handleKeyUp,this._eventOpts),this._targetElement.removeEventListener("mousedown",this.handleMouseDown,this._eventOpts),window.removeEventListener("mousemove",this.handleMouseMove,this._eventOpts),window.removeEventListener("mouseup",this.handleMouseUp,this._eventOpts),this._targetElement.removeEventListener("mouseenter",this.handleMouseEnter,this._eventOpts),this._targetElement.removeEventListener("mouseleave",this.handleMouseLeave,this._eventOpts),this._targetElement.removeEventListener("wheel",this.handleWheel,this._eventOpts),this._targetElement.removeEventListener("touchstart",this.handleTouchStart,this._eventOpts),this._targetElement.removeEventListener("touchmove",this.handleTouchMove,this._eventOpts),this._targetElement.removeEventListener("touchend",this.handleTouchEnd,this._eventOpts),document.body.removeEventListener("dragenter",this.handleDragEnter,this._eventOpts),document.body.removeEventListener("dragleave",this.handleDragLeave,this._eventOpts),document.body.removeEventListener("dragover",this.handleDragOver,this._eventOpts),window.removeEventListener("drop",this.handleDrop,this._eventOpts),document.removeEventListener("paste",this.handlePaste,this._eventOpts),document.removeEventListener("copy",this.handleCopy,this._eventOpts),this._targetElement.removeEventListener("focus",this.handleVisibilityChange,this._eventOpts),this._targetElement.removeEventListener("blur",this.handleVisibilityChange,this._eventOpts),document.removeEventListener("visibilitychange",this.handleVisibilityChange,this._eventOpts),this.ro.disconnect(),this._targetElement=null)}endActiveAction(){const n=this._getKeyCombination(this._keyCode);this._activeActionSet.forEach(s=>{(!this._keyCode||!s.canBeActive(n))&&(s.end(),this._activeActionSet.delete(s))})}releaseAllKeys(){this._paused||(this._keyCode=null,this._mouseKeyCode=null,this._modifiers={modifier:!1,ctrl:!1,shift:!1,alt:!1},this.emit(hl.MODIFIER_KEY_CHANGES,this._modifiers),this.endActiveAction())}pause(){this._paused||(this.releaseAllKeys(),this._paused=!0)}resume(){this._paused=!1}reset(){this.releaseAllKeys(),this._actions.clear()}_setMousePosition(n){if(n instanceof MouseEvent)this.mousePos.set(n.clientX,n.clientY);else{const s=n.changedTouches[0];this.mousePos.set(s.clientX,s.clientY)}if(this._targetElement instanceof Element)if(this._hoverElementsBoundsMap.has(this._targetElement)){const s=this._hoverElementsBoundsMap.get(this._targetElement);this.mousePos.sub(s)}else{const s=this._targetElement.getBoundingClientRect();this._hoverElementsBoundsMap.set(this._targetElement,s),this.mousePos.sub(s)}}_setDataTransfer(n){switch(n.type){case"drop":{const s=n;this.dataTransfer.files=s.dataTransfer?[...s.dataTransfer.files]:[],this.dataTransfer.items=[];break}case"copy":{this.dataTransfer.files=[],this.dataTransfer.items=[];break}case"paste":{const s=n.clipboardData;this.dataTransfer.files=s?[...s.files]:[],this.dataTransfer.items=s?[...s.items]:[];break}}}_clearHoverElementsBounds(){this._hoverElementsBoundsMap.clear()}_updateActions(){this._keys.clear();for(const[,s]of this._actions)for(const i of s._keyCombos){const r=this._keys.get(i.triggerKeyCode);r?r.push(s):this._keys.set(i.triggerKeyCode,[s])}(s=>{for(const[,i]of s)i.sort((r,o)=>Number(r.fallback)-Number(o.fallback))})(this._keys);const n=new Set(["LeftClickMove","MiddleClickMove","RightClickMove","DoubleLeftClick"]);this._keys=new Map([...this._keys.entries()].sort((s,i)=>(i[0]&&n.has(i[0])?1:0)-(s[0]&&n.has(s[0])?1:0)))}_getKeyCombination(n=null){return{key:n||this._keyCode||this._mouseKeyCode,modifiers:this._modifiers}}_trigger(n,s,i=!0){if(this._paused)return;this.event.domEvent=s,s instanceof ClipboardEvent||this.checkModifierState(s);const r=this._getKeyCombination(n);let o=!1;r.key&&(r.key.endsWith("ClickUp")||r.key.endsWith("TouchPanEnd"))&&(this.endActiveAction(),o=!0),r.key||(this.endActiveAction(),r.key="MouseMove");const a=this._keys.get(r.key);if(a){for(const c of a)if(c.context.includes(this.inputContext)&&i&&c.trigger(r,this.event)){this._activeActionSet.add(c),o=!0;break}}o&&s.preventDefault()}preprocessKeyboardEvent(n){const s=Rv[n.code]||n.key;return s===(Kh?"Meta":"Control")?"Modifier":s}checkModifierState(n){this._modifiers.ctrl=n.ctrlKey,this._modifiers.shift=n.shiftKey,this._modifiers.alt=n.altKey,this._modifiers.modifier=Kh?n.metaKey:n.ctrlKey}setInputContext(n){this.inputContext=n}_updatePinchState(n){const s=n.targetTouches;if(s.length!==2){this._pinchState.active&&(this._pinchState.active=!1,this._activeTouches.clear());return}const i=s[0],r=s[1],o=zv(i,r),a=Kv(i,r);if(!this._pinchState.active)this._pinchState.active=!0,this._pinchState.initialDistance=o,this._pinchState.initialScale=1,this._pinchState.lastScale=1,this._pinchState.center.copy(a),this._activeTouches.set(i.identifier,i),this._activeTouches.set(r.identifier,r);else{const c=o/this._pinchState.initialDistance,l=c/this._pinchState.lastScale;if(Math.abs(l-1)>.01){if(this._pinchState.center.copy(a),this._pinchState.lastScale=c,this.mousePos.copy(a),this._targetElement instanceof Element)if(this._hoverElementsBoundsMap.has(this._targetElement)){const d=this._hoverElementsBoundsMap.get(this._targetElement);this.mousePos.sub(d)}else{const d=this._targetElement.getBoundingClientRect();this._hoverElementsBoundsMap.set(this._targetElement,d),this.mousePos.sub(d)}this.event.pinchScale=l,this.event.pinchCenter=this._pinchState.center.clone();const h=l>1?"PinchZoomIn":"PinchZoomOut";this._trigger(h,n,!0)}}}}const UA={[Ee.LEFT_CLICK]:{keyCombos:["LeftClick"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.PROTOTYPE_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE],fallback:!0},[Ee.LEFT_CLICK_MOVE]:{keyCombos:["LeftClickMove"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.PROTOTYPE_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE],fallback:!0},[Ee.LEFT_CLICK_DOWN]:{keyCombos:["LeftClickDown"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.PROTOTYPE_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE],fallback:!0},[Ee.LEFT_CLICK_UP]:{keyCombos:["LeftClickUp"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.PROTOTYPE_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE],fallback:!0},[Ee.SPACE]:{keyCombos:["Space"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.PROTOTYPE_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE]},[Ee.MIDDLE_CLICK_MOVE]:{keyCombos:["MiddleClickMove"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.PROTOTYPE_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE]},[Ee.RIGHT_CLICK_MOVE]:{keyCombos:["RightClick","RightClickMove"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.PROTOTYPE_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE],fallback:!0},[Ee.MOUSE_MOVE]:{keyCombos:["MouseMove"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.PROTOTYPE_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE],fallback:!0},[Ee.MOUSE_ENTER]:{keyCombos:["MouseEnter"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.PROTOTYPE_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE],fallback:!0},[Ee.MOUSE_LEAVE]:{keyCombos:["MouseLeave"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.PROTOTYPE_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE],fallback:!0},[Ee.DOUBLE_LEFT_CLICK]:{keyCombos:["DoubleLeftClick"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.PROTOTYPE_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE]},[Ee.DRAG_OVER]:{keyCombos:["DragOver"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE],fallback:!0},[Ee.DRAG_END]:{keyCombos:["DragEnd"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE],fallback:!0},[Ee.DROP]:{keyCombos:["Drop"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE],fallback:!0},[Ee.SELECT_PREVIOUS_ELEMENT]:{keyCombos:["Tab"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE]},[Ee.SELECT_NEXT_ELEMENT]:{keyCombos:["Shift + Tab"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE]},[Ee.TEXT_MOVE_CARET_TO_LINE_START]:{keyCombos:["Home"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.TEXT_MOVE_CARET_TO_TEXT_START]:{keyCombos:["Modifier + Home"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.TEXT_EXPAND_SELECTION_TO_LINE_START]:{keyCombos:["Shift + Home"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.TEXT_EXPAND_SELECTION_TO_TEXT_START]:{keyCombos:["Modifier + Shift + Home"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.TEXT_MOVE_CARET_TO_LINE_END]:{keyCombos:["End"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.TEXT_MOVE_CARET_TO_TEXT_END]:{keyCombos:["Modifier + End"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.TEXT_EXPAND_SELECTION_TO_LINE_END]:{keyCombos:["Shift + End"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.TEXT_EXPAND_SELECTION_TO_TEXT_END]:{keyCombos:["Modifier + Shift + End"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.ENTER]:{keyCombos:["Enter"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE]},[Ee.ENTER_SHIFT]:{keyCombos:["Shift + Enter"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.ESCAPE]:{keyCombos:["Escape"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE],fallback:!0},[Ee.DELETE]:{keyCombos:["Delete","Backspace"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE],fallback:!0},[Ee.MOVE_RIGHT]:{keyCombos:["ArrowRight"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE],fallback:!0},[Ee.MOVE_LEFT]:{keyCombos:["ArrowLeft"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE],fallback:!0},[Ee.MOVE_UP]:{keyCombos:["ArrowUp"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE],fallback:!0},[Ee.MOVE_DOWN]:{keyCombos:["ArrowDown"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE],fallback:!0},[Ee.UNDO]:{keyCombos:["Modifier + Z"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE]},[Ee.REDO]:{keyCombos:["Modifier + Shift + Z"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE]},[Ee.ZOOM_OUT]:{keyCombos:["Modifier + -","-"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE,C.PROTOTYPE_MODE]},[Ee.ZOOM_IN]:{keyCombos:["Modifier + =","=","+"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE,C.PROTOTYPE_MODE]},[Ee.ZOOM_RESET]:{keyCombos:["Modifier + 0"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE]},[Ee.ZOOM_FIT_CONTENT]:{keyCombos:["Modifier + 1"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE]},[Ee.ZOOM_FIT_SELECTION]:{keyCombos:["Modifier + 2"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE]},[Ee.ZOOM_CENTER_SELECTION]:{keyCombos:["Modifier + 3"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.COPY]:{keyCombos:["Copy"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE],fallback:!0},[Ee.PASTE]:{keyCombos:["Paste"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE],fallback:!0},[Ee.CUT]:{keyCombos:["Modifier + X","Shift + Modifier + X"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.DUPLICATE]:{keyCombos:["Modifier + D","Shift + Modifier + D"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.SELECT_ALL]:{keyCombos:["Modifier + A"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.TOGGLE_ANIMATE_MODE]:{keyCombos:["A"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.TOGGLE_ACTION_PANEL]:{keyCombos:["["],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.ADD_ACTION]:{keyCombos:["Alt + N"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.ACTIVATE_SELECT_TOOL]:{keyCombos:["V"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE]},[Ee.ACTIVATE_SCALE_TOOL]:{keyCombos:["K"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE]},[Ee.ACTIVATE_HAND_TOOL]:{keyCombos:["H"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE]},[Ee.ACTIVATE_RECTANGLE_TOOL]:{keyCombos:["R"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE]},[Ee.RESTART_PROTOTYPE]:{keyCombos:["R"],context:[C.PROTOTYPE_MODE]},[Ee.ENTER_PROTOTYPE_MODE_FULL_SCREEN]:{keyCombos:["F"],context:[C.PROTOTYPE_MODE]},[Ee.TOGGLE_PROTOTYPE_MODE]:{keyCombos:["Shift + P"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.PROTOTYPE_MODE]},[Ee.EXIT_PROTOTYPE_MODE]:{keyCombos:["Escape"],context:[C.PROTOTYPE_MODE]},[Ee.ACTIVATE_CONTAINER_TOOL]:{keyCombos:["N"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE]},[Ee.ACTIVATE_ELLIPSE_TOOL]:{keyCombos:["O"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE]},[Ee.ACTIVATE_PEN_TOOL]:{keyCombos:["P"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE]},[Ee.ACTIVATE_COMMENT_TOOL]:{keyCombos:["C"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE]},[Ee.ACTIVATE_TEXT_TOOL]:{keyCombos:["T"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE]},[Ee.TOGGLE_EYE_DROPPER_TOOL]:{keyCombos:["I"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.INCREASE_CORNER_RADIUS]:{keyCombos:["Modifier + O"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.DECREASE_CORNER_RADIUS]:{keyCombos:["Modifier + K"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.GROUP_ELEMENTS]:{keyCombos:["Modifier + G","Modifier + Alt + G"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.UNGROUP_ELEMENT]:{keyCombos:["Modifier + Shift + G"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.TOGGLE_EXPAND]:{keyCombos:["Alt + L"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE]},[Ee.WHEEL_PAN_VIEWPORT]:{keyCombos:["WheelXPositive","WheelYPositive","WheelXNegative","WheelYNegative"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.PROTOTYPE_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE],fallback:!0},[Ee.WHEEL_ZOOM_TO_POINTER]:{keyCombos:["Modifier + WheelXPositive","Modifier + WheelYPositive","Modifier + WheelXNegative","Modifier + WheelYNegative"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.PROTOTYPE_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE]},[Ee.TRACKPAD_ZOOM_TO_POINTER]:{keyCombos:["Ctrl + WheelXPositive","Ctrl + WheelYPositive","Ctrl + WheelXNegative","Ctrl + WheelYNegative"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.PROTOTYPE_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE],platforms:["Mac"]},[Ee.MOBILE_PINCH_ZOOM_TO_POINTER]:{keyCombos:["PinchZoomIn","PinchZoomOut"],context:[C.PROTOTYPE_MODE]},[Ee.MOBILE_TOUCH_PAN]:{keyCombos:["TouchPan"],context:[C.PROTOTYPE_MODE]},[Ee.ALIGN_LEFT]:{keyCombos:["Alt + A"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.ALIGN_CENTER]:{keyCombos:["Alt + H"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.ALIGN_RIGHT]:{keyCombos:["Alt + D"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.ALIGN_TOP]:{keyCombos:["Alt + W"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.ALIGN_MIDDLE]:{keyCombos:["Alt + V"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.ALIGN_BOTTOM]:{keyCombos:["Alt + S"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.DISTRIBUTE_HORIZONTAL]:{keyCombos:["Ctrl + Alt + H"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.DISTRIBUTE_VERTICAL]:{keyCombos:["Ctrl + Alt + V"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.TOGGLE_ORIGIN]:{keyCombos:["Shift + Y"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE]},[Ee.TOGGLE_RULER]:{keyCombos:["Shift + R"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE]},[Ee.TOGGLE_INTERFACE]:{keyCombos:["Modifier + \\"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE]},[Ee.TOGGLE_COMMENT_VISIBILITY]:{keyCombos:["Shift + C"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE]},[Ee.TOGGLE_VISIBLE]:{keyCombos:["Modifier + Shift + H"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.TOGGLE_LOCK]:{keyCombos:["Modifier + Shift + L"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.BRING_TO_FRONT]:{keyCombos:["Alt + Modifier + ]"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.SEND_TO_BACK]:{keyCombos:["Alt + Modifier + ["],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.MOVE_FORWARD]:{keyCombos:["Modifier + ]"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.MOVE_BACKWARD]:{keyCombos:["Modifier + ["],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.MASK_SELECTION]:{keyCombos:["Ctrl + Modifier + M"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.TOGGLE_PRESENCE]:{keyCombos:["Shift + Modifier + \\"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE]},[Ee.EDIT_ORIGIN]:{keyCombos:["Y"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.TOGGLE_INSPECTING]:{keyCombos:["Shift + I"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE,C.SELECTOR_MODE]},[Ee.KEY_DOWN]:{keyCombos:["KeyDown_A","KeyDown_B","KeyDown_C","KeyDown_D","KeyDown_E","KeyDown_F","KeyDown_G","KeyDown_H","KeyDown_I","KeyDown_J","KeyDown_K","KeyDown_L","KeyDown_M","KeyDown_N","KeyDown_O","KeyDown_P","KeyDown_Q","KeyDown_R","KeyDown_S","KeyDown_T","KeyDown_U","KeyDown_V","KeyDown_W","KeyDown_X","KeyDown_Y","KeyDown_Z","KeyDown_0","KeyDown_1","KeyDown_2","KeyDown_3","KeyDown_4","KeyDown_5","KeyDown_6","KeyDown_7","KeyDown_8","KeyDown_9"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.PROTOTYPE_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]},[Ee.KEY_UP]:{keyCombos:["KeyUp_A","KeyUp_B","KeyUp_C","KeyUp_D","KeyUp_E","KeyUp_F","KeyUp_G","KeyUp_H","KeyUp_I","KeyUp_J","KeyUp_K","KeyUp_L","KeyUp_M","KeyUp_N","KeyUp_O","KeyUp_P","KeyUp_Q","KeyUp_R","KeyUp_S","KeyUp_T","KeyUp_U","KeyUp_V","KeyUp_W","KeyUp_X","KeyUp_Y","KeyUp_Z","KeyUp_0","KeyUp_1","KeyUp_2","KeyUp_3","KeyUp_4","KeyUp_5","KeyUp_6","KeyUp_7","KeyUp_8","KeyUp_9"],context:[C.DESIGN_MODE,C.ACTION_MODE,C.PROTOTYPE_MODE,C.INSPECT_MODE,C.VERSION_MODE,C.VIEW_MODE]}},Vs=new Qv;Vs.pause();for(const e in UA){const n=UA[e],s=new oT(e,n.keyCombos,n.context,n.fallback);Vs.addAction(s)}const Zv=(e,n,s=[],i)=>{const r=new oT(e,n,s,i);Vs.addAction(r)},qv=e=>{const n=Vs.getAction(e);n&&Vs.removeAction(n)},jv=()=>Vs.pause(),Jv=()=>Vs.resume(),$v=e=>Vs.getAction(e),eR=e=>Vs.watch(e);window.IS=Vs;const tR=e=>Vs.setInputContext(e),H={on:Vs.on.bind(Vs),off:Vs.off.bind(Vs),get:$v,pause:jv,resume:Jv,watch:eR,platform:xv,registerAction:Zv,unregisterAction:qv,Events:Ee,setInputContext:tR};var Ln;(function(e){e.FILL="fills",e.STROKE="strokes",e.SHADOW="shadows",e.INNER_SHADOW="innerShadows"})(Ln||(Ln={})),Ln.FILL,Ln.STROKE,Ln.SHADOW,Ln.INNER_SHADOW;const Qf=[Ln.FILL,Ln.STROKE,Ln.SHADOW,Ln.INNER_SHADOW];new Set(Qf),Ye.FILL+"",Ln.FILL,Ye.STROKE+"",Ln.STROKE,Ye.SHADOW+"",Ln.SHADOW,Ye.INNER_SHADOW+"",Ln.INNER_SHADOW,Ln.FILL+"",Ye.FILL,Ln.STROKE+"",Ye.STROKE,Ln.SHADOW+"",Ye.SHADOW,Ln.INNER_SHADOW+"",Ye.INNER_SHADOW;const nR={[wi.TRIM_PATH]:"trimPath"};Rn.FADE_IN+"",Rn.FADE_OUT+"",Rn.MOVE_IN+"",Rn.MOVE_OUT+"",Rn.SCALE_IN+"",Rn.SCALE_OUT+"",Rn.SPIN_IN+"",Rn.SPIN_OUT+"",Rn.TRIM_IN+"",Rn.TRIM_OUT+"",Te.LINEAR+"",Te.EASE+"",Te.EASE_IN+"",Te.EASE_OUT+"",Te.EASE_IN_OUT+"",Te.EASE_IN_SIN+"",Te.EASE_OUT_SINE+"",Te.EASE_IN_OUT_SINE+"",Te.EASE_IN_QUAD+"",Te.EASE_OUT_QUAD+"",Te.EASE_IN_OUT_QUAD+"",Te.EASE_IN_CUBIC+"",Te.EASE_OUT_CUBIC+"",Te.EASE_IN_OUT_CUBIC+"",Te.EASE_IN_QUART+"",Te.EASE_OUT_QUART+"",Te.EASE_IN_OUT_QUART+"",Te.EASE_IN_QUINT+"",Te.EASE_OUT_QUINT+"",Te.EASE_IN_OUT_QUINT+"",Te.EASE_IN_EXPO+"",Te.EASE_OUT_EXPO+"",Te.EASE_IN_OUT_EXPO+"",Te.EASE_IN_CIRC+"",Te.EASE_OUT_CIRC+"",Te.EASE_IN_OUT_CIRC+"",Te.EASE_IN_BACK+"",Te.EASE_OUT_BACK+"",Te.EASE_IN_OUT_BACK+"",new Set(Object.values(nR)),Object.freeze({fills:Re.FILL,strokes:Re.STROKE,shadows:Re.SHADOW,innerShadows:Re.INNER_SHADOW}),Object.freeze({fills:Ye.FILL,strokes:Ye.STROKE,shadows:Ye.SHADOW,innerShadows:Ye.INNER_SHADOW}),Te.LINEAR,Te.EASE,Te.EASE_IN,Te.EASE_OUT,Te.EASE_IN_OUT,Te.EASE_IN_SIN,Te.EASE_OUT_SINE,Te.EASE_IN_OUT_SINE,Te.EASE_IN_QUAD,Te.EASE_OUT_QUAD,Te.EASE_IN_OUT_QUAD,Te.EASE_IN_CUBIC,Te.EASE_OUT_CUBIC,Te.EASE_IN_OUT_CUBIC,Te.EASE_IN_QUART,Te.EASE_OUT_QUART,Te.EASE_IN_OUT_QUART,Te.EASE_IN_QUINT,Te.EASE_OUT_QUINT,Te.EASE_IN_OUT_QUINT,Te.EASE_IN_EXPO,Te.EASE_OUT_EXPO,Te.EASE_IN_OUT_EXPO,Te.EASE_IN_CIRC,Te.EASE_OUT_CIRC,Te.EASE_IN_OUT_CIRC,Te.EASE_IN_BACK,Te.EASE_OUT_BACK,Te.EASE_IN_OUT_BACK;var qh={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */qh.exports,function(e,n){(function(){var s,i="4.17.21",r=200,o="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",a="Expected a function",c="Invalid `variable` option passed into `_.template`",l="__lodash_hash_undefined__",h=500,d="__lodash_placeholder__",p=1,E=2,g=4,T=1,A=2,m=1,O=2,S=4,y=8,v=16,R=32,M=64,L=128,P=256,k=512,Q=30,b="...",X=800,K=16,V=1,J=2,ge=3,se=1/0,ue=9007199254740991,te=17976931348623157e292,ie=NaN,re=4294967295,fe=re-1,Ne=re>>>1,At=[["ary",L],["bind",m],["bindKey",O],["curry",y],["curryRight",v],["flip",k],["partial",R],["partialRight",M],["rearg",P]],Ke="[object Arguments]",St="[object Array]",hn="[object AsyncFunction]",_t="[object Boolean]",qn="[object Date]",ni="[object DOMException]",ys="[object Error]",Hi="[object Function]",Xo="[object GeneratorFunction]",jn="[object Map]",On="[object Number]",Wi="[object Null]",Yn="[object Object]",Rs="[object Promise]",no="[object Proxy]",so="[object RegExp]",ws="[object Set]",Rr="[object String]",si="[object Symbol]",zo="[object Undefined]",Ko="[object WeakMap]",xd="[object WeakSet]",ka="[object ArrayBuffer]",Qo="[object DataView]",wr="[object Float32Array]",Og="[object Float64Array]",Ig="[object Int8Array]",Sg="[object Int16Array]",yg="[object Int32Array]",Cg="[object Uint8Array]",Ng="[object Uint8ClampedArray]",xg="[object Uint16Array]",vg="[object Uint32Array]",b5=/\b__p \+= '';/g,U5=/\b(__p \+=) '' \+/g,G5=/(__e\(.*?\)|\b__t\)) \+\n'';/g,py=/&(?:amp|lt|gt|quot|#39);/g,Ey=/[&<>"']/g,F5=RegExp(py.source),k5=RegExp(Ey.source),B5=/<%-([\s\S]+?)%>/g,V5=/<%([\s\S]+?)%>/g,gy=/<%=([\s\S]+?)%>/g,H5=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,W5=/^\w*$/,Y5=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Rg=/[\\^$.*+?()[\]{}|]/g,X5=RegExp(Rg.source),wg=/^\s+/,z5=/\s/,K5=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Q5=/\{\n\/\* \[wrapped with (.+)\] \*/,Z5=/,? & /,q5=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,j5=/[()=,{}\[\]\/\s]/,J5=/\\(\\)?/g,$5=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,_y=/\w*$/,eF=/^[-+]0x[0-9a-f]+$/i,tF=/^0b[01]+$/i,nF=/^\[object .+?Constructor\]$/,sF=/^0o[0-7]+$/i,iF=/^(?:0|[1-9]\d*)$/,rF=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,vd=/($^)/,oF=/['\n\r\u2028\u2029\\]/g,Rd="\\ud800-\\udfff",aF="\\u0300-\\u036f",cF="\\ufe20-\\ufe2f",lF="\\u20d0-\\u20ff",Ty=aF+cF+lF,Ay="\\u2700-\\u27bf",my="a-z\\xdf-\\xf6\\xf8-\\xff",hF="\\xac\\xb1\\xd7\\xf7",uF="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",dF="\\u2000-\\u206f",fF=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Oy="A-Z\\xc0-\\xd6\\xd8-\\xde",Iy="\\ufe0e\\ufe0f",Sy=hF+uF+dF+fF,Dg="['’]",pF="["+Rd+"]",yy="["+Sy+"]",wd="["+Ty+"]",Cy="\\d+",EF="["+Ay+"]",Ny="["+my+"]",xy="[^"+Rd+Sy+Cy+Ay+my+Oy+"]",Lg="\\ud83c[\\udffb-\\udfff]",gF="(?:"+wd+"|"+Lg+")",vy="[^"+Rd+"]",Mg="(?:\\ud83c[\\udde6-\\uddff]){2}",Pg="[\\ud800-\\udbff][\\udc00-\\udfff]",Gc="["+Oy+"]",Ry="\\u200d",wy="(?:"+Ny+"|"+xy+")",_F="(?:"+Gc+"|"+xy+")",Dy="(?:"+Dg+"(?:d|ll|m|re|s|t|ve))?",Ly="(?:"+Dg+"(?:D|LL|M|RE|S|T|VE))?",My=gF+"?",Py="["+Iy+"]?",TF="(?:"+Ry+"(?:"+[vy,Mg,Pg].join("|")+")"+Py+My+")*",AF="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",mF="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",by=Py+My+TF,OF="(?:"+[EF,Mg,Pg].join("|")+")"+by,IF="(?:"+[vy+wd+"?",wd,Mg,Pg,pF].join("|")+")",SF=RegExp(Dg,"g"),yF=RegExp(wd,"g"),bg=RegExp(Lg+"(?="+Lg+")|"+IF+by,"g"),CF=RegExp([Gc+"?"+Ny+"+"+Dy+"(?="+[yy,Gc,"$"].join("|")+")",_F+"+"+Ly+"(?="+[yy,Gc+wy,"$"].join("|")+")",Gc+"?"+wy+"+"+Dy,Gc+"+"+Ly,mF,AF,Cy,OF].join("|"),"g"),NF=RegExp("["+Ry+Rd+Ty+Iy+"]"),xF=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,vF=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],RF=-1,En={};En[wr]=En[Og]=En[Ig]=En[Sg]=En[yg]=En[Cg]=En[Ng]=En[xg]=En[vg]=!0,En[Ke]=En[St]=En[ka]=En[_t]=En[Qo]=En[qn]=En[ys]=En[Hi]=En[jn]=En[On]=En[Yn]=En[so]=En[ws]=En[Rr]=En[Ko]=!1;var un={};un[Ke]=un[St]=un[ka]=un[Qo]=un[_t]=un[qn]=un[wr]=un[Og]=un[Ig]=un[Sg]=un[yg]=un[jn]=un[On]=un[Yn]=un[so]=un[ws]=un[Rr]=un[si]=un[Cg]=un[Ng]=un[xg]=un[vg]=!0,un[ys]=un[Hi]=un[Ko]=!1;var wF={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},DF={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},LF={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},MF={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},PF=parseFloat,bF=parseInt,Uy=typeof ol=="object"&&ol&&ol.Object===Object&&ol,UF=typeof self=="object"&&self&&self.Object===Object&&self,Cs=Uy||UF||Function("return this")(),Ug=n&&!n.nodeType&&n,Ba=Ug&&!0&&e&&!e.nodeType&&e,Gy=Ba&&Ba.exports===Ug,Gg=Gy&&Uy.process,Yi=function(){try{var W=Ba&&Ba.require&&Ba.require("util").types;return W||Gg&&Gg.binding&&Gg.binding("util")}catch{}}(),Fy=Yi&&Yi.isArrayBuffer,ky=Yi&&Yi.isDate,By=Yi&&Yi.isMap,Vy=Yi&&Yi.isRegExp,Hy=Yi&&Yi.isSet,Wy=Yi&&Yi.isTypedArray;function Ii(W,oe,j){switch(j.length){case 0:return W.call(oe);case 1:return W.call(oe,j[0]);case 2:return W.call(oe,j[0],j[1]);case 3:return W.call(oe,j[0],j[1],j[2])}return W.apply(oe,j)}function GF(W,oe,j,xe){for(var lt=-1,Ft=W==null?0:W.length;++lt<Ft;){var Jn=W[lt];oe(xe,Jn,j(Jn),W)}return xe}function Xi(W,oe){for(var j=-1,xe=W==null?0:W.length;++j<xe&&oe(W[j],j,W)!==!1;);return W}function FF(W,oe){for(var j=W==null?0:W.length;j--&&oe(W[j],j,W)!==!1;);return W}function Yy(W,oe){for(var j=-1,xe=W==null?0:W.length;++j<xe;)if(!oe(W[j],j,W))return!1;return!0}function Zo(W,oe){for(var j=-1,xe=W==null?0:W.length,lt=0,Ft=[];++j<xe;){var Jn=W[j];oe(Jn,j,W)&&(Ft[lt++]=Jn)}return Ft}function Dd(W,oe){var j=W==null?0:W.length;return!!j&&Fc(W,oe,0)>-1}function Fg(W,oe,j){for(var xe=-1,lt=W==null?0:W.length;++xe<lt;)if(j(oe,W[xe]))return!0;return!1}function In(W,oe){for(var j=-1,xe=W==null?0:W.length,lt=Array(xe);++j<xe;)lt[j]=oe(W[j],j,W);return lt}function qo(W,oe){for(var j=-1,xe=oe.length,lt=W.length;++j<xe;)W[lt+j]=oe[j];return W}function kg(W,oe,j,xe){var lt=-1,Ft=W==null?0:W.length;for(xe&&Ft&&(j=W[++lt]);++lt<Ft;)j=oe(j,W[lt],lt,W);return j}function kF(W,oe,j,xe){var lt=W==null?0:W.length;for(xe&&lt&&(j=W[--lt]);lt--;)j=oe(j,W[lt],lt,W);return j}function Bg(W,oe){for(var j=-1,xe=W==null?0:W.length;++j<xe;)if(oe(W[j],j,W))return!0;return!1}var BF=Vg("length");function VF(W){return W.split("")}function HF(W){return W.match(q5)||[]}function Xy(W,oe,j){var xe;return j(W,function(lt,Ft,Jn){if(oe(lt,Ft,Jn))return xe=Ft,!1}),xe}function Ld(W,oe,j,xe){for(var lt=W.length,Ft=j+(xe?1:-1);xe?Ft--:++Ft<lt;)if(oe(W[Ft],Ft,W))return Ft;return-1}function Fc(W,oe,j){return oe===oe?ek(W,oe,j):Ld(W,zy,j)}function WF(W,oe,j,xe){for(var lt=j-1,Ft=W.length;++lt<Ft;)if(xe(W[lt],oe))return lt;return-1}function zy(W){return W!==W}function Ky(W,oe){var j=W==null?0:W.length;return j?Wg(W,oe)/j:ie}function Vg(W){return function(oe){return oe==null?s:oe[W]}}function Hg(W){return function(oe){return W==null?s:W[oe]}}function Qy(W,oe,j,xe,lt){return lt(W,function(Ft,Jn,rn){j=xe?(xe=!1,Ft):oe(j,Ft,Jn,rn)}),j}function YF(W,oe){var j=W.length;for(W.sort(oe);j--;)W[j]=W[j].value;return W}function Wg(W,oe){for(var j,xe=-1,lt=W.length;++xe<lt;){var Ft=oe(W[xe]);Ft!==s&&(j=j===s?Ft:j+Ft)}return j}function Yg(W,oe){for(var j=-1,xe=Array(W);++j<W;)xe[j]=oe(j);return xe}function XF(W,oe){return In(oe,function(j){return[j,W[j]]})}function Zy(W){return W&&W.slice(0,$y(W)+1).replace(wg,"")}function Si(W){return function(oe){return W(oe)}}function Xg(W,oe){return In(oe,function(j){return W[j]})}function Ah(W,oe){return W.has(oe)}function qy(W,oe){for(var j=-1,xe=W.length;++j<xe&&Fc(oe,W[j],0)>-1;);return j}function jy(W,oe){for(var j=W.length;j--&&Fc(oe,W[j],0)>-1;);return j}function zF(W,oe){for(var j=W.length,xe=0;j--;)W[j]===oe&&++xe;return xe}var KF=Hg(wF),QF=Hg(DF);function ZF(W){return"\\"+MF[W]}function qF(W,oe){return W==null?s:W[oe]}function kc(W){return NF.test(W)}function jF(W){return xF.test(W)}function JF(W){for(var oe,j=[];!(oe=W.next()).done;)j.push(oe.value);return j}function zg(W){var oe=-1,j=Array(W.size);return W.forEach(function(xe,lt){j[++oe]=[lt,xe]}),j}function Jy(W,oe){return function(j){return W(oe(j))}}function jo(W,oe){for(var j=-1,xe=W.length,lt=0,Ft=[];++j<xe;){var Jn=W[j];(Jn===oe||Jn===d)&&(W[j]=d,Ft[lt++]=j)}return Ft}function Md(W){var oe=-1,j=Array(W.size);return W.forEach(function(xe){j[++oe]=xe}),j}function $F(W){var oe=-1,j=Array(W.size);return W.forEach(function(xe){j[++oe]=[xe,xe]}),j}function ek(W,oe,j){for(var xe=j-1,lt=W.length;++xe<lt;)if(W[xe]===oe)return xe;return-1}function tk(W,oe,j){for(var xe=j+1;xe--;)if(W[xe]===oe)return xe;return xe}function Bc(W){return kc(W)?sk(W):BF(W)}function dr(W){return kc(W)?ik(W):VF(W)}function $y(W){for(var oe=W.length;oe--&&z5.test(W.charAt(oe)););return oe}var nk=Hg(LF);function sk(W){for(var oe=bg.lastIndex=0;bg.test(W);)++oe;return oe}function ik(W){return W.match(bg)||[]}function rk(W){return W.match(CF)||[]}var ok=function W(oe){oe=oe==null?Cs:Vc.defaults(Cs.Object(),oe,Vc.pick(Cs,vF));var j=oe.Array,xe=oe.Date,lt=oe.Error,Ft=oe.Function,Jn=oe.Math,rn=oe.Object,Kg=oe.RegExp,ak=oe.String,zi=oe.TypeError,Pd=j.prototype,ck=Ft.prototype,Hc=rn.prototype,bd=oe["__core-js_shared__"],Ud=ck.toString,Zt=Hc.hasOwnProperty,lk=0,eC=function(){var u=/[^.]+$/.exec(bd&&bd.keys&&bd.keys.IE_PROTO||"");return u?"Symbol(src)_1."+u:""}(),Gd=Hc.toString,hk=Ud.call(rn),uk=Cs._,dk=Kg("^"+Ud.call(Zt).replace(Rg,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Fd=Gy?oe.Buffer:s,Jo=oe.Symbol,kd=oe.Uint8Array,tC=Fd?Fd.allocUnsafe:s,Bd=Jy(rn.getPrototypeOf,rn),nC=rn.create,sC=Hc.propertyIsEnumerable,Vd=Pd.splice,iC=Jo?Jo.isConcatSpreadable:s,mh=Jo?Jo.iterator:s,Va=Jo?Jo.toStringTag:s,Hd=function(){try{var u=za(rn,"defineProperty");return u({},"",{}),u}catch{}}(),fk=oe.clearTimeout!==Cs.clearTimeout&&oe.clearTimeout,pk=xe&&xe.now!==Cs.Date.now&&xe.now,Ek=oe.setTimeout!==Cs.setTimeout&&oe.setTimeout,Wd=Jn.ceil,Yd=Jn.floor,Qg=rn.getOwnPropertySymbols,gk=Fd?Fd.isBuffer:s,rC=oe.isFinite,_k=Pd.join,Tk=Jy(rn.keys,rn),$n=Jn.max,Ds=Jn.min,Ak=xe.now,mk=oe.parseInt,oC=Jn.random,Ok=Pd.reverse,Zg=za(oe,"DataView"),Oh=za(oe,"Map"),qg=za(oe,"Promise"),Wc=za(oe,"Set"),Ih=za(oe,"WeakMap"),Sh=za(rn,"create"),Xd=Ih&&new Ih,Yc={},Ik=Ka(Zg),Sk=Ka(Oh),yk=Ka(qg),Ck=Ka(Wc),Nk=Ka(Ih),zd=Jo?Jo.prototype:s,yh=zd?zd.valueOf:s,aC=zd?zd.toString:s;function w(u){if(bn(u)&&!ht(u)&&!(u instanceof xt)){if(u instanceof Ki)return u;if(Zt.call(u,"__wrapped__"))return cN(u)}return new Ki(u)}var Xc=function(){function u(){}return function(f){if(!Nn(f))return{};if(nC)return nC(f);u.prototype=f;var _=new u;return u.prototype=s,_}}();function Kd(){}function Ki(u,f){this.__wrapped__=u,this.__actions__=[],this.__chain__=!!f,this.__index__=0,this.__values__=s}w.templateSettings={escape:B5,evaluate:V5,interpolate:gy,variable:"",imports:{_:w}},w.prototype=Kd.prototype,w.prototype.constructor=w,Ki.prototype=Xc(Kd.prototype),Ki.prototype.constructor=Ki;function xt(u){this.__wrapped__=u,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=re,this.__views__=[]}function xk(){var u=new xt(this.__wrapped__);return u.__actions__=ii(this.__actions__),u.__dir__=this.__dir__,u.__filtered__=this.__filtered__,u.__iteratees__=ii(this.__iteratees__),u.__takeCount__=this.__takeCount__,u.__views__=ii(this.__views__),u}function vk(){if(this.__filtered__){var u=new xt(this);u.__dir__=-1,u.__filtered__=!0}else u=this.clone(),u.__dir__*=-1;return u}function Rk(){var u=this.__wrapped__.value(),f=this.__dir__,_=ht(u),I=f<0,x=_?u.length:0,D=VB(0,x,this.__views__),U=D.start,F=D.end,z=F-U,le=I?F:U-1,he=this.__iteratees__,de=he.length,Ie=0,Pe=Ds(z,this.__takeCount__);if(!_||!I&&x==z&&Pe==z)return DC(u,this.__actions__);var Qe=[];e:for(;z--&&Ie<Pe;){le+=f;for(var Tt=-1,Ze=u[le];++Tt<de;){var yt=he[Tt],Rt=yt.iteratee,Ni=yt.type,Ks=Rt(Ze);if(Ni==J)Ze=Ks;else if(!Ks){if(Ni==V)continue e;break e}}Qe[Ie++]=Ze}return Qe}xt.prototype=Xc(Kd.prototype),xt.prototype.constructor=xt;function Ha(u){var f=-1,_=u==null?0:u.length;for(this.clear();++f<_;){var I=u[f];this.set(I[0],I[1])}}function wk(){this.__data__=Sh?Sh(null):{},this.size=0}function Dk(u){var f=this.has(u)&&delete this.__data__[u];return this.size-=f?1:0,f}function Lk(u){var f=this.__data__;if(Sh){var _=f[u];return _===l?s:_}return Zt.call(f,u)?f[u]:s}function Mk(u){var f=this.__data__;return Sh?f[u]!==s:Zt.call(f,u)}function Pk(u,f){var _=this.__data__;return this.size+=this.has(u)?0:1,_[u]=Sh&&f===s?l:f,this}Ha.prototype.clear=wk,Ha.prototype.delete=Dk,Ha.prototype.get=Lk,Ha.prototype.has=Mk,Ha.prototype.set=Pk;function io(u){var f=-1,_=u==null?0:u.length;for(this.clear();++f<_;){var I=u[f];this.set(I[0],I[1])}}function bk(){this.__data__=[],this.size=0}function Uk(u){var f=this.__data__,_=Qd(f,u);if(_<0)return!1;var I=f.length-1;return _==I?f.pop():Vd.call(f,_,1),--this.size,!0}function Gk(u){var f=this.__data__,_=Qd(f,u);return _<0?s:f[_][1]}function Fk(u){return Qd(this.__data__,u)>-1}function kk(u,f){var _=this.__data__,I=Qd(_,u);return I<0?(++this.size,_.push([u,f])):_[I][1]=f,this}io.prototype.clear=bk,io.prototype.delete=Uk,io.prototype.get=Gk,io.prototype.has=Fk,io.prototype.set=kk;function ro(u){var f=-1,_=u==null?0:u.length;for(this.clear();++f<_;){var I=u[f];this.set(I[0],I[1])}}function Bk(){this.size=0,this.__data__={hash:new Ha,map:new(Oh||io),string:new Ha}}function Vk(u){var f=af(this,u).delete(u);return this.size-=f?1:0,f}function Hk(u){return af(this,u).get(u)}function Wk(u){return af(this,u).has(u)}function Yk(u,f){var _=af(this,u),I=_.size;return _.set(u,f),this.size+=_.size==I?0:1,this}ro.prototype.clear=Bk,ro.prototype.delete=Vk,ro.prototype.get=Hk,ro.prototype.has=Wk,ro.prototype.set=Yk;function Wa(u){var f=-1,_=u==null?0:u.length;for(this.__data__=new ro;++f<_;)this.add(u[f])}function Xk(u){return this.__data__.set(u,l),this}function zk(u){return this.__data__.has(u)}Wa.prototype.add=Wa.prototype.push=Xk,Wa.prototype.has=zk;function fr(u){var f=this.__data__=new io(u);this.size=f.size}function Kk(){this.__data__=new io,this.size=0}function Qk(u){var f=this.__data__,_=f.delete(u);return this.size=f.size,_}function Zk(u){return this.__data__.get(u)}function qk(u){return this.__data__.has(u)}function jk(u,f){var _=this.__data__;if(_ instanceof io){var I=_.__data__;if(!Oh||I.length<r-1)return I.push([u,f]),this.size=++_.size,this;_=this.__data__=new ro(I)}return _.set(u,f),this.size=_.size,this}fr.prototype.clear=Kk,fr.prototype.delete=Qk,fr.prototype.get=Zk,fr.prototype.has=qk,fr.prototype.set=jk;function cC(u,f){var _=ht(u),I=!_&&Qa(u),x=!_&&!I&&sa(u),D=!_&&!I&&!x&&Zc(u),U=_||I||x||D,F=U?Yg(u.length,ak):[],z=F.length;for(var le in u)(f||Zt.call(u,le))&&!(U&&(le=="length"||x&&(le=="offset"||le=="parent")||D&&(le=="buffer"||le=="byteLength"||le=="byteOffset")||lo(le,z)))&&F.push(le);return F}function lC(u){var f=u.length;return f?u[a0(0,f-1)]:s}function Jk(u,f){return cf(ii(u),Ya(f,0,u.length))}function $k(u){return cf(ii(u))}function jg(u,f,_){(_!==s&&!pr(u[f],_)||_===s&&!(f in u))&&oo(u,f,_)}function Ch(u,f,_){var I=u[f];(!(Zt.call(u,f)&&pr(I,_))||_===s&&!(f in u))&&oo(u,f,_)}function Qd(u,f){for(var _=u.length;_--;)if(pr(u[_][0],f))return _;return-1}function eB(u,f,_,I){return $o(u,function(x,D,U){f(I,x,_(x),U)}),I}function hC(u,f){return u&&Lr(f,hs(f),u)}function tB(u,f){return u&&Lr(f,oi(f),u)}function oo(u,f,_){f=="__proto__"&&Hd?Hd(u,f,{configurable:!0,enumerable:!0,value:_,writable:!0}):u[f]=_}function Jg(u,f){for(var _=-1,I=f.length,x=j(I),D=u==null;++_<I;)x[_]=D?s:L0(u,f[_]);return x}function Ya(u,f,_){return u===u&&(_!==s&&(u=u<=_?u:_),f!==s&&(u=u>=f?u:f)),u}function Qi(u,f,_,I,x,D){var U,F=f&p,z=f&E,le=f&g;if(_&&(U=x?_(u,I,x,D):_(u)),U!==s)return U;if(!Nn(u))return u;var he=ht(u);if(he){if(U=WB(u),!F)return ii(u,U)}else{var de=Ls(u),Ie=de==Hi||de==Xo;if(sa(u))return PC(u,F);if(de==Yn||de==Ke||Ie&&!x){if(U=z||Ie?{}:$C(u),!F)return z?LB(u,tB(U,u)):DB(u,hC(U,u))}else{if(!un[de])return x?u:{};U=YB(u,de,F)}}D||(D=new fr);var Pe=D.get(u);if(Pe)return Pe;D.set(u,U),vN(u)?u.forEach(function(Ze){U.add(Qi(Ze,f,_,Ze,u,D))}):NN(u)&&u.forEach(function(Ze,yt){U.set(yt,Qi(Ze,f,_,yt,u,D))});var Qe=le?z?T0:_0:z?oi:hs,Tt=he?s:Qe(u);return Xi(Tt||u,function(Ze,yt){Tt&&(yt=Ze,Ze=u[yt]),Ch(U,yt,Qi(Ze,f,_,yt,u,D))}),U}function nB(u){var f=hs(u);return function(_){return uC(_,u,f)}}function uC(u,f,_){var I=_.length;if(u==null)return!I;for(u=rn(u);I--;){var x=_[I],D=f[x],U=u[x];if(U===s&&!(x in u)||!D(U))return!1}return!0}function dC(u,f,_){if(typeof u!="function")throw new zi(a);return Lh(function(){u.apply(s,_)},f)}function Nh(u,f,_,I){var x=-1,D=Dd,U=!0,F=u.length,z=[],le=f.length;if(!F)return z;_&&(f=In(f,Si(_))),I?(D=Fg,U=!1):f.length>=r&&(D=Ah,U=!1,f=new Wa(f));e:for(;++x<F;){var he=u[x],de=_==null?he:_(he);if(he=I||he!==0?he:0,U&&de===de){for(var Ie=le;Ie--;)if(f[Ie]===de)continue e;z.push(he)}else D(f,de,I)||z.push(he)}return z}var $o=kC(Dr),fC=kC(e0,!0);function sB(u,f){var _=!0;return $o(u,function(I,x,D){return _=!!f(I,x,D),_}),_}function Zd(u,f,_){for(var I=-1,x=u.length;++I<x;){var D=u[I],U=f(D);if(U!=null&&(F===s?U===U&&!Ci(U):_(U,F)))var F=U,z=D}return z}function iB(u,f,_,I){var x=u.length;for(_=Et(_),_<0&&(_=-_>x?0:x+_),I=I===s||I>x?x:Et(I),I<0&&(I+=x),I=_>I?0:wN(I);_<I;)u[_++]=f;return u}function pC(u,f){var _=[];return $o(u,function(I,x,D){f(I,x,D)&&_.push(I)}),_}function Ns(u,f,_,I,x){var D=-1,U=u.length;for(_||(_=zB),x||(x=[]);++D<U;){var F=u[D];f>0&&_(F)?f>1?Ns(F,f-1,_,I,x):qo(x,F):I||(x[x.length]=F)}return x}var $g=BC(),EC=BC(!0);function Dr(u,f){return u&&$g(u,f,hs)}function e0(u,f){return u&&EC(u,f,hs)}function qd(u,f){return Zo(f,function(_){return ho(u[_])})}function Xa(u,f){f=ta(f,u);for(var _=0,I=f.length;u!=null&&_<I;)u=u[Mr(f[_++])];return _&&_==I?u:s}function gC(u,f,_){var I=f(u);return ht(u)?I:qo(I,_(u))}function Xs(u){return u==null?u===s?zo:Wi:Va&&Va in rn(u)?BB(u):$B(u)}function t0(u,f){return u>f}function rB(u,f){return u!=null&&Zt.call(u,f)}function oB(u,f){return u!=null&&f in rn(u)}function aB(u,f,_){return u>=Ds(f,_)&&u<$n(f,_)}function n0(u,f,_){for(var I=_?Fg:Dd,x=u[0].length,D=u.length,U=D,F=j(D),z=1/0,le=[];U--;){var he=u[U];U&&f&&(he=In(he,Si(f))),z=Ds(he.length,z),F[U]=!_&&(f||x>=120&&he.length>=120)?new Wa(U&&he):s}he=u[0];var de=-1,Ie=F[0];e:for(;++de<x&&le.length<z;){var Pe=he[de],Qe=f?f(Pe):Pe;if(Pe=_||Pe!==0?Pe:0,!(Ie?Ah(Ie,Qe):I(le,Qe,_))){for(U=D;--U;){var Tt=F[U];if(!(Tt?Ah(Tt,Qe):I(u[U],Qe,_)))continue e}Ie&&Ie.push(Qe),le.push(Pe)}}return le}function cB(u,f,_,I){return Dr(u,function(x,D,U){f(I,_(x),D,U)}),I}function xh(u,f,_){f=ta(f,u),u=sN(u,f);var I=u==null?u:u[Mr(qi(f))];return I==null?s:Ii(I,u,_)}function _C(u){return bn(u)&&Xs(u)==Ke}function lB(u){return bn(u)&&Xs(u)==ka}function hB(u){return bn(u)&&Xs(u)==qn}function vh(u,f,_,I,x){return u===f?!0:u==null||f==null||!bn(u)&&!bn(f)?u!==u&&f!==f:uB(u,f,_,I,vh,x)}function uB(u,f,_,I,x,D){var U=ht(u),F=ht(f),z=U?St:Ls(u),le=F?St:Ls(f);z=z==Ke?Yn:z,le=le==Ke?Yn:le;var he=z==Yn,de=le==Yn,Ie=z==le;if(Ie&&sa(u)){if(!sa(f))return!1;U=!0,he=!1}if(Ie&&!he)return D||(D=new fr),U||Zc(u)?qC(u,f,_,I,x,D):FB(u,f,z,_,I,x,D);if(!(_&T)){var Pe=he&&Zt.call(u,"__wrapped__"),Qe=de&&Zt.call(f,"__wrapped__");if(Pe||Qe){var Tt=Pe?u.value():u,Ze=Qe?f.value():f;return D||(D=new fr),x(Tt,Ze,_,I,D)}}return Ie?(D||(D=new fr),kB(u,f,_,I,x,D)):!1}function dB(u){return bn(u)&&Ls(u)==jn}function s0(u,f,_,I){var x=_.length,D=x,U=!I;if(u==null)return!D;for(u=rn(u);x--;){var F=_[x];if(U&&F[2]?F[1]!==u[F[0]]:!(F[0]in u))return!1}for(;++x<D;){F=_[x];var z=F[0],le=u[z],he=F[1];if(U&&F[2]){if(le===s&&!(z in u))return!1}else{var de=new fr;if(I)var Ie=I(le,he,z,u,f,de);if(!(Ie===s?vh(he,le,T|A,I,de):Ie))return!1}}return!0}function TC(u){if(!Nn(u)||QB(u))return!1;var f=ho(u)?dk:nF;return f.test(Ka(u))}function fB(u){return bn(u)&&Xs(u)==so}function pB(u){return bn(u)&&Ls(u)==ws}function EB(u){return bn(u)&&pf(u.length)&&!!En[Xs(u)]}function AC(u){return typeof u=="function"?u:u==null?ai:typeof u=="object"?ht(u)?IC(u[0],u[1]):OC(u):VN(u)}function i0(u){if(!Dh(u))return Tk(u);var f=[];for(var _ in rn(u))Zt.call(u,_)&&_!="constructor"&&f.push(_);return f}function gB(u){if(!Nn(u))return JB(u);var f=Dh(u),_=[];for(var I in u)I=="constructor"&&(f||!Zt.call(u,I))||_.push(I);return _}function r0(u,f){return u<f}function mC(u,f){var _=-1,I=ri(u)?j(u.length):[];return $o(u,function(x,D,U){I[++_]=f(x,D,U)}),I}function OC(u){var f=m0(u);return f.length==1&&f[0][2]?tN(f[0][0],f[0][1]):function(_){return _===u||s0(_,u,f)}}function IC(u,f){return I0(u)&&eN(f)?tN(Mr(u),f):function(_){var I=L0(_,u);return I===s&&I===f?M0(_,u):vh(f,I,T|A)}}function jd(u,f,_,I,x){u!==f&&$g(f,function(D,U){if(x||(x=new fr),Nn(D))_B(u,f,U,_,jd,I,x);else{var F=I?I(y0(u,U),D,U+"",u,f,x):s;F===s&&(F=D),jg(u,U,F)}},oi)}function _B(u,f,_,I,x,D,U){var F=y0(u,_),z=y0(f,_),le=U.get(z);if(le){jg(u,_,le);return}var he=D?D(F,z,_+"",u,f,U):s,de=he===s;if(de){var Ie=ht(z),Pe=!Ie&&sa(z),Qe=!Ie&&!Pe&&Zc(z);he=z,Ie||Pe||Qe?ht(F)?he=F:Bn(F)?he=ii(F):Pe?(de=!1,he=PC(z,!0)):Qe?(de=!1,he=bC(z,!0)):he=[]:Mh(z)||Qa(z)?(he=F,Qa(F)?he=DN(F):(!Nn(F)||ho(F))&&(he=$C(z))):de=!1}de&&(U.set(z,he),x(he,z,I,D,U),U.delete(z)),jg(u,_,he)}function SC(u,f){var _=u.length;if(_)return f+=f<0?_:0,lo(f,_)?u[f]:s}function yC(u,f,_){f.length?f=In(f,function(D){return ht(D)?function(U){return Xa(U,D.length===1?D[0]:D)}:D}):f=[ai];var I=-1;f=In(f,Si(ze()));var x=mC(u,function(D,U,F){var z=In(f,function(le){return le(D)});return{criteria:z,index:++I,value:D}});return YF(x,function(D,U){return wB(D,U,_)})}function TB(u,f){return CC(u,f,function(_,I){return M0(u,I)})}function CC(u,f,_){for(var I=-1,x=f.length,D={};++I<x;){var U=f[I],F=Xa(u,U);_(F,U)&&Rh(D,ta(U,u),F)}return D}function AB(u){return function(f){return Xa(f,u)}}function o0(u,f,_,I){var x=I?WF:Fc,D=-1,U=f.length,F=u;for(u===f&&(f=ii(f)),_&&(F=In(u,Si(_)));++D<U;)for(var z=0,le=f[D],he=_?_(le):le;(z=x(F,he,z,I))>-1;)F!==u&&Vd.call(F,z,1),Vd.call(u,z,1);return u}function NC(u,f){for(var _=u?f.length:0,I=_-1;_--;){var x=f[_];if(_==I||x!==D){var D=x;lo(x)?Vd.call(u,x,1):h0(u,x)}}return u}function a0(u,f){return u+Yd(oC()*(f-u+1))}function mB(u,f,_,I){for(var x=-1,D=$n(Wd((f-u)/(_||1)),0),U=j(D);D--;)U[I?D:++x]=u,u+=_;return U}function c0(u,f){var _="";if(!u||f<1||f>ue)return _;do f%2&&(_+=u),f=Yd(f/2),f&&(u+=u);while(f);return _}function mt(u,f){return C0(nN(u,f,ai),u+"")}function OB(u){return lC(qc(u))}function IB(u,f){var _=qc(u);return cf(_,Ya(f,0,_.length))}function Rh(u,f,_,I){if(!Nn(u))return u;f=ta(f,u);for(var x=-1,D=f.length,U=D-1,F=u;F!=null&&++x<D;){var z=Mr(f[x]),le=_;if(z==="__proto__"||z==="constructor"||z==="prototype")return u;if(x!=U){var he=F[z];le=I?I(he,z,F):s,le===s&&(le=Nn(he)?he:lo(f[x+1])?[]:{})}Ch(F,z,le),F=F[z]}return u}var xC=Xd?function(u,f){return Xd.set(u,f),u}:ai,SB=Hd?function(u,f){return Hd(u,"toString",{configurable:!0,enumerable:!1,value:b0(f),writable:!0})}:ai;function yB(u){return cf(qc(u))}function Zi(u,f,_){var I=-1,x=u.length;f<0&&(f=-f>x?0:x+f),_=_>x?x:_,_<0&&(_+=x),x=f>_?0:_-f>>>0,f>>>=0;for(var D=j(x);++I<x;)D[I]=u[I+f];return D}function CB(u,f){var _;return $o(u,function(I,x,D){return _=f(I,x,D),!_}),!!_}function Jd(u,f,_){var I=0,x=u==null?I:u.length;if(typeof f=="number"&&f===f&&x<=Ne){for(;I<x;){var D=I+x>>>1,U=u[D];U!==null&&!Ci(U)&&(_?U<=f:U<f)?I=D+1:x=D}return x}return l0(u,f,ai,_)}function l0(u,f,_,I){var x=0,D=u==null?0:u.length;if(D===0)return 0;f=_(f);for(var U=f!==f,F=f===null,z=Ci(f),le=f===s;x<D;){var he=Yd((x+D)/2),de=_(u[he]),Ie=de!==s,Pe=de===null,Qe=de===de,Tt=Ci(de);if(U)var Ze=I||Qe;else le?Ze=Qe&&(I||Ie):F?Ze=Qe&&Ie&&(I||!Pe):z?Ze=Qe&&Ie&&!Pe&&(I||!Tt):Pe||Tt?Ze=!1:Ze=I?de<=f:de<f;Ze?x=he+1:D=he}return Ds(D,fe)}function vC(u,f){for(var _=-1,I=u.length,x=0,D=[];++_<I;){var U=u[_],F=f?f(U):U;if(!_||!pr(F,z)){var z=F;D[x++]=U===0?0:U}}return D}function RC(u){return typeof u=="number"?u:Ci(u)?ie:+u}function yi(u){if(typeof u=="string")return u;if(ht(u))return In(u,yi)+"";if(Ci(u))return aC?aC.call(u):"";var f=u+"";return f=="0"&&1/u==-1/0?"-0":f}function ea(u,f,_){var I=-1,x=Dd,D=u.length,U=!0,F=[],z=F;if(_)U=!1,x=Fg;else if(D>=r){var le=f?null:UB(u);if(le)return Md(le);U=!1,x=Ah,z=new Wa}else z=f?[]:F;e:for(;++I<D;){var he=u[I],de=f?f(he):he;if(he=_||he!==0?he:0,U&&de===de){for(var Ie=z.length;Ie--;)if(z[Ie]===de)continue e;f&&z.push(de),F.push(he)}else x(z,de,_)||(z!==F&&z.push(de),F.push(he))}return F}function h0(u,f){return f=ta(f,u),u=sN(u,f),u==null||delete u[Mr(qi(f))]}function wC(u,f,_,I){return Rh(u,f,_(Xa(u,f)),I)}function $d(u,f,_,I){for(var x=u.length,D=I?x:-1;(I?D--:++D<x)&&f(u[D],D,u););return _?Zi(u,I?0:D,I?D+1:x):Zi(u,I?D+1:0,I?x:D)}function DC(u,f){var _=u;return _ instanceof xt&&(_=_.value()),kg(f,function(I,x){return x.func.apply(x.thisArg,qo([I],x.args))},_)}function u0(u,f,_){var I=u.length;if(I<2)return I?ea(u[0]):[];for(var x=-1,D=j(I);++x<I;)for(var U=u[x],F=-1;++F<I;)F!=x&&(D[x]=Nh(D[x]||U,u[F],f,_));return ea(Ns(D,1),f,_)}function LC(u,f,_){for(var I=-1,x=u.length,D=f.length,U={};++I<x;){var F=I<D?f[I]:s;_(U,u[I],F)}return U}function d0(u){return Bn(u)?u:[]}function f0(u){return typeof u=="function"?u:ai}function ta(u,f){return ht(u)?u:I0(u,f)?[u]:aN(Wt(u))}var NB=mt;function na(u,f,_){var I=u.length;return _=_===s?I:_,!f&&_>=I?u:Zi(u,f,_)}var MC=fk||function(u){return Cs.clearTimeout(u)};function PC(u,f){if(f)return u.slice();var _=u.length,I=tC?tC(_):new u.constructor(_);return u.copy(I),I}function p0(u){var f=new u.constructor(u.byteLength);return new kd(f).set(new kd(u)),f}function xB(u,f){var _=f?p0(u.buffer):u.buffer;return new u.constructor(_,u.byteOffset,u.byteLength)}function vB(u){var f=new u.constructor(u.source,_y.exec(u));return f.lastIndex=u.lastIndex,f}function RB(u){return yh?rn(yh.call(u)):{}}function bC(u,f){var _=f?p0(u.buffer):u.buffer;return new u.constructor(_,u.byteOffset,u.length)}function UC(u,f){if(u!==f){var _=u!==s,I=u===null,x=u===u,D=Ci(u),U=f!==s,F=f===null,z=f===f,le=Ci(f);if(!F&&!le&&!D&&u>f||D&&U&&z&&!F&&!le||I&&U&&z||!_&&z||!x)return 1;if(!I&&!D&&!le&&u<f||le&&_&&x&&!I&&!D||F&&_&&x||!U&&x||!z)return-1}return 0}function wB(u,f,_){for(var I=-1,x=u.criteria,D=f.criteria,U=x.length,F=_.length;++I<U;){var z=UC(x[I],D[I]);if(z){if(I>=F)return z;var le=_[I];return z*(le=="desc"?-1:1)}}return u.index-f.index}function GC(u,f,_,I){for(var x=-1,D=u.length,U=_.length,F=-1,z=f.length,le=$n(D-U,0),he=j(z+le),de=!I;++F<z;)he[F]=f[F];for(;++x<U;)(de||x<D)&&(he[_[x]]=u[x]);for(;le--;)he[F++]=u[x++];return he}function FC(u,f,_,I){for(var x=-1,D=u.length,U=-1,F=_.length,z=-1,le=f.length,he=$n(D-F,0),de=j(he+le),Ie=!I;++x<he;)de[x]=u[x];for(var Pe=x;++z<le;)de[Pe+z]=f[z];for(;++U<F;)(Ie||x<D)&&(de[Pe+_[U]]=u[x++]);return de}function ii(u,f){var _=-1,I=u.length;for(f||(f=j(I));++_<I;)f[_]=u[_];return f}function Lr(u,f,_,I){var x=!_;_||(_={});for(var D=-1,U=f.length;++D<U;){var F=f[D],z=I?I(_[F],u[F],F,_,u):s;z===s&&(z=u[F]),x?oo(_,F,z):Ch(_,F,z)}return _}function DB(u,f){return Lr(u,O0(u),f)}function LB(u,f){return Lr(u,jC(u),f)}function ef(u,f){return function(_,I){var x=ht(_)?GF:eB,D=f?f():{};return x(_,u,ze(I,2),D)}}function zc(u){return mt(function(f,_){var I=-1,x=_.length,D=x>1?_[x-1]:s,U=x>2?_[2]:s;for(D=u.length>3&&typeof D=="function"?(x--,D):s,U&&zs(_[0],_[1],U)&&(D=x<3?s:D,x=1),f=rn(f);++I<x;){var F=_[I];F&&u(f,F,I,D)}return f})}function kC(u,f){return function(_,I){if(_==null)return _;if(!ri(_))return u(_,I);for(var x=_.length,D=f?x:-1,U=rn(_);(f?D--:++D<x)&&I(U[D],D,U)!==!1;);return _}}function BC(u){return function(f,_,I){for(var x=-1,D=rn(f),U=I(f),F=U.length;F--;){var z=U[u?F:++x];if(_(D[z],z,D)===!1)break}return f}}function MB(u,f,_){var I=f&m,x=wh(u);function D(){var U=this&&this!==Cs&&this instanceof D?x:u;return U.apply(I?_:this,arguments)}return D}function VC(u){return function(f){f=Wt(f);var _=kc(f)?dr(f):s,I=_?_[0]:f.charAt(0),x=_?na(_,1).join(""):f.slice(1);return I[u]()+x}}function Kc(u){return function(f){return kg(kN(FN(f).replace(SF,"")),u,"")}}function wh(u){return function(){var f=arguments;switch(f.length){case 0:return new u;case 1:return new u(f[0]);case 2:return new u(f[0],f[1]);case 3:return new u(f[0],f[1],f[2]);case 4:return new u(f[0],f[1],f[2],f[3]);case 5:return new u(f[0],f[1],f[2],f[3],f[4]);case 6:return new u(f[0],f[1],f[2],f[3],f[4],f[5]);case 7:return new u(f[0],f[1],f[2],f[3],f[4],f[5],f[6])}var _=Xc(u.prototype),I=u.apply(_,f);return Nn(I)?I:_}}function PB(u,f,_){var I=wh(u);function x(){for(var D=arguments.length,U=j(D),F=D,z=Qc(x);F--;)U[F]=arguments[F];var le=D<3&&U[0]!==z&&U[D-1]!==z?[]:jo(U,z);if(D-=le.length,D<_)return zC(u,f,tf,x.placeholder,s,U,le,s,s,_-D);var he=this&&this!==Cs&&this instanceof x?I:u;return Ii(he,this,U)}return x}function HC(u){return function(f,_,I){var x=rn(f);if(!ri(f)){var D=ze(_,3);f=hs(f),_=function(F){return D(x[F],F,x)}}var U=u(f,_,I);return U>-1?x[D?f[U]:U]:s}}function WC(u){return co(function(f){var _=f.length,I=_,x=Ki.prototype.thru;for(u&&f.reverse();I--;){var D=f[I];if(typeof D!="function")throw new zi(a);if(x&&!U&&of(D)=="wrapper")var U=new Ki([],!0)}for(I=U?I:_;++I<_;){D=f[I];var F=of(D),z=F=="wrapper"?A0(D):s;z&&S0(z[0])&&z[1]==(L|y|R|P)&&!z[4].length&&z[9]==1?U=U[of(z[0])].apply(U,z[3]):U=D.length==1&&S0(D)?U[F]():U.thru(D)}return function(){var le=arguments,he=le[0];if(U&&le.length==1&&ht(he))return U.plant(he).value();for(var de=0,Ie=_?f[de].apply(this,le):he;++de<_;)Ie=f[de].call(this,Ie);return Ie}})}function tf(u,f,_,I,x,D,U,F,z,le){var he=f&L,de=f&m,Ie=f&O,Pe=f&(y|v),Qe=f&k,Tt=Ie?s:wh(u);function Ze(){for(var yt=arguments.length,Rt=j(yt),Ni=yt;Ni--;)Rt[Ni]=arguments[Ni];if(Pe)var Ks=Qc(Ze),xi=zF(Rt,Ks);if(I&&(Rt=GC(Rt,I,x,Pe)),D&&(Rt=FC(Rt,D,U,Pe)),yt-=xi,Pe&&yt<le){var Vn=jo(Rt,Ks);return zC(u,f,tf,Ze.placeholder,_,Rt,Vn,F,z,le-yt)}var Er=de?_:this,fo=Ie?Er[u]:u;return yt=Rt.length,F?Rt=e4(Rt,F):Qe&&yt>1&&Rt.reverse(),he&&z<yt&&(Rt.length=z),this&&this!==Cs&&this instanceof Ze&&(fo=Tt||wh(fo)),fo.apply(Er,Rt)}return Ze}function YC(u,f){return function(_,I){return cB(_,u,f(I),{})}}function nf(u,f){return function(_,I){var x;if(_===s&&I===s)return f;if(_!==s&&(x=_),I!==s){if(x===s)return I;typeof _=="string"||typeof I=="string"?(_=yi(_),I=yi(I)):(_=RC(_),I=RC(I)),x=u(_,I)}return x}}function E0(u){return co(function(f){return f=In(f,Si(ze())),mt(function(_){var I=this;return u(f,function(x){return Ii(x,I,_)})})})}function sf(u,f){f=f===s?" ":yi(f);var _=f.length;if(_<2)return _?c0(f,u):f;var I=c0(f,Wd(u/Bc(f)));return kc(f)?na(dr(I),0,u).join(""):I.slice(0,u)}function bB(u,f,_,I){var x=f&m,D=wh(u);function U(){for(var F=-1,z=arguments.length,le=-1,he=I.length,de=j(he+z),Ie=this&&this!==Cs&&this instanceof U?D:u;++le<he;)de[le]=I[le];for(;z--;)de[le++]=arguments[++F];return Ii(Ie,x?_:this,de)}return U}function XC(u){return function(f,_,I){return I&&typeof I!="number"&&zs(f,_,I)&&(_=I=s),f=uo(f),_===s?(_=f,f=0):_=uo(_),I=I===s?f<_?1:-1:uo(I),mB(f,_,I,u)}}function rf(u){return function(f,_){return typeof f=="string"&&typeof _=="string"||(f=ji(f),_=ji(_)),u(f,_)}}function zC(u,f,_,I,x,D,U,F,z,le){var he=f&y,de=he?U:s,Ie=he?s:U,Pe=he?D:s,Qe=he?s:D;f|=he?R:M,f&=~(he?M:R),f&S||(f&=-4);var Tt=[u,f,x,Pe,de,Qe,Ie,F,z,le],Ze=_.apply(s,Tt);return S0(u)&&iN(Ze,Tt),Ze.placeholder=I,rN(Ze,u,f)}function g0(u){var f=Jn[u];return function(_,I){if(_=ji(_),I=I==null?0:Ds(Et(I),292),I&&rC(_)){var x=(Wt(_)+"e").split("e"),D=f(x[0]+"e"+(+x[1]+I));return x=(Wt(D)+"e").split("e"),+(x[0]+"e"+(+x[1]-I))}return f(_)}}var UB=Wc&&1/Md(new Wc([,-0]))[1]==se?function(u){return new Wc(u)}:F0;function KC(u){return function(f){var _=Ls(f);return _==jn?zg(f):_==ws?$F(f):XF(f,u(f))}}function ao(u,f,_,I,x,D,U,F){var z=f&O;if(!z&&typeof u!="function")throw new zi(a);var le=I?I.length:0;if(le||(f&=-97,I=x=s),U=U===s?U:$n(Et(U),0),F=F===s?F:Et(F),le-=x?x.length:0,f&M){var he=I,de=x;I=x=s}var Ie=z?s:A0(u),Pe=[u,f,_,I,x,he,de,D,U,F];if(Ie&&jB(Pe,Ie),u=Pe[0],f=Pe[1],_=Pe[2],I=Pe[3],x=Pe[4],F=Pe[9]=Pe[9]===s?z?0:u.length:$n(Pe[9]-le,0),!F&&f&(y|v)&&(f&=-25),!f||f==m)var Qe=MB(u,f,_);else f==y||f==v?Qe=PB(u,f,F):(f==R||f==(m|R))&&!x.length?Qe=bB(u,f,_,I):Qe=tf.apply(s,Pe);var Tt=Ie?xC:iN;return rN(Tt(Qe,Pe),u,f)}function QC(u,f,_,I){return u===s||pr(u,Hc[_])&&!Zt.call(I,_)?f:u}function ZC(u,f,_,I,x,D){return Nn(u)&&Nn(f)&&(D.set(f,u),jd(u,f,s,ZC,D),D.delete(f)),u}function GB(u){return Mh(u)?s:u}function qC(u,f,_,I,x,D){var U=_&T,F=u.length,z=f.length;if(F!=z&&!(U&&z>F))return!1;var le=D.get(u),he=D.get(f);if(le&&he)return le==f&&he==u;var de=-1,Ie=!0,Pe=_&A?new Wa:s;for(D.set(u,f),D.set(f,u);++de<F;){var Qe=u[de],Tt=f[de];if(I)var Ze=U?I(Tt,Qe,de,f,u,D):I(Qe,Tt,de,u,f,D);if(Ze!==s){if(Ze)continue;Ie=!1;break}if(Pe){if(!Bg(f,function(yt,Rt){if(!Ah(Pe,Rt)&&(Qe===yt||x(Qe,yt,_,I,D)))return Pe.push(Rt)})){Ie=!1;break}}else if(!(Qe===Tt||x(Qe,Tt,_,I,D))){Ie=!1;break}}return D.delete(u),D.delete(f),Ie}function FB(u,f,_,I,x,D,U){switch(_){case Qo:if(u.byteLength!=f.byteLength||u.byteOffset!=f.byteOffset)return!1;u=u.buffer,f=f.buffer;case ka:return!(u.byteLength!=f.byteLength||!D(new kd(u),new kd(f)));case _t:case qn:case On:return pr(+u,+f);case ys:return u.name==f.name&&u.message==f.message;case so:case Rr:return u==f+"";case jn:var F=zg;case ws:var z=I&T;if(F||(F=Md),u.size!=f.size&&!z)return!1;var le=U.get(u);if(le)return le==f;I|=A,U.set(u,f);var he=qC(F(u),F(f),I,x,D,U);return U.delete(u),he;case si:if(yh)return yh.call(u)==yh.call(f)}return!1}function kB(u,f,_,I,x,D){var U=_&T,F=_0(u),z=F.length,le=_0(f),he=le.length;if(z!=he&&!U)return!1;for(var de=z;de--;){var Ie=F[de];if(!(U?Ie in f:Zt.call(f,Ie)))return!1}var Pe=D.get(u),Qe=D.get(f);if(Pe&&Qe)return Pe==f&&Qe==u;var Tt=!0;D.set(u,f),D.set(f,u);for(var Ze=U;++de<z;){Ie=F[de];var yt=u[Ie],Rt=f[Ie];if(I)var Ni=U?I(Rt,yt,Ie,f,u,D):I(yt,Rt,Ie,u,f,D);if(!(Ni===s?yt===Rt||x(yt,Rt,_,I,D):Ni)){Tt=!1;break}Ze||(Ze=Ie=="constructor")}if(Tt&&!Ze){var Ks=u.constructor,xi=f.constructor;Ks!=xi&&"constructor"in u&&"constructor"in f&&!(typeof Ks=="function"&&Ks instanceof Ks&&typeof xi=="function"&&xi instanceof xi)&&(Tt=!1)}return D.delete(u),D.delete(f),Tt}function co(u){return C0(nN(u,s,uN),u+"")}function _0(u){return gC(u,hs,O0)}function T0(u){return gC(u,oi,jC)}var A0=Xd?function(u){return Xd.get(u)}:F0;function of(u){for(var f=u.name+"",_=Yc[f],I=Zt.call(Yc,f)?_.length:0;I--;){var x=_[I],D=x.func;if(D==null||D==u)return x.name}return f}function Qc(u){var f=Zt.call(w,"placeholder")?w:u;return f.placeholder}function ze(){var u=w.iteratee||U0;return u=u===U0?AC:u,arguments.length?u(arguments[0],arguments[1]):u}function af(u,f){var _=u.__data__;return KB(f)?_[typeof f=="string"?"string":"hash"]:_.map}function m0(u){for(var f=hs(u),_=f.length;_--;){var I=f[_],x=u[I];f[_]=[I,x,eN(x)]}return f}function za(u,f){var _=qF(u,f);return TC(_)?_:s}function BB(u){var f=Zt.call(u,Va),_=u[Va];try{u[Va]=s;var I=!0}catch{}var x=Gd.call(u);return I&&(f?u[Va]=_:delete u[Va]),x}var O0=Qg?function(u){return u==null?[]:(u=rn(u),Zo(Qg(u),function(f){return sC.call(u,f)}))}:k0,jC=Qg?function(u){for(var f=[];u;)qo(f,O0(u)),u=Bd(u);return f}:k0,Ls=Xs;(Zg&&Ls(new Zg(new ArrayBuffer(1)))!=Qo||Oh&&Ls(new Oh)!=jn||qg&&Ls(qg.resolve())!=Rs||Wc&&Ls(new Wc)!=ws||Ih&&Ls(new Ih)!=Ko)&&(Ls=function(u){var f=Xs(u),_=f==Yn?u.constructor:s,I=_?Ka(_):"";if(I)switch(I){case Ik:return Qo;case Sk:return jn;case yk:return Rs;case Ck:return ws;case Nk:return Ko}return f});function VB(u,f,_){for(var I=-1,x=_.length;++I<x;){var D=_[I],U=D.size;switch(D.type){case"drop":u+=U;break;case"dropRight":f-=U;break;case"take":f=Ds(f,u+U);break;case"takeRight":u=$n(u,f-U);break}}return{start:u,end:f}}function HB(u){var f=u.match(Q5);return f?f[1].split(Z5):[]}function JC(u,f,_){f=ta(f,u);for(var I=-1,x=f.length,D=!1;++I<x;){var U=Mr(f[I]);if(!(D=u!=null&&_(u,U)))break;u=u[U]}return D||++I!=x?D:(x=u==null?0:u.length,!!x&&pf(x)&&lo(U,x)&&(ht(u)||Qa(u)))}function WB(u){var f=u.length,_=new u.constructor(f);return f&&typeof u[0]=="string"&&Zt.call(u,"index")&&(_.index=u.index,_.input=u.input),_}function $C(u){return typeof u.constructor=="function"&&!Dh(u)?Xc(Bd(u)):{}}function YB(u,f,_){var I=u.constructor;switch(f){case ka:return p0(u);case _t:case qn:return new I(+u);case Qo:return xB(u,_);case wr:case Og:case Ig:case Sg:case yg:case Cg:case Ng:case xg:case vg:return bC(u,_);case jn:return new I;case On:case Rr:return new I(u);case so:return vB(u);case ws:return new I;case si:return RB(u)}}function XB(u,f){var _=f.length;if(!_)return u;var I=_-1;return f[I]=(_>1?"& ":"")+f[I],f=f.join(_>2?", ":" "),u.replace(K5,`{
/* [wrapped with `+f+`] */
`)}function zB(u){return ht(u)||Qa(u)||!!(iC&&u&&u[iC])}function lo(u,f){var _=typeof u;return f=f??ue,!!f&&(_=="number"||_!="symbol"&&iF.test(u))&&u>-1&&u%1==0&&u<f}function zs(u,f,_){if(!Nn(_))return!1;var I=typeof f;return(I=="number"?ri(_)&&lo(f,_.length):I=="string"&&f in _)?pr(_[f],u):!1}function I0(u,f){if(ht(u))return!1;var _=typeof u;return _=="number"||_=="symbol"||_=="boolean"||u==null||Ci(u)?!0:W5.test(u)||!H5.test(u)||f!=null&&u in rn(f)}function KB(u){var f=typeof u;return f=="string"||f=="number"||f=="symbol"||f=="boolean"?u!=="__proto__":u===null}function S0(u){var f=of(u),_=w[f];if(typeof _!="function"||!(f in xt.prototype))return!1;if(u===_)return!0;var I=A0(_);return!!I&&u===I[0]}function QB(u){return!!eC&&eC in u}var ZB=bd?ho:B0;function Dh(u){var f=u&&u.constructor,_=typeof f=="function"&&f.prototype||Hc;return u===_}function eN(u){return u===u&&!Nn(u)}function tN(u,f){return function(_){return _==null?!1:_[u]===f&&(f!==s||u in rn(_))}}function qB(u){var f=df(u,function(I){return _.size===h&&_.clear(),I}),_=f.cache;return f}function jB(u,f){var _=u[1],I=f[1],x=_|I,D=x<(m|O|L),U=I==L&&_==y||I==L&&_==P&&u[7].length<=f[8]||I==(L|P)&&f[7].length<=f[8]&&_==y;if(!(D||U))return u;I&m&&(u[2]=f[2],x|=_&m?0:S);var F=f[3];if(F){var z=u[3];u[3]=z?GC(z,F,f[4]):F,u[4]=z?jo(u[3],d):f[4]}return F=f[5],F&&(z=u[5],u[5]=z?FC(z,F,f[6]):F,u[6]=z?jo(u[5],d):f[6]),F=f[7],F&&(u[7]=F),I&L&&(u[8]=u[8]==null?f[8]:Ds(u[8],f[8])),u[9]==null&&(u[9]=f[9]),u[0]=f[0],u[1]=x,u}function JB(u){var f=[];if(u!=null)for(var _ in rn(u))f.push(_);return f}function $B(u){return Gd.call(u)}function nN(u,f,_){return f=$n(f===s?u.length-1:f,0),function(){for(var I=arguments,x=-1,D=$n(I.length-f,0),U=j(D);++x<D;)U[x]=I[f+x];x=-1;for(var F=j(f+1);++x<f;)F[x]=I[x];return F[f]=_(U),Ii(u,this,F)}}function sN(u,f){return f.length<2?u:Xa(u,Zi(f,0,-1))}function e4(u,f){for(var _=u.length,I=Ds(f.length,_),x=ii(u);I--;){var D=f[I];u[I]=lo(D,_)?x[D]:s}return u}function y0(u,f){if(!(f==="constructor"&&typeof u[f]=="function")&&f!="__proto__")return u[f]}var iN=oN(xC),Lh=Ek||function(u,f){return Cs.setTimeout(u,f)},C0=oN(SB);function rN(u,f,_){var I=f+"";return C0(u,XB(I,t4(HB(I),_)))}function oN(u){var f=0,_=0;return function(){var I=Ak(),x=K-(I-_);if(_=I,x>0){if(++f>=X)return arguments[0]}else f=0;return u.apply(s,arguments)}}function cf(u,f){var _=-1,I=u.length,x=I-1;for(f=f===s?I:f;++_<f;){var D=a0(_,x),U=u[D];u[D]=u[_],u[_]=U}return u.length=f,u}var aN=qB(function(u){var f=[];return u.charCodeAt(0)===46&&f.push(""),u.replace(Y5,function(_,I,x,D){f.push(x?D.replace(J5,"$1"):I||_)}),f});function Mr(u){if(typeof u=="string"||Ci(u))return u;var f=u+"";return f=="0"&&1/u==-1/0?"-0":f}function Ka(u){if(u!=null){try{return Ud.call(u)}catch{}try{return u+""}catch{}}return""}function t4(u,f){return Xi(At,function(_){var I="_."+_[0];f&_[1]&&!Dd(u,I)&&u.push(I)}),u.sort()}function cN(u){if(u instanceof xt)return u.clone();var f=new Ki(u.__wrapped__,u.__chain__);return f.__actions__=ii(u.__actions__),f.__index__=u.__index__,f.__values__=u.__values__,f}function n4(u,f,_){(_?zs(u,f,_):f===s)?f=1:f=$n(Et(f),0);var I=u==null?0:u.length;if(!I||f<1)return[];for(var x=0,D=0,U=j(Wd(I/f));x<I;)U[D++]=Zi(u,x,x+=f);return U}function s4(u){for(var f=-1,_=u==null?0:u.length,I=0,x=[];++f<_;){var D=u[f];D&&(x[I++]=D)}return x}function i4(){var u=arguments.length;if(!u)return[];for(var f=j(u-1),_=arguments[0],I=u;I--;)f[I-1]=arguments[I];return qo(ht(_)?ii(_):[_],Ns(f,1))}var r4=mt(function(u,f){return Bn(u)?Nh(u,Ns(f,1,Bn,!0)):[]}),o4=mt(function(u,f){var _=qi(f);return Bn(_)&&(_=s),Bn(u)?Nh(u,Ns(f,1,Bn,!0),ze(_,2)):[]}),a4=mt(function(u,f){var _=qi(f);return Bn(_)&&(_=s),Bn(u)?Nh(u,Ns(f,1,Bn,!0),s,_):[]});function c4(u,f,_){var I=u==null?0:u.length;return I?(f=_||f===s?1:Et(f),Zi(u,f<0?0:f,I)):[]}function l4(u,f,_){var I=u==null?0:u.length;return I?(f=_||f===s?1:Et(f),f=I-f,Zi(u,0,f<0?0:f)):[]}function h4(u,f){return u&&u.length?$d(u,ze(f,3),!0,!0):[]}function u4(u,f){return u&&u.length?$d(u,ze(f,3),!0):[]}function d4(u,f,_,I){var x=u==null?0:u.length;return x?(_&&typeof _!="number"&&zs(u,f,_)&&(_=0,I=x),iB(u,f,_,I)):[]}function lN(u,f,_){var I=u==null?0:u.length;if(!I)return-1;var x=_==null?0:Et(_);return x<0&&(x=$n(I+x,0)),Ld(u,ze(f,3),x)}function hN(u,f,_){var I=u==null?0:u.length;if(!I)return-1;var x=I-1;return _!==s&&(x=Et(_),x=_<0?$n(I+x,0):Ds(x,I-1)),Ld(u,ze(f,3),x,!0)}function uN(u){var f=u==null?0:u.length;return f?Ns(u,1):[]}function f4(u){var f=u==null?0:u.length;return f?Ns(u,se):[]}function p4(u,f){var _=u==null?0:u.length;return _?(f=f===s?1:Et(f),Ns(u,f)):[]}function E4(u){for(var f=-1,_=u==null?0:u.length,I={};++f<_;){var x=u[f];I[x[0]]=x[1]}return I}function dN(u){return u&&u.length?u[0]:s}function g4(u,f,_){var I=u==null?0:u.length;if(!I)return-1;var x=_==null?0:Et(_);return x<0&&(x=$n(I+x,0)),Fc(u,f,x)}function _4(u){var f=u==null?0:u.length;return f?Zi(u,0,-1):[]}var T4=mt(function(u){var f=In(u,d0);return f.length&&f[0]===u[0]?n0(f):[]}),A4=mt(function(u){var f=qi(u),_=In(u,d0);return f===qi(_)?f=s:_.pop(),_.length&&_[0]===u[0]?n0(_,ze(f,2)):[]}),m4=mt(function(u){var f=qi(u),_=In(u,d0);return f=typeof f=="function"?f:s,f&&_.pop(),_.length&&_[0]===u[0]?n0(_,s,f):[]});function O4(u,f){return u==null?"":_k.call(u,f)}function qi(u){var f=u==null?0:u.length;return f?u[f-1]:s}function I4(u,f,_){var I=u==null?0:u.length;if(!I)return-1;var x=I;return _!==s&&(x=Et(_),x=x<0?$n(I+x,0):Ds(x,I-1)),f===f?tk(u,f,x):Ld(u,zy,x,!0)}function S4(u,f){return u&&u.length?SC(u,Et(f)):s}var y4=mt(fN);function fN(u,f){return u&&u.length&&f&&f.length?o0(u,f):u}function C4(u,f,_){return u&&u.length&&f&&f.length?o0(u,f,ze(_,2)):u}function N4(u,f,_){return u&&u.length&&f&&f.length?o0(u,f,s,_):u}var x4=co(function(u,f){var _=u==null?0:u.length,I=Jg(u,f);return NC(u,In(f,function(x){return lo(x,_)?+x:x}).sort(UC)),I});function v4(u,f){var _=[];if(!(u&&u.length))return _;var I=-1,x=[],D=u.length;for(f=ze(f,3);++I<D;){var U=u[I];f(U,I,u)&&(_.push(U),x.push(I))}return NC(u,x),_}function N0(u){return u==null?u:Ok.call(u)}function R4(u,f,_){var I=u==null?0:u.length;return I?(_&&typeof _!="number"&&zs(u,f,_)?(f=0,_=I):(f=f==null?0:Et(f),_=_===s?I:Et(_)),Zi(u,f,_)):[]}function w4(u,f){return Jd(u,f)}function D4(u,f,_){return l0(u,f,ze(_,2))}function L4(u,f){var _=u==null?0:u.length;if(_){var I=Jd(u,f);if(I<_&&pr(u[I],f))return I}return-1}function M4(u,f){return Jd(u,f,!0)}function P4(u,f,_){return l0(u,f,ze(_,2),!0)}function b4(u,f){var _=u==null?0:u.length;if(_){var I=Jd(u,f,!0)-1;if(pr(u[I],f))return I}return-1}function U4(u){return u&&u.length?vC(u):[]}function G4(u,f){return u&&u.length?vC(u,ze(f,2)):[]}function F4(u){var f=u==null?0:u.length;return f?Zi(u,1,f):[]}function k4(u,f,_){return u&&u.length?(f=_||f===s?1:Et(f),Zi(u,0,f<0?0:f)):[]}function B4(u,f,_){var I=u==null?0:u.length;return I?(f=_||f===s?1:Et(f),f=I-f,Zi(u,f<0?0:f,I)):[]}function V4(u,f){return u&&u.length?$d(u,ze(f,3),!1,!0):[]}function H4(u,f){return u&&u.length?$d(u,ze(f,3)):[]}var W4=mt(function(u){return ea(Ns(u,1,Bn,!0))}),Y4=mt(function(u){var f=qi(u);return Bn(f)&&(f=s),ea(Ns(u,1,Bn,!0),ze(f,2))}),X4=mt(function(u){var f=qi(u);return f=typeof f=="function"?f:s,ea(Ns(u,1,Bn,!0),s,f)});function z4(u){return u&&u.length?ea(u):[]}function K4(u,f){return u&&u.length?ea(u,ze(f,2)):[]}function Q4(u,f){return f=typeof f=="function"?f:s,u&&u.length?ea(u,s,f):[]}function x0(u){if(!(u&&u.length))return[];var f=0;return u=Zo(u,function(_){if(Bn(_))return f=$n(_.length,f),!0}),Yg(f,function(_){return In(u,Vg(_))})}function pN(u,f){if(!(u&&u.length))return[];var _=x0(u);return f==null?_:In(_,function(I){return Ii(f,s,I)})}var Z4=mt(function(u,f){return Bn(u)?Nh(u,f):[]}),q4=mt(function(u){return u0(Zo(u,Bn))}),j4=mt(function(u){var f=qi(u);return Bn(f)&&(f=s),u0(Zo(u,Bn),ze(f,2))}),J4=mt(function(u){var f=qi(u);return f=typeof f=="function"?f:s,u0(Zo(u,Bn),s,f)}),$4=mt(x0);function eV(u,f){return LC(u||[],f||[],Ch)}function tV(u,f){return LC(u||[],f||[],Rh)}var nV=mt(function(u){var f=u.length,_=f>1?u[f-1]:s;return _=typeof _=="function"?(u.pop(),_):s,pN(u,_)});function EN(u){var f=w(u);return f.__chain__=!0,f}function sV(u,f){return f(u),u}function lf(u,f){return f(u)}var iV=co(function(u){var f=u.length,_=f?u[0]:0,I=this.__wrapped__,x=function(D){return Jg(D,u)};return f>1||this.__actions__.length||!(I instanceof xt)||!lo(_)?this.thru(x):(I=I.slice(_,+_+(f?1:0)),I.__actions__.push({func:lf,args:[x],thisArg:s}),new Ki(I,this.__chain__).thru(function(D){return f&&!D.length&&D.push(s),D}))});function rV(){return EN(this)}function oV(){return new Ki(this.value(),this.__chain__)}function aV(){this.__values__===s&&(this.__values__=RN(this.value()));var u=this.__index__>=this.__values__.length,f=u?s:this.__values__[this.__index__++];return{done:u,value:f}}function cV(){return this}function lV(u){for(var f,_=this;_ instanceof Kd;){var I=cN(_);I.__index__=0,I.__values__=s,f?x.__wrapped__=I:f=I;var x=I;_=_.__wrapped__}return x.__wrapped__=u,f}function hV(){var u=this.__wrapped__;if(u instanceof xt){var f=u;return this.__actions__.length&&(f=new xt(this)),f=f.reverse(),f.__actions__.push({func:lf,args:[N0],thisArg:s}),new Ki(f,this.__chain__)}return this.thru(N0)}function uV(){return DC(this.__wrapped__,this.__actions__)}var dV=ef(function(u,f,_){Zt.call(u,_)?++u[_]:oo(u,_,1)});function fV(u,f,_){var I=ht(u)?Yy:sB;return _&&zs(u,f,_)&&(f=s),I(u,ze(f,3))}function pV(u,f){var _=ht(u)?Zo:pC;return _(u,ze(f,3))}var EV=HC(lN),gV=HC(hN);function _V(u,f){return Ns(hf(u,f),1)}function TV(u,f){return Ns(hf(u,f),se)}function AV(u,f,_){return _=_===s?1:Et(_),Ns(hf(u,f),_)}function gN(u,f){var _=ht(u)?Xi:$o;return _(u,ze(f,3))}function _N(u,f){var _=ht(u)?FF:fC;return _(u,ze(f,3))}var mV=ef(function(u,f,_){Zt.call(u,_)?u[_].push(f):oo(u,_,[f])});function OV(u,f,_,I){u=ri(u)?u:qc(u),_=_&&!I?Et(_):0;var x=u.length;return _<0&&(_=$n(x+_,0)),Ef(u)?_<=x&&u.indexOf(f,_)>-1:!!x&&Fc(u,f,_)>-1}var IV=mt(function(u,f,_){var I=-1,x=typeof f=="function",D=ri(u)?j(u.length):[];return $o(u,function(U){D[++I]=x?Ii(f,U,_):xh(U,f,_)}),D}),SV=ef(function(u,f,_){oo(u,_,f)});function hf(u,f){var _=ht(u)?In:mC;return _(u,ze(f,3))}function yV(u,f,_,I){return u==null?[]:(ht(f)||(f=f==null?[]:[f]),_=I?s:_,ht(_)||(_=_==null?[]:[_]),yC(u,f,_))}var CV=ef(function(u,f,_){u[_?0:1].push(f)},function(){return[[],[]]});function NV(u,f,_){var I=ht(u)?kg:Qy,x=arguments.length<3;return I(u,ze(f,4),_,x,$o)}function xV(u,f,_){var I=ht(u)?kF:Qy,x=arguments.length<3;return I(u,ze(f,4),_,x,fC)}function vV(u,f){var _=ht(u)?Zo:pC;return _(u,ff(ze(f,3)))}function RV(u){var f=ht(u)?lC:OB;return f(u)}function wV(u,f,_){(_?zs(u,f,_):f===s)?f=1:f=Et(f);var I=ht(u)?Jk:IB;return I(u,f)}function DV(u){var f=ht(u)?$k:yB;return f(u)}function LV(u){if(u==null)return 0;if(ri(u))return Ef(u)?Bc(u):u.length;var f=Ls(u);return f==jn||f==ws?u.size:i0(u).length}function MV(u,f,_){var I=ht(u)?Bg:CB;return _&&zs(u,f,_)&&(f=s),I(u,ze(f,3))}var PV=mt(function(u,f){if(u==null)return[];var _=f.length;return _>1&&zs(u,f[0],f[1])?f=[]:_>2&&zs(f[0],f[1],f[2])&&(f=[f[0]]),yC(u,Ns(f,1),[])}),uf=pk||function(){return Cs.Date.now()};function bV(u,f){if(typeof f!="function")throw new zi(a);return u=Et(u),function(){if(--u<1)return f.apply(this,arguments)}}function TN(u,f,_){return f=_?s:f,f=u&&f==null?u.length:f,ao(u,L,s,s,s,s,f)}function AN(u,f){var _;if(typeof f!="function")throw new zi(a);return u=Et(u),function(){return--u>0&&(_=f.apply(this,arguments)),u<=1&&(f=s),_}}var v0=mt(function(u,f,_){var I=m;if(_.length){var x=jo(_,Qc(v0));I|=R}return ao(u,I,f,_,x)}),mN=mt(function(u,f,_){var I=m|O;if(_.length){var x=jo(_,Qc(mN));I|=R}return ao(f,I,u,_,x)});function ON(u,f,_){f=_?s:f;var I=ao(u,y,s,s,s,s,s,f);return I.placeholder=ON.placeholder,I}function IN(u,f,_){f=_?s:f;var I=ao(u,v,s,s,s,s,s,f);return I.placeholder=IN.placeholder,I}function SN(u,f,_){var I,x,D,U,F,z,le=0,he=!1,de=!1,Ie=!0;if(typeof u!="function")throw new zi(a);f=ji(f)||0,Nn(_)&&(he=!!_.leading,de="maxWait"in _,D=de?$n(ji(_.maxWait)||0,f):D,Ie="trailing"in _?!!_.trailing:Ie);function Pe(Vn){var Er=I,fo=x;return I=x=s,le=Vn,U=u.apply(fo,Er),U}function Qe(Vn){return le=Vn,F=Lh(yt,f),he?Pe(Vn):U}function Tt(Vn){var Er=Vn-z,fo=Vn-le,HN=f-Er;return de?Ds(HN,D-fo):HN}function Ze(Vn){var Er=Vn-z,fo=Vn-le;return z===s||Er>=f||Er<0||de&&fo>=D}function yt(){var Vn=uf();if(Ze(Vn))return Rt(Vn);F=Lh(yt,Tt(Vn))}function Rt(Vn){return F=s,Ie&&I?Pe(Vn):(I=x=s,U)}function Ni(){F!==s&&MC(F),le=0,I=z=x=F=s}function Ks(){return F===s?U:Rt(uf())}function xi(){var Vn=uf(),Er=Ze(Vn);if(I=arguments,x=this,z=Vn,Er){if(F===s)return Qe(z);if(de)return MC(F),F=Lh(yt,f),Pe(z)}return F===s&&(F=Lh(yt,f)),U}return xi.cancel=Ni,xi.flush=Ks,xi}var UV=mt(function(u,f){return dC(u,1,f)}),GV=mt(function(u,f,_){return dC(u,ji(f)||0,_)});function FV(u){return ao(u,k)}function df(u,f){if(typeof u!="function"||f!=null&&typeof f!="function")throw new zi(a);var _=function(){var I=arguments,x=f?f.apply(this,I):I[0],D=_.cache;if(D.has(x))return D.get(x);var U=u.apply(this,I);return _.cache=D.set(x,U)||D,U};return _.cache=new(df.Cache||ro),_}df.Cache=ro;function ff(u){if(typeof u!="function")throw new zi(a);return function(){var f=arguments;switch(f.length){case 0:return!u.call(this);case 1:return!u.call(this,f[0]);case 2:return!u.call(this,f[0],f[1]);case 3:return!u.call(this,f[0],f[1],f[2])}return!u.apply(this,f)}}function kV(u){return AN(2,u)}var BV=NB(function(u,f){f=f.length==1&&ht(f[0])?In(f[0],Si(ze())):In(Ns(f,1),Si(ze()));var _=f.length;return mt(function(I){for(var x=-1,D=Ds(I.length,_);++x<D;)I[x]=f[x].call(this,I[x]);return Ii(u,this,I)})}),R0=mt(function(u,f){var _=jo(f,Qc(R0));return ao(u,R,s,f,_)}),yN=mt(function(u,f){var _=jo(f,Qc(yN));return ao(u,M,s,f,_)}),VV=co(function(u,f){return ao(u,P,s,s,s,f)});function HV(u,f){if(typeof u!="function")throw new zi(a);return f=f===s?f:Et(f),mt(u,f)}function WV(u,f){if(typeof u!="function")throw new zi(a);return f=f==null?0:$n(Et(f),0),mt(function(_){var I=_[f],x=na(_,0,f);return I&&qo(x,I),Ii(u,this,x)})}function YV(u,f,_){var I=!0,x=!0;if(typeof u!="function")throw new zi(a);return Nn(_)&&(I="leading"in _?!!_.leading:I,x="trailing"in _?!!_.trailing:x),SN(u,f,{leading:I,maxWait:f,trailing:x})}function XV(u){return TN(u,1)}function zV(u,f){return R0(f0(f),u)}function KV(){if(!arguments.length)return[];var u=arguments[0];return ht(u)?u:[u]}function QV(u){return Qi(u,g)}function ZV(u,f){return f=typeof f=="function"?f:s,Qi(u,g,f)}function qV(u){return Qi(u,p|g)}function jV(u,f){return f=typeof f=="function"?f:s,Qi(u,p|g,f)}function JV(u,f){return f==null||uC(u,f,hs(f))}function pr(u,f){return u===f||u!==u&&f!==f}var $V=rf(t0),eH=rf(function(u,f){return u>=f}),Qa=_C(function(){return arguments}())?_C:function(u){return bn(u)&&Zt.call(u,"callee")&&!sC.call(u,"callee")},ht=j.isArray,tH=Fy?Si(Fy):lB;function ri(u){return u!=null&&pf(u.length)&&!ho(u)}function Bn(u){return bn(u)&&ri(u)}function nH(u){return u===!0||u===!1||bn(u)&&Xs(u)==_t}var sa=gk||B0,sH=ky?Si(ky):hB;function iH(u){return bn(u)&&u.nodeType===1&&!Mh(u)}function rH(u){if(u==null)return!0;if(ri(u)&&(ht(u)||typeof u=="string"||typeof u.splice=="function"||sa(u)||Zc(u)||Qa(u)))return!u.length;var f=Ls(u);if(f==jn||f==ws)return!u.size;if(Dh(u))return!i0(u).length;for(var _ in u)if(Zt.call(u,_))return!1;return!0}function oH(u,f){return vh(u,f)}function aH(u,f,_){_=typeof _=="function"?_:s;var I=_?_(u,f):s;return I===s?vh(u,f,s,_):!!I}function w0(u){if(!bn(u))return!1;var f=Xs(u);return f==ys||f==ni||typeof u.message=="string"&&typeof u.name=="string"&&!Mh(u)}function cH(u){return typeof u=="number"&&rC(u)}function ho(u){if(!Nn(u))return!1;var f=Xs(u);return f==Hi||f==Xo||f==hn||f==no}function CN(u){return typeof u=="number"&&u==Et(u)}function pf(u){return typeof u=="number"&&u>-1&&u%1==0&&u<=ue}function Nn(u){var f=typeof u;return u!=null&&(f=="object"||f=="function")}function bn(u){return u!=null&&typeof u=="object"}var NN=By?Si(By):dB;function lH(u,f){return u===f||s0(u,f,m0(f))}function hH(u,f,_){return _=typeof _=="function"?_:s,s0(u,f,m0(f),_)}function uH(u){return xN(u)&&u!=+u}function dH(u){if(ZB(u))throw new lt(o);return TC(u)}function fH(u){return u===null}function pH(u){return u==null}function xN(u){return typeof u=="number"||bn(u)&&Xs(u)==On}function Mh(u){if(!bn(u)||Xs(u)!=Yn)return!1;var f=Bd(u);if(f===null)return!0;var _=Zt.call(f,"constructor")&&f.constructor;return typeof _=="function"&&_ instanceof _&&Ud.call(_)==hk}var D0=Vy?Si(Vy):fB;function EH(u){return CN(u)&&u>=-9007199254740991&&u<=ue}var vN=Hy?Si(Hy):pB;function Ef(u){return typeof u=="string"||!ht(u)&&bn(u)&&Xs(u)==Rr}function Ci(u){return typeof u=="symbol"||bn(u)&&Xs(u)==si}var Zc=Wy?Si(Wy):EB;function gH(u){return u===s}function _H(u){return bn(u)&&Ls(u)==Ko}function TH(u){return bn(u)&&Xs(u)==xd}var AH=rf(r0),mH=rf(function(u,f){return u<=f});function RN(u){if(!u)return[];if(ri(u))return Ef(u)?dr(u):ii(u);if(mh&&u[mh])return JF(u[mh]());var f=Ls(u),_=f==jn?zg:f==ws?Md:qc;return _(u)}function uo(u){if(!u)return u===0?u:0;if(u=ji(u),u===se||u===-1/0){var f=u<0?-1:1;return f*te}return u===u?u:0}function Et(u){var f=uo(u),_=f%1;return f===f?_?f-_:f:0}function wN(u){return u?Ya(Et(u),0,re):0}function ji(u){if(typeof u=="number")return u;if(Ci(u))return ie;if(Nn(u)){var f=typeof u.valueOf=="function"?u.valueOf():u;u=Nn(f)?f+"":f}if(typeof u!="string")return u===0?u:+u;u=Zy(u);var _=tF.test(u);return _||sF.test(u)?bF(u.slice(2),_?2:8):eF.test(u)?ie:+u}function DN(u){return Lr(u,oi(u))}function OH(u){return u?Ya(Et(u),-9007199254740991,ue):u===0?u:0}function Wt(u){return u==null?"":yi(u)}var IH=zc(function(u,f){if(Dh(f)||ri(f)){Lr(f,hs(f),u);return}for(var _ in f)Zt.call(f,_)&&Ch(u,_,f[_])}),LN=zc(function(u,f){Lr(f,oi(f),u)}),gf=zc(function(u,f,_,I){Lr(f,oi(f),u,I)}),SH=zc(function(u,f,_,I){Lr(f,hs(f),u,I)}),yH=co(Jg);function CH(u,f){var _=Xc(u);return f==null?_:hC(_,f)}var NH=mt(function(u,f){u=rn(u);var _=-1,I=f.length,x=I>2?f[2]:s;for(x&&zs(f[0],f[1],x)&&(I=1);++_<I;)for(var D=f[_],U=oi(D),F=-1,z=U.length;++F<z;){var le=U[F],he=u[le];(he===s||pr(he,Hc[le])&&!Zt.call(u,le))&&(u[le]=D[le])}return u}),xH=mt(function(u){return u.push(s,ZC),Ii(MN,s,u)});function vH(u,f){return Xy(u,ze(f,3),Dr)}function RH(u,f){return Xy(u,ze(f,3),e0)}function wH(u,f){return u==null?u:$g(u,ze(f,3),oi)}function DH(u,f){return u==null?u:EC(u,ze(f,3),oi)}function LH(u,f){return u&&Dr(u,ze(f,3))}function MH(u,f){return u&&e0(u,ze(f,3))}function PH(u){return u==null?[]:qd(u,hs(u))}function bH(u){return u==null?[]:qd(u,oi(u))}function L0(u,f,_){var I=u==null?s:Xa(u,f);return I===s?_:I}function UH(u,f){return u!=null&&JC(u,f,rB)}function M0(u,f){return u!=null&&JC(u,f,oB)}var GH=YC(function(u,f,_){f!=null&&typeof f.toString!="function"&&(f=Gd.call(f)),u[f]=_},b0(ai)),FH=YC(function(u,f,_){f!=null&&typeof f.toString!="function"&&(f=Gd.call(f)),Zt.call(u,f)?u[f].push(_):u[f]=[_]},ze),kH=mt(xh);function hs(u){return ri(u)?cC(u):i0(u)}function oi(u){return ri(u)?cC(u,!0):gB(u)}function BH(u,f){var _={};return f=ze(f,3),Dr(u,function(I,x,D){oo(_,f(I,x,D),I)}),_}function VH(u,f){var _={};return f=ze(f,3),Dr(u,function(I,x,D){oo(_,x,f(I,x,D))}),_}var HH=zc(function(u,f,_){jd(u,f,_)}),MN=zc(function(u,f,_,I){jd(u,f,_,I)}),WH=co(function(u,f){var _={};if(u==null)return _;var I=!1;f=In(f,function(D){return D=ta(D,u),I||(I=D.length>1),D}),Lr(u,T0(u),_),I&&(_=Qi(_,p|E|g,GB));for(var x=f.length;x--;)h0(_,f[x]);return _});function YH(u,f){return PN(u,ff(ze(f)))}var XH=co(function(u,f){return u==null?{}:TB(u,f)});function PN(u,f){if(u==null)return{};var _=In(T0(u),function(I){return[I]});return f=ze(f),CC(u,_,function(I,x){return f(I,x[0])})}function zH(u,f,_){f=ta(f,u);var I=-1,x=f.length;for(x||(x=1,u=s);++I<x;){var D=u==null?s:u[Mr(f[I])];D===s&&(I=x,D=_),u=ho(D)?D.call(u):D}return u}function KH(u,f,_){return u==null?u:Rh(u,f,_)}function QH(u,f,_,I){return I=typeof I=="function"?I:s,u==null?u:Rh(u,f,_,I)}var bN=KC(hs),UN=KC(oi);function ZH(u,f,_){var I=ht(u),x=I||sa(u)||Zc(u);if(f=ze(f,4),_==null){var D=u&&u.constructor;x?_=I?new D:[]:Nn(u)?_=ho(D)?Xc(Bd(u)):{}:_={}}return(x?Xi:Dr)(u,function(U,F,z){return f(_,U,F,z)}),_}function qH(u,f){return u==null?!0:h0(u,f)}function jH(u,f,_){return u==null?u:wC(u,f,f0(_))}function JH(u,f,_,I){return I=typeof I=="function"?I:s,u==null?u:wC(u,f,f0(_),I)}function qc(u){return u==null?[]:Xg(u,hs(u))}function $H(u){return u==null?[]:Xg(u,oi(u))}function e8(u,f,_){return _===s&&(_=f,f=s),_!==s&&(_=ji(_),_=_===_?_:0),f!==s&&(f=ji(f),f=f===f?f:0),Ya(ji(u),f,_)}function t8(u,f,_){return f=uo(f),_===s?(_=f,f=0):_=uo(_),u=ji(u),aB(u,f,_)}function n8(u,f,_){if(_&&typeof _!="boolean"&&zs(u,f,_)&&(f=_=s),_===s&&(typeof f=="boolean"?(_=f,f=s):typeof u=="boolean"&&(_=u,u=s)),u===s&&f===s?(u=0,f=1):(u=uo(u),f===s?(f=u,u=0):f=uo(f)),u>f){var I=u;u=f,f=I}if(_||u%1||f%1){var x=oC();return Ds(u+x*(f-u+PF("1e-"+((x+"").length-1))),f)}return a0(u,f)}var s8=Kc(function(u,f,_){return f=f.toLowerCase(),u+(_?GN(f):f)});function GN(u){return P0(Wt(u).toLowerCase())}function FN(u){return u=Wt(u),u&&u.replace(rF,KF).replace(yF,"")}function i8(u,f,_){u=Wt(u),f=yi(f);var I=u.length;_=_===s?I:Ya(Et(_),0,I);var x=_;return _-=f.length,_>=0&&u.slice(_,x)==f}function r8(u){return u=Wt(u),u&&k5.test(u)?u.replace(Ey,QF):u}function o8(u){return u=Wt(u),u&&X5.test(u)?u.replace(Rg,"\\$&"):u}var a8=Kc(function(u,f,_){return u+(_?"-":"")+f.toLowerCase()}),c8=Kc(function(u,f,_){return u+(_?" ":"")+f.toLowerCase()}),l8=VC("toLowerCase");function h8(u,f,_){u=Wt(u),f=Et(f);var I=f?Bc(u):0;if(!f||I>=f)return u;var x=(f-I)/2;return sf(Yd(x),_)+u+sf(Wd(x),_)}function u8(u,f,_){u=Wt(u),f=Et(f);var I=f?Bc(u):0;return f&&I<f?u+sf(f-I,_):u}function d8(u,f,_){u=Wt(u),f=Et(f);var I=f?Bc(u):0;return f&&I<f?sf(f-I,_)+u:u}function f8(u,f,_){return _||f==null?f=0:f&&(f=+f),mk(Wt(u).replace(wg,""),f||0)}function p8(u,f,_){return(_?zs(u,f,_):f===s)?f=1:f=Et(f),c0(Wt(u),f)}function E8(){var u=arguments,f=Wt(u[0]);return u.length<3?f:f.replace(u[1],u[2])}var g8=Kc(function(u,f,_){return u+(_?"_":"")+f.toLowerCase()});function _8(u,f,_){return _&&typeof _!="number"&&zs(u,f,_)&&(f=_=s),_=_===s?re:_>>>0,_?(u=Wt(u),u&&(typeof f=="string"||f!=null&&!D0(f))&&(f=yi(f),!f&&kc(u))?na(dr(u),0,_):u.split(f,_)):[]}var T8=Kc(function(u,f,_){return u+(_?" ":"")+P0(f)});function A8(u,f,_){return u=Wt(u),_=_==null?0:Ya(Et(_),0,u.length),f=yi(f),u.slice(_,_+f.length)==f}function m8(u,f,_){var I=w.templateSettings;_&&zs(u,f,_)&&(f=s),u=Wt(u),f=gf({},f,I,QC);var x=gf({},f.imports,I.imports,QC),D=hs(x),U=Xg(x,D),F,z,le=0,he=f.interpolate||vd,de="__p += '",Ie=Kg((f.escape||vd).source+"|"+he.source+"|"+(he===gy?$5:vd).source+"|"+(f.evaluate||vd).source+"|$","g"),Pe="//# sourceURL="+(Zt.call(f,"sourceURL")?(f.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++RF+"]")+`
`;u.replace(Ie,function(Ze,yt,Rt,Ni,Ks,xi){return Rt||(Rt=Ni),de+=u.slice(le,xi).replace(oF,ZF),yt&&(F=!0,de+=`' +
__e(`+yt+`) +
'`),Ks&&(z=!0,de+=`';
`+Ks+`;
__p += '`),Rt&&(de+=`' +
((__t = (`+Rt+`)) == null ? '' : __t) +
'`),le=xi+Ze.length,Ze}),de+=`';
`;var Qe=Zt.call(f,"variable")&&f.variable;if(!Qe)de=`with (obj) {
`+de+`
}
`;else if(j5.test(Qe))throw new lt(c);de=(z?de.replace(b5,""):de).replace(U5,"$1").replace(G5,"$1;"),de="function("+(Qe||"obj")+`) {
`+(Qe?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(F?", __e = _.escape":"")+(z?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+de+`return __p
}`;var Tt=BN(function(){return Ft(D,Pe+"return "+de).apply(s,U)});if(Tt.source=de,w0(Tt))throw Tt;return Tt}function O8(u){return Wt(u).toLowerCase()}function I8(u){return Wt(u).toUpperCase()}function S8(u,f,_){if(u=Wt(u),u&&(_||f===s))return Zy(u);if(!u||!(f=yi(f)))return u;var I=dr(u),x=dr(f),D=qy(I,x),U=jy(I,x)+1;return na(I,D,U).join("")}function y8(u,f,_){if(u=Wt(u),u&&(_||f===s))return u.slice(0,$y(u)+1);if(!u||!(f=yi(f)))return u;var I=dr(u),x=jy(I,dr(f))+1;return na(I,0,x).join("")}function C8(u,f,_){if(u=Wt(u),u&&(_||f===s))return u.replace(wg,"");if(!u||!(f=yi(f)))return u;var I=dr(u),x=qy(I,dr(f));return na(I,x).join("")}function N8(u,f){var _=Q,I=b;if(Nn(f)){var x="separator"in f?f.separator:x;_="length"in f?Et(f.length):_,I="omission"in f?yi(f.omission):I}u=Wt(u);var D=u.length;if(kc(u)){var U=dr(u);D=U.length}if(_>=D)return u;var F=_-Bc(I);if(F<1)return I;var z=U?na(U,0,F).join(""):u.slice(0,F);if(x===s)return z+I;if(U&&(F+=z.length-F),D0(x)){if(u.slice(F).search(x)){var le,he=z;for(x.global||(x=Kg(x.source,Wt(_y.exec(x))+"g")),x.lastIndex=0;le=x.exec(he);)var de=le.index;z=z.slice(0,de===s?F:de)}}else if(u.indexOf(yi(x),F)!=F){var Ie=z.lastIndexOf(x);Ie>-1&&(z=z.slice(0,Ie))}return z+I}function x8(u){return u=Wt(u),u&&F5.test(u)?u.replace(py,nk):u}var v8=Kc(function(u,f,_){return u+(_?" ":"")+f.toUpperCase()}),P0=VC("toUpperCase");function kN(u,f,_){return u=Wt(u),f=_?s:f,f===s?jF(u)?rk(u):HF(u):u.match(f)||[]}var BN=mt(function(u,f){try{return Ii(u,s,f)}catch(_){return w0(_)?_:new lt(_)}}),R8=co(function(u,f){return Xi(f,function(_){_=Mr(_),oo(u,_,v0(u[_],u))}),u});function w8(u){var f=u==null?0:u.length,_=ze();return u=f?In(u,function(I){if(typeof I[1]!="function")throw new zi(a);return[_(I[0]),I[1]]}):[],mt(function(I){for(var x=-1;++x<f;){var D=u[x];if(Ii(D[0],this,I))return Ii(D[1],this,I)}})}function D8(u){return nB(Qi(u,p))}function b0(u){return function(){return u}}function L8(u,f){return u==null||u!==u?f:u}var M8=WC(),P8=WC(!0);function ai(u){return u}function U0(u){return AC(typeof u=="function"?u:Qi(u,p))}function b8(u){return OC(Qi(u,p))}function U8(u,f){return IC(u,Qi(f,p))}var G8=mt(function(u,f){return function(_){return xh(_,u,f)}}),F8=mt(function(u,f){return function(_){return xh(u,_,f)}});function G0(u,f,_){var I=hs(f),x=qd(f,I);_==null&&!(Nn(f)&&(x.length||!I.length))&&(_=f,f=u,u=this,x=qd(f,hs(f)));var D=!(Nn(_)&&"chain"in _)||!!_.chain,U=ho(u);return Xi(x,function(F){var z=f[F];u[F]=z,U&&(u.prototype[F]=function(){var le=this.__chain__;if(D||le){var he=u(this.__wrapped__),de=he.__actions__=ii(this.__actions__);return de.push({func:z,args:arguments,thisArg:u}),he.__chain__=le,he}return z.apply(u,qo([this.value()],arguments))})}),u}function k8(){return Cs._===this&&(Cs._=uk),this}function F0(){}function B8(u){return u=Et(u),mt(function(f){return SC(f,u)})}var V8=E0(In),H8=E0(Yy),W8=E0(Bg);function VN(u){return I0(u)?Vg(Mr(u)):AB(u)}function Y8(u){return function(f){return u==null?s:Xa(u,f)}}var X8=XC(),z8=XC(!0);function k0(){return[]}function B0(){return!1}function K8(){return{}}function Q8(){return""}function Z8(){return!0}function q8(u,f){if(u=Et(u),u<1||u>ue)return[];var _=re,I=Ds(u,re);f=ze(f),u-=re;for(var x=Yg(I,f);++_<u;)f(_);return x}function j8(u){return ht(u)?In(u,Mr):Ci(u)?[u]:ii(aN(Wt(u)))}function J8(u){var f=++lk;return Wt(u)+f}var $8=nf(function(u,f){return u+f},0),e6=g0("ceil"),t6=nf(function(u,f){return u/f},1),n6=g0("floor");function s6(u){return u&&u.length?Zd(u,ai,t0):s}function i6(u,f){return u&&u.length?Zd(u,ze(f,2),t0):s}function r6(u){return Ky(u,ai)}function o6(u,f){return Ky(u,ze(f,2))}function a6(u){return u&&u.length?Zd(u,ai,r0):s}function c6(u,f){return u&&u.length?Zd(u,ze(f,2),r0):s}var l6=nf(function(u,f){return u*f},1),h6=g0("round"),u6=nf(function(u,f){return u-f},0);function d6(u){return u&&u.length?Wg(u,ai):0}function f6(u,f){return u&&u.length?Wg(u,ze(f,2)):0}return w.after=bV,w.ary=TN,w.assign=IH,w.assignIn=LN,w.assignInWith=gf,w.assignWith=SH,w.at=yH,w.before=AN,w.bind=v0,w.bindAll=R8,w.bindKey=mN,w.castArray=KV,w.chain=EN,w.chunk=n4,w.compact=s4,w.concat=i4,w.cond=w8,w.conforms=D8,w.constant=b0,w.countBy=dV,w.create=CH,w.curry=ON,w.curryRight=IN,w.debounce=SN,w.defaults=NH,w.defaultsDeep=xH,w.defer=UV,w.delay=GV,w.difference=r4,w.differenceBy=o4,w.differenceWith=a4,w.drop=c4,w.dropRight=l4,w.dropRightWhile=h4,w.dropWhile=u4,w.fill=d4,w.filter=pV,w.flatMap=_V,w.flatMapDeep=TV,w.flatMapDepth=AV,w.flatten=uN,w.flattenDeep=f4,w.flattenDepth=p4,w.flip=FV,w.flow=M8,w.flowRight=P8,w.fromPairs=E4,w.functions=PH,w.functionsIn=bH,w.groupBy=mV,w.initial=_4,w.intersection=T4,w.intersectionBy=A4,w.intersectionWith=m4,w.invert=GH,w.invertBy=FH,w.invokeMap=IV,w.iteratee=U0,w.keyBy=SV,w.keys=hs,w.keysIn=oi,w.map=hf,w.mapKeys=BH,w.mapValues=VH,w.matches=b8,w.matchesProperty=U8,w.memoize=df,w.merge=HH,w.mergeWith=MN,w.method=G8,w.methodOf=F8,w.mixin=G0,w.negate=ff,w.nthArg=B8,w.omit=WH,w.omitBy=YH,w.once=kV,w.orderBy=yV,w.over=V8,w.overArgs=BV,w.overEvery=H8,w.overSome=W8,w.partial=R0,w.partialRight=yN,w.partition=CV,w.pick=XH,w.pickBy=PN,w.property=VN,w.propertyOf=Y8,w.pull=y4,w.pullAll=fN,w.pullAllBy=C4,w.pullAllWith=N4,w.pullAt=x4,w.range=X8,w.rangeRight=z8,w.rearg=VV,w.reject=vV,w.remove=v4,w.rest=HV,w.reverse=N0,w.sampleSize=wV,w.set=KH,w.setWith=QH,w.shuffle=DV,w.slice=R4,w.sortBy=PV,w.sortedUniq=U4,w.sortedUniqBy=G4,w.split=_8,w.spread=WV,w.tail=F4,w.take=k4,w.takeRight=B4,w.takeRightWhile=V4,w.takeWhile=H4,w.tap=sV,w.throttle=YV,w.thru=lf,w.toArray=RN,w.toPairs=bN,w.toPairsIn=UN,w.toPath=j8,w.toPlainObject=DN,w.transform=ZH,w.unary=XV,w.union=W4,w.unionBy=Y4,w.unionWith=X4,w.uniq=z4,w.uniqBy=K4,w.uniqWith=Q4,w.unset=qH,w.unzip=x0,w.unzipWith=pN,w.update=jH,w.updateWith=JH,w.values=qc,w.valuesIn=$H,w.without=Z4,w.words=kN,w.wrap=zV,w.xor=q4,w.xorBy=j4,w.xorWith=J4,w.zip=$4,w.zipObject=eV,w.zipObjectDeep=tV,w.zipWith=nV,w.entries=bN,w.entriesIn=UN,w.extend=LN,w.extendWith=gf,G0(w,w),w.add=$8,w.attempt=BN,w.camelCase=s8,w.capitalize=GN,w.ceil=e6,w.clamp=e8,w.clone=QV,w.cloneDeep=qV,w.cloneDeepWith=jV,w.cloneWith=ZV,w.conformsTo=JV,w.deburr=FN,w.defaultTo=L8,w.divide=t6,w.endsWith=i8,w.eq=pr,w.escape=r8,w.escapeRegExp=o8,w.every=fV,w.find=EV,w.findIndex=lN,w.findKey=vH,w.findLast=gV,w.findLastIndex=hN,w.findLastKey=RH,w.floor=n6,w.forEach=gN,w.forEachRight=_N,w.forIn=wH,w.forInRight=DH,w.forOwn=LH,w.forOwnRight=MH,w.get=L0,w.gt=$V,w.gte=eH,w.has=UH,w.hasIn=M0,w.head=dN,w.identity=ai,w.includes=OV,w.indexOf=g4,w.inRange=t8,w.invoke=kH,w.isArguments=Qa,w.isArray=ht,w.isArrayBuffer=tH,w.isArrayLike=ri,w.isArrayLikeObject=Bn,w.isBoolean=nH,w.isBuffer=sa,w.isDate=sH,w.isElement=iH,w.isEmpty=rH,w.isEqual=oH,w.isEqualWith=aH,w.isError=w0,w.isFinite=cH,w.isFunction=ho,w.isInteger=CN,w.isLength=pf,w.isMap=NN,w.isMatch=lH,w.isMatchWith=hH,w.isNaN=uH,w.isNative=dH,w.isNil=pH,w.isNull=fH,w.isNumber=xN,w.isObject=Nn,w.isObjectLike=bn,w.isPlainObject=Mh,w.isRegExp=D0,w.isSafeInteger=EH,w.isSet=vN,w.isString=Ef,w.isSymbol=Ci,w.isTypedArray=Zc,w.isUndefined=gH,w.isWeakMap=_H,w.isWeakSet=TH,w.join=O4,w.kebabCase=a8,w.last=qi,w.lastIndexOf=I4,w.lowerCase=c8,w.lowerFirst=l8,w.lt=AH,w.lte=mH,w.max=s6,w.maxBy=i6,w.mean=r6,w.meanBy=o6,w.min=a6,w.minBy=c6,w.stubArray=k0,w.stubFalse=B0,w.stubObject=K8,w.stubString=Q8,w.stubTrue=Z8,w.multiply=l6,w.nth=S4,w.noConflict=k8,w.noop=F0,w.now=uf,w.pad=h8,w.padEnd=u8,w.padStart=d8,w.parseInt=f8,w.random=n8,w.reduce=NV,w.reduceRight=xV,w.repeat=p8,w.replace=E8,w.result=zH,w.round=h6,w.runInContext=W,w.sample=RV,w.size=LV,w.snakeCase=g8,w.some=MV,w.sortedIndex=w4,w.sortedIndexBy=D4,w.sortedIndexOf=L4,w.sortedLastIndex=M4,w.sortedLastIndexBy=P4,w.sortedLastIndexOf=b4,w.startCase=T8,w.startsWith=A8,w.subtract=u6,w.sum=d6,w.sumBy=f6,w.template=m8,w.times=q8,w.toFinite=uo,w.toInteger=Et,w.toLength=wN,w.toLower=O8,w.toNumber=ji,w.toSafeInteger=OH,w.toString=Wt,w.toUpper=I8,w.trim=S8,w.trimEnd=y8,w.trimStart=C8,w.truncate=N8,w.unescape=x8,w.uniqueId=J8,w.upperCase=v8,w.upperFirst=P0,w.each=gN,w.eachRight=_N,w.first=dN,G0(w,function(){var u={};return Dr(w,function(f,_){Zt.call(w.prototype,_)||(u[_]=f)}),u}(),{chain:!1}),w.VERSION=i,Xi(["bind","bindKey","curry","curryRight","partial","partialRight"],function(u){w[u].placeholder=w}),Xi(["drop","take"],function(u,f){xt.prototype[u]=function(_){_=_===s?1:$n(Et(_),0);var I=this.__filtered__&&!f?new xt(this):this.clone();return I.__filtered__?I.__takeCount__=Ds(_,I.__takeCount__):I.__views__.push({size:Ds(_,re),type:u+(I.__dir__<0?"Right":"")}),I},xt.prototype[u+"Right"]=function(_){return this.reverse()[u](_).reverse()}}),Xi(["filter","map","takeWhile"],function(u,f){var _=f+1,I=_==V||_==ge;xt.prototype[u]=function(x){var D=this.clone();return D.__iteratees__.push({iteratee:ze(x,3),type:_}),D.__filtered__=D.__filtered__||I,D}}),Xi(["head","last"],function(u,f){var _="take"+(f?"Right":"");xt.prototype[u]=function(){return this[_](1).value()[0]}}),Xi(["initial","tail"],function(u,f){var _="drop"+(f?"":"Right");xt.prototype[u]=function(){return this.__filtered__?new xt(this):this[_](1)}}),xt.prototype.compact=function(){return this.filter(ai)},xt.prototype.find=function(u){return this.filter(u).head()},xt.prototype.findLast=function(u){return this.reverse().find(u)},xt.prototype.invokeMap=mt(function(u,f){return typeof u=="function"?new xt(this):this.map(function(_){return xh(_,u,f)})}),xt.prototype.reject=function(u){return this.filter(ff(ze(u)))},xt.prototype.slice=function(u,f){u=Et(u);var _=this;return _.__filtered__&&(u>0||f<0)?new xt(_):(u<0?_=_.takeRight(-u):u&&(_=_.drop(u)),f!==s&&(f=Et(f),_=f<0?_.dropRight(-f):_.take(f-u)),_)},xt.prototype.takeRightWhile=function(u){return this.reverse().takeWhile(u).reverse()},xt.prototype.toArray=function(){return this.take(re)},Dr(xt.prototype,function(u,f){var _=/^(?:filter|find|map|reject)|While$/.test(f),I=/^(?:head|last)$/.test(f),x=w[I?"take"+(f=="last"?"Right":""):f],D=I||/^find/.test(f);x&&(w.prototype[f]=function(){var U=this.__wrapped__,F=I?[1]:arguments,z=U instanceof xt,le=F[0],he=z||ht(U),de=function(yt){var Rt=x.apply(w,qo([yt],F));return I&&Ie?Rt[0]:Rt};he&&_&&typeof le=="function"&&le.length!=1&&(z=he=!1);var Ie=this.__chain__,Pe=!!this.__actions__.length,Qe=D&&!Ie,Tt=z&&!Pe;if(!D&&he){U=Tt?U:new xt(this);var Ze=u.apply(U,F);return Ze.__actions__.push({func:lf,args:[de],thisArg:s}),new Ki(Ze,Ie)}return Qe&&Tt?u.apply(this,F):(Ze=this.thru(de),Qe?I?Ze.value()[0]:Ze.value():Ze)})}),Xi(["pop","push","shift","sort","splice","unshift"],function(u){var f=Pd[u],_=/^(?:push|sort|unshift)$/.test(u)?"tap":"thru",I=/^(?:pop|shift)$/.test(u);w.prototype[u]=function(){var x=arguments;if(I&&!this.__chain__){var D=this.value();return f.apply(ht(D)?D:[],x)}return this[_](function(U){return f.apply(ht(U)?U:[],x)})}}),Dr(xt.prototype,function(u,f){var _=w[f];if(_){var I=_.name+"";Zt.call(Yc,I)||(Yc[I]=[]),Yc[I].push({name:f,func:_})}}),Yc[tf(s,O).name]=[{name:"wrapper",func:s}],xt.prototype.clone=xk,xt.prototype.reverse=vk,xt.prototype.value=Rk,w.prototype.at=iV,w.prototype.chain=rV,w.prototype.commit=oV,w.prototype.next=aV,w.prototype.plant=lV,w.prototype.reverse=hV,w.prototype.toJSON=w.prototype.valueOf=w.prototype.value=uV,w.prototype.first=w.prototype.head,mh&&(w.prototype[mh]=cV),w},Vc=ok();Ba?((Ba.exports=Vc)._=Vc,Ug._=Vc):Cs._=Vc}).call(ol)}(qh,qh.exports);var sR=qh.exports,jh;(function(e){e.LEFT="left",e.RIGHT="right"})(jh||(jh={}));var Jh;(function(e){e.LEFT="v",e.RIGHT="w"})(Jh||(Jh={})),jh.LEFT+"",Jh.LEFT,jh.RIGHT+"",Jh.RIGHT;/*! https://mths.be/codepointat v0.2.0 by @mathias */String.prototype.codePointAt||function(){var e=function(){try{var s={},i=Object.defineProperty,r=i(s,s,s)&&i}catch{}return r}(),n=function(s){if(this==null)throw TypeError();var i=String(this),r=i.length,o=s?Number(s):0;if(o!=o&&(o=0),!(o<0||o>=r)){var a=i.charCodeAt(o),c;return a>=55296&&a<=56319&&r>o+1&&(c=i.charCodeAt(o+1),c>=56320&&c<=57343)?(a-55296)*1024+c-56320+65536:a}};e?e(String.prototype,"codePointAt",{value:n,configurable:!0,writable:!0}):String.prototype.codePointAt=n}();function GA(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}var iR=new GA,rR=new GA,FA=new Uint8Array(30),kA=new Uint16Array(30),oR=new Uint8Array(30),aR=new Uint16Array(30);function BA(e,n,s,i){var r,o;for(r=0;r<s;++r)e[r]=0;for(r=0;r<30-s;++r)e[r+s]=r/s|0;for(o=i,r=0;r<30;++r)n[r]=o,o+=1<<e[r]}function cR(e,n){var s;for(s=0;s<7;++s)e.table[s]=0;for(e.table[7]=24,e.table[8]=152,e.table[9]=112,s=0;s<24;++s)e.trans[s]=256+s;for(s=0;s<144;++s)e.trans[24+s]=s;for(s=0;s<8;++s)e.trans[168+s]=280+s;for(s=0;s<112;++s)e.trans[176+s]=144+s;for(s=0;s<5;++s)n.table[s]=0;for(n.table[5]=32,s=0;s<32;++s)n.trans[s]=s}cR(iR,rR),BA(FA,kA,4,3),BA(oR,aR,2,1),FA[28]=0,kA[28]=258;function cc(e,n,s,i,r){return Math.pow(1-r,3)*e+3*Math.pow(1-r,2)*r*n+3*(1-r)*Math.pow(r,2)*s+Math.pow(r,3)*i}function Io(){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN}Io.prototype.isEmpty=function(){return isNaN(this.x1)||isNaN(this.y1)||isNaN(this.x2)||isNaN(this.y2)},Io.prototype.addPoint=function(e,n){typeof e=="number"&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=e,this.x2=e),e<this.x1&&(this.x1=e),e>this.x2&&(this.x2=e)),typeof n=="number"&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=n,this.y2=n),n<this.y1&&(this.y1=n),n>this.y2&&(this.y2=n))},Io.prototype.addX=function(e){this.addPoint(e,null)},Io.prototype.addY=function(e){this.addPoint(null,e)},Io.prototype.addBezier=function(e,n,s,i,r,o,a,c){var l=[e,n],h=[s,i],d=[r,o],p=[a,c];this.addPoint(e,n),this.addPoint(a,c);for(var E=0;E<=1;E++){var g=6*l[E]-12*h[E]+6*d[E],T=-3*l[E]+9*h[E]-9*d[E]+3*p[E],A=3*h[E]-3*l[E];if(T===0){if(g===0)continue;var m=-A/g;0<m&&m<1&&(E===0&&this.addX(cc(l[E],h[E],d[E],p[E],m)),E===1&&this.addY(cc(l[E],h[E],d[E],p[E],m)));continue}var O=Math.pow(g,2)-4*A*T;if(!(O<0)){var S=(-g+Math.sqrt(O))/(2*T);0<S&&S<1&&(E===0&&this.addX(cc(l[E],h[E],d[E],p[E],S)),E===1&&this.addY(cc(l[E],h[E],d[E],p[E],S)));var y=(-g-Math.sqrt(O))/(2*T);0<y&&y<1&&(E===0&&this.addX(cc(l[E],h[E],d[E],p[E],y)),E===1&&this.addY(cc(l[E],h[E],d[E],p[E],y)))}}},Io.prototype.addQuad=function(e,n,s,i,r,o){var a=e+.6666666666666666*(s-e),c=n+2/3*(i-n),l=a+1/3*(r-e),h=c+1/3*(o-n);this.addBezier(e,n,a,c,l,h,r,o)};function zn(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}zn.prototype.moveTo=function(e,n){this.commands.push({type:"M",x:e,y:n})},zn.prototype.lineTo=function(e,n){this.commands.push({type:"L",x:e,y:n})},zn.prototype.curveTo=zn.prototype.bezierCurveTo=function(e,n,s,i,r,o){this.commands.push({type:"C",x1:e,y1:n,x2:s,y2:i,x:r,y:o})},zn.prototype.quadTo=zn.prototype.quadraticCurveTo=function(e,n,s,i){this.commands.push({type:"Q",x1:e,y1:n,x:s,y:i})},zn.prototype.close=zn.prototype.closePath=function(){this.commands.push({type:"Z"})},zn.prototype.extend=function(e){if(e.commands)e=e.commands;else if(e instanceof Io){var n=e;this.moveTo(n.x1,n.y1),this.lineTo(n.x2,n.y1),this.lineTo(n.x2,n.y2),this.lineTo(n.x1,n.y2),this.close();return}Array.prototype.push.apply(this.commands,e)},zn.prototype.getBoundingBox=function(){for(var e=new Io,n=0,s=0,i=0,r=0,o=0;o<this.commands.length;o++){var a=this.commands[o];switch(a.type){case"M":e.addPoint(a.x,a.y),n=i=a.x,s=r=a.y;break;case"L":e.addPoint(a.x,a.y),i=a.x,r=a.y;break;case"Q":e.addQuad(i,r,a.x1,a.y1,a.x,a.y),i=a.x,r=a.y;break;case"C":e.addBezier(i,r,a.x1,a.y1,a.x2,a.y2,a.x,a.y),i=a.x,r=a.y;break;case"Z":i=n,r=s;break;default:throw new Error("Unexpected path command "+a.type)}}return e.isEmpty()&&e.addPoint(0,0),e},zn.prototype.draw=function(e){e.beginPath();for(var n=0;n<this.commands.length;n+=1){var s=this.commands[n];s.type==="M"?e.moveTo(s.x,s.y):s.type==="L"?e.lineTo(s.x,s.y):s.type==="C"?e.bezierCurveTo(s.x1,s.y1,s.x2,s.y2,s.x,s.y):s.type==="Q"?e.quadraticCurveTo(s.x1,s.y1,s.x,s.y):s.type==="Z"&&e.closePath()}this.fill&&(e.fillStyle=this.fill,e.fill()),this.stroke&&(e.strokeStyle=this.stroke,e.lineWidth=this.strokeWidth,e.stroke())},zn.prototype.toPathData=function(e){e=e!==void 0?e:2;function n(a){return Math.round(a)===a?""+Math.round(a):a.toFixed(e)}function s(){for(var a=arguments,c="",l=0;l<arguments.length;l+=1){var h=a[l];h>=0&&l>0&&(c+=" "),c+=n(h)}return c}for(var i="",r=0;r<this.commands.length;r+=1){var o=this.commands[r];o.type==="M"?i+="M"+s(o.x,o.y):o.type==="L"?i+="L"+s(o.x,o.y):o.type==="C"?i+="C"+s(o.x1,o.y1,o.x2,o.y2,o.x,o.y):o.type==="Q"?i+="Q"+s(o.x1,o.y1,o.x,o.y):o.type==="Z"&&(i+="Z")}return i},zn.prototype.toSVG=function(e){var n='<path d="';return n+=this.toPathData(e),n+='"',this.fill&&this.fill!=="black"&&(this.fill===null?n+=' fill="none"':n+=' fill="'+this.fill+'"'),this.stroke&&(n+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),n+="/>",n},zn.prototype.toDOMElement=function(e){var n=this.toPathData(e),s=document.createElementNS("http://www.w3.org/2000/svg","path");return s.setAttribute("d",n),s};function VA(e){throw new Error(e)}function HA(e,n){e||VA(n)}var rt={fail:VA,argument:HA,assert:HA},WA=32768,YA=2147483648,lc={},Ae={},je={};function nr(e){return function(){return e}}Ae.BYTE=function(e){return rt.argument(e>=0&&e<=255,"Byte value should be between 0 and 255."),[e]},je.BYTE=nr(1),Ae.CHAR=function(e){return[e.charCodeAt(0)]},je.CHAR=nr(1),Ae.CHARARRAY=function(e){typeof e>"u"&&(e="",console.warn("Undefined CHARARRAY encountered and treated as an empty string. This is probably caused by a missing glyph name."));for(var n=[],s=0;s<e.length;s+=1)n[s]=e.charCodeAt(s);return n},je.CHARARRAY=function(e){return typeof e>"u"?0:e.length},Ae.USHORT=function(e){return[e>>8&255,e&255]},je.USHORT=nr(2),Ae.SHORT=function(e){return e>=WA&&(e=-(2*WA-e)),[e>>8&255,e&255]},je.SHORT=nr(2),Ae.UINT24=function(e){return[e>>16&255,e>>8&255,e&255]},je.UINT24=nr(3),Ae.ULONG=function(e){return[e>>24&255,e>>16&255,e>>8&255,e&255]},je.ULONG=nr(4),Ae.LONG=function(e){return e>=YA&&(e=-(2*YA-e)),[e>>24&255,e>>16&255,e>>8&255,e&255]},je.LONG=nr(4),Ae.FIXED=Ae.ULONG,je.FIXED=je.ULONG,Ae.FWORD=Ae.SHORT,je.FWORD=je.SHORT,Ae.UFWORD=Ae.USHORT,je.UFWORD=je.USHORT,Ae.LONGDATETIME=function(e){return[0,0,0,0,e>>24&255,e>>16&255,e>>8&255,e&255]},je.LONGDATETIME=nr(8),Ae.TAG=function(e){return rt.argument(e.length===4,"Tag should be exactly 4 ASCII characters."),[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]},je.TAG=nr(4),Ae.Card8=Ae.BYTE,je.Card8=je.BYTE,Ae.Card16=Ae.USHORT,je.Card16=je.USHORT,Ae.OffSize=Ae.BYTE,je.OffSize=je.BYTE,Ae.SID=Ae.USHORT,je.SID=je.USHORT,Ae.NUMBER=function(e){return e>=-107&&e<=107?[e+139]:e>=108&&e<=1131?(e=e-108,[(e>>8)+247,e&255]):e>=-1131&&e<=-108?(e=-e-108,[(e>>8)+251,e&255]):e>=-32768&&e<=32767?Ae.NUMBER16(e):Ae.NUMBER32(e)},je.NUMBER=function(e){return Ae.NUMBER(e).length},Ae.NUMBER16=function(e){return[28,e>>8&255,e&255]},je.NUMBER16=nr(3),Ae.NUMBER32=function(e){return[29,e>>24&255,e>>16&255,e>>8&255,e&255]},je.NUMBER32=nr(5),Ae.REAL=function(e){var n=e.toString(),s=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(n);if(s){var i=parseFloat("1e"+((s[2]?+s[2]:0)+s[1].length));n=(Math.round(e*i)/i).toString()}for(var r="",o=0,a=n.length;o<a;o+=1){var c=n[o];c==="e"?r+=n[++o]==="-"?"c":"b":c==="."?r+="a":c==="-"?r+="e":r+=c}r+=r.length&1?"f":"ff";for(var l=[30],h=0,d=r.length;h<d;h+=2)l.push(parseInt(r.substr(h,2),16));return l},je.REAL=function(e){return Ae.REAL(e).length},Ae.NAME=Ae.CHARARRAY,je.NAME=je.CHARARRAY,Ae.STRING=Ae.CHARARRAY,je.STRING=je.CHARARRAY,lc.UTF8=function(e,n,s){for(var i=[],r=s,o=0;o<r;o++,n+=1)i[o]=e.getUint8(n);return String.fromCharCode.apply(null,i)},lc.UTF16=function(e,n,s){for(var i=[],r=s/2,o=0;o<r;o++,n+=2)i[o]=e.getUint16(n);return String.fromCharCode.apply(null,i)},Ae.UTF16=function(e){for(var n=[],s=0;s<e.length;s+=1){var i=e.charCodeAt(s);n[n.length]=i>>8&255,n[n.length]=i&255}return n},je.UTF16=function(e){return e.length*2};var Zf={"x-mac-croatian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®Š™´¨≠ŽØ∞±≤≥∆µ∂∑∏š∫ªºΩžø¿¡¬√ƒ≈Ć«Č… ÀÃÕŒœĐ—“”‘’÷◊©⁄€‹›Æ»–·‚„‰ÂćÁčÈÍÎÏÌÓÔđÒÚÛÙıˆ˜¯πË˚¸Êæˇ","x-mac-cyrillic":"АБВГДЕЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ†°Ґ£§•¶І®©™Ђђ≠Ѓѓ∞±≤≥іµґЈЄєЇїЉљЊњјЅ¬√ƒ≈∆«»… ЋћЌќѕ–—“”‘’÷„ЎўЏџ№Ёёяабвгдежзийклмнопрстуфхцчшщъыьэю","x-mac-gaelic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØḂ±≤≥ḃĊċḊḋḞḟĠġṀæøṁṖṗɼƒſṠ«»… ÀÃÕŒœ–—“”‘’ṡẛÿŸṪ€‹›Ŷŷṫ·Ỳỳ⁊ÂÊÁËÈÍÎÏÌÓÔ♣ÒÚÛÙıÝýŴŵẄẅẀẁẂẃ","x-mac-greek":"Ä¹²É³ÖÜ΅àâä΄¨çéèêë£™îï•½‰ôö¦€ùûü†ΓΔΘΛΞΠß®©ΣΪ§≠°·Α±≤≥¥ΒΕΖΗΙΚΜΦΫΨΩάΝ¬ΟΡ≈Τ«»… ΥΧΆΈœ–―“”‘’÷ΉΊΌΎέήίόΏύαβψδεφγηιξκλμνοπώρστθωςχυζϊϋΐΰ­","x-mac-icelandic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûüÝ°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€ÐðÞþý·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-inuit":"ᐃᐄᐅᐆᐊᐋᐱᐲᐳᐴᐸᐹᑉᑎᑏᑐᑑᑕᑖᑦᑭᑮᑯᑰᑲᑳᒃᒋᒌᒍᒎᒐᒑ°ᒡᒥᒦ•¶ᒧ®©™ᒨᒪᒫᒻᓂᓃᓄᓅᓇᓈᓐᓯᓰᓱᓲᓴᓵᔅᓕᓖᓗᓘᓚᓛᓪᔨᔩᔪᔫᔭ… ᔮᔾᕕᕖᕗ–—“”‘’ᕘᕙᕚᕝᕆᕇᕈᕉᕋᕌᕐᕿᖀᖁᖂᖃᖄᖅᖏᖐᖑᖒᖓᖔᖕᙱᙲᙳᙴᙵᙶᖖᖠᖡᖢᖣᖤᖥᖦᕼŁł","x-mac-ce":"ÄĀāÉĄÖÜáąČäčĆćéŹźĎíďĒēĖóėôöõúĚěü†°Ę£§•¶ß®©™ę¨≠ģĮįĪ≤≥īĶ∂∑łĻļĽľĹĺŅņŃ¬√ńŇ∆«»… ňŐÕőŌ–—“”‘’÷◊ōŔŕŘ‹›řŖŗŠ‚„šŚśÁŤťÍŽžŪÓÔūŮÚůŰűŲųÝýķŻŁżĢˇ",macintosh:"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›ﬁﬂ‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-romanian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ĂȘ∞±≤≥¥µ∂∑∏π∫ªºΩăș¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›Țț‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-turkish":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸĞğİıŞş‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙˆ˜¯˘˙˚¸˝˛ˇ"};lc.MACSTRING=function(e,n,s,i){var r=Zf[i];if(r!==void 0){for(var o="",a=0;a<s;a++){var c=e.getUint8(n+a);c<=127?o+=String.fromCharCode(c):o+=r[c&127]}return o}};var $h=typeof WeakMap=="function"&&new WeakMap,eu,lR=function(e){if(!eu){eu={};for(var n in Zf)eu[n]=new String(n)}var s=eu[e];if(s!==void 0){if($h){var i=$h.get(s);if(i!==void 0)return i}var r=Zf[e];if(r!==void 0){for(var o={},a=0;a<r.length;a++)o[r.charCodeAt(a)]=a+128;return $h&&$h.set(s,o),o}}};Ae.MACSTRING=function(e,n){var s=lR(n);if(s!==void 0){for(var i=[],r=0;r<e.length;r++){var o=e.charCodeAt(r);if(o>=128&&(o=s[o],o===void 0))return;i[r]=o}return i}},je.MACSTRING=function(e,n){var s=Ae.MACSTRING(e,n);return s!==void 0?s.length:0};function qf(e){return e>=-128&&e<=127}function hR(e,n,s){for(var i=0,r=e.length;n<r&&i<64&&e[n]===0;)++n,++i;return s.push(128|i-1),n}function uR(e,n,s){for(var i=0,r=e.length,o=n;o<r&&i<64;){var a=e[o];if(!qf(a)||a===0&&o+1<r&&e[o+1]===0)break;++o,++i}s.push(i-1);for(var c=n;c<o;++c)s.push(e[c]+256&255);return o}function dR(e,n,s){for(var i=0,r=e.length,o=n;o<r&&i<64;){var a=e[o];if(a===0||qf(a)&&o+1<r&&qf(e[o+1]))break;++o,++i}s.push(64|i-1);for(var c=n;c<o;++c){var l=e[c];s.push(l+65536>>8&255,l+256&255)}return o}Ae.VARDELTAS=function(e){for(var n=0,s=[];n<e.length;){var i=e[n];i===0?n=hR(e,n,s):i>=-128&&i<=127?n=uR(e,n,s):n=dR(e,n,s)}return s},Ae.INDEX=function(e){for(var n=1,s=[n],i=[],r=0;r<e.length;r+=1){var o=Ae.OBJECT(e[r]);Array.prototype.push.apply(i,o),n+=o.length,s.push(n)}if(i.length===0)return[0,0];for(var a=[],c=1+Math.floor(Math.log(n)/Math.log(2))/8|0,l=[void 0,Ae.BYTE,Ae.USHORT,Ae.UINT24,Ae.ULONG][c],h=0;h<s.length;h+=1){var d=l(s[h]);Array.prototype.push.apply(a,d)}return Array.prototype.concat(Ae.Card16(e.length),Ae.OffSize(c),a,i)},je.INDEX=function(e){return Ae.INDEX(e).length},Ae.DICT=function(e){for(var n=[],s=Object.keys(e),i=s.length,r=0;r<i;r+=1){var o=parseInt(s[r],0),a=e[o];n=n.concat(Ae.OPERAND(a.value,a.type)),n=n.concat(Ae.OPERATOR(o))}return n},je.DICT=function(e){return Ae.DICT(e).length},Ae.OPERATOR=function(e){return e<1200?[e]:[12,e-1200]},Ae.OPERAND=function(e,n){var s=[];if(Array.isArray(n))for(var i=0;i<n.length;i+=1)rt.argument(e.length===n.length,"Not enough arguments given for type"+n),s=s.concat(Ae.OPERAND(e[i],n[i]));else if(n==="SID")s=s.concat(Ae.NUMBER(e));else if(n==="offset")s=s.concat(Ae.NUMBER32(e));else if(n==="number")s=s.concat(Ae.NUMBER(e));else if(n==="real")s=s.concat(Ae.REAL(e));else throw new Error("Unknown operand type "+n);return s},Ae.OP=Ae.BYTE,je.OP=je.BYTE;var tu=typeof WeakMap=="function"&&new WeakMap;Ae.CHARSTRING=function(e){if(tu){var n=tu.get(e);if(n!==void 0)return n}for(var s=[],i=e.length,r=0;r<i;r+=1){var o=e[r];s=s.concat(Ae[o.type](o.value))}return tu&&tu.set(e,s),s},je.CHARSTRING=function(e){return Ae.CHARSTRING(e).length},Ae.OBJECT=function(e){var n=Ae[e.type];return rt.argument(n!==void 0,"No encoding function for type "+e.type),n(e.value)},je.OBJECT=function(e){var n=je[e.type];return rt.argument(n!==void 0,"No sizeOf function for type "+e.type),n(e.value)},Ae.TABLE=function(e){for(var n=[],s=e.fields.length,i=[],r=[],o=0;o<s;o+=1){var a=e.fields[o],c=Ae[a.type];rt.argument(c!==void 0,"No encoding function for field type "+a.type+" ("+a.name+")");var l=e[a.name];l===void 0&&(l=a.value);var h=c(l);a.type==="TABLE"?(r.push(n.length),n=n.concat([0,0]),i.push(h)):n=n.concat(h)}for(var d=0;d<i.length;d+=1){var p=r[d],E=n.length;rt.argument(E<65536,"Table "+e.tableName+" too big."),n[p]=E>>8,n[p+1]=E&255,n=n.concat(i[d])}return n},je.TABLE=function(e){for(var n=0,s=e.fields.length,i=0;i<s;i+=1){var r=e.fields[i],o=je[r.type];rt.argument(o!==void 0,"No sizeOf function for field type "+r.type+" ("+r.name+")");var a=e[r.name];a===void 0&&(a=r.value),n+=o(a),r.type==="TABLE"&&(n+=2)}return n},Ae.RECORD=Ae.TABLE,je.RECORD=je.TABLE,Ae.LITERAL=function(e){return e},je.LITERAL=function(e){return e.length};function ss(e,n,s){if(n.length&&(n[0].name!=="coverageFormat"||n[0].value===1))for(var i=0;i<n.length;i+=1){var r=n[i];this[r.name]=r.value}if(this.tableName=e,this.fields=n,s)for(var o=Object.keys(s),a=0;a<o.length;a+=1){var c=o[a],l=s[c];this[c]!==void 0&&(this[c]=l)}}ss.prototype.encode=function(){return Ae.TABLE(this)},ss.prototype.sizeOf=function(){return je.TABLE(this)};function ul(e,n,s){s===void 0&&(s=n.length);var i=new Array(n.length+1);i[0]={name:e+"Count",type:"USHORT",value:s};for(var r=0;r<n.length;r++)i[r+1]={name:e+r,type:"USHORT",value:n[r]};return i}function jf(e,n,s){var i=n.length,r=new Array(i+1);r[0]={name:e+"Count",type:"USHORT",value:i};for(var o=0;o<i;o++)r[o+1]={name:e+o,type:"TABLE",value:s(n[o],o)};return r}function dl(e,n,s){var i=n.length,r=[];r[0]={name:e+"Count",type:"USHORT",value:i};for(var o=0;o<i;o++)r=r.concat(s(n[o],o));return r}function nu(e){e.format===1?ss.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(ul("glyph",e.glyphs))):e.format===2?ss.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:2}].concat(dl("rangeRecord",e.ranges,function(n){return[{name:"startGlyphID",type:"USHORT",value:n.start},{name:"endGlyphID",type:"USHORT",value:n.end},{name:"startCoverageIndex",type:"USHORT",value:n.index}]}))):rt.assert(!1,"Coverage format must be 1 or 2.")}nu.prototype=Object.create(ss.prototype),nu.prototype.constructor=nu;function su(e){ss.call(this,"scriptListTable",dl("scriptRecord",e,function(n,s){var i=n.script,r=i.defaultLangSys;return rt.assert(!!r,"Unable to write GSUB: script "+n.tag+" has no default language system."),[{name:"scriptTag"+s,type:"TAG",value:n.tag},{name:"script"+s,type:"TABLE",value:new ss("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new ss("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:r.reqFeatureIndex}].concat(ul("featureIndex",r.featureIndexes)))}].concat(dl("langSys",i.langSysRecords,function(o,a){var c=o.langSys;return[{name:"langSysTag"+a,type:"TAG",value:o.tag},{name:"langSys"+a,type:"TABLE",value:new ss("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:c.reqFeatureIndex}].concat(ul("featureIndex",c.featureIndexes)))}]})))}]}))}su.prototype=Object.create(ss.prototype),su.prototype.constructor=su;function iu(e){ss.call(this,"featureListTable",dl("featureRecord",e,function(n,s){var i=n.feature;return[{name:"featureTag"+s,type:"TAG",value:n.tag},{name:"feature"+s,type:"TABLE",value:new ss("featureTable",[{name:"featureParams",type:"USHORT",value:i.featureParams}].concat(ul("lookupListIndex",i.lookupListIndexes)))}]}))}iu.prototype=Object.create(ss.prototype),iu.prototype.constructor=iu;function ru(e,n){ss.call(this,"lookupListTable",jf("lookup",e,function(s){var i=n[s.lookupType];return rt.assert(!!i,"Unable to write GSUB lookup type "+s.lookupType+" tables."),new ss("lookupTable",[{name:"lookupType",type:"USHORT",value:s.lookupType},{name:"lookupFlag",type:"USHORT",value:s.lookupFlag}].concat(jf("subtable",s.subtables,i)))}))}ru.prototype=Object.create(ss.prototype),ru.prototype.constructor=ru;var De={Table:ss,Record:ss,Coverage:nu,ScriptList:su,FeatureList:iu,LookupList:ru,ushortList:ul,tableList:jf,recordList:dl};function XA(e,n){return e.getUint8(n)}function ou(e,n){return e.getUint16(n,!1)}function fR(e,n){return e.getInt16(n,!1)}function Jf(e,n){return e.getUint32(n,!1)}function zA(e,n){var s=e.getInt16(n,!1),i=e.getUint16(n+2,!1);return s+i/65535}function pR(e,n){for(var s="",i=n;i<n+4;i+=1)s+=String.fromCharCode(e.getInt8(i));return s}function ER(e,n,s){for(var i=0,r=0;r<s;r+=1)i<<=8,i+=e.getUint8(n+r);return i}function gR(e,n,s){for(var i=[],r=n;r<s;r+=1)i.push(e.getUint8(r));return i}function _R(e){for(var n="",s=0;s<e.length;s+=1)n+=String.fromCharCode(e[s]);return n}var TR={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};function $(e,n){this.data=e,this.offset=n,this.relativeOffset=0}$.prototype.parseByte=function(){var e=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},$.prototype.parseChar=function(){var e=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},$.prototype.parseCard8=$.prototype.parseByte,$.prototype.parseUShort=function(){var e=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},$.prototype.parseCard16=$.prototype.parseUShort,$.prototype.parseSID=$.prototype.parseUShort,$.prototype.parseOffset16=$.prototype.parseUShort,$.prototype.parseShort=function(){var e=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},$.prototype.parseF2Dot14=function(){var e=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,e},$.prototype.parseULong=function(){var e=Jf(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},$.prototype.parseOffset32=$.prototype.parseULong,$.prototype.parseFixed=function(){var e=zA(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},$.prototype.parseString=function(e){var n=this.data,s=this.offset+this.relativeOffset,i="";this.relativeOffset+=e;for(var r=0;r<e;r++)i+=String.fromCharCode(n.getUint8(s+r));return i},$.prototype.parseTag=function(){return this.parseString(4)},$.prototype.parseLongDateTime=function(){var e=Jf(this.data,this.offset+this.relativeOffset+4);return e-=2082844800,this.relativeOffset+=8,e},$.prototype.parseVersion=function(e){var n=ou(this.data,this.offset+this.relativeOffset),s=ou(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,e===void 0&&(e=4096),n+s/e/10},$.prototype.skip=function(e,n){n===void 0&&(n=1),this.relativeOffset+=TR[e]*n},$.prototype.parseULongList=function(e){e===void 0&&(e=this.parseULong());for(var n=new Array(e),s=this.data,i=this.offset+this.relativeOffset,r=0;r<e;r++)n[r]=s.getUint32(i),i+=4;return this.relativeOffset+=e*4,n},$.prototype.parseOffset16List=$.prototype.parseUShortList=function(e){e===void 0&&(e=this.parseUShort());for(var n=new Array(e),s=this.data,i=this.offset+this.relativeOffset,r=0;r<e;r++)n[r]=s.getUint16(i),i+=2;return this.relativeOffset+=e*2,n},$.prototype.parseShortList=function(e){for(var n=new Array(e),s=this.data,i=this.offset+this.relativeOffset,r=0;r<e;r++)n[r]=s.getInt16(i),i+=2;return this.relativeOffset+=e*2,n},$.prototype.parseByteList=function(e){for(var n=new Array(e),s=this.data,i=this.offset+this.relativeOffset,r=0;r<e;r++)n[r]=s.getUint8(i++);return this.relativeOffset+=e,n},$.prototype.parseList=function(e,n){n||(n=e,e=this.parseUShort());for(var s=new Array(e),i=0;i<e;i++)s[i]=n.call(this);return s},$.prototype.parseList32=function(e,n){n||(n=e,e=this.parseULong());for(var s=new Array(e),i=0;i<e;i++)s[i]=n.call(this);return s},$.prototype.parseRecordList=function(e,n){n||(n=e,e=this.parseUShort());for(var s=new Array(e),i=Object.keys(n),r=0;r<e;r++){for(var o={},a=0;a<i.length;a++){var c=i[a],l=n[c];o[c]=l.call(this)}s[r]=o}return s},$.prototype.parseRecordList32=function(e,n){n||(n=e,e=this.parseULong());for(var s=new Array(e),i=Object.keys(n),r=0;r<e;r++){for(var o={},a=0;a<i.length;a++){var c=i[a],l=n[c];o[c]=l.call(this)}s[r]=o}return s},$.prototype.parseStruct=function(e){if(typeof e=="function")return e.call(this);for(var n=Object.keys(e),s={},i=0;i<n.length;i++){var r=n[i],o=e[r];s[r]=o.call(this)}return s},$.prototype.parseValueRecord=function(e){if(e===void 0&&(e=this.parseUShort()),e!==0){var n={};return e&1&&(n.xPlacement=this.parseShort()),e&2&&(n.yPlacement=this.parseShort()),e&4&&(n.xAdvance=this.parseShort()),e&8&&(n.yAdvance=this.parseShort()),e&16&&(n.xPlaDevice=void 0,this.parseShort()),e&32&&(n.yPlaDevice=void 0,this.parseShort()),e&64&&(n.xAdvDevice=void 0,this.parseShort()),e&128&&(n.yAdvDevice=void 0,this.parseShort()),n}},$.prototype.parseValueRecordList=function(){for(var e=this.parseUShort(),n=this.parseUShort(),s=new Array(n),i=0;i<n;i++)s[i]=this.parseValueRecord(e);return s},$.prototype.parsePointer=function(e){var n=this.parseOffset16();if(n>0)return new $(this.data,this.offset+n).parseStruct(e)},$.prototype.parsePointer32=function(e){var n=this.parseOffset32();if(n>0)return new $(this.data,this.offset+n).parseStruct(e)},$.prototype.parseListOfLists=function(e){for(var n=this.parseOffset16List(),s=n.length,i=this.relativeOffset,r=new Array(s),o=0;o<s;o++){var a=n[o];if(a===0){r[o]=void 0;continue}if(this.relativeOffset=a,e){for(var c=this.parseOffset16List(),l=new Array(c.length),h=0;h<c.length;h++)this.relativeOffset=a+c[h],l[h]=e.call(this);r[o]=l}else r[o]=this.parseUShortList()}return this.relativeOffset=i,r},$.prototype.parseCoverage=function(){var e=this.offset+this.relativeOffset,n=this.parseUShort(),s=this.parseUShort();if(n===1)return{format:1,glyphs:this.parseUShortList(s)};if(n===2){for(var i=new Array(s),r=0;r<s;r++)i[r]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:i}}throw new Error("0x"+e.toString(16)+": Coverage format must be 1 or 2.")},$.prototype.parseClassDef=function(){var e=this.offset+this.relativeOffset,n=this.parseUShort();if(n===1)return{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()};if(n===2)return{format:2,ranges:this.parseRecordList({start:$.uShort,end:$.uShort,classId:$.uShort})};throw new Error("0x"+e.toString(16)+": ClassDef format must be 1 or 2.")},$.list=function(e,n){return function(){return this.parseList(e,n)}},$.list32=function(e,n){return function(){return this.parseList32(e,n)}},$.recordList=function(e,n){return function(){return this.parseRecordList(e,n)}},$.recordList32=function(e,n){return function(){return this.parseRecordList32(e,n)}},$.pointer=function(e){return function(){return this.parsePointer(e)}},$.pointer32=function(e){return function(){return this.parsePointer32(e)}},$.tag=$.prototype.parseTag,$.byte=$.prototype.parseByte,$.uShort=$.offset16=$.prototype.parseUShort,$.uShortList=$.prototype.parseUShortList,$.uLong=$.offset32=$.prototype.parseULong,$.uLongList=$.prototype.parseULongList,$.struct=$.prototype.parseStruct,$.coverage=$.prototype.parseCoverage,$.classDef=$.prototype.parseClassDef;var KA={reserved:$.uShort,reqFeatureIndex:$.uShort,featureIndexes:$.uShortList};$.prototype.parseScriptList=function(){return this.parsePointer($.recordList({tag:$.tag,script:$.pointer({defaultLangSys:$.pointer(KA),langSysRecords:$.recordList({tag:$.tag,langSys:$.pointer(KA)})})}))||[]},$.prototype.parseFeatureList=function(){return this.parsePointer($.recordList({tag:$.tag,feature:$.pointer({featureParams:$.offset16,lookupListIndexes:$.uShortList})}))||[]},$.prototype.parseLookupList=function(e){return this.parsePointer($.list($.pointer(function(){var n=this.parseUShort();rt.argument(1<=n&&n<=9,"GPOS/GSUB lookup type "+n+" unknown.");var s=this.parseUShort(),i=s&16;return{lookupType:n,lookupFlag:s,subtables:this.parseList($.pointer(e[n])),markFilteringSet:i?this.parseUShort():void 0}})))||[]},$.prototype.parseFeatureVariationsList=function(){return this.parsePointer32(function(){var e=this.parseUShort(),n=this.parseUShort();rt.argument(e===1&&n<1,"GPOS/GSUB feature variations table unknown.");var s=this.parseRecordList32({conditionSetOffset:$.offset32,featureTableSubstitutionOffset:$.offset32});return s})||[]};var ft={getByte:XA,getCard8:XA,getUShort:ou,getCard16:ou,getShort:fR,getULong:Jf,getFixed:zA,getTag:pR,getOffset:ER,getBytes:gR,bytesToString:_R,Parser:$};function AR(e,n){n.parseUShort(),e.length=n.parseULong(),e.language=n.parseULong();var s;e.groupCount=s=n.parseULong(),e.glyphIndexMap={};for(var i=0;i<s;i+=1)for(var r=n.parseULong(),o=n.parseULong(),a=n.parseULong(),c=r;c<=o;c+=1)e.glyphIndexMap[c]=a,a++}function mR(e,n,s,i,r){e.length=n.parseUShort(),e.language=n.parseUShort();var o;e.segCount=o=n.parseUShort()>>1,n.skip("uShort",3),e.glyphIndexMap={};for(var a=new ft.Parser(s,i+r+14),c=new ft.Parser(s,i+r+16+o*2),l=new ft.Parser(s,i+r+16+o*4),h=new ft.Parser(s,i+r+16+o*6),d=i+r+16+o*8,p=0;p<o-1;p+=1)for(var E=void 0,g=a.parseUShort(),T=c.parseUShort(),A=l.parseShort(),m=h.parseUShort(),O=T;O<=g;O+=1)m!==0?(d=h.offset+h.relativeOffset-2,d+=m,d+=(O-T)*2,E=ft.getUShort(s,d),E!==0&&(E=E+A&65535)):E=O+A&65535,e.glyphIndexMap[O]=E}function OR(e,n){var s={};s.version=ft.getUShort(e,n),rt.argument(s.version===0,"cmap table version should be 0."),s.numTables=ft.getUShort(e,n+2);for(var i=-1,r=s.numTables-1;r>=0;r-=1){var o=ft.getUShort(e,n+4+r*8),a=ft.getUShort(e,n+4+r*8+2);if(o===3&&(a===0||a===1||a===10)||o===0&&(a===0||a===1||a===2||a===3||a===4)){i=ft.getULong(e,n+4+r*8+4);break}}if(i===-1)throw new Error("No valid cmap sub-tables found.");var c=new ft.Parser(e,n+i);if(s.format=c.parseUShort(),s.format===12)AR(s,c);else if(s.format===4)mR(s,c,e,n,i);else throw new Error("Only format 4 and 12 cmap tables are supported (found format "+s.format+").");return s}function IR(e,n,s){e.segments.push({end:n,start:n,delta:-(n-s),offset:0,glyphIndex:s})}function SR(e){e.segments.push({end:65535,start:65535,delta:1,offset:0})}function yR(e){var n=!0,s;for(s=e.length-1;s>0;s-=1){var i=e.get(s);if(i.unicode>65535){console.log("Adding CMAP format 12 (needed!)"),n=!1;break}}var r=[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:n?1:2},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:n?12:20}];n||(r=r.concat([{name:"cmap12PlatformID",type:"USHORT",value:3},{name:"cmap12EncodingID",type:"USHORT",value:10},{name:"cmap12Offset",type:"ULONG",value:0}])),r=r.concat([{name:"format",type:"USHORT",value:4},{name:"cmap4Length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);var o=new De.Table("cmap",r);for(o.segments=[],s=0;s<e.length;s+=1){for(var a=e.get(s),c=0;c<a.unicodes.length;c+=1)IR(o,a.unicodes[c],s);o.segments=o.segments.sort(function(S,y){return S.start-y.start})}SR(o);var l=o.segments.length,h=0,d=[],p=[],E=[],g=[],T=[],A=[];for(s=0;s<l;s+=1){var m=o.segments[s];m.end<=65535&&m.start<=65535?(d=d.concat({name:"end_"+s,type:"USHORT",value:m.end}),p=p.concat({name:"start_"+s,type:"USHORT",value:m.start}),E=E.concat({name:"idDelta_"+s,type:"SHORT",value:m.delta}),g=g.concat({name:"idRangeOffset_"+s,type:"USHORT",value:m.offset}),m.glyphId!==void 0&&(T=T.concat({name:"glyph_"+s,type:"USHORT",value:m.glyphId}))):h+=1,!n&&m.glyphIndex!==void 0&&(A=A.concat({name:"cmap12Start_"+s,type:"ULONG",value:m.start}),A=A.concat({name:"cmap12End_"+s,type:"ULONG",value:m.end}),A=A.concat({name:"cmap12Glyph_"+s,type:"ULONG",value:m.glyphIndex}))}if(o.segCountX2=(l-h)*2,o.searchRange=Math.pow(2,Math.floor(Math.log(l-h)/Math.log(2)))*2,o.entrySelector=Math.log(o.searchRange/2)/Math.log(2),o.rangeShift=o.segCountX2-o.searchRange,o.fields=o.fields.concat(d),o.fields.push({name:"reservedPad",type:"USHORT",value:0}),o.fields=o.fields.concat(p),o.fields=o.fields.concat(E),o.fields=o.fields.concat(g),o.fields=o.fields.concat(T),o.cmap4Length=14+d.length*2+2+p.length*2+E.length*2+g.length*2+T.length*2,!n){var O=16+A.length*4;o.cmap12Offset=12+2*2+4+o.cmap4Length,o.fields=o.fields.concat([{name:"cmap12Format",type:"USHORT",value:12},{name:"cmap12Reserved",type:"USHORT",value:0},{name:"cmap12Length",type:"ULONG",value:O},{name:"cmap12Language",type:"ULONG",value:0},{name:"cmap12nGroups",type:"ULONG",value:A.length/3}]),o.fields=o.fields.concat(A)}return o}var CR={parse:OR,make:yR},au=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],NR=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],xR=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],QA=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];function ZA(e){this.font=e}ZA.prototype.charToGlyphIndex=function(e){var n=e.codePointAt(0),s=this.font.glyphs;if(s){for(var i=0;i<s.length;i+=1)for(var r=s.get(i),o=0;o<r.unicodes.length;o+=1)if(r.unicodes[o]===n)return i}return null};function cu(e,n){this.encoding=e,this.charset=n}cu.prototype.charToGlyphIndex=function(e){var n=e.codePointAt(0),s=this.encoding[n];return this.charset.indexOf(s)};function vR(e,n,s,i,r){e.beginPath(),e.moveTo(n,s),e.lineTo(i,r),e.stroke()}var ga={line:vR};function RR(e,n){var s=n||new zn;return{configurable:!0,get:function(){return typeof s=="function"&&(s=s()),s},set:function(i){s=i}}}function Pi(e){this.bindConstructorValues(e)}Pi.prototype.bindConstructorValues=function(e){this.index=e.index||0,this.name=e.name||null,this.unicode=e.unicode||void 0,this.unicodes=e.unicodes||e.unicode!==void 0?[e.unicode]:[],"xMin"in e&&(this.xMin=e.xMin),"yMin"in e&&(this.yMin=e.yMin),"xMax"in e&&(this.xMax=e.xMax),"yMax"in e&&(this.yMax=e.yMax),"advanceWidth"in e&&(this.advanceWidth=e.advanceWidth),Object.defineProperty(this,"path",RR(this,e.path))},Pi.prototype.addUnicode=function(e){this.unicodes.length===0&&(this.unicode=e),this.unicodes.push(e)},Pi.prototype.getBoundingBox=function(){return this.path.getBoundingBox()},Pi.prototype.getPath=function(e,n,s,i,r){e=e!==void 0?e:0,n=n!==void 0?n:0,s=s!==void 0?s:72;var o,a;i||(i={});var c=i.xScale,l=i.yScale;if(i.hinting&&r&&r.hinting&&(a=this.path&&r.hinting.exec(this,s)),a)o=r.hinting.getCommands(a),e=Math.round(e),n=Math.round(n),c=l=1;else{o=this.path.commands;var h=1/(this.path.unitsPerEm||1e3)*s;c===void 0&&(c=h),l===void 0&&(l=h)}for(var d=new zn,p=0;p<o.length;p+=1){var E=o[p];E.type==="M"?d.moveTo(e+E.x*c,n+-E.y*l):E.type==="L"?d.lineTo(e+E.x*c,n+-E.y*l):E.type==="Q"?d.quadraticCurveTo(e+E.x1*c,n+-E.y1*l,e+E.x*c,n+-E.y*l):E.type==="C"?d.curveTo(e+E.x1*c,n+-E.y1*l,e+E.x2*c,n+-E.y2*l,e+E.x*c,n+-E.y*l):E.type==="Z"&&d.closePath()}return d},Pi.prototype.getContours=function(){if(this.points===void 0)return[];for(var e=[],n=[],s=0;s<this.points.length;s+=1){var i=this.points[s];n.push(i),i.lastPointOfContour&&(e.push(n),n=[])}return rt.argument(n.length===0,"There are still points left in the current contour."),e},Pi.prototype.getMetrics=function(){for(var e=this.path.commands,n=[],s=[],i=0;i<e.length;i+=1){var r=e[i];r.type!=="Z"&&(n.push(r.x),s.push(r.y)),(r.type==="Q"||r.type==="C")&&(n.push(r.x1),s.push(r.y1)),r.type==="C"&&(n.push(r.x2),s.push(r.y2))}var o={xMin:Math.min.apply(null,n),yMin:Math.min.apply(null,s),xMax:Math.max.apply(null,n),yMax:Math.max.apply(null,s),leftSideBearing:this.leftSideBearing};return isFinite(o.xMin)||(o.xMin=0),isFinite(o.xMax)||(o.xMax=this.advanceWidth),isFinite(o.yMin)||(o.yMin=0),isFinite(o.yMax)||(o.yMax=0),o.rightSideBearing=this.advanceWidth-o.leftSideBearing-(o.xMax-o.xMin),o},Pi.prototype.draw=function(e,n,s,i,r){this.getPath(n,s,i,r).draw(e)},Pi.prototype.drawPoints=function(e,n,s,i){function r(p,E,g,T){e.beginPath();for(var A=0;A<p.length;A+=1)e.moveTo(E+p[A].x*T,g+p[A].y*T),e.arc(E+p[A].x*T,g+p[A].y*T,2,0,Math.PI*2,!1);e.closePath(),e.fill()}n=n!==void 0?n:0,s=s!==void 0?s:0,i=i!==void 0?i:24;for(var o=1/this.path.unitsPerEm*i,a=[],c=[],l=this.path,h=0;h<l.commands.length;h+=1){var d=l.commands[h];d.x!==void 0&&a.push({x:d.x,y:-d.y}),d.x1!==void 0&&c.push({x:d.x1,y:-d.y1}),d.x2!==void 0&&c.push({x:d.x2,y:-d.y2})}e.fillStyle="blue",r(a,n,s,o),e.fillStyle="red",r(c,n,s,o)},Pi.prototype.drawMetrics=function(e,n,s,i){var r;n=n!==void 0?n:0,s=s!==void 0?s:0,i=i!==void 0?i:24,r=1/this.path.unitsPerEm*i,e.lineWidth=1,e.strokeStyle="black",ga.line(e,n,-1e4,n,1e4),ga.line(e,-1e4,s,1e4,s);var o=this.xMin||0,a=this.yMin||0,c=this.xMax||0,l=this.yMax||0,h=this.advanceWidth||0;e.strokeStyle="blue",ga.line(e,n+o*r,-1e4,n+o*r,1e4),ga.line(e,n+c*r,-1e4,n+c*r,1e4),ga.line(e,-1e4,s+-a*r,1e4,s+-a*r),ga.line(e,-1e4,s+-l*r,1e4,s+-l*r),e.strokeStyle="green",ga.line(e,n+h*r,-1e4,n+h*r,1e4)};function lu(e,n,s){Object.defineProperty(e,n,{get:function(){return e.path,e[s]},set:function(i){e[s]=i},enumerable:!0,configurable:!0})}function $f(e,n){if(this.font=e,this.glyphs={},Array.isArray(n))for(var s=0;s<n.length;s++){var i=n[s];i.path.unitsPerEm=e.unitsPerEm,this.glyphs[s]=i}this.length=n&&n.length||0}$f.prototype.get=function(e){if(this.glyphs[e]===void 0){this.font._push(e),typeof this.glyphs[e]=="function"&&(this.glyphs[e]=this.glyphs[e]());var n=this.glyphs[e],s=this.font._IndexToUnicodeMap[e];if(s)for(var i=0;i<s.unicodes.length;i++)n.addUnicode(s.unicodes[i]);this.font.cffEncoding?this.font.isCIDFont?n.name="gid"+e:n.name=this.font.cffEncoding.charset[e]:this.font.glyphNames.names&&(n.name=this.font.glyphNames.glyphIndexToName(e)),this.glyphs[e].advanceWidth=this.font._hmtxTableData[e].advanceWidth,this.glyphs[e].leftSideBearing=this.font._hmtxTableData[e].leftSideBearing}else typeof this.glyphs[e]=="function"&&(this.glyphs[e]=this.glyphs[e]());return this.glyphs[e]},$f.prototype.push=function(e,n){this.glyphs[e]=n,this.length++};function wR(e,n){return new Pi({index:n,font:e})}function DR(e,n,s,i,r,o){return function(){var a=new Pi({index:n,font:e});return a.path=function(){s(a,i,r);var c=o(e.glyphs,a);return c.unitsPerEm=e.unitsPerEm,c},lu(a,"xMin","_xMin"),lu(a,"xMax","_xMax"),lu(a,"yMin","_yMin"),lu(a,"yMax","_yMax"),a}}function LR(e,n,s,i){return function(){var r=new Pi({index:n,font:e});return r.path=function(){var o=s(e,r,i);return o.unitsPerEm=e.unitsPerEm,o},r}}var Ar={GlyphSet:$f,glyphLoader:wR,ttfGlyphLoader:DR,cffGlyphLoader:LR};function qA(e,n){if(e===n)return!0;if(Array.isArray(e)&&Array.isArray(n)){if(e.length!==n.length)return!1;for(var s=0;s<e.length;s+=1)if(!qA(e[s],n[s]))return!1;return!0}else return!1}function ep(e){var n;return e.length<1240?n=107:e.length<33900?n=1131:n=32768,n}function So(e,n,s){var i=[],r=[],o=ft.getCard16(e,n),a,c;if(o!==0){var l=ft.getByte(e,n+2);a=n+(o+1)*l+2;for(var h=n+3,d=0;d<o+1;d+=1)i.push(ft.getOffset(e,h,l)),h+=l;c=a+i[o]}else c=n+2;for(var p=0;p<i.length-1;p+=1){var E=ft.getBytes(e,a+i[p],a+i[p+1]);s&&(E=s(E)),r.push(E)}return{objects:r,startOffset:n,endOffset:c}}function MR(e,n){var s=[],i=ft.getCard16(e,n),r,o;if(i!==0){var a=ft.getByte(e,n+2);r=n+(i+1)*a+2;for(var c=n+3,l=0;l<i+1;l+=1)s.push(ft.getOffset(e,c,a)),c+=a;o=r+s[i]}else o=n+2;return{offsets:s,startOffset:n,endOffset:o}}function PR(e,n,s,i,r){var o=ft.getCard16(s,i),a=0;if(o!==0){var c=ft.getByte(s,i+2);a=i+(o+1)*c+2}var l=ft.getBytes(s,a+n[e],a+n[e+1]);return l}function bR(e){for(var n="",s=15,i=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var r=e.parseByte(),o=r>>4,a=r&15;if(o===s||(n+=i[o],a===s))break;n+=i[a]}return parseFloat(n)}function UR(e,n){var s,i,r,o;if(n===28)return s=e.parseByte(),i=e.parseByte(),s<<8|i;if(n===29)return s=e.parseByte(),i=e.parseByte(),r=e.parseByte(),o=e.parseByte(),s<<24|i<<16|r<<8|o;if(n===30)return bR(e);if(n>=32&&n<=246)return n-139;if(n>=247&&n<=250)return s=e.parseByte(),(n-247)*256+s+108;if(n>=251&&n<=254)return s=e.parseByte(),-(n-251)*256-s-108;throw new Error("Invalid b0 "+n)}function GR(e){for(var n={},s=0;s<e.length;s+=1){var i=e[s][0],r=e[s][1],o=void 0;if(r.length===1?o=r[0]:o=r,n.hasOwnProperty(i)&&!isNaN(n[i]))throw new Error("Object "+n+" already has key "+i);n[i]=o}return n}function jA(e,n,s){n=n!==void 0?n:0;var i=new ft.Parser(e,n),r=[],o=[];for(s=s!==void 0?s:e.length;i.relativeOffset<s;){var a=i.parseByte();a<=21?(a===12&&(a=1200+i.parseByte()),r.push([a,o]),o=[]):o.push(UR(i,a))}return GR(r)}function fl(e,n){return n<=390?n=au[n]:n=e[n-391],n}function JA(e,n,s){for(var i={},r,o=0;o<n.length;o+=1){var a=n[o];if(Array.isArray(a.type)){var c=[];c.length=a.type.length;for(var l=0;l<a.type.length;l++)r=e[a.op]!==void 0?e[a.op][l]:void 0,r===void 0&&(r=a.value!==void 0&&a.value[l]!==void 0?a.value[l]:null),a.type[l]==="SID"&&(r=fl(s,r)),c[l]=r;i[a.name]=c}else r=e[a.op],r===void 0&&(r=a.value!==void 0?a.value:null),a.type==="SID"&&(r=fl(s,r)),i[a.name]=r}return i}function FR(e,n){var s={};return s.formatMajor=ft.getCard8(e,n),s.formatMinor=ft.getCard8(e,n+1),s.size=ft.getCard8(e,n+2),s.offsetSize=ft.getCard8(e,n+3),s.startOffset=n,s.endOffset=n+4,s}var $A=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]},{name:"ros",op:1230,type:["SID","SID","number"]},{name:"cidFontVersion",op:1231,type:"number",value:0},{name:"cidFontRevision",op:1232,type:"number",value:0},{name:"cidFontType",op:1233,type:"number",value:0},{name:"cidCount",op:1234,type:"number",value:8720},{name:"uidBase",op:1235,type:"number"},{name:"fdArray",op:1236,type:"offset"},{name:"fdSelect",op:1237,type:"offset"},{name:"fontName",op:1238,type:"SID"}],em=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];function kR(e,n){var s=jA(e,0,e.byteLength);return JA(s,$A,n)}function tm(e,n,s,i){var r=jA(e,n,s);return JA(r,em,i)}function nm(e,n,s,i){for(var r=[],o=0;o<s.length;o+=1){var a=new DataView(new Uint8Array(s[o]).buffer),c=kR(a,i);c._subrs=[],c._subrsBias=0,c._defaultWidthX=0,c._nominalWidthX=0;var l=c.private[0],h=c.private[1];if(l!==0&&h!==0){var d=tm(e,h+n,l,i);if(c._defaultWidthX=d.defaultWidthX,c._nominalWidthX=d.nominalWidthX,d.subrs!==0){var p=h+d.subrs,E=So(e,p+n);c._subrs=E.objects,c._subrsBias=ep(c._subrs)}c._privateDict=d}r.push(c)}return r}function BR(e,n,s,i){var r,o,a=new ft.Parser(e,n);s-=1;var c=[".notdef"],l=a.parseCard8();if(l===0)for(var h=0;h<s;h+=1)r=a.parseSID(),c.push(fl(i,r));else if(l===1)for(;c.length<=s;){r=a.parseSID(),o=a.parseCard8();for(var d=0;d<=o;d+=1)c.push(fl(i,r)),r+=1}else if(l===2)for(;c.length<=s;){r=a.parseSID(),o=a.parseCard16();for(var p=0;p<=o;p+=1)c.push(fl(i,r)),r+=1}else throw new Error("Unknown charset format "+l);return c}function VR(e,n,s){var i,r={},o=new ft.Parser(e,n),a=o.parseCard8();if(a===0)for(var c=o.parseCard8(),l=0;l<c;l+=1)i=o.parseCard8(),r[i]=l;else if(a===1){var h=o.parseCard8();i=1;for(var d=0;d<h;d+=1)for(var p=o.parseCard8(),E=o.parseCard8(),g=p;g<=p+E;g+=1)r[g]=i,i+=1}else throw new Error("Unknown encoding format "+a);return new cu(r,s)}function sm(e,n,s){var i,r,o,a,c=new zn,l=[],h=0,d=!1,p=!1,E=0,g=0,T,A,m,O;if(e.isCIDFont){var S=e.tables.cff.topDict._fdSelect[n.index],y=e.tables.cff.topDict._fdArray[S];T=y._subrs,A=y._subrsBias,m=y._defaultWidthX,O=y._nominalWidthX}else T=e.tables.cff.topDict._subrs,A=e.tables.cff.topDict._subrsBias,m=e.tables.cff.topDict._defaultWidthX,O=e.tables.cff.topDict._nominalWidthX;var v=m;function R(P,k){p&&c.closePath(),c.moveTo(P,k),p=!0}function M(){var P;P=l.length%2!==0,P&&!d&&(v=l.shift()+O),h+=l.length>>1,l.length=0,d=!0}function L(P){for(var k,Q,b,X,K,V,J,ge,se,ue,te,ie,re=0;re<P.length;){var fe=P[re];switch(re+=1,fe){case 1:M();break;case 3:M();break;case 4:l.length>1&&!d&&(v=l.shift()+O,d=!0),g+=l.pop(),R(E,g);break;case 5:for(;l.length>0;)E+=l.shift(),g+=l.shift(),c.lineTo(E,g);break;case 6:for(;l.length>0&&(E+=l.shift(),c.lineTo(E,g),l.length!==0);)g+=l.shift(),c.lineTo(E,g);break;case 7:for(;l.length>0&&(g+=l.shift(),c.lineTo(E,g),l.length!==0);)E+=l.shift(),c.lineTo(E,g);break;case 8:for(;l.length>0;)i=E+l.shift(),r=g+l.shift(),o=i+l.shift(),a=r+l.shift(),E=o+l.shift(),g=a+l.shift(),c.curveTo(i,r,o,a,E,g);break;case 10:K=l.pop()+A,V=T[K],V&&L(V);break;case 11:return;case 12:switch(fe=P[re],re+=1,fe){case 35:i=E+l.shift(),r=g+l.shift(),o=i+l.shift(),a=r+l.shift(),J=o+l.shift(),ge=a+l.shift(),se=J+l.shift(),ue=ge+l.shift(),te=se+l.shift(),ie=ue+l.shift(),E=te+l.shift(),g=ie+l.shift(),l.shift(),c.curveTo(i,r,o,a,J,ge),c.curveTo(se,ue,te,ie,E,g);break;case 34:i=E+l.shift(),r=g,o=i+l.shift(),a=r+l.shift(),J=o+l.shift(),ge=a,se=J+l.shift(),ue=a,te=se+l.shift(),ie=g,E=te+l.shift(),c.curveTo(i,r,o,a,J,ge),c.curveTo(se,ue,te,ie,E,g);break;case 36:i=E+l.shift(),r=g+l.shift(),o=i+l.shift(),a=r+l.shift(),J=o+l.shift(),ge=a,se=J+l.shift(),ue=a,te=se+l.shift(),ie=ue+l.shift(),E=te+l.shift(),c.curveTo(i,r,o,a,J,ge),c.curveTo(se,ue,te,ie,E,g);break;case 37:i=E+l.shift(),r=g+l.shift(),o=i+l.shift(),a=r+l.shift(),J=o+l.shift(),ge=a+l.shift(),se=J+l.shift(),ue=ge+l.shift(),te=se+l.shift(),ie=ue+l.shift(),Math.abs(te-E)>Math.abs(ie-g)?E=te+l.shift():g=ie+l.shift(),c.curveTo(i,r,o,a,J,ge),c.curveTo(se,ue,te,ie,E,g);break;default:console.log("Glyph "+n.index+": unknown operator 1200"+fe),l.length=0}break;case 14:l.length>0&&!d&&(v=l.shift()+O,d=!0),p&&(c.closePath(),p=!1);break;case 18:M();break;case 19:case 20:M(),re+=h+7>>3;break;case 21:l.length>2&&!d&&(v=l.shift()+O,d=!0),g+=l.pop(),E+=l.pop(),R(E,g);break;case 22:l.length>1&&!d&&(v=l.shift()+O,d=!0),E+=l.pop(),R(E,g);break;case 23:M();break;case 24:for(;l.length>2;)i=E+l.shift(),r=g+l.shift(),o=i+l.shift(),a=r+l.shift(),E=o+l.shift(),g=a+l.shift(),c.curveTo(i,r,o,a,E,g);E+=l.shift(),g+=l.shift(),c.lineTo(E,g);break;case 25:for(;l.length>6;)E+=l.shift(),g+=l.shift(),c.lineTo(E,g);i=E+l.shift(),r=g+l.shift(),o=i+l.shift(),a=r+l.shift(),E=o+l.shift(),g=a+l.shift(),c.curveTo(i,r,o,a,E,g);break;case 26:for(l.length%2&&(E+=l.shift());l.length>0;)i=E,r=g+l.shift(),o=i+l.shift(),a=r+l.shift(),E=o,g=a+l.shift(),c.curveTo(i,r,o,a,E,g);break;case 27:for(l.length%2&&(g+=l.shift());l.length>0;)i=E+l.shift(),r=g,o=i+l.shift(),a=r+l.shift(),E=o+l.shift(),g=a,c.curveTo(i,r,o,a,E,g);break;case 28:k=P[re],Q=P[re+1],l.push((k<<24|Q<<16)>>16),re+=2;break;case 29:K=l.pop()+e.gsubrsBias,V=e.gsubrs[K],V&&L(V);break;case 30:for(;l.length>0&&(i=E,r=g+l.shift(),o=i+l.shift(),a=r+l.shift(),E=o+l.shift(),g=a+(l.length===1?l.shift():0),c.curveTo(i,r,o,a,E,g),l.length!==0);)i=E+l.shift(),r=g,o=i+l.shift(),a=r+l.shift(),g=a+l.shift(),E=o+(l.length===1?l.shift():0),c.curveTo(i,r,o,a,E,g);break;case 31:for(;l.length>0&&(i=E+l.shift(),r=g,o=i+l.shift(),a=r+l.shift(),g=a+l.shift(),E=o+(l.length===1?l.shift():0),c.curveTo(i,r,o,a,E,g),l.length!==0);)i=E,r=g+l.shift(),o=i+l.shift(),a=r+l.shift(),E=o+l.shift(),g=a+(l.length===1?l.shift():0),c.curveTo(i,r,o,a,E,g);break;default:fe<32?console.log("Glyph "+n.index+": unknown operator "+fe):fe<247?l.push(fe-139):fe<251?(k=P[re],re+=1,l.push((fe-247)*256+k+108)):fe<255?(k=P[re],re+=1,l.push(-(fe-251)*256-k-108)):(k=P[re],Q=P[re+1],b=P[re+2],X=P[re+3],re+=4,l.push((k<<24|Q<<16|b<<8|X)/65536))}}}return L(s),n.advanceWidth=v,c}function HR(e,n,s,i){var r=[],o,a=new ft.Parser(e,n),c=a.parseCard8();if(c===0)for(var l=0;l<s;l++){if(o=a.parseCard8(),o>=i)throw new Error("CFF table CID Font FDSelect has bad FD index value "+o+" (FD count "+i+")");r.push(o)}else if(c===3){var h=a.parseCard16(),d=a.parseCard16();if(d!==0)throw new Error("CFF Table CID Font FDSelect format 3 range has bad initial GID "+d);for(var p,E=0;E<h;E++){if(o=a.parseCard8(),p=a.parseCard16(),o>=i)throw new Error("CFF table CID Font FDSelect has bad FD index value "+o+" (FD count "+i+")");if(p>s)throw new Error("CFF Table CID Font FDSelect format 3 range has bad GID "+p);for(;d<p;d++)r.push(o);d=p}if(p!==s)throw new Error("CFF Table CID Font FDSelect format 3 range has bad final GID "+p)}else throw new Error("CFF Table CID Font FDSelect table has unsupported format "+c);return r}function WR(e,n,s,i){s.tables.cff={};var r=FR(e,n),o=So(e,r.endOffset,ft.bytesToString),a=So(e,o.endOffset),c=So(e,a.endOffset,ft.bytesToString),l=So(e,c.endOffset);s.gsubrs=l.objects,s.gsubrsBias=ep(s.gsubrs);var h=nm(e,n,a.objects,c.objects);if(h.length!==1)throw new Error("CFF table has too many fonts in 'FontSet' - count of fonts NameIndex.length = "+h.length);var d=h[0];if(s.tables.cff.topDict=d,d._privateDict&&(s.defaultWidthX=d._privateDict.defaultWidthX,s.nominalWidthX=d._privateDict.nominalWidthX),d.ros[0]!==void 0&&d.ros[1]!==void 0&&(s.isCIDFont=!0),s.isCIDFont){var p=d.fdArray,E=d.fdSelect;if(p===0||E===0)throw new Error("Font is marked as a CID font, but FDArray and/or FDSelect information is missing");p+=n;var g=So(e,p),T=nm(e,n,g.objects,c.objects);d._fdArray=T,E+=n,d._fdSelect=HR(e,E,s.numGlyphs,T.length)}var A=n+d.private[1],m=tm(e,A,d.private[0],c.objects);if(s.defaultWidthX=m.defaultWidthX,s.nominalWidthX=m.nominalWidthX,m.subrs!==0){var O=A+m.subrs,S=So(e,O);s.subrs=S.objects,s.subrsBias=ep(s.subrs)}else s.subrs=[],s.subrsBias=0;var y;i.lowMemory?(y=MR(e,n+d.charStrings),s.nGlyphs=y.offsets.length):(y=So(e,n+d.charStrings),s.nGlyphs=y.objects.length);var v=BR(e,n+d.charset,s.nGlyphs,c.objects);if(d.encoding===0?s.cffEncoding=new cu(NR,v):d.encoding===1?s.cffEncoding=new cu(xR,v):s.cffEncoding=VR(e,n+d.encoding,v),s.encoding=s.encoding||s.cffEncoding,s.glyphs=new Ar.GlyphSet(s),i.lowMemory)s._push=function(L){var P=PR(L,y.offsets,e,n+d.charStrings);s.glyphs.push(L,Ar.cffGlyphLoader(s,L,sm,P))};else for(var R=0;R<s.nGlyphs;R+=1){var M=y.objects[R];s.glyphs.push(R,Ar.cffGlyphLoader(s,R,sm,M))}}function im(e,n){var s,i=au.indexOf(e);return i>=0&&(s=i),i=n.indexOf(e),i>=0?s=i+au.length:(s=au.length+n.length,n.push(e)),s}function YR(){return new De.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}])}function XR(e){var n=new De.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);n.names=[];for(var s=0;s<e.length;s+=1)n.names.push({name:"name_"+s,type:"NAME",value:e[s]});return n}function rm(e,n,s){for(var i={},r=0;r<e.length;r+=1){var o=e[r],a=n[o.name];a!==void 0&&!qA(a,o.value)&&(o.type==="SID"&&(a=im(a,s)),i[o.op]={name:o.name,type:o.type,value:a})}return i}function om(e,n){var s=new De.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return s.dict=rm($A,e,n),s}function am(e){var n=new De.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return n.topDicts=[{name:"topDict_0",type:"TABLE",value:e}],n}function zR(e){var n=new De.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);n.strings=[];for(var s=0;s<e.length;s+=1)n.strings.push({name:"string_"+s,type:"STRING",value:e[s]});return n}function KR(){return new De.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}])}function QR(e,n){for(var s=new De.Record("Charsets",[{name:"format",type:"Card8",value:0}]),i=0;i<e.length;i+=1){var r=e[i],o=im(r,n);s.fields.push({name:"glyph_"+i,type:"SID",value:o})}return s}function ZR(e){var n=[],s=e.path;n.push({name:"width",type:"NUMBER",value:e.advanceWidth});for(var i=0,r=0,o=0;o<s.commands.length;o+=1){var a=void 0,c=void 0,l=s.commands[o];if(l.type==="Q"){var h=.3333333333333333,d=2/3;l={type:"C",x:l.x,y:l.y,x1:Math.round(h*i+d*l.x1),y1:Math.round(h*r+d*l.y1),x2:Math.round(h*l.x+d*l.x1),y2:Math.round(h*l.y+d*l.y1)}}if(l.type==="M")a=Math.round(l.x-i),c=Math.round(l.y-r),n.push({name:"dx",type:"NUMBER",value:a}),n.push({name:"dy",type:"NUMBER",value:c}),n.push({name:"rmoveto",type:"OP",value:21}),i=Math.round(l.x),r=Math.round(l.y);else if(l.type==="L")a=Math.round(l.x-i),c=Math.round(l.y-r),n.push({name:"dx",type:"NUMBER",value:a}),n.push({name:"dy",type:"NUMBER",value:c}),n.push({name:"rlineto",type:"OP",value:5}),i=Math.round(l.x),r=Math.round(l.y);else if(l.type==="C"){var p=Math.round(l.x1-i),E=Math.round(l.y1-r),g=Math.round(l.x2-l.x1),T=Math.round(l.y2-l.y1);a=Math.round(l.x-l.x2),c=Math.round(l.y-l.y2),n.push({name:"dx1",type:"NUMBER",value:p}),n.push({name:"dy1",type:"NUMBER",value:E}),n.push({name:"dx2",type:"NUMBER",value:g}),n.push({name:"dy2",type:"NUMBER",value:T}),n.push({name:"dx",type:"NUMBER",value:a}),n.push({name:"dy",type:"NUMBER",value:c}),n.push({name:"rrcurveto",type:"OP",value:8}),i=Math.round(l.x),r=Math.round(l.y)}}return n.push({name:"endchar",type:"OP",value:14}),n}function qR(e){for(var n=new De.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),s=0;s<e.length;s+=1){var i=e.get(s),r=ZR(i);n.charStrings.push({name:i.name,type:"CHARSTRING",value:r})}return n}function jR(e,n){var s=new De.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}]);return s.dict=rm(em,e,n),s}function JR(e,n){for(var s=new De.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),i=1/n.unitsPerEm,r={version:n.version,fullName:n.fullName,familyName:n.familyName,weight:n.weightName,fontBBox:n.fontBBox||[0,0,0,0],fontMatrix:[i,0,0,i,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},o={},a=[],c,l=1;l<e.length;l+=1)c=e.get(l),a.push(c.name);var h=[];s.header=YR(),s.nameIndex=XR([n.postScriptName]);var d=om(r,h);s.topDictIndex=am(d),s.globalSubrIndex=KR(),s.charsets=QR(a,h),s.charStringsIndex=qR(e),s.privateDict=jR(o,h),s.stringIndex=zR(h);var p=s.header.sizeOf()+s.nameIndex.sizeOf()+s.topDictIndex.sizeOf()+s.stringIndex.sizeOf()+s.globalSubrIndex.sizeOf();return r.charset=p,r.encoding=0,r.charStrings=r.charset+s.charsets.sizeOf(),r.private[1]=r.charStrings+s.charStringsIndex.sizeOf(),d=om(r,h),s.topDictIndex=am(d),s}var $R={parse:WR,make:JR};function ew(e,n){var s={},i=new ft.Parser(e,n);return s.version=i.parseVersion(),s.fontRevision=Math.round(i.parseFixed()*1e3)/1e3,s.checkSumAdjustment=i.parseULong(),s.magicNumber=i.parseULong(),rt.argument(s.magicNumber===1594834165,"Font header has wrong magic number."),s.flags=i.parseUShort(),s.unitsPerEm=i.parseUShort(),s.created=i.parseLongDateTime(),s.modified=i.parseLongDateTime(),s.xMin=i.parseShort(),s.yMin=i.parseShort(),s.xMax=i.parseShort(),s.yMax=i.parseShort(),s.macStyle=i.parseUShort(),s.lowestRecPPEM=i.parseUShort(),s.fontDirectionHint=i.parseShort(),s.indexToLocFormat=i.parseShort(),s.glyphDataFormat=i.parseShort(),s}function tw(e){var n=Math.round(new Date().getTime()/1e3)+2082844800,s=n;return e.createdTimestamp&&(s=e.createdTimestamp+2082844800),new De.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:s},{name:"modified",type:"LONGDATETIME",value:n},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],e)}var nw={parse:ew,make:tw};function sw(e,n){var s={},i=new ft.Parser(e,n);return s.version=i.parseVersion(),s.ascender=i.parseShort(),s.descender=i.parseShort(),s.lineGap=i.parseShort(),s.advanceWidthMax=i.parseUShort(),s.minLeftSideBearing=i.parseShort(),s.minRightSideBearing=i.parseShort(),s.xMaxExtent=i.parseShort(),s.caretSlopeRise=i.parseShort(),s.caretSlopeRun=i.parseShort(),s.caretOffset=i.parseShort(),i.relativeOffset+=8,s.metricDataFormat=i.parseShort(),s.numberOfHMetrics=i.parseUShort(),s}function iw(e){return new De.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],e)}var rw={parse:sw,make:iw};function ow(e,n,s,i,r){for(var o,a,c=new ft.Parser(e,n),l=0;l<i;l+=1){l<s&&(o=c.parseUShort(),a=c.parseShort());var h=r.get(l);h.advanceWidth=o,h.leftSideBearing=a}}function aw(e,n,s,i,r){e._hmtxTableData={};for(var o,a,c=new ft.Parser(n,s),l=0;l<r;l+=1)l<i&&(o=c.parseUShort(),a=c.parseShort()),e._hmtxTableData[l]={advanceWidth:o,leftSideBearing:a}}function cw(e,n,s,i,r,o,a){a.lowMemory?aw(e,n,s,i,r):ow(n,s,i,r,o)}function lw(e){for(var n=new De.Table("hmtx",[]),s=0;s<e.length;s+=1){var i=e.get(s),r=i.advanceWidth||0,o=i.leftSideBearing||0;n.fields.push({name:"advanceWidth_"+s,type:"USHORT",value:r}),n.fields.push({name:"leftSideBearing_"+s,type:"SHORT",value:o})}return n}var hw={parse:cw,make:lw};function uw(e){for(var n=new De.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:e.length}]),s="",i=12+e.length*4,r=0;r<e.length;++r){var o=s.indexOf(e[r]);o<0&&(o=s.length,s+=e[r]),n.fields.push({name:"offset "+r,type:"USHORT",value:i+o}),n.fields.push({name:"length "+r,type:"USHORT",value:e[r].length})}return n.fields.push({name:"stringPool",type:"CHARARRAY",value:s}),n}function dw(e,n){var s=new ft.Parser(e,n),i=s.parseULong();rt.argument(i===1,"Unsupported ltag table version."),s.skip("uLong",1);for(var r=s.parseULong(),o=[],a=0;a<r;a++){for(var c="",l=n+s.parseUShort(),h=s.parseUShort(),d=l;d<l+h;++d)c+=String.fromCharCode(e.getInt8(d));o.push(c)}return o}var fw={make:uw,parse:dw};function pw(e,n){var s={},i=new ft.Parser(e,n);return s.version=i.parseVersion(),s.numGlyphs=i.parseUShort(),s.version===1&&(s.maxPoints=i.parseUShort(),s.maxContours=i.parseUShort(),s.maxCompositePoints=i.parseUShort(),s.maxCompositeContours=i.parseUShort(),s.maxZones=i.parseUShort(),s.maxTwilightPoints=i.parseUShort(),s.maxStorage=i.parseUShort(),s.maxFunctionDefs=i.parseUShort(),s.maxInstructionDefs=i.parseUShort(),s.maxStackElements=i.parseUShort(),s.maxSizeOfInstructions=i.parseUShort(),s.maxComponentElements=i.parseUShort(),s.maxComponentDepth=i.parseUShort()),s}function Ew(e){return new De.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:e}])}var gw={parse:pw,make:Ew},cm=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],lm={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},_w={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},hm={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"};function Tw(e,n,s){switch(e){case 0:if(n===65535)return"und";if(s)return s[n];break;case 1:return lm[n];case 3:return hm[n]}}var tp="utf-16",Aw={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},mw={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function um(e,n,s){switch(e){case 0:return tp;case 1:return mw[s]||Aw[n];case 3:if(n===1||n===10)return tp;break}}function Ow(e,n,s){for(var i={},r=new ft.Parser(e,n),o=r.parseUShort(),a=r.parseUShort(),c=r.offset+r.parseUShort(),l=0;l<a;l++){var h=r.parseUShort(),d=r.parseUShort(),p=r.parseUShort(),E=r.parseUShort(),g=cm[E]||E,T=r.parseUShort(),A=r.parseUShort(),m=Tw(h,p,s),O=um(h,d,p);if(O!==void 0&&m!==void 0){var S=void 0;if(O===tp?S=lc.UTF16(e,c+A,T):S=lc.MACSTRING(e,c+A,T,O),S){var y=i[g];y===void 0&&(y=i[g]={}),y[m]=S}}}return o===1&&r.parseUShort(),i}function np(e){var n={};for(var s in e)n[e[s]]=parseInt(s);return n}function dm(e,n,s,i,r,o){return new De.Record("NameRecord",[{name:"platformID",type:"USHORT",value:e},{name:"encodingID",type:"USHORT",value:n},{name:"languageID",type:"USHORT",value:s},{name:"nameID",type:"USHORT",value:i},{name:"length",type:"USHORT",value:r},{name:"offset",type:"USHORT",value:o}])}function Iw(e,n){var s=e.length,i=n.length-s+1;e:for(var r=0;r<i;r++)for(;r<i;r++){for(var o=0;o<s;o++)if(n[r+o]!==e[o])continue e;return r}return-1}function fm(e,n){var s=Iw(e,n);if(s<0){s=n.length;for(var i=0,r=e.length;i<r;++i)n.push(e[i])}return s}function Sw(e,n){var s,i=[],r={},o=np(cm);for(var a in e){var c=o[a];if(c===void 0&&(c=a),s=parseInt(c),isNaN(s))throw new Error('Name table entry "'+a+'" does not exist, see nameTableNames for complete list.');r[s]=e[a],i.push(s)}for(var l=np(lm),h=np(hm),d=[],p=[],E=0;E<i.length;E++){s=i[E];var g=r[s];for(var T in g){var A=g[T],m=1,O=l[T],S=_w[O],y=um(m,S,O),v=Ae.MACSTRING(A,y);v===void 0&&(m=0,O=n.indexOf(T),O<0&&(O=n.length,n.push(T)),S=4,v=Ae.UTF16(A));var R=fm(v,p);d.push(dm(m,S,O,s,v.length,R));var M=h[T];if(M!==void 0){var L=Ae.UTF16(A),P=fm(L,p);d.push(dm(3,1,M,s,L.length,P))}}}d.sort(function(b,X){return b.platformID-X.platformID||b.encodingID-X.encodingID||b.languageID-X.languageID||b.nameID-X.nameID});for(var k=new De.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:d.length},{name:"stringOffset",type:"USHORT",value:6+d.length*12}]),Q=0;Q<d.length;Q++)k.fields.push({name:"record_"+Q,type:"RECORD",value:d[Q]});return k.fields.push({name:"strings",type:"LITERAL",value:p}),k}var yw={parse:Ow,make:Sw},sp=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}];function Cw(e){for(var n=0;n<sp.length;n+=1){var s=sp[n];if(e>=s.begin&&e<s.end)return n}return-1}function Nw(e,n){var s={},i=new ft.Parser(e,n);s.version=i.parseUShort(),s.xAvgCharWidth=i.parseShort(),s.usWeightClass=i.parseUShort(),s.usWidthClass=i.parseUShort(),s.fsType=i.parseUShort(),s.ySubscriptXSize=i.parseShort(),s.ySubscriptYSize=i.parseShort(),s.ySubscriptXOffset=i.parseShort(),s.ySubscriptYOffset=i.parseShort(),s.ySuperscriptXSize=i.parseShort(),s.ySuperscriptYSize=i.parseShort(),s.ySuperscriptXOffset=i.parseShort(),s.ySuperscriptYOffset=i.parseShort(),s.yStrikeoutSize=i.parseShort(),s.yStrikeoutPosition=i.parseShort(),s.sFamilyClass=i.parseShort(),s.panose=[];for(var r=0;r<10;r++)s.panose[r]=i.parseByte();return s.ulUnicodeRange1=i.parseULong(),s.ulUnicodeRange2=i.parseULong(),s.ulUnicodeRange3=i.parseULong(),s.ulUnicodeRange4=i.parseULong(),s.achVendID=String.fromCharCode(i.parseByte(),i.parseByte(),i.parseByte(),i.parseByte()),s.fsSelection=i.parseUShort(),s.usFirstCharIndex=i.parseUShort(),s.usLastCharIndex=i.parseUShort(),s.sTypoAscender=i.parseShort(),s.sTypoDescender=i.parseShort(),s.sTypoLineGap=i.parseShort(),s.usWinAscent=i.parseUShort(),s.usWinDescent=i.parseUShort(),s.version>=1&&(s.ulCodePageRange1=i.parseULong(),s.ulCodePageRange2=i.parseULong()),s.version>=2&&(s.sxHeight=i.parseShort(),s.sCapHeight=i.parseShort(),s.usDefaultChar=i.parseUShort(),s.usBreakChar=i.parseUShort(),s.usMaxContent=i.parseUShort()),s}function xw(e){return new De.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],e)}var pm={parse:Nw,make:xw,unicodeRanges:sp,getUnicodeRange:Cw};function vw(e,n){var s={},i=new ft.Parser(e,n);switch(s.version=i.parseVersion(),s.italicAngle=i.parseFixed(),s.underlinePosition=i.parseShort(),s.underlineThickness=i.parseShort(),s.isFixedPitch=i.parseULong(),s.minMemType42=i.parseULong(),s.maxMemType42=i.parseULong(),s.minMemType1=i.parseULong(),s.maxMemType1=i.parseULong(),s.version){case 1:s.names=QA.slice();break;case 2:s.numberOfGlyphs=i.parseUShort(),s.glyphNameIndex=new Array(s.numberOfGlyphs);for(var r=0;r<s.numberOfGlyphs;r++)s.glyphNameIndex[r]=i.parseUShort();s.names=[];for(var o=0;o<s.numberOfGlyphs;o++)if(s.glyphNameIndex[o]>=QA.length){var a=i.parseChar();s.names.push(i.parseString(a))}break;case 2.5:s.numberOfGlyphs=i.parseUShort(),s.offset=new Array(s.numberOfGlyphs);for(var c=0;c<s.numberOfGlyphs;c++)s.offset[c]=i.parseChar();break}return s}function Rw(){return new De.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}var ww={parse:vw,make:Rw},sr=new Array(9);sr[1]=function(){var n=this.offset+this.relativeOffset,s=this.parseUShort();if(s===1)return{substFormat:1,coverage:this.parsePointer($.coverage),deltaGlyphId:this.parseUShort()};if(s===2)return{substFormat:2,coverage:this.parsePointer($.coverage),substitute:this.parseOffset16List()};rt.assert(!1,"0x"+n.toString(16)+": lookup type 1 format must be 1 or 2.")},sr[2]=function(){var n=this.parseUShort();return rt.argument(n===1,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:n,coverage:this.parsePointer($.coverage),sequences:this.parseListOfLists()}},sr[3]=function(){var n=this.parseUShort();return rt.argument(n===1,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:n,coverage:this.parsePointer($.coverage),alternateSets:this.parseListOfLists()}},sr[4]=function(){var n=this.parseUShort();return rt.argument(n===1,"GSUB ligature table identifier-format must be 1"),{substFormat:n,coverage:this.parsePointer($.coverage),ligatureSets:this.parseListOfLists(function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}})}};var hc={sequenceIndex:$.uShort,lookupListIndex:$.uShort};sr[5]=function(){var n=this.offset+this.relativeOffset,s=this.parseUShort();if(s===1)return{substFormat:s,coverage:this.parsePointer($.coverage),ruleSets:this.parseListOfLists(function(){var o=this.parseUShort(),a=this.parseUShort();return{input:this.parseUShortList(o-1),lookupRecords:this.parseRecordList(a,hc)}})};if(s===2)return{substFormat:s,coverage:this.parsePointer($.coverage),classDef:this.parsePointer($.classDef),classSets:this.parseListOfLists(function(){var o=this.parseUShort(),a=this.parseUShort();return{classes:this.parseUShortList(o-1),lookupRecords:this.parseRecordList(a,hc)}})};if(s===3){var i=this.parseUShort(),r=this.parseUShort();return{substFormat:s,coverages:this.parseList(i,$.pointer($.coverage)),lookupRecords:this.parseRecordList(r,hc)}}rt.assert(!1,"0x"+n.toString(16)+": lookup type 5 format must be 1, 2 or 3.")},sr[6]=function(){var n=this.offset+this.relativeOffset,s=this.parseUShort();if(s===1)return{substFormat:1,coverage:this.parsePointer($.coverage),chainRuleSets:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(hc)}})};if(s===2)return{substFormat:2,coverage:this.parsePointer($.coverage),backtrackClassDef:this.parsePointer($.classDef),inputClassDef:this.parsePointer($.classDef),lookaheadClassDef:this.parsePointer($.classDef),chainClassSet:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(hc)}})};if(s===3)return{substFormat:3,backtrackCoverage:this.parseList($.pointer($.coverage)),inputCoverage:this.parseList($.pointer($.coverage)),lookaheadCoverage:this.parseList($.pointer($.coverage)),lookupRecords:this.parseRecordList(hc)};rt.assert(!1,"0x"+n.toString(16)+": lookup type 6 format must be 1, 2 or 3.")},sr[7]=function(){var n=this.parseUShort();rt.argument(n===1,"GSUB Extension Substitution subtable identifier-format must be 1");var s=this.parseUShort(),i=new $(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:s,extension:sr[s].call(i)}},sr[8]=function(){var n=this.parseUShort();return rt.argument(n===1,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:n,coverage:this.parsePointer($.coverage),backtrackCoverage:this.parseList($.pointer($.coverage)),lookaheadCoverage:this.parseList($.pointer($.coverage)),substitutes:this.parseUShortList()}};function Dw(e,n){n=n||0;var s=new $(e,n),i=s.parseVersion(1);return rt.argument(i===1||i===1.1,"Unsupported GSUB table version."),i===1?{version:i,scripts:s.parseScriptList(),features:s.parseFeatureList(),lookups:s.parseLookupList(sr)}:{version:i,scripts:s.parseScriptList(),features:s.parseFeatureList(),lookups:s.parseLookupList(sr),variations:s.parseFeatureVariationsList()}}var uc=new Array(9);uc[1]=function(n){return n.substFormat===1?new De.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new De.Coverage(n.coverage)},{name:"deltaGlyphID",type:"USHORT",value:n.deltaGlyphId}]):new De.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new De.Coverage(n.coverage)}].concat(De.ushortList("substitute",n.substitute)))},uc[2]=function(n){return rt.assert(n.substFormat===1,"Lookup type 2 substFormat must be 1."),new De.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new De.Coverage(n.coverage)}].concat(De.tableList("seqSet",n.sequences,function(s){return new De.Table("sequenceSetTable",De.ushortList("sequence",s))})))},uc[3]=function(n){return rt.assert(n.substFormat===1,"Lookup type 3 substFormat must be 1."),new De.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new De.Coverage(n.coverage)}].concat(De.tableList("altSet",n.alternateSets,function(s){return new De.Table("alternateSetTable",De.ushortList("alternate",s))})))},uc[4]=function(n){return rt.assert(n.substFormat===1,"Lookup type 4 substFormat must be 1."),new De.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new De.Coverage(n.coverage)}].concat(De.tableList("ligSet",n.ligatureSets,function(s){return new De.Table("ligatureSetTable",De.tableList("ligature",s,function(i){return new De.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:i.ligGlyph}].concat(De.ushortList("component",i.components,i.components.length+1)))}))})))},uc[6]=function(n){if(n.substFormat===1){var s=new De.Table("chainContextTable",[{name:"substFormat",type:"USHORT",value:n.substFormat},{name:"coverage",type:"TABLE",value:new De.Coverage(n.coverage)}].concat(De.tableList("chainRuleSet",n.chainRuleSets,function(o){return new De.Table("chainRuleSetTable",De.tableList("chainRule",o,function(a){var c=De.ushortList("backtrackGlyph",a.backtrack,a.backtrack.length).concat(De.ushortList("inputGlyph",a.input,a.input.length+1)).concat(De.ushortList("lookaheadGlyph",a.lookahead,a.lookahead.length)).concat(De.ushortList("substitution",[],a.lookupRecords.length));return a.lookupRecords.forEach(function(l,h){c=c.concat({name:"sequenceIndex"+h,type:"USHORT",value:l.sequenceIndex}).concat({name:"lookupListIndex"+h,type:"USHORT",value:l.lookupListIndex})}),new De.Table("chainRuleTable",c)}))})));return s}else if(n.substFormat===2)rt.assert(!1,"lookup type 6 format 2 is not yet supported.");else if(n.substFormat===3){var i=[{name:"substFormat",type:"USHORT",value:n.substFormat}];i.push({name:"backtrackGlyphCount",type:"USHORT",value:n.backtrackCoverage.length}),n.backtrackCoverage.forEach(function(o,a){i.push({name:"backtrackCoverage"+a,type:"TABLE",value:new De.Coverage(o)})}),i.push({name:"inputGlyphCount",type:"USHORT",value:n.inputCoverage.length}),n.inputCoverage.forEach(function(o,a){i.push({name:"inputCoverage"+a,type:"TABLE",value:new De.Coverage(o)})}),i.push({name:"lookaheadGlyphCount",type:"USHORT",value:n.lookaheadCoverage.length}),n.lookaheadCoverage.forEach(function(o,a){i.push({name:"lookaheadCoverage"+a,type:"TABLE",value:new De.Coverage(o)})}),i.push({name:"substitutionCount",type:"USHORT",value:n.lookupRecords.length}),n.lookupRecords.forEach(function(o,a){i=i.concat({name:"sequenceIndex"+a,type:"USHORT",value:o.sequenceIndex}).concat({name:"lookupListIndex"+a,type:"USHORT",value:o.lookupListIndex})});var r=new De.Table("chainContextTable",i);return r}rt.assert(!1,"lookup type 6 format must be 1, 2 or 3.")};function Lw(e){return new De.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new De.ScriptList(e.scripts)},{name:"features",type:"TABLE",value:new De.FeatureList(e.features)},{name:"lookups",type:"TABLE",value:new De.LookupList(e.lookups,uc)}])}var Mw={parse:Dw,make:Lw};function Pw(e,n){var s=new ft.Parser(e,n),i=s.parseULong();rt.argument(i===1,"Unsupported META table version."),s.parseULong(),s.parseULong();for(var r=s.parseULong(),o={},a=0;a<r;a++){var c=s.parseTag(),l=s.parseULong(),h=s.parseULong(),d=lc.UTF8(e,n+l,h);o[c]=d}return o}function bw(e){var n=Object.keys(e).length,s="",i=16+n*12,r=new De.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:i},{name:"numTags",type:"ULONG",value:n}]);for(var o in e){var a=s.length;s+=e[o],r.fields.push({name:"tag "+o,type:"TAG",value:o}),r.fields.push({name:"offset "+o,type:"ULONG",value:i+a}),r.fields.push({name:"length "+o,type:"ULONG",value:e[o].length})}return r.fields.push({name:"stringPool",type:"CHARARRAY",value:s}),r}var Uw={parse:Pw,make:bw};function Em(e){return Math.log(e)/Math.log(2)|0}function ip(e){for(;e.length%4!==0;)e.push(0);for(var n=0,s=0;s<e.length;s+=4)n+=(e[s]<<24)+(e[s+1]<<16)+(e[s+2]<<8)+e[s+3];return n%=Math.pow(2,32),n}function gm(e,n,s,i){return new De.Record("Table Record",[{name:"tag",type:"TAG",value:e!==void 0?e:""},{name:"checkSum",type:"ULONG",value:n!==void 0?n:0},{name:"offset",type:"ULONG",value:s!==void 0?s:0},{name:"length",type:"ULONG",value:i!==void 0?i:0}])}function _m(e){var n=new De.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);n.tables=e,n.numTables=e.length;var s=Math.pow(2,Em(n.numTables));n.searchRange=16*s,n.entrySelector=Em(s),n.rangeShift=n.numTables*16-n.searchRange;for(var i=[],r=[],o=n.sizeOf()+gm().sizeOf()*n.numTables;o%4!==0;)o+=1,r.push({name:"padding",type:"BYTE",value:0});for(var a=0;a<e.length;a+=1){var c=e[a];rt.argument(c.tableName.length===4,"Table name"+c.tableName+" is invalid.");var l=c.sizeOf(),h=gm(c.tableName,ip(c.encode()),o,l);for(i.push({name:h.tag+" Table Record",type:"RECORD",value:h}),r.push({name:c.tableName+" table",type:"RECORD",value:c}),o+=l,rt.argument(!isNaN(o),"Something went wrong calculating the offset.");o%4!==0;)o+=1,r.push({name:"padding",type:"BYTE",value:0})}return i.sort(function(d,p){return d.value.tag>p.value.tag?1:-1}),n.fields=n.fields.concat(i),n.fields=n.fields.concat(r),n}function Tm(e,n,s){for(var i=0;i<n.length;i+=1){var r=e.charToGlyphIndex(n[i]);if(r>0){var o=e.glyphs.get(r);return o.getMetrics()}}return s}function Gw(e){for(var n=0,s=0;s<e.length;s+=1)n+=e[s];return n/e.length}function Fw(e){for(var n=[],s=[],i=[],r=[],o=[],a=[],c=[],l,h=0,d=0,p=0,E=0,g=0,T=0;T<e.glyphs.length;T+=1){var A=e.glyphs.get(T),m=A.unicode|0;if(isNaN(A.advanceWidth))throw new Error("Glyph "+A.name+" ("+T+"): advanceWidth is not a number.");(l>m||l===void 0)&&m>0&&(l=m),h<m&&(h=m);var O=pm.getUnicodeRange(m);if(O<32)d|=1<<O;else if(O<64)p|=1<<O-32;else if(O<96)E|=1<<O-64;else if(O<123)g|=1<<O-96;else throw new Error("Unicode ranges bits > 123 are reserved for internal usage");if(A.name!==".notdef"){var S=A.getMetrics();n.push(S.xMin),s.push(S.yMin),i.push(S.xMax),r.push(S.yMax),a.push(S.leftSideBearing),c.push(S.rightSideBearing),o.push(A.advanceWidth)}}var y={xMin:Math.min.apply(null,n),yMin:Math.min.apply(null,s),xMax:Math.max.apply(null,i),yMax:Math.max.apply(null,r),advanceWidthMax:Math.max.apply(null,o),advanceWidthAvg:Gw(o),minLeftSideBearing:Math.min.apply(null,a),maxLeftSideBearing:Math.max.apply(null,a),minRightSideBearing:Math.min.apply(null,c)};y.ascender=e.ascender,y.descender=e.descender;var v=nw.make({flags:3,unitsPerEm:e.unitsPerEm,xMin:y.xMin,yMin:y.yMin,xMax:y.xMax,yMax:y.yMax,lowestRecPPEM:3,createdTimestamp:e.createdTimestamp}),R=rw.make({ascender:y.ascender,descender:y.descender,advanceWidthMax:y.advanceWidthMax,minLeftSideBearing:y.minLeftSideBearing,minRightSideBearing:y.minRightSideBearing,xMaxExtent:y.maxLeftSideBearing+(y.xMax-y.xMin),numberOfHMetrics:e.glyphs.length}),M=gw.make(e.glyphs.length),L=pm.make(Object.assign({xAvgCharWidth:Math.round(y.advanceWidthAvg),usFirstCharIndex:l,usLastCharIndex:h,ulUnicodeRange1:d,ulUnicodeRange2:p,ulUnicodeRange3:E,ulUnicodeRange4:g,sTypoAscender:y.ascender,sTypoDescender:y.descender,sTypoLineGap:0,usWinAscent:y.yMax,usWinDescent:Math.abs(y.yMin),ulCodePageRange1:1,sxHeight:Tm(e,"xyvw",{yMax:Math.round(y.ascender/2)}).yMax,sCapHeight:Tm(e,"HIKLEFJMNTZBDPRAGOQSUVWXY",y).yMax,usDefaultChar:e.hasChar(" ")?32:0,usBreakChar:e.hasChar(" ")?32:0},e.tables.os2)),P=hw.make(e.glyphs),k=CR.make(e.glyphs),Q=e.getEnglishName("fontFamily"),b=e.getEnglishName("fontSubfamily"),X=Q+" "+b,K=e.getEnglishName("postScriptName");K||(K=Q.replace(/\s/g,"")+"-"+b);var V={};for(var J in e.names)V[J]=e.names[J];V.uniqueID||(V.uniqueID={en:e.getEnglishName("manufacturer")+":"+X}),V.postScriptName||(V.postScriptName={en:K}),V.preferredFamily||(V.preferredFamily=e.names.fontFamily),V.preferredSubfamily||(V.preferredSubfamily=e.names.fontSubfamily);var ge=[],se=yw.make(V,ge),ue=ge.length>0?fw.make(ge):void 0,te=ww.make(),ie=$R.make(e.glyphs,{version:e.getEnglishName("version"),fullName:X,familyName:Q,weightName:b,postScriptName:K,unitsPerEm:e.unitsPerEm,fontBBox:[0,y.yMin,y.ascender,y.advanceWidthMax]}),re=e.metas&&Object.keys(e.metas).length>0?Uw.make(e.metas):void 0,fe=[v,R,M,L,se,k,te,ie,P];ue&&fe.push(ue),e.tables.gsub&&fe.push(Mw.make(e.tables.gsub)),re&&fe.push(re);for(var Ne=_m(fe),At=Ne.encode(),Ke=ip(At),St=Ne.fields,hn=!1,_t=0;_t<St.length;_t+=1)if(St[_t].name==="head table"){St[_t].value.checkSumAdjustment=2981146554-Ke,hn=!0;break}if(!hn)throw new Error("Could not find head table with checkSum to adjust.");return Ne}var kw={make:_m,fontToTable:Fw,computeCheckSum:ip};function rp(e,n){for(var s=0,i=e.length-1;s<=i;){var r=s+i>>>1,o=e[r].tag;if(o===n)return r;o<n?s=r+1:i=r-1}return-s-1}function Am(e,n){for(var s=0,i=e.length-1;s<=i;){var r=s+i>>>1,o=e[r];if(o===n)return r;o<n?s=r+1:i=r-1}return-s-1}function mm(e,n){for(var s,i=0,r=e.length-1;i<=r;){var o=i+r>>>1;s=e[o];var a=s.start;if(a===n)return s;a<n?i=o+1:r=o-1}if(i>0)return s=e[i-1],n>s.end?0:s}function pl(e,n){this.font=e,this.tableName=n}pl.prototype={searchTag:rp,binSearch:Am,getTable:function(e){var n=this.font.tables[this.tableName];return!n&&e&&(n=this.font.tables[this.tableName]=this.createDefaultTable()),n},getScriptNames:function(){var e=this.getTable();return e?e.scripts.map(function(n){return n.tag}):[]},getDefaultScriptName:function(){var e=this.getTable();if(e){for(var n=!1,s=0;s<e.scripts.length;s++){var i=e.scripts[s].tag;if(i==="DFLT")return i;i==="latn"&&(n=!0)}if(n)return"latn"}},getScriptTable:function(e,n){var s=this.getTable(n);if(s){e=e||"DFLT";var i=s.scripts,r=rp(s.scripts,e);if(r>=0)return i[r].script;if(n){var o={tag:e,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}};return i.splice(-1-r,0,o),o.script}}},getLangSysTable:function(e,n,s){var i=this.getScriptTable(e,s);if(i){if(!n||n==="dflt"||n==="DFLT")return i.defaultLangSys;var r=rp(i.langSysRecords,n);if(r>=0)return i.langSysRecords[r].langSys;if(s){var o={tag:n,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}};return i.langSysRecords.splice(-1-r,0,o),o.langSys}}},getFeatureTable:function(e,n,s,i){var r=this.getLangSysTable(e,n,i);if(r){for(var o,a=r.featureIndexes,c=this.font.tables[this.tableName].features,l=0;l<a.length;l++)if(o=c[a[l]],o.tag===s)return o.feature;if(i){var h=c.length;return rt.assert(h===0||s>=c[h-1].tag,"Features must be added in alphabetical order."),o={tag:s,feature:{params:0,lookupListIndexes:[]}},c.push(o),a.push(h),o.feature}}},getLookupTables:function(e,n,s,i,r){var o=this.getFeatureTable(e,n,s,r),a=[];if(o){for(var c,l=o.lookupListIndexes,h=this.font.tables[this.tableName].lookups,d=0;d<l.length;d++)c=h[l[d]],c.lookupType===i&&a.push(c);if(a.length===0&&r){c={lookupType:i,lookupFlag:0,subtables:[],markFilteringSet:void 0};var p=h.length;return h.push(c),l.push(p),[c]}}return a},getGlyphClass:function(e,n){switch(e.format){case 1:return e.startGlyph<=n&&n<e.startGlyph+e.classes.length?e.classes[n-e.startGlyph]:0;case 2:var s=mm(e.ranges,n);return s?s.classId:0}},getCoverageIndex:function(e,n){switch(e.format){case 1:var s=Am(e.glyphs,n);return s>=0?s:-1;case 2:var i=mm(e.ranges,n);return i?i.index+n-i.start:-1}},expandCoverage:function(e){if(e.format===1)return e.glyphs;for(var n=[],s=e.ranges,i=0;i<s.length;i++)for(var r=s[i],o=r.start,a=r.end,c=o;c<=a;c++)n.push(c);return n}};function El(e){pl.call(this,e,"gpos")}El.prototype=pl.prototype,El.prototype.init=function(){var e=this.getDefaultScriptName();this.defaultKerningTables=this.getKerningTables(e)},El.prototype.getKerningValue=function(e,n,s){for(var i=0;i<e.length;i++)for(var r=e[i].subtables,o=0;o<r.length;o++){var a=r[o],c=this.getCoverageIndex(a.coverage,n);if(!(c<0))switch(a.posFormat){case 1:for(var l=a.pairSets[c],h=0;h<l.length;h++){var d=l[h];if(d.secondGlyph===s)return d.value1&&d.value1.xAdvance||0}break;case 2:var p=this.getGlyphClass(a.classDef1,n),E=this.getGlyphClass(a.classDef2,s),g=a.classRecords[p][E];return g.value1&&g.value1.xAdvance||0}}return 0},El.prototype.getKerningTables=function(e,n){if(this.font.tables.gpos)return this.getLookupTables(e,n,"kern",2)};function hi(e){pl.call(this,e,"gsub")}function Bw(e,n){var s=e.length;if(s!==n.length)return!1;for(var i=0;i<s;i++)if(e[i]!==n[i])return!1;return!0}function op(e,n,s){for(var i=e.subtables,r=0;r<i.length;r++){var o=i[r];if(o.substFormat===n)return o}if(s)return i.push(s),s}hi.prototype=pl.prototype,hi.prototype.createDefaultTable=function(){return{version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}},hi.prototype.getSingle=function(e,n,s){for(var i=[],r=this.getLookupTables(n,s,e,1),o=0;o<r.length;o++)for(var a=r[o].subtables,c=0;c<a.length;c++){var l=a[c],h=this.expandCoverage(l.coverage),d=void 0;if(l.substFormat===1){var p=l.deltaGlyphId;for(d=0;d<h.length;d++){var E=h[d];i.push({sub:E,by:E+p})}}else{var g=l.substitute;for(d=0;d<h.length;d++)i.push({sub:h[d],by:g[d]})}}return i},hi.prototype.getMultiple=function(e,n,s){for(var i=[],r=this.getLookupTables(n,s,e,2),o=0;o<r.length;o++)for(var a=r[o].subtables,c=0;c<a.length;c++){var l=a[c],h=this.expandCoverage(l.coverage),d=void 0;for(d=0;d<h.length;d++){var p=h[d],E=l.sequences[d];i.push({sub:p,by:E})}}return i},hi.prototype.getAlternates=function(e,n,s){for(var i=[],r=this.getLookupTables(n,s,e,3),o=0;o<r.length;o++)for(var a=r[o].subtables,c=0;c<a.length;c++)for(var l=a[c],h=this.expandCoverage(l.coverage),d=l.alternateSets,p=0;p<h.length;p++)i.push({sub:h[p],by:d[p]});return i},hi.prototype.getLigatures=function(e,n,s){for(var i=[],r=this.getLookupTables(n,s,e,4),o=0;o<r.length;o++)for(var a=r[o].subtables,c=0;c<a.length;c++)for(var l=a[c],h=this.expandCoverage(l.coverage),d=l.ligatureSets,p=0;p<h.length;p++)for(var E=h[p],g=d[p],T=0;T<g.length;T++){var A=g[T];i.push({sub:[E].concat(A.components),by:A.ligGlyph})}return i},hi.prototype.addSingle=function(e,n,s,i){var r=this.getLookupTables(s,i,e,1,!0)[0],o=op(r,2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]});rt.assert(o.coverage.format===1,"Single: unable to modify coverage table format "+o.coverage.format);var a=n.sub,c=this.binSearch(o.coverage.glyphs,a);c<0&&(c=-1-c,o.coverage.glyphs.splice(c,0,a),o.substitute.splice(c,0,0)),o.substitute[c]=n.by},hi.prototype.addMultiple=function(e,n,s,i){rt.assert(n.by instanceof Array&&n.by.length>1,'Multiple: "by" must be an array of two or more ids');var r=this.getLookupTables(s,i,e,2,!0)[0],o=op(r,1,{substFormat:1,coverage:{format:1,glyphs:[]},sequences:[]});rt.assert(o.coverage.format===1,"Multiple: unable to modify coverage table format "+o.coverage.format);var a=n.sub,c=this.binSearch(o.coverage.glyphs,a);c<0&&(c=-1-c,o.coverage.glyphs.splice(c,0,a),o.sequences.splice(c,0,0)),o.sequences[c]=n.by},hi.prototype.addAlternate=function(e,n,s,i){var r=this.getLookupTables(s,i,e,3,!0)[0],o=op(r,1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]});rt.assert(o.coverage.format===1,"Alternate: unable to modify coverage table format "+o.coverage.format);var a=n.sub,c=this.binSearch(o.coverage.glyphs,a);c<0&&(c=-1-c,o.coverage.glyphs.splice(c,0,a),o.alternateSets.splice(c,0,0)),o.alternateSets[c]=n.by},hi.prototype.addLigature=function(e,n,s,i){var r=this.getLookupTables(s,i,e,4,!0)[0],o=r.subtables[0];o||(o={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]},r.subtables[0]=o),rt.assert(o.coverage.format===1,"Ligature: unable to modify coverage table format "+o.coverage.format);var a=n.sub[0],c=n.sub.slice(1),l={ligGlyph:n.by,components:c},h=this.binSearch(o.coverage.glyphs,a);if(h>=0){for(var d=o.ligatureSets[h],p=0;p<d.length;p++)if(Bw(d[p].components,c))return;d.push(l)}else h=-1-h,o.coverage.glyphs.splice(h,0,a),o.ligatureSets.splice(h,0,[l])},hi.prototype.getFeature=function(e,n,s){if(/ss\d\d/.test(e))return this.getSingle(e,n,s);switch(e){case"aalt":case"salt":return this.getSingle(e,n,s).concat(this.getAlternates(e,n,s));case"dlig":case"liga":case"rlig":return this.getLigatures(e,n,s);case"ccmp":return this.getMultiple(e,n,s).concat(this.getLigatures(e,n,s));case"stch":return this.getMultiple(e,n,s)}},hi.prototype.add=function(e,n,s,i){if(/ss\d\d/.test(e))return this.addSingle(e,n,s,i);switch(e){case"aalt":case"salt":return typeof n.by=="number"?this.addSingle(e,n,s,i):this.addAlternate(e,n,s,i);case"dlig":case"liga":case"rlig":return this.addLigature(e,n,s,i);case"ccmp":return n.by instanceof Array?this.addMultiple(e,n,s,i):this.addLigature(e,n,s,i)}};function Vw(){return typeof window<"u"}function Hw(e){for(var n=new Buffer(e.byteLength),s=new Uint8Array(e),i=0;i<n.length;++i)n[i]=s[i];return n}function gl(e,n){if(!e)throw n}function Om(e,n,s,i,r){var o;return(n&i)>0?(o=e.parseByte(),n&r||(o=-o),o=s+o):(n&r)>0?o=s:o=s+e.parseShort(),o}function Im(e,n,s){var i=new ft.Parser(n,s);e.numberOfContours=i.parseShort(),e._xMin=i.parseShort(),e._yMin=i.parseShort(),e._xMax=i.parseShort(),e._yMax=i.parseShort();var r,o;if(e.numberOfContours>0){for(var a=e.endPointIndices=[],c=0;c<e.numberOfContours;c+=1)a.push(i.parseUShort());e.instructionLength=i.parseUShort(),e.instructions=[];for(var l=0;l<e.instructionLength;l+=1)e.instructions.push(i.parseByte());var h=a[a.length-1]+1;r=[];for(var d=0;d<h;d+=1)if(o=i.parseByte(),r.push(o),(o&8)>0)for(var p=i.parseByte(),E=0;E<p;E+=1)r.push(o),d+=1;if(rt.argument(r.length===h,"Bad flags."),a.length>0){var g=[],T;if(h>0){for(var A=0;A<h;A+=1)o=r[A],T={},T.onCurve=!!(o&1),T.lastPointOfContour=a.indexOf(A)>=0,g.push(T);for(var m=0,O=0;O<h;O+=1)o=r[O],T=g[O],T.x=Om(i,o,m,2,16),m=T.x;for(var S=0,y=0;y<h;y+=1)o=r[y],T=g[y],T.y=Om(i,o,S,4,32),S=T.y}e.points=g}else e.points=[]}else if(e.numberOfContours===0)e.points=[];else{e.isComposite=!0,e.points=[],e.components=[];for(var v=!0;v;){r=i.parseUShort();var R={glyphIndex:i.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};(r&1)>0?(r&2)>0?(R.dx=i.parseShort(),R.dy=i.parseShort()):R.matchedPoints=[i.parseUShort(),i.parseUShort()]:(r&2)>0?(R.dx=i.parseChar(),R.dy=i.parseChar()):R.matchedPoints=[i.parseByte(),i.parseByte()],(r&8)>0?R.xScale=R.yScale=i.parseF2Dot14():(r&64)>0?(R.xScale=i.parseF2Dot14(),R.yScale=i.parseF2Dot14()):(r&128)>0&&(R.xScale=i.parseF2Dot14(),R.scale01=i.parseF2Dot14(),R.scale10=i.parseF2Dot14(),R.yScale=i.parseF2Dot14()),e.components.push(R),v=!!(r&32)}if(r&256){e.instructionLength=i.parseUShort(),e.instructions=[];for(var M=0;M<e.instructionLength;M+=1)e.instructions.push(i.parseByte())}}}function ap(e,n){for(var s=[],i=0;i<e.length;i+=1){var r=e[i],o={x:n.xScale*r.x+n.scale01*r.y+n.dx,y:n.scale10*r.x+n.yScale*r.y+n.dy,onCurve:r.onCurve,lastPointOfContour:r.lastPointOfContour};s.push(o)}return s}function Ww(e){for(var n=[],s=[],i=0;i<e.length;i+=1){var r=e[i];s.push(r),r.lastPointOfContour&&(n.push(s),s=[])}return rt.argument(s.length===0,"There are still points left in the current contour."),n}function Sm(e){var n=new zn;if(!e)return n;for(var s=Ww(e),i=0;i<s.length;++i){var r=s[i],o=null,a=r[r.length-1],c=r[0];if(a.onCurve)n.moveTo(a.x,a.y);else if(c.onCurve)n.moveTo(c.x,c.y);else{var l={x:(a.x+c.x)*.5,y:(a.y+c.y)*.5};n.moveTo(l.x,l.y)}for(var h=0;h<r.length;++h)if(o=a,a=c,c=r[(h+1)%r.length],a.onCurve)n.lineTo(a.x,a.y);else{var d=c;o.onCurve||((a.x+o.x)*.5,(a.y+o.y)*.5),c.onCurve||(d={x:(a.x+c.x)*.5,y:(a.y+c.y)*.5}),n.quadraticCurveTo(a.x,a.y,d.x,d.y)}n.closePath()}return n}function ym(e,n){if(n.isComposite)for(var s=0;s<n.components.length;s+=1){var i=n.components[s],r=e.get(i.glyphIndex);if(r.getPath(),r.points){var o=void 0;if(i.matchedPoints===void 0)o=ap(r.points,i);else{if(i.matchedPoints[0]>n.points.length-1||i.matchedPoints[1]>r.points.length-1)throw Error("Matched points out of range in "+n.name);var a=n.points[i.matchedPoints[0]],c=r.points[i.matchedPoints[1]],l={xScale:i.xScale,scale01:i.scale01,scale10:i.scale10,yScale:i.yScale,dx:0,dy:0};c=ap([c],l)[0],l.dx=a.x-c.x,l.dy=a.y-c.y,o=ap(r.points,l)}n.points=n.points.concat(o)}}return Sm(n.points)}function Yw(e,n,s,i){for(var r=new Ar.GlyphSet(i),o=0;o<s.length-1;o+=1){var a=s[o],c=s[o+1];a!==c?r.push(o,Ar.ttfGlyphLoader(i,o,Im,e,n+a,ym)):r.push(o,Ar.glyphLoader(i,o))}return r}function Xw(e,n,s,i){var r=new Ar.GlyphSet(i);return i._push=function(o){var a=s[o],c=s[o+1];a!==c?r.push(o,Ar.ttfGlyphLoader(i,o,Im,e,n+a,ym)):r.push(o,Ar.glyphLoader(i,o))},r}function zw(e,n,s,i,r){return r.lowMemory?Xw(e,n,s,i):Yw(e,n,s,i)}var Kw={getPath:Sm,parse:zw},Cm,_a,Nm,cp;function xm(e){this.font=e,this.getCommands=function(n){return Kw.getPath(n).commands},this._fpgmState=this._prepState=void 0,this._errorState=0}function Qw(e){return e}function vm(e){return Math.sign(e)*Math.round(Math.abs(e))}function Zw(e){return Math.sign(e)*Math.round(Math.abs(e*2))/2}function qw(e){return Math.sign(e)*(Math.round(Math.abs(e)+.5)-.5)}function jw(e){return Math.sign(e)*Math.ceil(Math.abs(e))}function Jw(e){return Math.sign(e)*Math.floor(Math.abs(e))}var Rm=function(e){var n=this.srPeriod,s=this.srPhase,i=this.srThreshold,r=1;return e<0&&(e=-e,r=-1),e+=i-s,e=Math.trunc(e/n)*n,e+=s,e<0?s*r:e*r},mr={x:1,y:0,axis:"x",distance:function(e,n,s,i){return(s?e.xo:e.x)-(i?n.xo:n.x)},interpolate:function(e,n,s,i){var r,o,a,c,l,h,d;if(!i||i===this){if(r=e.xo-n.xo,o=e.xo-s.xo,l=n.x-n.xo,h=s.x-s.xo,a=Math.abs(r),c=Math.abs(o),d=a+c,d===0){e.x=e.xo+(l+h)/2;return}e.x=e.xo+(l*c+h*a)/d;return}if(r=i.distance(e,n,!0,!0),o=i.distance(e,s,!0,!0),l=i.distance(n,n,!1,!0),h=i.distance(s,s,!1,!0),a=Math.abs(r),c=Math.abs(o),d=a+c,d===0){mr.setRelative(e,e,(l+h)/2,i,!0);return}mr.setRelative(e,e,(l*c+h*a)/d,i,!0)},normalSlope:Number.NEGATIVE_INFINITY,setRelative:function(e,n,s,i,r){if(!i||i===this){e.x=(r?n.xo:n.x)+s;return}var o=r?n.xo:n.x,a=r?n.yo:n.y,c=o+s*i.x,l=a+s*i.y;e.x=c+(e.y-l)/i.normalSlope},slope:0,touch:function(e){e.xTouched=!0},touched:function(e){return e.xTouched},untouch:function(e){e.xTouched=!1}},Fr={x:0,y:1,axis:"y",distance:function(e,n,s,i){return(s?e.yo:e.y)-(i?n.yo:n.y)},interpolate:function(e,n,s,i){var r,o,a,c,l,h,d;if(!i||i===this){if(r=e.yo-n.yo,o=e.yo-s.yo,l=n.y-n.yo,h=s.y-s.yo,a=Math.abs(r),c=Math.abs(o),d=a+c,d===0){e.y=e.yo+(l+h)/2;return}e.y=e.yo+(l*c+h*a)/d;return}if(r=i.distance(e,n,!0,!0),o=i.distance(e,s,!0,!0),l=i.distance(n,n,!1,!0),h=i.distance(s,s,!1,!0),a=Math.abs(r),c=Math.abs(o),d=a+c,d===0){Fr.setRelative(e,e,(l+h)/2,i,!0);return}Fr.setRelative(e,e,(l*c+h*a)/d,i,!0)},normalSlope:0,setRelative:function(e,n,s,i,r){if(!i||i===this){e.y=(r?n.yo:n.y)+s;return}var o=r?n.xo:n.x,a=r?n.yo:n.y,c=o+s*i.x,l=a+s*i.y;e.y=l+i.normalSlope*(e.x-c)},slope:Number.POSITIVE_INFINITY,touch:function(e){e.yTouched=!0},touched:function(e){return e.yTouched},untouch:function(e){e.yTouched=!1}};Object.freeze(mr),Object.freeze(Fr);function _l(e,n){this.x=e,this.y=n,this.axis=void 0,this.slope=n/e,this.normalSlope=-e/n,Object.freeze(this)}_l.prototype.distance=function(e,n,s,i){return this.x*mr.distance(e,n,s,i)+this.y*Fr.distance(e,n,s,i)},_l.prototype.interpolate=function(e,n,s,i){var r,o,a,c,l,h,d;if(a=i.distance(e,n,!0,!0),c=i.distance(e,s,!0,!0),r=i.distance(n,n,!1,!0),o=i.distance(s,s,!1,!0),l=Math.abs(a),h=Math.abs(c),d=l+h,d===0){this.setRelative(e,e,(r+o)/2,i,!0);return}this.setRelative(e,e,(r*h+o*l)/d,i,!0)},_l.prototype.setRelative=function(e,n,s,i,r){i=i||this;var o=r?n.xo:n.x,a=r?n.yo:n.y,c=o+s*i.x,l=a+s*i.y,h=i.normalSlope,d=this.slope,p=e.x,E=e.y;e.x=(d*p-h*c+l-E)/(d-h),e.y=d*(e.x-p)+E},_l.prototype.touch=function(e){e.xTouched=!0,e.yTouched=!0};function Tl(e,n){var s=Math.sqrt(e*e+n*n);return e/=s,n/=s,e===1&&n===0?mr:e===0&&n===1?Fr:new _l(e,n)}function kr(e,n,s,i){this.x=this.xo=Math.round(e*64)/64,this.y=this.yo=Math.round(n*64)/64,this.lastPointOfContour=s,this.onCurve=i,this.prevPointOnContour=void 0,this.nextPointOnContour=void 0,this.xTouched=!1,this.yTouched=!1,Object.preventExtensions(this)}kr.prototype.nextTouched=function(e){for(var n=this.nextPointOnContour;!e.touched(n)&&n!==this;)n=n.nextPointOnContour;return n},kr.prototype.prevTouched=function(e){for(var n=this.prevPointOnContour;!e.touched(n)&&n!==this;)n=n.prevPointOnContour;return n};var Al=Object.freeze(new kr(0,0)),$w={cvCutIn:17/16,deltaBase:9,deltaShift:.125,loop:1,minDis:1,autoFlip:!0};function yo(e,n){switch(this.env=e,this.stack=[],this.prog=n,e){case"glyf":this.zp0=this.zp1=this.zp2=1,this.rp0=this.rp1=this.rp2=0;case"prep":this.fv=this.pv=this.dpv=mr,this.round=vm}}xm.prototype.exec=function(e,n){if(typeof n!="number")throw new Error("Point size is not a number!");if(!(this._errorState>2)){var s=this.font,i=this._prepState;if(!i||i.ppem!==n){var r=this._fpgmState;if(!r){yo.prototype=$w,r=this._fpgmState=new yo("fpgm",s.tables.fpgm),r.funcs=[],r.font=s,exports.DEBUG&&(console.log("---EXEC FPGM---"),r.step=-1);try{_a(r)}catch(h){console.log("Hinting error in FPGM:"+h),this._errorState=3;return}}yo.prototype=r,i=this._prepState=new yo("prep",s.tables.prep),i.ppem=n;var o=s.tables.cvt;if(o)for(var a=i.cvt=new Array(o.length),c=n/s.unitsPerEm,l=0;l<o.length;l++)a[l]=o[l]*c;else i.cvt=[];exports.DEBUG&&(console.log("---EXEC PREP---"),i.step=-1);try{_a(i)}catch(h){this._errorState<2&&console.log("Hinting error in PREP:"+h),this._errorState=2}}if(!(this._errorState>1))try{return Nm(e,i)}catch(h){this._errorState<1&&(console.log("Hinting error:"+h),console.log("Note: further hinting errors are silenced")),this._errorState=1;return}}},Nm=function(e,n){var s=n.ppem/n.font.unitsPerEm,i=s,r=e.components,o,a,c;if(yo.prototype=n,!r)c=new yo("glyf",e.instructions),exports.DEBUG&&(console.log("---EXEC GLYPH---"),c.step=-1),cp(e,c,s,i),a=c.gZone;else{var l=n.font;a=[],o=[];for(var h=0;h<r.length;h++){var d=r[h],p=l.glyphs.get(d.glyphIndex);c=new yo("glyf",p.instructions),exports.DEBUG&&(console.log("---EXEC COMP "+h+"---"),c.step=-1),cp(p,c,s,i);for(var E=Math.round(d.dx*s),g=Math.round(d.dy*i),T=c.gZone,A=c.contours,m=0;m<T.length;m++){var O=T[m];O.xTouched=O.yTouched=!1,O.xo=O.x=O.x+E,O.yo=O.y=O.y+g}var S=a.length;a.push.apply(a,T);for(var y=0;y<A.length;y++)o.push(A[y]+S)}e.instructions&&!c.inhibitGridFit&&(c=new yo("glyf",e.instructions),c.gZone=c.z0=c.z1=c.z2=a,c.contours=o,a.push(new kr(0,0),new kr(Math.round(e.advanceWidth*s),0)),exports.DEBUG&&(console.log("---EXEC COMPOSITE---"),c.step=-1),_a(c),a.length-=2)}return a},cp=function(e,n,s,i){for(var r=e.points||[],o=r.length,a=n.gZone=n.z0=n.z1=n.z2=[],c=n.contours=[],l,h=0;h<o;h++)l=r[h],a[h]=new kr(l.x*s,l.y*i,l.lastPointOfContour,l.onCurve);for(var d,p,E=0;E<o;E++)l=a[E],d||(d=l,c.push(E)),l.lastPointOfContour?(l.nextPointOnContour=d,d.prevPointOnContour=l,d=void 0):(p=a[E+1],l.nextPointOnContour=p,p.prevPointOnContour=l);if(!n.inhibitGridFit){if(exports.DEBUG){console.log("PROCESSING GLYPH",n.stack);for(var g=0;g<o;g++)console.log(g,a[g].x,a[g].y)}if(a.push(new kr(0,0),new kr(Math.round(e.advanceWidth*s),0)),_a(n),a.length-=2,exports.DEBUG){console.log("FINISHED GLYPH",n.stack);for(var T=0;T<o;T++)console.log(T,a[T].x,a[T].y)}}},_a=function(e){var n=e.prog;if(n){var s=n.length,i;for(e.ip=0;e.ip<s;e.ip++){if(exports.DEBUG&&e.step++,i=Cm[n[e.ip]],!i)throw new Error("unknown instruction: 0x"+Number(n[e.ip]).toString(16));i(e)}}};function hu(e){for(var n=e.tZone=new Array(e.gZone.length),s=0;s<n.length;s++)n[s]=new kr(0,0)}function wm(e,n){var s=e.prog,i=e.ip,r=1,o;do if(o=s[++i],o===88)r++;else if(o===89)r--;else if(o===64)i+=s[i+1]+1;else if(o===65)i+=2*s[i+1]+1;else if(o>=176&&o<=183)i+=o-176+1;else if(o>=184&&o<=191)i+=(o-184+1)*2;else if(n&&r===1&&o===27)break;while(r>0);e.ip=i}function Dm(e,n){exports.DEBUG&&console.log(n.step,"SVTCA["+e.axis+"]"),n.fv=n.pv=n.dpv=e}function Lm(e,n){exports.DEBUG&&console.log(n.step,"SPVTCA["+e.axis+"]"),n.pv=n.dpv=e}function Mm(e,n){exports.DEBUG&&console.log(n.step,"SFVTCA["+e.axis+"]"),n.fv=e}function Pm(e,n){var s=n.stack,i=s.pop(),r=s.pop(),o=n.z2[i],a=n.z1[r];exports.DEBUG&&console.log("SPVTL["+e+"]",i,r);var c,l;e?(c=o.y-a.y,l=a.x-o.x):(c=a.x-o.x,l=a.y-o.y),n.pv=n.dpv=Tl(c,l)}function bm(e,n){var s=n.stack,i=s.pop(),r=s.pop(),o=n.z2[i],a=n.z1[r];exports.DEBUG&&console.log("SFVTL["+e+"]",i,r);var c,l;e?(c=o.y-a.y,l=a.x-o.x):(c=a.x-o.x,l=a.y-o.y),n.fv=Tl(c,l)}function eD(e){var n=e.stack,s=n.pop(),i=n.pop();exports.DEBUG&&console.log(e.step,"SPVFS[]",s,i),e.pv=e.dpv=Tl(i,s)}function tD(e){var n=e.stack,s=n.pop(),i=n.pop();exports.DEBUG&&console.log(e.step,"SPVFS[]",s,i),e.fv=Tl(i,s)}function nD(e){var n=e.stack,s=e.pv;exports.DEBUG&&console.log(e.step,"GPV[]"),n.push(s.x*16384),n.push(s.y*16384)}function sD(e){var n=e.stack,s=e.fv;exports.DEBUG&&console.log(e.step,"GFV[]"),n.push(s.x*16384),n.push(s.y*16384)}function iD(e){e.fv=e.pv,exports.DEBUG&&console.log(e.step,"SFVTPV[]")}function rD(e){var n=e.stack,s=n.pop(),i=n.pop(),r=n.pop(),o=n.pop(),a=n.pop(),c=e.z0,l=e.z1,h=c[s],d=c[i],p=l[r],E=l[o],g=e.z2[a];exports.DEBUG&&console.log("ISECT[], ",s,i,r,o,a);var T=h.x,A=h.y,m=d.x,O=d.y,S=p.x,y=p.y,v=E.x,R=E.y,M=(T-m)*(y-R)-(A-O)*(S-v),L=T*O-A*m,P=S*R-y*v;g.x=(L*(S-v)-P*(T-m))/M,g.y=(L*(y-R)-P*(A-O))/M}function oD(e){e.rp0=e.stack.pop(),exports.DEBUG&&console.log(e.step,"SRP0[]",e.rp0)}function aD(e){e.rp1=e.stack.pop(),exports.DEBUG&&console.log(e.step,"SRP1[]",e.rp1)}function cD(e){e.rp2=e.stack.pop(),exports.DEBUG&&console.log(e.step,"SRP2[]",e.rp2)}function lD(e){var n=e.stack.pop();switch(exports.DEBUG&&console.log(e.step,"SZP0[]",n),e.zp0=n,n){case 0:e.tZone||hu(e),e.z0=e.tZone;break;case 1:e.z0=e.gZone;break;default:throw new Error("Invalid zone pointer")}}function hD(e){var n=e.stack.pop();switch(exports.DEBUG&&console.log(e.step,"SZP1[]",n),e.zp1=n,n){case 0:e.tZone||hu(e),e.z1=e.tZone;break;case 1:e.z1=e.gZone;break;default:throw new Error("Invalid zone pointer")}}function uD(e){var n=e.stack.pop();switch(exports.DEBUG&&console.log(e.step,"SZP2[]",n),e.zp2=n,n){case 0:e.tZone||hu(e),e.z2=e.tZone;break;case 1:e.z2=e.gZone;break;default:throw new Error("Invalid zone pointer")}}function dD(e){var n=e.stack.pop();switch(exports.DEBUG&&console.log(e.step,"SZPS[]",n),e.zp0=e.zp1=e.zp2=n,n){case 0:e.tZone||hu(e),e.z0=e.z1=e.z2=e.tZone;break;case 1:e.z0=e.z1=e.z2=e.gZone;break;default:throw new Error("Invalid zone pointer")}}function fD(e){e.loop=e.stack.pop(),exports.DEBUG&&console.log(e.step,"SLOOP[]",e.loop)}function pD(e){exports.DEBUG&&console.log(e.step,"RTG[]"),e.round=vm}function ED(e){exports.DEBUG&&console.log(e.step,"RTHG[]"),e.round=qw}function gD(e){var n=e.stack.pop();exports.DEBUG&&console.log(e.step,"SMD[]",n),e.minDis=n/64}function _D(e){exports.DEBUG&&console.log(e.step,"ELSE[]"),wm(e,!1)}function TD(e){var n=e.stack.pop();exports.DEBUG&&console.log(e.step,"JMPR[]",n),e.ip+=n-1}function AD(e){var n=e.stack.pop();exports.DEBUG&&console.log(e.step,"SCVTCI[]",n),e.cvCutIn=n/64}function mD(e){var n=e.stack;exports.DEBUG&&console.log(e.step,"DUP[]"),n.push(n[n.length-1])}function lp(e){exports.DEBUG&&console.log(e.step,"POP[]"),e.stack.pop()}function OD(e){exports.DEBUG&&console.log(e.step,"CLEAR[]"),e.stack.length=0}function ID(e){var n=e.stack,s=n.pop(),i=n.pop();exports.DEBUG&&console.log(e.step,"SWAP[]"),n.push(s),n.push(i)}function SD(e){var n=e.stack;exports.DEBUG&&console.log(e.step,"DEPTH[]"),n.push(n.length)}function yD(e){var n=e.stack,s=n.pop(),i=n.pop();exports.DEBUG&&console.log(e.step,"LOOPCALL[]",s,i);var r=e.ip,o=e.prog;e.prog=e.funcs[s];for(var a=0;a<i;a++)_a(e),exports.DEBUG&&console.log(++e.step,a+1<i?"next loopcall":"done loopcall",a);e.ip=r,e.prog=o}function CD(e){var n=e.stack.pop();exports.DEBUG&&console.log(e.step,"CALL[]",n);var s=e.ip,i=e.prog;e.prog=e.funcs[n],_a(e),e.ip=s,e.prog=i,exports.DEBUG&&console.log(++e.step,"returning from",n)}function ND(e){var n=e.stack,s=n.pop();exports.DEBUG&&console.log(e.step,"CINDEX[]",s),n.push(n[n.length-s])}function xD(e){var n=e.stack,s=n.pop();exports.DEBUG&&console.log(e.step,"MINDEX[]",s),n.push(n.splice(n.length-s,1)[0])}function vD(e){if(e.env!=="fpgm")throw new Error("FDEF not allowed here");var n=e.stack,s=e.prog,i=e.ip,r=n.pop(),o=i;for(exports.DEBUG&&console.log(e.step,"FDEF[]",r);s[++i]!==45;);e.ip=i,e.funcs[r]=s.slice(o+1,i)}function Um(e,n){var s=n.stack.pop(),i=n.z0[s],r=n.fv,o=n.pv;exports.DEBUG&&console.log(n.step,"MDAP["+e+"]",s);var a=o.distance(i,Al);e&&(a=n.round(a)),r.setRelative(i,Al,a,o),r.touch(i),n.rp0=n.rp1=s}function Gm(e,n){var s=n.z2,i=s.length-2,r,o,a;exports.DEBUG&&console.log(n.step,"IUP["+e.axis+"]");for(var c=0;c<i;c++)r=s[c],!e.touched(r)&&(o=r.prevTouched(e),o!==r&&(a=r.nextTouched(e),o===a&&e.setRelative(r,r,e.distance(o,o,!1,!0),e,!0),e.interpolate(r,o,a,e)))}function Fm(e,n){for(var s=n.stack,i=e?n.rp1:n.rp2,r=(e?n.z0:n.z1)[i],o=n.fv,a=n.pv,c=n.loop,l=n.z2;c--;){var h=s.pop(),d=l[h],p=a.distance(r,r,!1,!0);o.setRelative(d,d,p,a),o.touch(d),exports.DEBUG&&console.log(n.step,(n.loop>1?"loop "+(n.loop-c)+": ":"")+"SHP["+(e?"rp1":"rp2")+"]",h)}n.loop=1}function km(e,n){var s=n.stack,i=e?n.rp1:n.rp2,r=(e?n.z0:n.z1)[i],o=n.fv,a=n.pv,c=s.pop(),l=n.z2[n.contours[c]],h=l;exports.DEBUG&&console.log(n.step,"SHC["+e+"]",c);var d=a.distance(r,r,!1,!0);do h!==r&&o.setRelative(h,h,d,a),h=h.nextPointOnContour;while(h!==l)}function Bm(e,n){var s=n.stack,i=e?n.rp1:n.rp2,r=(e?n.z0:n.z1)[i],o=n.fv,a=n.pv,c=s.pop();exports.DEBUG&&console.log(n.step,"SHZ["+e+"]",c);var l;switch(c){case 0:l=n.tZone;break;case 1:l=n.gZone;break;default:throw new Error("Invalid zone")}for(var h,d=a.distance(r,r,!1,!0),p=l.length-2,E=0;E<p;E++)h=l[E],o.setRelative(h,h,d,a)}function RD(e){for(var n=e.stack,s=e.loop,i=e.fv,r=n.pop()/64,o=e.z2;s--;){var a=n.pop(),c=o[a];exports.DEBUG&&console.log(e.step,(e.loop>1?"loop "+(e.loop-s)+": ":"")+"SHPIX[]",a,r),i.setRelative(c,c,r),i.touch(c)}e.loop=1}function wD(e){for(var n=e.stack,s=e.rp1,i=e.rp2,r=e.loop,o=e.z0[s],a=e.z1[i],c=e.fv,l=e.dpv,h=e.z2;r--;){var d=n.pop(),p=h[d];exports.DEBUG&&console.log(e.step,(e.loop>1?"loop "+(e.loop-r)+": ":"")+"IP[]",d,s,"<->",i),c.interpolate(p,o,a,l),c.touch(p)}e.loop=1}function Vm(e,n){var s=n.stack,i=s.pop()/64,r=s.pop(),o=n.z1[r],a=n.z0[n.rp0],c=n.fv,l=n.pv;c.setRelative(o,a,i,l),c.touch(o),exports.DEBUG&&console.log(n.step,"MSIRP["+e+"]",i,r),n.rp1=n.rp0,n.rp2=r,e&&(n.rp0=r)}function DD(e){for(var n=e.stack,s=e.rp0,i=e.z0[s],r=e.loop,o=e.fv,a=e.pv,c=e.z1;r--;){var l=n.pop(),h=c[l];exports.DEBUG&&console.log(e.step,(e.loop>1?"loop "+(e.loop-r)+": ":"")+"ALIGNRP[]",l),o.setRelative(h,i,0,a),o.touch(h)}e.loop=1}function LD(e){exports.DEBUG&&console.log(e.step,"RTDG[]"),e.round=Zw}function Hm(e,n){var s=n.stack,i=s.pop(),r=s.pop(),o=n.z0[r],a=n.fv,c=n.pv,l=n.cvt[i];exports.DEBUG&&console.log(n.step,"MIAP["+e+"]",i,"(",l,")",r);var h=c.distance(o,Al);e&&(Math.abs(h-l)<n.cvCutIn&&(h=l),h=n.round(h)),a.setRelative(o,Al,h,c),n.zp0===0&&(o.xo=o.x,o.yo=o.y),a.touch(o),n.rp0=n.rp1=r}function MD(e){var n=e.prog,s=e.ip,i=e.stack,r=n[++s];exports.DEBUG&&console.log(e.step,"NPUSHB[]",r);for(var o=0;o<r;o++)i.push(n[++s]);e.ip=s}function PD(e){var n=e.ip,s=e.prog,i=e.stack,r=s[++n];exports.DEBUG&&console.log(e.step,"NPUSHW[]",r);for(var o=0;o<r;o++){var a=s[++n]<<8|s[++n];a&32768&&(a=-((a^65535)+1)),i.push(a)}e.ip=n}function bD(e){var n=e.stack,s=e.store;s||(s=e.store=[]);var i=n.pop(),r=n.pop();exports.DEBUG&&console.log(e.step,"WS",i,r),s[r]=i}function UD(e){var n=e.stack,s=e.store,i=n.pop();exports.DEBUG&&console.log(e.step,"RS",i);var r=s&&s[i]||0;n.push(r)}function GD(e){var n=e.stack,s=n.pop(),i=n.pop();exports.DEBUG&&console.log(e.step,"WCVTP",s,i),e.cvt[i]=s/64}function FD(e){var n=e.stack,s=n.pop();exports.DEBUG&&console.log(e.step,"RCVT",s),n.push(e.cvt[s]*64)}function Wm(e,n){var s=n.stack,i=s.pop(),r=n.z2[i];exports.DEBUG&&console.log(n.step,"GC["+e+"]",i),s.push(n.dpv.distance(r,Al,e,!1)*64)}function Ym(e,n){var s=n.stack,i=s.pop(),r=s.pop(),o=n.z1[i],a=n.z0[r],c=n.dpv.distance(a,o,e,e);exports.DEBUG&&console.log(n.step,"MD["+e+"]",i,r,"->",c),n.stack.push(Math.round(c*64))}function kD(e){exports.DEBUG&&console.log(e.step,"MPPEM[]"),e.stack.push(e.ppem)}function BD(e){exports.DEBUG&&console.log(e.step,"FLIPON[]"),e.autoFlip=!0}function VD(e){var n=e.stack,s=n.pop(),i=n.pop();exports.DEBUG&&console.log(e.step,"LT[]",s,i),n.push(i<s?1:0)}function HD(e){var n=e.stack,s=n.pop(),i=n.pop();exports.DEBUG&&console.log(e.step,"LTEQ[]",s,i),n.push(i<=s?1:0)}function WD(e){var n=e.stack,s=n.pop(),i=n.pop();exports.DEBUG&&console.log(e.step,"GT[]",s,i),n.push(i>s?1:0)}function YD(e){var n=e.stack,s=n.pop(),i=n.pop();exports.DEBUG&&console.log(e.step,"GTEQ[]",s,i),n.push(i>=s?1:0)}function XD(e){var n=e.stack,s=n.pop(),i=n.pop();exports.DEBUG&&console.log(e.step,"EQ[]",s,i),n.push(s===i?1:0)}function zD(e){var n=e.stack,s=n.pop(),i=n.pop();exports.DEBUG&&console.log(e.step,"NEQ[]",s,i),n.push(s!==i?1:0)}function KD(e){var n=e.stack,s=n.pop();exports.DEBUG&&console.log(e.step,"ODD[]",s),n.push(Math.trunc(s)%2?1:0)}function QD(e){var n=e.stack,s=n.pop();exports.DEBUG&&console.log(e.step,"EVEN[]",s),n.push(Math.trunc(s)%2?0:1)}function ZD(e){var n=e.stack.pop();exports.DEBUG&&console.log(e.step,"IF[]",n),n||(wm(e,!0),exports.DEBUG&&console.log(e.step,"EIF[]"))}function qD(e){exports.DEBUG&&console.log(e.step,"EIF[]")}function jD(e){var n=e.stack,s=n.pop(),i=n.pop();exports.DEBUG&&console.log(e.step,"AND[]",s,i),n.push(s&&i?1:0)}function JD(e){var n=e.stack,s=n.pop(),i=n.pop();exports.DEBUG&&console.log(e.step,"OR[]",s,i),n.push(s||i?1:0)}function $D(e){var n=e.stack,s=n.pop();exports.DEBUG&&console.log(e.step,"NOT[]",s),n.push(s?0:1)}function hp(e,n){var s=n.stack,i=s.pop(),r=n.fv,o=n.pv,a=n.ppem,c=n.deltaBase+(e-1)*16,l=n.deltaShift,h=n.z0;exports.DEBUG&&console.log(n.step,"DELTAP["+e+"]",i,s);for(var d=0;d<i;d++){var p=s.pop(),E=s.pop(),g=c+((E&240)>>4);if(g===a){var T=(E&15)-8;T>=0&&T++,exports.DEBUG&&console.log(n.step,"DELTAPFIX",p,"by",T*l);var A=h[p];r.setRelative(A,A,T*l,o)}}}function eL(e){var n=e.stack,s=n.pop();exports.DEBUG&&console.log(e.step,"SDB[]",s),e.deltaBase=s}function tL(e){var n=e.stack,s=n.pop();exports.DEBUG&&console.log(e.step,"SDS[]",s),e.deltaShift=Math.pow(.5,s)}function nL(e){var n=e.stack,s=n.pop(),i=n.pop();exports.DEBUG&&console.log(e.step,"ADD[]",s,i),n.push(i+s)}function sL(e){var n=e.stack,s=n.pop(),i=n.pop();exports.DEBUG&&console.log(e.step,"SUB[]",s,i),n.push(i-s)}function iL(e){var n=e.stack,s=n.pop(),i=n.pop();exports.DEBUG&&console.log(e.step,"DIV[]",s,i),n.push(i*64/s)}function rL(e){var n=e.stack,s=n.pop(),i=n.pop();exports.DEBUG&&console.log(e.step,"MUL[]",s,i),n.push(i*s/64)}function oL(e){var n=e.stack,s=n.pop();exports.DEBUG&&console.log(e.step,"ABS[]",s),n.push(Math.abs(s))}function aL(e){var n=e.stack,s=n.pop();exports.DEBUG&&console.log(e.step,"NEG[]",s),n.push(-s)}function cL(e){var n=e.stack,s=n.pop();exports.DEBUG&&console.log(e.step,"FLOOR[]",s),n.push(Math.floor(s/64)*64)}function lL(e){var n=e.stack,s=n.pop();exports.DEBUG&&console.log(e.step,"CEILING[]",s),n.push(Math.ceil(s/64)*64)}function uu(e,n){var s=n.stack,i=s.pop();exports.DEBUG&&console.log(n.step,"ROUND[]"),s.push(n.round(i/64)*64)}function hL(e){var n=e.stack,s=n.pop(),i=n.pop();exports.DEBUG&&console.log(e.step,"WCVTF[]",s,i),e.cvt[i]=s*e.ppem/e.font.unitsPerEm}function up(e,n){var s=n.stack,i=s.pop(),r=n.ppem,o=n.deltaBase+(e-1)*16,a=n.deltaShift;exports.DEBUG&&console.log(n.step,"DELTAC["+e+"]",i,s);for(var c=0;c<i;c++){var l=s.pop(),h=s.pop(),d=o+((h&240)>>4);if(d===r){var p=(h&15)-8;p>=0&&p++;var E=p*a;exports.DEBUG&&console.log(n.step,"DELTACFIX",l,"by",E),n.cvt[l]+=E}}}function uL(e){var n=e.stack.pop();exports.DEBUG&&console.log(e.step,"SROUND[]",n),e.round=Rm;var s;switch(n&192){case 0:s=.5;break;case 64:s=1;break;case 128:s=2;break;default:throw new Error("invalid SROUND value")}switch(e.srPeriod=s,n&48){case 0:e.srPhase=0;break;case 16:e.srPhase=.25*s;break;case 32:e.srPhase=.5*s;break;case 48:e.srPhase=.75*s;break;default:throw new Error("invalid SROUND value")}n&=15,n===0?e.srThreshold=0:e.srThreshold=(n/8-.5)*s}function dL(e){var n=e.stack.pop();exports.DEBUG&&console.log(e.step,"S45ROUND[]",n),e.round=Rm;var s;switch(n&192){case 0:s=Math.sqrt(2)/2;break;case 64:s=Math.sqrt(2);break;case 128:s=2*Math.sqrt(2);break;default:throw new Error("invalid S45ROUND value")}switch(e.srPeriod=s,n&48){case 0:e.srPhase=0;break;case 16:e.srPhase=.25*s;break;case 32:e.srPhase=.5*s;break;case 48:e.srPhase=.75*s;break;default:throw new Error("invalid S45ROUND value")}n&=15,n===0?e.srThreshold=0:e.srThreshold=(n/8-.5)*s}function fL(e){exports.DEBUG&&console.log(e.step,"ROFF[]"),e.round=Qw}function pL(e){exports.DEBUG&&console.log(e.step,"RUTG[]"),e.round=jw}function EL(e){exports.DEBUG&&console.log(e.step,"RDTG[]"),e.round=Jw}function gL(e){var n=e.stack.pop();exports.DEBUG&&console.log(e.step,"SCANCTRL[]",n)}function Xm(e,n){var s=n.stack,i=s.pop(),r=s.pop(),o=n.z2[i],a=n.z1[r];exports.DEBUG&&console.log(n.step,"SDPVTL["+e+"]",i,r);var c,l;e?(c=o.y-a.y,l=a.x-o.x):(c=a.x-o.x,l=a.y-o.y),n.dpv=Tl(c,l)}function _L(e){var n=e.stack,s=n.pop(),i=0;exports.DEBUG&&console.log(e.step,"GETINFO[]",s),s&1&&(i=35),s&32&&(i|=4096),n.push(i)}function TL(e){var n=e.stack,s=n.pop(),i=n.pop(),r=n.pop();exports.DEBUG&&console.log(e.step,"ROLL[]"),n.push(i),n.push(s),n.push(r)}function AL(e){var n=e.stack,s=n.pop(),i=n.pop();exports.DEBUG&&console.log(e.step,"MAX[]",s,i),n.push(Math.max(i,s))}function mL(e){var n=e.stack,s=n.pop(),i=n.pop();exports.DEBUG&&console.log(e.step,"MIN[]",s,i),n.push(Math.min(i,s))}function OL(e){var n=e.stack.pop();exports.DEBUG&&console.log(e.step,"SCANTYPE[]",n)}function IL(e){var n=e.stack.pop(),s=e.stack.pop();switch(exports.DEBUG&&console.log(e.step,"INSTCTRL[]",n,s),n){case 1:e.inhibitGridFit=!!s;return;case 2:e.ignoreCvt=!!s;return;default:throw new Error("invalid INSTCTRL[] selector")}}function Co(e,n){var s=n.stack,i=n.prog,r=n.ip;exports.DEBUG&&console.log(n.step,"PUSHB["+e+"]");for(var o=0;o<e;o++)s.push(i[++r]);n.ip=r}function No(e,n){var s=n.ip,i=n.prog,r=n.stack;exports.DEBUG&&console.log(n.ip,"PUSHW["+e+"]");for(var o=0;o<e;o++){var a=i[++s]<<8|i[++s];a&32768&&(a=-((a^65535)+1)),r.push(a)}n.ip=s}function we(e,n,s,i,r,o){var a=o.stack,c=e&&a.pop(),l=a.pop(),h=o.rp0,d=o.z0[h],p=o.z1[l],E=o.minDis,g=o.fv,T=o.dpv,A,m,O,S;m=A=T.distance(p,d,!0,!0),O=m>=0?1:-1,m=Math.abs(m),e&&(S=o.cvt[c],i&&Math.abs(m-S)<o.cvCutIn&&(m=S)),s&&m<E&&(m=E),i&&(m=o.round(m)),g.setRelative(p,d,O*m,T),g.touch(p),exports.DEBUG&&console.log(o.step,(e?"MIRP[":"MDRP[")+(n?"M":"m")+(s?">":"_")+(i?"R":"_")+(r===0?"Gr":r===1?"Bl":r===2?"Wh":"")+"]",e?c+"("+o.cvt[c]+","+S+")":"",l,"(d =",A,"->",O*m,")"),o.rp1=o.rp0,o.rp2=l,n&&(o.rp0=l)}Cm=[Dm.bind(void 0,Fr),Dm.bind(void 0,mr),Lm.bind(void 0,Fr),Lm.bind(void 0,mr),Mm.bind(void 0,Fr),Mm.bind(void 0,mr),Pm.bind(void 0,0),Pm.bind(void 0,1),bm.bind(void 0,0),bm.bind(void 0,1),eD,tD,nD,sD,iD,rD,oD,aD,cD,lD,hD,uD,dD,fD,pD,ED,gD,_D,TD,AD,void 0,void 0,mD,lp,OD,ID,SD,ND,xD,void 0,void 0,void 0,yD,CD,vD,void 0,Um.bind(void 0,0),Um.bind(void 0,1),Gm.bind(void 0,Fr),Gm.bind(void 0,mr),Fm.bind(void 0,0),Fm.bind(void 0,1),km.bind(void 0,0),km.bind(void 0,1),Bm.bind(void 0,0),Bm.bind(void 0,1),RD,wD,Vm.bind(void 0,0),Vm.bind(void 0,1),DD,LD,Hm.bind(void 0,0),Hm.bind(void 0,1),MD,PD,bD,UD,GD,FD,Wm.bind(void 0,0),Wm.bind(void 0,1),void 0,Ym.bind(void 0,0),Ym.bind(void 0,1),kD,void 0,BD,void 0,void 0,VD,HD,WD,YD,XD,zD,KD,QD,ZD,qD,jD,JD,$D,hp.bind(void 0,1),eL,tL,nL,sL,iL,rL,oL,aL,cL,lL,uu.bind(void 0,0),uu.bind(void 0,1),uu.bind(void 0,2),uu.bind(void 0,3),void 0,void 0,void 0,void 0,hL,hp.bind(void 0,2),hp.bind(void 0,3),up.bind(void 0,1),up.bind(void 0,2),up.bind(void 0,3),uL,dL,void 0,void 0,fL,void 0,pL,EL,lp,lp,void 0,void 0,void 0,void 0,void 0,gL,Xm.bind(void 0,0),Xm.bind(void 0,1),_L,void 0,TL,AL,mL,OL,IL,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,Co.bind(void 0,1),Co.bind(void 0,2),Co.bind(void 0,3),Co.bind(void 0,4),Co.bind(void 0,5),Co.bind(void 0,6),Co.bind(void 0,7),Co.bind(void 0,8),No.bind(void 0,1),No.bind(void 0,2),No.bind(void 0,3),No.bind(void 0,4),No.bind(void 0,5),No.bind(void 0,6),No.bind(void 0,7),No.bind(void 0,8),we.bind(void 0,0,0,0,0,0),we.bind(void 0,0,0,0,0,1),we.bind(void 0,0,0,0,0,2),we.bind(void 0,0,0,0,0,3),we.bind(void 0,0,0,0,1,0),we.bind(void 0,0,0,0,1,1),we.bind(void 0,0,0,0,1,2),we.bind(void 0,0,0,0,1,3),we.bind(void 0,0,0,1,0,0),we.bind(void 0,0,0,1,0,1),we.bind(void 0,0,0,1,0,2),we.bind(void 0,0,0,1,0,3),we.bind(void 0,0,0,1,1,0),we.bind(void 0,0,0,1,1,1),we.bind(void 0,0,0,1,1,2),we.bind(void 0,0,0,1,1,3),we.bind(void 0,0,1,0,0,0),we.bind(void 0,0,1,0,0,1),we.bind(void 0,0,1,0,0,2),we.bind(void 0,0,1,0,0,3),we.bind(void 0,0,1,0,1,0),we.bind(void 0,0,1,0,1,1),we.bind(void 0,0,1,0,1,2),we.bind(void 0,0,1,0,1,3),we.bind(void 0,0,1,1,0,0),we.bind(void 0,0,1,1,0,1),we.bind(void 0,0,1,1,0,2),we.bind(void 0,0,1,1,0,3),we.bind(void 0,0,1,1,1,0),we.bind(void 0,0,1,1,1,1),we.bind(void 0,0,1,1,1,2),we.bind(void 0,0,1,1,1,3),we.bind(void 0,1,0,0,0,0),we.bind(void 0,1,0,0,0,1),we.bind(void 0,1,0,0,0,2),we.bind(void 0,1,0,0,0,3),we.bind(void 0,1,0,0,1,0),we.bind(void 0,1,0,0,1,1),we.bind(void 0,1,0,0,1,2),we.bind(void 0,1,0,0,1,3),we.bind(void 0,1,0,1,0,0),we.bind(void 0,1,0,1,0,1),we.bind(void 0,1,0,1,0,2),we.bind(void 0,1,0,1,0,3),we.bind(void 0,1,0,1,1,0),we.bind(void 0,1,0,1,1,1),we.bind(void 0,1,0,1,1,2),we.bind(void 0,1,0,1,1,3),we.bind(void 0,1,1,0,0,0),we.bind(void 0,1,1,0,0,1),we.bind(void 0,1,1,0,0,2),we.bind(void 0,1,1,0,0,3),we.bind(void 0,1,1,0,1,0),we.bind(void 0,1,1,0,1,1),we.bind(void 0,1,1,0,1,2),we.bind(void 0,1,1,0,1,3),we.bind(void 0,1,1,1,0,0),we.bind(void 0,1,1,1,0,1),we.bind(void 0,1,1,1,0,2),we.bind(void 0,1,1,1,0,3),we.bind(void 0,1,1,1,1,0),we.bind(void 0,1,1,1,1,1),we.bind(void 0,1,1,1,1,2),we.bind(void 0,1,1,1,1,3)];function dc(e){this.char=e,this.state={},this.activeState=null}function dp(e,n,s){this.contextName=s,this.startIndex=e,this.endOffset=n}function SL(e,n,s){this.contextName=e,this.openRange=null,this.ranges=[],this.checkStart=n,this.checkEnd=s}function ir(e,n){this.context=e,this.index=n,this.length=e.length,this.current=e[n],this.backtrack=e.slice(0,n),this.lookahead=e.slice(n+1)}function du(e){this.eventId=e,this.subscribers=[]}function yL(e){var n=this,s=["start","end","next","newToken","contextStart","contextEnd","insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD","updateContextsRanges"];s.forEach(function(r){Object.defineProperty(n.events,r,{value:new du(r)})}),e&&s.forEach(function(r){var o=e[r];typeof o=="function"&&n.events[r].subscribe(o)});var i=["insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD"];i.forEach(function(r){n.events[r].subscribe(n.updateContextsRanges)})}function Mn(e){this.tokens=[],this.registeredContexts={},this.contextCheckers=[],this.events={},this.registeredModifiers=[],yL.call(this,e)}dc.prototype.setState=function(e,n){return this.state[e]=n,this.activeState={key:e,value:this.state[e]},this.activeState},dc.prototype.getState=function(e){return this.state[e]||null},Mn.prototype.inboundIndex=function(e){return e>=0&&e<this.tokens.length},Mn.prototype.composeRUD=function(e){var n=this,s=!0,i=e.map(function(o){return n[o[0]].apply(n,o.slice(1).concat(s))}),r=function(o){return typeof o=="object"&&o.hasOwnProperty("FAIL")};if(i.every(r))return{FAIL:"composeRUD: one or more operations hasn't completed successfully",report:i.filter(r)};this.dispatch("composeRUD",[i.filter(function(o){return!r(o)})])},Mn.prototype.replaceRange=function(e,n,s,i){n=n!==null?n:this.tokens.length;var r=s.every(function(a){return a instanceof dc});if(!isNaN(e)&&this.inboundIndex(e)&&r){var o=this.tokens.splice.apply(this.tokens,[e,n].concat(s));return i||this.dispatch("replaceToken",[e,n,s]),[o,s]}else return{FAIL:"replaceRange: invalid tokens or startIndex."}},Mn.prototype.replaceToken=function(e,n,s){if(!isNaN(e)&&this.inboundIndex(e)&&n instanceof dc){var i=this.tokens.splice(e,1,n);return s||this.dispatch("replaceToken",[e,n]),[i[0],n]}else return{FAIL:"replaceToken: invalid token or index."}},Mn.prototype.removeRange=function(e,n,s){n=isNaN(n)?this.tokens.length:n;var i=this.tokens.splice(e,n);return s||this.dispatch("removeRange",[i,e,n]),i},Mn.prototype.removeToken=function(e,n){if(!isNaN(e)&&this.inboundIndex(e)){var s=this.tokens.splice(e,1);return n||this.dispatch("removeToken",[s,e]),s}else return{FAIL:"removeToken: invalid token index."}},Mn.prototype.insertToken=function(e,n,s){var i=e.every(function(r){return r instanceof dc});return i?(this.tokens.splice.apply(this.tokens,[n,0].concat(e)),s||this.dispatch("insertToken",[e,n]),e):{FAIL:"insertToken: invalid token(s)."}},Mn.prototype.registerModifier=function(e,n,s){this.events.newToken.subscribe(function(i,r){var o=[i,r],a=n===null||n.apply(this,o)===!0,c=[i,r];if(a){var l=s.apply(this,c);i.setState(e,l)}}),this.registeredModifiers.push(e)},du.prototype.subscribe=function(e){return typeof e=="function"?this.subscribers.push(e)-1:{FAIL:"invalid '"+this.eventId+"' event handler"}},du.prototype.unsubscribe=function(e){this.subscribers.splice(e,1)},ir.prototype.setCurrentIndex=function(e){this.index=e,this.current=this.context[e],this.backtrack=this.context.slice(0,e),this.lookahead=this.context.slice(e+1)},ir.prototype.get=function(e){switch(!0){case e===0:return this.current;case(e<0&&Math.abs(e)<=this.backtrack.length):return this.backtrack.slice(e)[0];case(e>0&&e<=this.lookahead.length):return this.lookahead[e-1];default:return null}},Mn.prototype.rangeToText=function(e){if(e instanceof dp)return this.getRangeTokens(e).map(function(n){return n.char}).join("")},Mn.prototype.getText=function(){return this.tokens.map(function(e){return e.char}).join("")},Mn.prototype.getContext=function(e){var n=this.registeredContexts[e];return n||null},Mn.prototype.on=function(e,n){var s=this.events[e];return s?s.subscribe(n):null},Mn.prototype.dispatch=function(e,n){var s=this,i=this.events[e];i instanceof du&&i.subscribers.forEach(function(r){r.apply(s,n||[])})},Mn.prototype.registerContextChecker=function(e,n,s){if(this.getContext(e))return{FAIL:"context name '"+e+"' is already registered."};if(typeof n!="function")return{FAIL:"missing context start check."};if(typeof s!="function")return{FAIL:"missing context end check."};var i=new SL(e,n,s);return this.registeredContexts[e]=i,this.contextCheckers.push(i),i},Mn.prototype.getRangeTokens=function(e){var n=e.startIndex+e.endOffset;return[].concat(this.tokens.slice(e.startIndex,n))},Mn.prototype.getContextRanges=function(e){var n=this.getContext(e);return n?n.ranges:{FAIL:"context checker '"+e+"' is not registered."}},Mn.prototype.resetContextsRanges=function(){var e=this.registeredContexts;for(var n in e)if(e.hasOwnProperty(n)){var s=e[n];s.ranges=[]}},Mn.prototype.updateContextsRanges=function(){this.resetContextsRanges();for(var e=this.tokens.map(function(i){return i.char}),n=0;n<e.length;n++){var s=new ir(e,n);this.runContextCheck(s)}this.dispatch("updateContextsRanges",[this.registeredContexts])},Mn.prototype.setEndOffset=function(e,n){var s=this.getContext(n).openRange.startIndex,i=new dp(s,e,n),r=this.getContext(n).ranges;return i.rangeId=n+"."+r.length,r.push(i),this.getContext(n).openRange=null,i},Mn.prototype.runContextCheck=function(e){var n=this,s=e.index;this.contextCheckers.forEach(function(i){var r=i.contextName,o=n.getContext(r).openRange;if(!o&&i.checkStart(e)&&(o=new dp(s,null,r),n.getContext(r).openRange=o,n.dispatch("contextStart",[r,s])),o&&i.checkEnd(e)){var a=s-o.startIndex+1,c=n.setEndOffset(a,r);n.dispatch("contextEnd",[r,c])}})},Mn.prototype.tokenize=function(e){this.tokens=[],this.resetContextsRanges();var n=Array.from(e);this.dispatch("start");for(var s=0;s<n.length;s++){var i=n[s],r=new ir(n,s);this.dispatch("next",[r]),this.runContextCheck(r);var o=new dc(i);this.tokens.push(o),this.dispatch("newToken",[o,r])}return this.dispatch("end",[this.tokens]),this.tokens};function xo(e){return/[\u0600-\u065F\u066A-\u06D2\u06FA-\u06FF]/.test(e)}function zm(e){return/[\u0630\u0690\u0621\u0631\u0661\u0671\u0622\u0632\u0672\u0692\u06C2\u0623\u0673\u0693\u06C3\u0624\u0694\u06C4\u0625\u0675\u0695\u06C5\u06E5\u0676\u0696\u06C6\u0627\u0677\u0697\u06C7\u0648\u0688\u0698\u06C8\u0689\u0699\u06C9\u068A\u06CA\u066B\u068B\u06CB\u068C\u068D\u06CD\u06FD\u068E\u06EE\u06FE\u062F\u068F\u06CF\u06EF]/.test(e)}function vo(e){return/[\u0600-\u0605\u060C-\u060E\u0610-\u061B\u061E\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED]/.test(e)}function fu(e){return/[A-z]/.test(e)}function CL(e){return/\s/.test(e)}function ui(e){this.font=e,this.features={}}function Ta(e){this.id=e.id,this.tag=e.tag,this.substitution=e.substitution}function ml(e,n){if(!e)return-1;switch(n.format){case 1:return n.glyphs.indexOf(e);case 2:for(var s=n.ranges,i=0;i<s.length;i++){var r=s[i];if(e>=r.start&&e<=r.end){var o=e-r.start;return r.index+o}}break;default:return-1}return-1}function NL(e,n){var s=ml(e,n.coverage);return s===-1?null:e+n.deltaGlyphId}function xL(e,n){var s=ml(e,n.coverage);return s===-1?null:n.substitute[s]}function fp(e,n){for(var s=[],i=0;i<e.length;i++){var r=e[i],o=n.current;o=Array.isArray(o)?o[0]:o;var a=ml(o,r);a!==-1&&s.push(a)}return s.length!==e.length?-1:s}function vL(e,n){var s=n.inputCoverage.length+n.lookaheadCoverage.length+n.backtrackCoverage.length;if(e.context.length<s)return[];var i=fp(n.inputCoverage,e);if(i===-1)return[];var r=n.inputCoverage.length-1;if(e.lookahead.length<n.lookaheadCoverage.length)return[];for(var o=e.lookahead.slice(r);o.length&&vo(o[0].char);)o.shift();var a=new ir(o,0),c=fp(n.lookaheadCoverage,a),l=[].concat(e.backtrack);for(l.reverse();l.length&&vo(l[0].char);)l.shift();if(l.length<n.backtrackCoverage.length)return[];var h=new ir(l,0),d=fp(n.backtrackCoverage,h),p=i.length===n.inputCoverage.length&&c.length===n.lookaheadCoverage.length&&d.length===n.backtrackCoverage.length,E=[];if(p)for(var g=0;g<n.lookupRecords.length;g++)for(var T=n.lookupRecords[g],A=T.lookupListIndex,m=this.getLookupByIndex(A),O=0;O<m.subtables.length;O++){var S=m.subtables[O],y=this.getLookupMethod(m,S),v=this.getSubstitutionType(m,S);if(v==="12")for(var R=0;R<i.length;R++){var M=e.get(R),L=y(M);L&&E.push(L)}}return E}function RL(e,n){var s=e.current,i=ml(s,n.coverage);if(i===-1)return null;for(var r,o=n.ligatureSets[i],a=0;a<o.length;a++){r=o[a];for(var c=0;c<r.components.length;c++){var l=e.lookahead[c],h=r.components[c];if(l!==h)break;if(c===r.components.length-1)return r}}return null}function wL(e,n){var s=ml(e,n.coverage);return s===-1?null:n.sequences[s]}ui.prototype.getDefaultScriptFeaturesIndexes=function(){for(var e=this.font.tables.gsub.scripts,n=0;n<e.length;n++){var s=e[n];if(s.tag==="DFLT")return s.script.defaultLangSys.featureIndexes}return[]},ui.prototype.getScriptFeaturesIndexes=function(e){var n=this.font.tables;if(!n.gsub)return[];if(!e)return this.getDefaultScriptFeaturesIndexes();for(var s=this.font.tables.gsub.scripts,i=0;i<s.length;i++){var r=s[i];if(r.tag===e&&r.script.defaultLangSys)return r.script.defaultLangSys.featureIndexes;var o=r.langSysRecords;if(o)for(var a=0;a<o.length;a++){var c=o[a];if(c.tag===e){var l=c.langSys;return l.featureIndexes}}}return this.getDefaultScriptFeaturesIndexes()},ui.prototype.mapTagsToFeatures=function(e,n){for(var s={},i=0;i<e.length;i++){var r=e[i].tag,o=e[i].feature;s[r]=o}this.features[n].tags=s},ui.prototype.getScriptFeatures=function(e){var n=this.features[e];if(this.features.hasOwnProperty(e))return n;var s=this.getScriptFeaturesIndexes(e);if(!s)return null;var i=this.font.tables.gsub;return n=s.map(function(r){return i.features[r]}),this.features[e]=n,this.mapTagsToFeatures(n,e),n},ui.prototype.getSubstitutionType=function(e,n){var s=e.lookupType.toString(),i=n.substFormat.toString();return s+i},ui.prototype.getLookupMethod=function(e,n){var s=this,i=this.getSubstitutionType(e,n);switch(i){case"11":return function(r){return NL.apply(s,[r,n])};case"12":return function(r){return xL.apply(s,[r,n])};case"63":return function(r){return vL.apply(s,[r,n])};case"41":return function(r){return RL.apply(s,[r,n])};case"21":return function(r){return wL.apply(s,[r,n])};default:throw new Error("lookupType: "+e.lookupType+" - substFormat: "+n.substFormat+" is not yet supported")}},ui.prototype.lookupFeature=function(e){var n=e.contextParams,s=n.index,i=this.getFeature({tag:e.tag,script:e.script});if(!i)return new Error("font '"+this.font.names.fullName.en+"' doesn't support feature '"+e.tag+"' for script '"+e.script+"'.");for(var r=this.getFeatureLookups(i),o=[].concat(n.context),a=0;a<r.length;a++)for(var c=r[a],l=this.getLookupSubtables(c),h=0;h<l.length;h++){var d=l[h],p=this.getSubstitutionType(c,d),E=this.getLookupMethod(c,d),g=void 0;switch(p){case"11":g=E(n.current),g&&o.splice(s,1,new Ta({id:11,tag:e.tag,substitution:g}));break;case"12":g=E(n.current),g&&o.splice(s,1,new Ta({id:12,tag:e.tag,substitution:g}));break;case"63":g=E(n),Array.isArray(g)&&g.length&&o.splice(s,1,new Ta({id:63,tag:e.tag,substitution:g}));break;case"41":g=E(n),g&&o.splice(s,1,new Ta({id:41,tag:e.tag,substitution:g}));break;case"21":g=E(n.current),g&&o.splice(s,1,new Ta({id:21,tag:e.tag,substitution:g}));break}n=new ir(o,s),!(Array.isArray(g)&&!g.length)&&(g=null)}return o.length?o:null},ui.prototype.supports=function(e){if(!e.script)return!1;this.getScriptFeatures(e.script);var n=this.features.hasOwnProperty(e.script);if(!e.tag)return n;var s=this.features[e.script].some(function(i){return i.tag===e.tag});return n&&s},ui.prototype.getLookupSubtables=function(e){return e.subtables||null},ui.prototype.getLookupByIndex=function(e){var n=this.font.tables.gsub.lookups;return n[e]||null},ui.prototype.getFeatureLookups=function(e){return e.lookupListIndexes.map(this.getLookupByIndex.bind(this))},ui.prototype.getFeature=function(n){if(!this.font)return{FAIL:"No font was found"};this.features.hasOwnProperty(n.script)||this.getScriptFeatures(n.script);var s=this.features[n.script];return s?s.tags[n.tag]?this.features[n.script].tags[n.tag]:null:{FAIL:"No feature for script "+n.script}};function DL(e){var n=e.current,s=e.get(-1);return s===null&&xo(n)||!xo(s)&&xo(n)}function LL(e){var n=e.get(1);return n===null||!xo(n)}var ML={startCheck:DL,endCheck:LL};function PL(e){var n=e.current,s=e.get(-1);return(xo(n)||vo(n))&&!xo(s)}function bL(e){var n=e.get(1);switch(!0){case n===null:return!0;case(!xo(n)&&!vo(n)):var s=CL(n);if(!s)return!0;if(s){var i=!1;if(i=e.lookahead.some(function(r){return xo(r)||vo(r)}),!i)return!0}break;default:return!1}}var UL={startCheck:PL,endCheck:bL};function GL(e,n,s){n[s].setState(e.tag,e.substitution)}function FL(e,n,s){n[s].setState(e.tag,e.substitution)}function kL(e,n,s){e.substitution.forEach(function(i,r){var o=n[s+r];o.setState(e.tag,i)})}function BL(e,n,s){var i=n[s];i.setState(e.tag,e.substitution.ligGlyph);for(var r=e.substitution.components.length,o=0;o<r;o++)i=n[s+o+1],i.setState("deleted",!0)}var Km={11:GL,12:FL,63:kL,41:BL};function pp(e,n,s){e instanceof Ta&&Km[e.id]&&Km[e.id](e,n,s)}function VL(e){for(var n=[].concat(e.backtrack),s=n.length-1;s>=0;s--){var i=n[s],r=zm(i),o=vo(i);if(!r&&!o)return!0;if(r)return!1}return!1}function HL(e){if(zm(e.current))return!1;for(var n=0;n<e.lookahead.length;n++){var s=e.lookahead[n],i=vo(s);if(!i)return!0}return!1}function WL(e){var n=this,s="arab",i=this.featuresTags[s],r=this.tokenizer.getRangeTokens(e);if(r.length!==1){var o=new ir(r.map(function(c){return c.getState("glyphIndex")}),0),a=new ir(r.map(function(c){return c.char}),0);r.forEach(function(c,l){if(!vo(c.char)){o.setCurrentIndex(l),a.setCurrentIndex(l);var h=0;VL(a)&&(h|=1),HL(a)&&(h|=2);var d;switch(h){case 1:d="fina";break;case 2:d="init";break;case 3:d="medi";break}if(i.indexOf(d)!==-1){var p=n.query.lookupFeature({tag:d,script:s,contextParams:o});if(p instanceof Error)return console.info(p.message);p.forEach(function(E,g){E instanceof Ta&&(pp(E,r,g),o.context[g]=E.substitution)})}}})}}function Qm(e,n){var s=e.map(function(i){return i.activeState.value});return new ir(s,0)}function YL(e){var n=this,s="arab",i=this.tokenizer.getRangeTokens(e),r=Qm(i);r.context.forEach(function(o,a){r.setCurrentIndex(a);var c=n.query.lookupFeature({tag:"rlig",script:s,contextParams:r});c.length&&(c.forEach(function(l){return pp(l,i,a)}),r=Qm(i))})}function XL(e){var n=e.current,s=e.get(-1);return s===null&&fu(n)||!fu(s)&&fu(n)}function zL(e){var n=e.get(1);return n===null||!fu(n)}var KL={startCheck:XL,endCheck:zL};function Zm(e,n){var s=e.map(function(i){return i.activeState.value});return new ir(s,0)}function QL(e){var n=this,s="latn",i=this.tokenizer.getRangeTokens(e),r=Zm(i);r.context.forEach(function(o,a){r.setCurrentIndex(a);var c=n.query.lookupFeature({tag:"liga",script:s,contextParams:r});c.length&&(c.forEach(function(l){return pp(l,i,a)}),r=Zm(i))})}function rr(e){this.baseDir=e||"ltr",this.tokenizer=new Mn,this.featuresTags={}}rr.prototype.setText=function(e){this.text=e},rr.prototype.contextChecks={latinWordCheck:KL,arabicWordCheck:ML,arabicSentenceCheck:UL};function Ep(e){var n=this.contextChecks[e+"Check"];return this.tokenizer.registerContextChecker(e,n.startCheck,n.endCheck)}function ZL(){return Ep.call(this,"latinWord"),Ep.call(this,"arabicWord"),Ep.call(this,"arabicSentence"),this.tokenizer.tokenize(this.text)}function qL(){var e=this,n=this.tokenizer.getContextRanges("arabicSentence");n.forEach(function(s){var i=e.tokenizer.getRangeTokens(s);e.tokenizer.replaceRange(s.startIndex,s.endOffset,i.reverse())})}rr.prototype.registerFeatures=function(e,n){var s=this,i=n.filter(function(r){return s.query.supports({script:e,tag:r})});this.featuresTags.hasOwnProperty(e)?this.featuresTags[e]=this.featuresTags[e].concat(i):this.featuresTags[e]=i},rr.prototype.applyFeatures=function(e,n){if(!e)throw new Error("No valid font was provided to apply features");this.query||(this.query=new ui(e));for(var s=0;s<n.length;s++){var i=n[s];this.query.supports({script:i.script})&&this.registerFeatures(i.script,i.tags)}},rr.prototype.registerModifier=function(e,n,s){this.tokenizer.registerModifier(e,n,s)};function gp(){if(this.tokenizer.registeredModifiers.indexOf("glyphIndex")===-1)throw new Error("glyphIndex modifier is required to apply arabic presentation features.")}function jL(){var e=this,n="arab";if(this.featuresTags.hasOwnProperty(n)){gp.call(this);var s=this.tokenizer.getContextRanges("arabicWord");s.forEach(function(i){WL.call(e,i)})}}function JL(){var e=this,n="arab";if(this.featuresTags.hasOwnProperty(n)){var s=this.featuresTags[n];if(s.indexOf("rlig")!==-1){gp.call(this);var i=this.tokenizer.getContextRanges("arabicWord");i.forEach(function(r){YL.call(e,r)})}}}function $L(){var e=this,n="latn";if(this.featuresTags.hasOwnProperty(n)){var s=this.featuresTags[n];if(s.indexOf("liga")!==-1){gp.call(this);var i=this.tokenizer.getContextRanges("latinWord");i.forEach(function(r){QL.call(e,r)})}}}rr.prototype.checkContextReady=function(e){return!!this.tokenizer.getContext(e)},rr.prototype.applyFeaturesToContexts=function(){this.checkContextReady("arabicWord")&&(jL.call(this),JL.call(this)),this.checkContextReady("latinWord")&&$L.call(this),this.checkContextReady("arabicSentence")&&qL.call(this)},rr.prototype.processText=function(e){(!this.text||this.text!==e)&&(this.setText(e),ZL.call(this),this.applyFeaturesToContexts())},rr.prototype.getBidiText=function(e){return this.processText(e),this.tokenizer.getText()},rr.prototype.getTextGlyphs=function(e){this.processText(e);for(var n=[],s=0;s<this.tokenizer.tokens.length;s++){var i=this.tokenizer.tokens[s];if(!i.state.deleted){var r=i.activeState.value;n.push(Array.isArray(r)?r[0]:r)}}return n};function cn(e){e=e||{},e.tables=e.tables||{},e.empty||(gl(e.familyName,"When creating a new Font object, familyName is required."),gl(e.styleName,"When creating a new Font object, styleName is required."),gl(e.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),gl(e.ascender,"When creating a new Font object, ascender is required."),gl(e.descender<=0,"When creating a new Font object, negative descender value is required."),this.names={fontFamily:{en:e.familyName||" "},fontSubfamily:{en:e.styleName||" "},fullName:{en:e.fullName||e.familyName+" "+e.styleName},postScriptName:{en:e.postScriptName||(e.familyName+e.styleName).replace(/\s/g,"")},designer:{en:e.designer||" "},designerURL:{en:e.designerURL||" "},manufacturer:{en:e.manufacturer||" "},manufacturerURL:{en:e.manufacturerURL||" "},license:{en:e.license||" "},licenseURL:{en:e.licenseURL||" "},version:{en:e.version||"Version 0.1"},description:{en:e.description||" "},copyright:{en:e.copyright||" "},trademark:{en:e.trademark||" "}},this.unitsPerEm=e.unitsPerEm||1e3,this.ascender=e.ascender,this.descender=e.descender,this.createdTimestamp=e.createdTimestamp,this.tables=Object.assign(e.tables,{os2:Object.assign({usWeightClass:e.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:e.widthClass||this.usWidthClasses.MEDIUM,fsSelection:e.fsSelection||this.fsSelectionValues.REGULAR},e.tables.os2)})),this.supported=!0,this.glyphs=new Ar.GlyphSet(this,e.glyphs||[]),this.encoding=new ZA(this),this.position=new El(this),this.substitution=new hi(this),this.tables=this.tables||{},this._push=null,this._hmtxTableData={},Object.defineProperty(this,"hinting",{get:function(){if(this._hinting)return this._hinting;if(this.outlinesFormat==="truetype")return this._hinting=new xm(this)}})}cn.prototype.hasChar=function(e){return this.encoding.charToGlyphIndex(e)!==null},cn.prototype.charToGlyphIndex=function(e){return this.encoding.charToGlyphIndex(e)},cn.prototype.charToGlyph=function(e){var n=this.charToGlyphIndex(e),s=this.glyphs.get(n);return s||(s=this.glyphs.get(0)),s},cn.prototype.updateFeatures=function(e){return this.defaultRenderOptions.features.map(function(n){return n.script==="latn"?{script:"latn",tags:n.tags.filter(function(s){return e[s]})}:n})},cn.prototype.stringToGlyphs=function(e,n){var s=this,i=new rr,r=function(p){return s.charToGlyphIndex(p.char)};i.registerModifier("glyphIndex",null,r);var o=n?this.updateFeatures(n.features):this.defaultRenderOptions.features;i.applyFeatures(this,o);for(var a=i.getTextGlyphs(e),c=a.length,l=new Array(c),h=this.glyphs.get(0),d=0;d<c;d+=1)l[d]=this.glyphs.get(a[d])||h;return l},cn.prototype.nameToGlyphIndex=function(e){return this.glyphNames.nameToGlyphIndex(e)},cn.prototype.nameToGlyph=function(e){var n=this.nameToGlyphIndex(e),s=this.glyphs.get(n);return s||(s=this.glyphs.get(0)),s},cn.prototype.glyphIndexToName=function(e){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(e):""},cn.prototype.getKerningValue=function(e,n){e=e.index||e,n=n.index||n;var s=this.position.defaultKerningTables;return s?this.position.getKerningValue(s,e,n):this.kerningPairs[e+","+n]||0},cn.prototype.defaultRenderOptions={kerning:!0,features:[{script:"arab",tags:["init","medi","fina","rlig"]},{script:"latn",tags:["liga","rlig"]}]},cn.prototype.forEachGlyph=function(e,n,s,i,r,o){n=n!==void 0?n:0,s=s!==void 0?s:0,i=i!==void 0?i:72,r=Object.assign({},this.defaultRenderOptions,r);var a=1/this.unitsPerEm*i,c=this.stringToGlyphs(e,r),l;if(r.kerning){var h=r.script||this.position.getDefaultScriptName();l=this.position.getKerningTables(h,r.language)}for(var d=0;d<c.length;d+=1){var p=c[d];if(o.call(this,p,n,s,i,r),p.advanceWidth&&(n+=p.advanceWidth*a),r.kerning&&d<c.length-1){var E=l?this.position.getKerningValue(l,p.index,c[d+1].index):this.getKerningValue(p,c[d+1]);n+=E*a}r.letterSpacing?n+=r.letterSpacing*i:r.tracking&&(n+=r.tracking/1e3*i)}return n},cn.prototype.getPath=function(e,n,s,i,r){var o=new zn;return this.forEachGlyph(e,n,s,i,r,function(a,c,l,h){var d=a.getPath(c,l,h,r,this);o.extend(d)}),o},cn.prototype.getPaths=function(e,n,s,i,r){var o=[];return this.forEachGlyph(e,n,s,i,r,function(a,c,l,h){var d=a.getPath(c,l,h,r,this);o.push(d)}),o},cn.prototype.getAdvanceWidth=function(e,n,s){return this.forEachGlyph(e,0,0,n,s,function(){})},cn.prototype.draw=function(e,n,s,i,r,o){this.getPath(n,s,i,r,o).draw(e)},cn.prototype.drawPoints=function(e,n,s,i,r,o){this.forEachGlyph(n,s,i,r,o,function(a,c,l,h){a.drawPoints(e,c,l,h)})},cn.prototype.drawMetrics=function(e,n,s,i,r,o){this.forEachGlyph(n,s,i,r,o,function(a,c,l,h){a.drawMetrics(e,c,l,h)})},cn.prototype.getEnglishName=function(e){var n=this.names[e];if(n)return n.en},cn.prototype.validate=function(){var e=this;function n(i,r){}function s(i){var r=e.getEnglishName(i);r&&r.trim().length>0}s("fontFamily"),s("weightName"),s("manufacturer"),s("copyright"),s("version"),this.unitsPerEm>0},cn.prototype.toTables=function(){return kw.fontToTable(this)},cn.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()},cn.prototype.toArrayBuffer=function(){for(var e=this.toTables(),n=e.encode(),s=new ArrayBuffer(n.length),i=new Uint8Array(s),r=0;r<n.length;r++)i[r]=n[r];return s},cn.prototype.download=function(e){var n=this.getEnglishName("fontFamily"),s=this.getEnglishName("fontSubfamily");e=e||n.replace(/\s/g,"")+"-"+s+".otf";var i=this.toArrayBuffer();if(Vw())if(window.URL=window.URL||window.webkitURL,window.URL){var r=new DataView(i),o=new Blob([r],{type:"font/opentype"}),a=document.createElement("a");a.href=window.URL.createObjectURL(o),a.download=e;var c=document.createEvent("MouseEvents");c.initEvent("click",!0,!1),a.dispatchEvent(c)}else console.warn("Font file could not be downloaded. Try using a different browser.");else{var l=require("fs"),h=Hw(i);l.writeFileSync(e,h)}},cn.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512},cn.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9},cn.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900};var Br=new Array(10);Br[1]=function(){var n=this.offset+this.relativeOffset,s=this.parseUShort();if(s===1)return{posFormat:1,coverage:this.parsePointer($.coverage),value:this.parseValueRecord()};if(s===2)return{posFormat:2,coverage:this.parsePointer($.coverage),values:this.parseValueRecordList()};rt.assert(!1,"0x"+n.toString(16)+": GPOS lookup type 1 format must be 1 or 2.")},Br[2]=function(){var n=this.offset+this.relativeOffset,s=this.parseUShort();rt.assert(s===1||s===2,"0x"+n.toString(16)+": GPOS lookup type 2 format must be 1 or 2.");var i=this.parsePointer($.coverage),r=this.parseUShort(),o=this.parseUShort();if(s===1)return{posFormat:s,coverage:i,valueFormat1:r,valueFormat2:o,pairSets:this.parseList($.pointer($.list(function(){return{secondGlyph:this.parseUShort(),value1:this.parseValueRecord(r),value2:this.parseValueRecord(o)}})))};if(s===2){var a=this.parsePointer($.classDef),c=this.parsePointer($.classDef),l=this.parseUShort(),h=this.parseUShort();return{posFormat:s,coverage:i,valueFormat1:r,valueFormat2:o,classDef1:a,classDef2:c,class1Count:l,class2Count:h,classRecords:this.parseList(l,$.list(h,function(){return{value1:this.parseValueRecord(r),value2:this.parseValueRecord(o)}}))}}},Br[3]=function(){return{error:"GPOS Lookup 3 not supported"}},Br[4]=function(){return{error:"GPOS Lookup 4 not supported"}},Br[5]=function(){return{error:"GPOS Lookup 5 not supported"}},Br[6]=function(){return{error:"GPOS Lookup 6 not supported"}},Br[7]=function(){return{error:"GPOS Lookup 7 not supported"}},Br[8]=function(){return{error:"GPOS Lookup 8 not supported"}},Br[9]=function(){return{error:"GPOS Lookup 9 not supported"}},new Array(10);var qm;(function(e){e.BEFORE="before",e.AFTER="after"})(qm||(qm={}));const jm=new Set(["translate","motionPath","dimensions","rotation","cornerRadius","contentAnchor","scale","skew","opacity","blendMode","blurGaussian","font"]),eM=new Set(["effects"]),Jm=new Set(["trimPath"]),tM=new Set(["width","growDirection","cap","capSize","join","joinSize","dash","gap","offset","miter","ends"]),nM=new Set(["offsetX","offsetY","blur","spread"]),is=new Map([["ROOT",[...jm.keys(),...Qf,...eM.keys(),"blurs",...Jm.keys(),"pathMorphing"]],["dimensions",["width","height"]],["contentAnchor",["contentAnchorX","contentAnchorY"]],["scale",["scaleX","scaleY"]],["skew",["skewX","skewY"]],["opacity",["opacity","blendMode"]],["font",["fontSize","lineHeight","letterSpacing"]],[Ln.FILL,[]],[Ln.STROKE,[]],[Ln.SHADOW,[]],[Ln.INNER_SHADOW,[]],["LAYER",["blendMode","paint","opacity",...tM.keys(),...nM.keys()]],["blurs",["blurGaussian"]],["trimPath",["trimPath.start","trimPath.end","trimPath.offset"]]]),sM=new Set(Array.from(jm).flatMap(e=>{const n=is.get(e)||[e];return[e,...n]}));new Set(Array.from(Jm).flatMap(e=>is.get(e)||[e])),Array.from(is.entries()).reduce((e,[n,s])=>(s.forEach(i=>{e.set(i,n)}),e),new Map);const _p=[{position:0,color:[.85,.85,.85,1]},{position:1,color:[.85,.85,.85,0]}],iM=[{position:0,color:[0,0,0,1]},{position:1,color:[0,0,0,0]}];Ye.FILL+"",new ts([0,0,0,1]),_p.map(e=>new da(e)),new ks(0,-1,1,0,0,1),_r.FILL;const pu={[Ye.FILL]:{color:new ts([.85,.85,.85,1]),gradientStops:_p.map(e=>new da(e)),gradientTransform:new ks(0,-1,1,0,0,1),opacity:1,imageId:null,imageMode:_r.FILL},[Ye.STROKE]:{color:new ts([0,0,0,1]),gradientStops:iM.map(e=>new da(e)),gradientTransform:new ks(0,-1,1,0,0,1),opacity:1},[Ye.SHADOW]:{color:new ts([0,0,0,1]),opacity:.25},[Ye.INNER_SHADOW]:{color:new ts([1,1,1,1]),opacity:.25}};pe.NONE;const $m={...pu[Ye.FILL],layerType:Ye.FILL,paintType:Oe.SOLID,blendMode:Ut.NORMAL},rM={...pu[Ye.STROKE],layerType:Ye.STROKE,paintType:Oe.SOLID,blendMode:Ut.NORMAL,growDirection:Ja.CENTER,cap:on.NONE,join:bs.MITER,ends:ca.STRAIGHT},oM={...pu[Ye.SHADOW],layerType:Ye.SHADOW,paintType:Oe.SOLID,blendMode:Ut.NORMAL},aM={...pu[Ye.INNER_SHADOW],layerType:Ye.INNER_SHADOW,paintType:Oe.SOLID,blendMode:Ut.NORMAL};Ye.FILL+"",Ye.STROKE+"",Ye.SHADOW+"",Ye.INNER_SHADOW+"";const eO={start:0,end:100,offset:0,mode:$i.SIMULTANEOUSLY};wi.TRIM_PATH+"",wi.TRIM_PATH+"",wi.TRIM_PATH;const Eu={solid:["color"],gradient:["gradientTransform","gradientStops","activeGradientStopIdx"],image:["imageId","imageMode"]},tO=["visible","layerType","paintType","blendMode","opacity"],nO=[...tO,...Eu.solid,...Eu.image,...Eu.gradient],Tp=["paintState","opacityState","blendModeState"],cM=[...nO,"width","growDirection","offset","dash","gap","cap","capSize","join","joinSize","miter","ends"],lM=[...Tp,"widthState","growDirectionState","offsetState","dashState","gapState","capState","capSizeState","joinState","joinSizeState","miterState","endsState"],sO=[...tO,...Eu.solid,"offsetX","offsetY","blur","spread"],iO=[...Tp,"offsetXState","offsetYState","blurState","spreadState"];[...Object.keys(eO)],Ye.FILL+"",Ye.STROKE+"",Ye.SHADOW+"",Ye.INNER_SHADOW+"",Ye.FILL+"",Ye.STROKE+"",Ye.SHADOW+"",Ye.INNER_SHADOW+"",Oe.GRADIENT_LINEAR,Oe.GRADIENT_RADIAL,Oe.GRADIENT_ANGULAR,Oe.GRADIENT_DIAMOND,Oe.SOLID+"",Oe.IMAGE+"",Oe.GRADIENT_LINEAR+"",Oe.GRADIENT_RADIAL+"",Oe.GRADIENT_ANGULAR+"",Oe.GRADIENT_DIAMOND+"";const Ol=[["paintState","paint"],["opacityState","opacity"],["blendModeState","blendMode"]],gu=Ol.map(e=>[...e].reverse()),rO=[["widthState","width"],["growDirectionState","growDirection"],["offsetState","offset"],["dashState","dash"],["gapState","gap"],["capState","cap"],["capSizeState","capSize"],["joinState","join"],["joinSizeState","joinSize"],["miterState","miter"],["endsState","ends"]],hM=rO.map(e=>[...e].reverse()),Ap=[["offsetXState","offsetX"],["offsetYState","offsetY"],["blurState","blur"],["spreadState","spread"]],oO=Ap.map(e=>[...e].reverse());Ye.FILL+"",new Map([...Ol]),Ye.STROKE+"",new Map([...Ol,...rO]),Ye.SHADOW+"",new Map([...Ol,...Ap]),Ye.INNER_SHADOW+"",new Map([...Ol,...Ap]),Ye.FILL+"",new Map([...gu]),Ye.STROKE+"",new Map([...gu,...hM]),Ye.SHADOW+"",new Map([...gu,...oO]),Ye.INNER_SHADOW+"",new Map([...gu,...oO]);const aO=[["startState","start"],["endState","end"],["offsetState","offset"]],uM=aO.map(e=>[...e].reverse());wi.TRIM_PATH+"",new Map([...aO]),wi.TRIM_PATH+"",new Map([...uM]),wi.TRIM_PATH+"",wi.TRIM_PATH+"";const dM=["effects"];Le.SCREEN+"",[...sM.keys(),...is.get("trimPath")],Le.CONTAINER+"",[...is.get("font")],Le.NORMAL_GROUP+"",[...is.get("dimensions"),...is.get("font")],Le.BOOLEAN_CONTAINER+"",[...is.get("dimensions"),...is.get("font")],Le.MASK_CONTAINER+"",[...is.get("dimensions"),...is.get("trimPath"),...is.get("font")],Le.TEXT+"",[...is.get("trimPath")],Le.PATH+"",Le.GROUP+"",gn.RECTANGLE+"",[...is.get("font")],gn.ELLIPSE+"",[...is.get("font")],gn.POLYGON+"",[...is.get("dimensions"),...is.get("font")],gn.REGULAR_POLYGON+"",gn.STAR+"",gn.LINE+"",[...is.get("font")],Us.ELEMENT,Us.COMPUTED_STYLE,Us.COMPUTED_LAYER,Us.COMPUTED_EFFECT;const Il=["translate","dimensions","rotation","opacity","referencePoint","contentAnchor","scale","skew"],fM=["blurGaussian"],_u=["cornerRadius"],cO=["overflow"],lO=["font","textAlignment","textDecoration","textDirection"],Sl=new Set(Qf),yl=new Set(dM);Re.TRANSLATE,Re.DIMENSIONS,Re.ROTATION,Re.OPACITY,Re.REFERENCE_POINT,Re.CONTENT_ANCHOR,Re.BLUR_GAUSSIAN,Re.SCALE,Re.SKEW,Re.CORNER_RADIUS,Re.OVERFLOW,Re.FONT,Re.TEXT_ALIGNMENT,Re.TEXT_DECORATION,Re.TEXT_DIRECTION,Tr.FILL,Tr.STROKE,Tr.SHADOW,Tr.INNER_SHADOW,Re.EFFECT,[...Il,...Sl,...yl];const pM=[...Il,..._u,...Sl,...yl],hO=[...Il,..._u,...cO,...Sl,...yl],EM=[...Il,...lO,...Sl,...yl,..._u];[...Il,...fM,..._u,...cO,...lO,...Sl,...yl],Le.TEXT+"",Le.CONTAINER+"",Le.SCREEN+"",Le.PATH+"",Gs.OTHER,Oe.SOLID+"",Oe.IMAGE+"",Oe.GRADIENT_LINEAR+"",Oe.GRADIENT_RADIAL+"",Oe.GRADIENT_ANGULAR+"",Oe.GRADIENT_DIAMOND+"",rc({color:{type:ts},gradientTransform:{type:ks},gradientStops:{type:Array,itemType:da}}),rc({dash:{type:Array},gap:{type:Array}}),rc({color:{type:ts}});const gM={regenId:!1};class Sn extends B_{constructor(n,s={},{regenId:i=!1}=gM){super(n,gr.PROPERTY),this.dataStore=n;const{id:r,name:o,appliedTo:a,componentType:c}=s;!i&&ee(r)?(W_(r,ci.PROPERTY_COMPONENT),this.id=r):this.id=Gr(ci.PROPERTY_COMPONENT),this.type=Us.PROP_COMPONENT,this.componentType=c||"",this.name=ee(o)?o:"",this.appliedTo=new Map(a)}updateProp(n,s){this.changes.update(n,new tn({before:this[n],after:s})),this[n]=s}undo(n){n.forEach(({before:s},i)=>{this[i]=s}),super.undo(n)}redo(n){n.forEach(({after:s},i)=>{this[i]=s}),super.redo(n)}set(n){ee(n.name)&&this.updateProp("name",n.name)}clone(n){return this._clone(n)}_clone(n){const s=new this.constructor(this.dataStore);return s.type=this.type,s.componentType=this.componentType,s.name=this.name,s.appliedTo=new Map(this.appliedTo),s}static createRefKey({elementId:n,styleId:s,layerId:i}){return`${n},${s}${i?`,${i}`:""}`}apply(n){const{elementId:s,styleId:i,layerId:r}=n;if(s&&i){const o=Sn.createRefKey({elementId:s,styleId:i,layerId:r});this.appliedTo.set(o,{elementId:s,styleId:i,layerId:r})}}cancel({elementId:n,styleId:s,layerId:i}={}){if(this.isShared&&n&&s){const r=Sn.createRefKey({elementId:n,styleId:s,layerId:i});this.appliedTo.delete(r)}}save(){return this._save()}_save(){const n={};return n.id=this.id,n.type=this.type,n.componentType=this.componentType,n.name=this.name,n.appliedTo=[...this.appliedTo],n}forceSave(){return{data:this._save()}}get isShared(){return this.appliedTo.size>0}getRef(n){const s=this.dataStore.getById(n.elementId),i=s.getStyleById(n.styleId),r={element:s,style:i};return n.layerId&&(r.layer=i.getLayerById(n.layerId)),r}propagateChanges(n,s,i){if(this.isShared&&!s.__id__){s.__id__=!0;for(const r of this.appliedTo.values()){if(r.styleId===i||r.layerId===i)continue;const{style:o,layer:a}=this.getRef(r);a?a.setProperty(n,s):o.setProperty(n,s)}}}_setComponent(n,s,i){return i instanceof s?i:(n.set(i),n)}clearChanges(){this.changes.clear()}}const uO={paintType:{default:Oe.SOLID},blendMode:{default:Ut.NORMAL},opacity:{default:1},color:{default:$m.color,implementation:e=>new ts(e)},gradientStops:{default:_p,implementation:e=>e.map(n=>new da(n))},gradientTransform:{default:[0,-1,1,0,0,1],implementation:e=>new ks(e)},imageId:{default:null},imageMode:{default:_r.FILL}};class _M extends Sn{constructor(n,s={},i){super(n,s,i),this.componentType=Re.PAINT,this._initValues(s),this.activeGradientStopIdx=0,this.name||(this.name="paint")}get initValues(){return Object.entries(uO).reduce((n,[s,i])=>(n[s]=i.default,n),{})}_initValues(n={}){Object.entries(uO).forEach(([s,i])=>{const r=s in n?n[s]:i.default;i.implementation?this[s]=i.implementation(r):this[s]=r})}set(n){super.set(n),n.paintType in Oe&&this.updateProp("paintType",n.paintType),n.blendMode in Ut&&this.updateProp("blendMode",n.blendMode),ee(n.opacity)&&this.updateProp("opacity",n.opacity);const s=n.paintType||this.paintType;if(s===Oe.SOLID)ee(n.color)&&this.updateProp("color",new ts(n.color));else if(s===Oe.IMAGE)ee(n.imageId)&&this.updateProp("imageId",n.imageId),n.imageMode in _r&&this.updateProp("imageMode",n.imageMode);else{if(ee(n.gradientTransform)){const i=new ks(n.gradientTransform);this.updateProp("gradientTransform",i)}if(ee(n.gradientStops)){const i=n.gradientStops.map(r=>new da(r));this.updateProp("gradientStops",i)}ee(n.activeGradientStopIdx)&&this.updateProp("activeGradientStopIdx",n.activeGradientStopIdx)}}_clone(n){const s=super._clone(n);return s.paintType=this.paintType,s.blendMode=this.blendMode,s.opacity=this.opacity,s.color=new ts(this.color),s.gradientTransform=new ks(this.gradientTransform),s.gradientStops=this.gradientStops.map(i=>new da(i)),s.imageId=this.imageId,s.imageMode=this.imageMode,s}_save(){const n=super._save();return n.paintType=this.paintType,n.blendMode=this.blendMode,n.opacity=this.opacity,this.paintType===Oe.SOLID?n.color=[...this.color]:this.paintType===Oe.IMAGE?(n.imageId=this.imageId,n.imageMode=this.imageMode):(n.gradientTransform=[...this.gradientTransform],n.gradientStops=this.gradientStops.map(s=>s.save())),n}apply(n){super.apply(n)}cancel(n){super.cancel(n)}}class TM extends Sn{constructor(n,s={},i){super(n,s,i);const{amount:r,visible:o}=s;this.componentType=Re.BLUR_GAUSSIAN,this.visible=ee(o)?o:!0,this.amount=ee(r)?r:10,this.name||(this.name="blurGaussian")}set(n){super.set(n),ee(n.amount)&&this.updateProp("amount",n.amount),ee(n.visible)&&this.updateProp("visible",n.visible)}_clone(n){const s=super._clone(n);return s.amount=this.amount,s.visible=this.visible,s}_save(){const n=super._save();return n.amount=this.amount,n.visible=this.visible,n}}class dO extends Sn{constructor(n,s={},i){super(n,s,i);const{width:r,widthUnit:o,height:a,heightUnit:c}=s;this.componentType=Re.DIMENSIONS,this.width=be(r)?r:0,this.widthUnit=o||qt.PIXEL,this.height=be(a)?a:0,this.heightUnit=c||qt.PIXEL,this.name||(this.name="dimensions")}set(n){super.set(n),be(n.width)?this.updateProp("width",n.width):n.width===null&&this.updateProp("width",void 0),be(n.height)?this.updateProp("height",n.height):n.height===null&&this.updateProp("height",void 0),n.widthUnit in qt&&ee(this.width)&&this.updateProp("widthUnit",n.widthUnit),n.heightUnit in qt&&ee(this.height)&&this.updateProp("heightUnit",n.heightUnit)}_clone(n){const s=super._clone(n);return s.width=this.width,s.widthUnit=this.widthUnit,s.height=this.height,s.heightUnit=this.heightUnit,s}_save(){const n=super._save();return ee(this.width)&&(n.width=this.width,n.widthUnit=this.widthUnit),ee(this.height)&&(n.height=this.height,n.heightUnit=this.heightUnit),n}}dO.BASE_DEFAULT_DATA={width:0,widthUnit:qt.PIXEL,height:0,heightUnit:qt.PIXEL};class fO extends Sn{constructor(n,s={},i){super(n,s,i);const{fontFamily:r,fontStyle:o,fontWeight:a,fontSize:c,fontSizeUnit:l,letterSpacing:h,wordSpacing:d,lineHeight:p,paragraphSpacing:E,paragraphIndent:g}=s;this.componentType=Re.FONT,this.fontFamily=Ji(r)?r:"Inter",this.fontStyle=Ji(o)?o:"Regular",this.fontWeight=be(a)?a:400,this.fontSize=be(c)?c:12,this.fontSizeUnit=Ji(l)?l:ja.PIXEL,this.letterSpacing=be(h)?h:0,this.wordSpacing=be(d)?d:0,this.lineHeight=be(p)?p:1.2,this.paragraphSpacing=be(E)?E:0,this.paragraphIndent=be(g)?g:0,this.name||(this.name="font")}set(n){super.set(n);const{fontFamily:s,fontStyle:i,fontWeight:r,fontSize:o,fontSizeUnit:a,letterSpacing:c,wordSpacing:l,lineHeight:h,paragraphSpacing:d,paragraphIndent:p}=n;Ji(s)?this.updateProp("fontFamily",s):s===null&&this.updateProp("fontFamily",void 0),Ji(i)?this.updateProp("fontStyle",i):i===null&&this.updateProp("fontStyle",void 0),be(r)?this.updateProp("fontWeight",r):r===null&&this.updateProp("fontWeight",void 0),be(o)?this.updateProp("fontSize",o):o===null&&(this.updateProp("fontSize",void 0),this.updateProp("fontSizeUnit","px")),a in ja&&be(this.fontSize)&&this.updateProp("fontSizeUnit",a),be(c)?this.updateProp("letterSpacing",c):c===null&&this.updateProp("letterSpacing",void 0),be(l)?this.updateProp("wordSpacing",l):l===null&&this.updateProp("wordSpacing",void 0),be(h)?this.updateProp("lineHeight",h):h===null&&this.updateProp("lineHeight",void 0),be(d)?this.updateProp("paragraphSpacing",d):d===null&&this.updateProp("paragraphSpacing",void 0),be(p)?this.updateProp("paragraphIndent",p):p===null&&this.updateProp("paragraphIndent",void 0)}_clone(n){const s=super._clone(n);return s.fontFamily=this.fontFamily,s.fontStyle=this.fontStyle,s.fontWeight=this.fontWeight,s.fontSize=this.fontSize,s.fontSizeUnit=this.fontSizeUnit,s.letterSpacing=this.letterSpacing,s.wordSpacing=this.wordSpacing,s.lineHeight=this.lineHeight,s.paragraphSpacing=this.paragraphSpacing,s.paragraphIndent=this.paragraphIndent,s}_save(){const n=super._save();return Ji(this.fontFamily)&&(n.fontFamily=this.fontFamily),Ji(this.fontStyle)&&(n.fontStyle=this.fontStyle),be(this.fontSize)&&(n.fontSize=this.fontSize),be(this.fontWeight)&&(n.fontWeight=this.fontWeight),this.fontSizeUnit in ja&&(n.fontSizeUnit=this.fontSizeUnit),ee(this.letterSpacing)&&(n.letterSpacing=this.letterSpacing),ee(this.wordSpacing)&&(n.wordSpacing=this.wordSpacing),ee(this.lineHeight)&&(n.lineHeight=this.lineHeight),ee(this.paragraphSpacing)&&(n.paragraphSpacing=this.paragraphSpacing),ee(this.paragraphIndent)&&(n.paragraphIndent=this.paragraphIndent),n}}fO.BASE_DEFAULT_DATA={fontFamily:"Inter",fontStyle:"Regular",fontSize:12,fontWeight:400,fontSizeUnit:ja.PIXEL,letterSpacing:0,wordSpacing:0,lineHeight:1.2,paragraphSpacing:0,paragraphIndent:0};class AM extends Sn{constructor(n,s={},i){super(n,s,i);const{overflowX:r,overflowY:o,scrollX:a,scrollY:c,scrollBarX:l,scrollBarY:h}=s;this.componentType=Re.OVERFLOW,this.overflowX=ee(r)?r:!1,this.overflowY=ee(o)?o:!1,this.scrollX=ee(a)?a:!1,this.scrollY=ee(c)?c:!1,this.scrollBarX=ee(l)?l:!1,this.scrollBarY=ee(h)?h:!1,this.name||(this.name="overflow")}set(n){super.set(n),ee(n.overflowX)&&this.updateProp("overflowX",n.overflowX),ee(n.overflowY)&&this.updateProp("overflowY",n.overflowY),ee(n.scrollX)&&this.updateProp("scrollX",n.scrollX),ee(n.scrollY)&&this.updateProp("scrollY",n.scrollY),ee(n.scrollBarX)&&this.updateProp("scrollBarX",n.scrollBarX),ee(n.scrollBarY)&&this.updateProp("scrollBarY",n.scrollBarY)}_clone(n){const s=super._clone(n);return s.overflowX=this.overflowX,s.overflowY=this.overflowY,s.scrollX=this.scrollX,s.scrollY=this.scrollY,s.scrollBarX=this.scrollBarX,s.scrollBarY=this.scrollBarY,s}_save(){const n=super._save();return n.overflowX=this.overflowX,n.overflowY=this.overflowY,n.scrollX=this.scrollX,n.scrollY=this.scrollY,n.scrollBarX=this.scrollBarX,n.scrollBarY=this.scrollBarY,n}}class mM extends Sn{constructor(n,s={},i){super(n,s,i);const{opacityType:r,blendMode:o,opacity:a,opacityHandles:c,opacityStops:l}=s;this.componentType=Re.OPACITY,this.opacityType=ee(r)?r:Fh.SOLID,this.blendMode=ee(o)?o:Ut.PASS_THROUGH,this.opacity=ee(a)?a:1,this.opacityHandles=ee(c)?c.map(h=>new ne(h)):[],this.opacityStops=ee(l)?l.map(h=>new kf(h)):[],this.name||(this.name="opacity")}set(n){if(super.set(n),n.opacityType in Fh&&this.updateProp("opacityType",n.opacityType),n.blendMode in Ut&&this.updateProp("blendMode",n.blendMode),ee(n.opacity)&&this.updateProp("opacity",n.opacity),ee(n.opacityHandles)){const s=n.opacityHandles.map(i=>new ne(i));this.updateProp("opacityHandles",s)}if(ee(n.opacityStops)){const s=n.opacityStops.map(i=>new kf(i));this.updateProp("opacityStops",s)}}_clone(n){const s=super._clone(n);return s.opacityType=this.opacityType,s.blendMode=this.blendMode,s.opacity=this.opacity,s.opacityHandles=this.opacityHandles.map(i=>new ne(i)),s.opacityStops=this.opacityStops.map(i=>new kf(i)),s}_save(){const n=super._save();return n.opacityType=this.opacityType,n.blendMode=this.blendMode,n.opacity=this.opacity,n.opacityHandles=this.opacityHandles.map(s=>[...s]),n.opacityStops=this.opacityStops.map(s=>s.save()),n}}class pO extends Sn{constructor(n,s={},i){super(n,s,i);const{originX:r,originY:o,originXUnit:a,originYUnit:c}=s;this.componentType=Re.ORIGIN,this.originX=be(r)?r:50,this.originY=be(o)?o:50,this.originXUnit=a in qt?a:qt.PERCENT,this.originYUnit=c in qt?c:qt.PERCENT,this.name||(this.name="origin")}set(n){super.set(n),be(n.originX)?this.updateProp("originX",n.originX):n.originX===null&&this.updateProp("originX",void 0),be(n.originY)?this.updateProp("originY",n.originY):n.originY===null&&this.updateProp("originY",void 0),n.originXUnit in qt&&ee(this.originX)&&this.updateProp("originXUnit",n.originXUnit),n.originYUnit in qt&&ee(this.originY)&&this.updateProp("originYUnit",n.originYUnit)}_clone(n){const s=super._clone(n);return s.originX=this.originX,s.originY=this.originY,s.originXUnit=this.originXUnit,s.originYUnit=this.originYUnit,s}_save(){const n=super._save();return ee(this.originX)&&(n.originX=this.originX,n.originXUnit=this.originXUnit),ee(this.originY)&&(n.originY=this.originY,n.originYUnit=this.originYUnit),n}}pO.BASE_DEFAULT_DATA={componentType:Re.ORIGIN,originX:50,originY:50,originXUnit:qt.PERCENT,originYUnit:qt.PERCENT};class EO extends Sn{constructor(n,s={},i){super(n,s,i);const{referencePointX:r,referencePointY:o}=s;this.componentType=Re.REFERENCE_POINT,this.referencePointX=be(r)?r:0,this.referencePointY=be(o)?o:0,this.name||(this.name="referencePoint")}set(n){super.set(n),be(n.referencePointX)&&this.updateProp("referencePointX",n.referencePointX),be(n.referencePointY)&&this.updateProp("referencePointY",n.referencePointY)}_clone(n){const s=super._clone(n);return s.referencePointX=this.referencePointX,s.referencePointY=this.referencePointY,s}_save(){const n=super._save();return n.referencePointX=this.referencePointX,n.referencePointY=this.referencePointY,n}}EO.BASE_DEFAULT_DATA={referencePointX:0,referencePointY:0};class gO extends Sn{constructor(n,s={},i){super(n,s,i);const{contentAnchorX:r,contentAnchorY:o,contentAnchorXUnit:a,contentAnchorYUnit:c,contentAnchorAutoAdd:l,contentAnchorType:h}=s;this.componentType=Re.CONTENT_ANCHOR,this.contentAnchorX=be(r)?r:0,this.contentAnchorY=be(o)?o:0,this.contentAnchorXUnit=a in qt?a:qt.PIXEL,this.contentAnchorYUnit=c in qt?c:qt.PIXEL,this.contentAnchorAutoAdd=ee(l)?l:!1,this.contentAnchorType=ee(h)?h:Vh.CONTENT,this.name||(this.name="contentAnchor")}set(n){super.set(n),be(n.contentAnchorX)?this.updateProp("contentAnchorX",n.contentAnchorX):n.contentAnchorX===null&&this.updateProp("contentAnchorX",void 0),be(n.contentAnchorY)?this.updateProp("contentAnchorY",n.contentAnchorY):n.contentAnchorY===null&&this.updateProp("contentAnchorY",void 0),n.contentAnchorXUnit in qt&&ee(this.contentAnchorX)&&this.updateProp("contentAnchorXUnit",n.contentAnchorXUnit),n.contentAnchorYUnit in qt&&ee(this.contentAnchorY)&&this.updateProp("contentAnchorYUnit",n.contentAnchorYUnit),ee(n.contentAnchorAutoAdd)&&this.updateProp("contentAnchorAutoAdd",n.contentAnchorAutoAdd),ee(n.contentAnchorType)&&this.updateProp("contentAnchorType",n.contentAnchorType)}_clone(n){const s=super._clone(n);return s.contentAnchorX=this.contentAnchorX,s.contentAnchorY=this.contentAnchorY,s.contentAnchorXUnit=this.contentAnchorXUnit,s.contentAnchorYUnit=this.contentAnchorYUnit,s.contentAnchorAutoAdd=this.contentAnchorAutoAdd,s.contentAnchorType=this.contentAnchorType,s}_save(){const n=super._save();return ee(this.contentAnchorX)&&(n.contentAnchorX=this.contentAnchorX,n.contentAnchorXUnit=this.contentAnchorXUnit),ee(this.contentAnchorY)&&(n.contentAnchorY=this.contentAnchorY,n.contentAnchorYUnit=this.contentAnchorYUnit),n.contentAnchorAutoAdd=this.contentAnchorAutoAdd,n.contentAnchorType=this.contentAnchorType,n}}gO.BASE_DEFAULT_DATA={contentAnchorX:0,contentAnchorY:0,contentAnchorXUnit:"px",contentAnchorYUnit:"px",contentAnchorAutoAdd:!0,contentAnchorType:Vh.CONTENT};class OM extends Sn{constructor(n,s={},i){super(n,s,i);const{cornerRadius:r,cornerSmoothing:o}=s;this.componentType=Re.CORNER_RADIUS,this.cornerRadius=be(r)?r:void 0,this.cornerRadius===void 0&&(this.cornerRadius=Gh(r)?[...r]:0),this.cornerSmoothing=ee(o)?o:0,this.name||(this.name="cornerRadius")}set(n){super.set(n),be(n.cornerRadius)?this.updateProp("cornerRadius",n.cornerRadius):Gh(n.cornerRadius)?this.updateProp("cornerRadius",[...n.cornerRadius]):n.cornerRadius===null&&this.updateProp("cornerRadius",void 0),be(n.cornerSmoothing)?this.updateProp("cornerSmoothing",n.cornerSmoothing):n.cornerSmoothing===null&&this.updateProp("cornerSmoothing",void 0)}_clone(n){const s=super._clone(n);return ee(this.cornerRadius)&&(s.cornerRadius=be(this.cornerRadius)?this.cornerRadius:[...this.cornerRadius]),s.cornerSmoothing=this.cornerSmoothing,s}_save(){const n=super._save();return ee(this.cornerRadius)&&(n.cornerRadius=be(this.cornerRadius)?this.cornerRadius:[...this.cornerRadius]),n.cornerSmoothing=this.cornerSmoothing,n}}class _O extends Sn{constructor(n,s={},i){super(n,s,i);const{translateX:r,translateY:o,translateXUnit:a,translateYUnit:c}=s;this.componentType=Re.TRANSLATE,this.translateX=be(r)?r:0,this.translateY=be(o)?o:0,this.translateXUnit=a in qt?a:qt.PIXEL,this.translateYUnit=c in qt?c:qt.PIXEL,this.name||(this.name="translate")}set(n){super.set(n),be(n.translateX)?this.updateProp("translateX",n.translateX):n.translateX===null&&this.updateProp("translateX",void 0),be(n.translateY)?this.updateProp("translateY",n.translateY):n.translateY===null&&this.updateProp("translateY",void 0),n.translateXUnit in qt&&ee(this.translateXUnit)&&this.updateProp("translateXUnit",n.translateXUnit),n.translateYUnit in qt&&ee(this.translateYUnit)&&this.updateProp("translateYUnit",n.translateYUnit)}_clone(n){const s=super._clone(n);return s.translateX=this.translateX,s.translateY=this.translateY,s.translateXUnit=this.translateXUnit,s.translateYUnit=this.translateYUnit,s}_save(){const n=super._save();return ee(this.translateX)&&(n.translateX=this.translateX,n.translateXUnit=this.translateXUnit),ee(this.translateY)&&(n.translateY=this.translateY,n.translateYUnit=this.translateYUnit),n}}_O.BASE_DEFAULT_DATA={translateX:0,translateY:0,translateXUnit:"px",translateYUnit:"px"};class IM extends Sn{constructor(n,s={},i){super(n,s,i);const{rotation:r}=s;this.componentType=Re.ROTATION,this.rotation=ee(r)?r:0,this.name||(this.name="rotation")}set(n){super.set(n),ee(n.rotation)&&this.updateProp("rotation",n.rotation)}_clone(n){const s=super._clone(n);return s.rotation=this.rotation,s}_save(){const n=super._save();return n.rotation=this.rotation,n}}class SM extends Sn{constructor(n,s={},i){super(n,s,i);const{scaleX:r,scaleY:o}=s;this.scaleX=ee(r)?r:1,this.scaleY=ee(o)?o:1,this.componentType=Re.SCALE,this.name||(this.name="scale")}set(n){super.set(n),ee(n.scaleX)&&this.updateProp("scaleX",n.scaleX),ee(n.scaleY)&&this.updateProp("scaleY",n.scaleY)}_clone(n){const s=super._clone(n);return s.scaleX=this.scaleX,s.scaleY=this.scaleY,s}_save(){const n=super._save();return n.scaleX=this.scaleX,n.scaleY=this.scaleY,n}}class TO extends Sn{constructor(n,s={},i){super(n,s,i);const{skewX:r,skewY:o}=s;this.skewX=ee(r)?r:0,this.skewY=ee(o)?o:0,this.componentType=Re.SKEW,this.name||(this.name="skew")}set(n){super.set(n),ee(n.skewX)?this.updateProp("skewX",n.skewX):n.skewX===null&&this.updateProp("skewX",void 0),ee(n.skewY)?this.updateProp("skewY",n.skewY):n.skewY===null&&this.updateProp("skewY",void 0)}_clone(n){const s=super._clone(n);return s.skewX=this.skewX,s.skewY=this.skewY,s}_save(){const n=super._save();return n.skewX=this.skewX,n.skewY=this.skewY,n}}TO.BASE_DEFAULT_DATA={skewX:0,skewY:0};class Tu extends Sn{constructor(n,s={},i){super(n,s,i);const{layerType:r,layers:o}=s;this.layerType=ee(r)?r:"LAYER",this.layers=ee(o)?o:[],this.name||(this.name="layer")}set(n){super.set(n),ee(n.layers)&&this.updateProp("layers",n.layers)}addLayer(n,s=-1){if(this.layers.includes(n))return;const i=s===-1?this.layers.length:s,r=this.layers.slice();r.splice(i,0,n),this.set({layers:r})}removeLayer(n){const s=this.layers.findIndex(r=>r===n);if(s===-1)return;const i=this.layers.slice();i.splice(s,1),this.set({layers:i})}_clone(n){const s=super._clone(n);return s.layerType=this.layerType,s}_save(){const n=super._save();return n.layerType=this.layerType,n.layers=this.layers,n}apply(n){super.apply(n),this.layers.forEach(s=>{this.dataStore.library.getLayer(s).apply(n)})}cancel(n){super.cancel(n),this.layers.forEach(s=>{this.dataStore.library.getLayer(s).cancel(n)})}}class yM extends Tu{constructor(n,s={},i){super(n,s,i),this.componentType=Tr.FILL,(!this.name||this.name==="layer")&&(this.name="fill"),(!this.layerType||this.layerType==="LAYER")&&(this.layerType=Ye.FILL)}}class CM extends Tu{constructor(n,s={},i){super(n,s,i),this.componentType=Tr.STROKE,(!this.name||this.name==="layer")&&(this.name="stroke"),(!this.layerType||this.layerType==="LAYER")&&(this.layerType=Ye.STROKE)}}class NM extends Tu{constructor(n,s={},i){super(n,s,i),this.componentType=Tr.SHADOW,(!this.name||this.name==="layer")&&(this.name="shadow"),(!this.layerType||this.layerType==="LAYER")&&(this.layerType=Ye.SHADOW)}}class xM extends Tu{constructor(n,s={},i){super(n,s,i),this.componentType=Tr.INNER_SHADOW,(!this.name||this.name==="layer")&&(this.name="inner-shadow"),(!this.layerType||this.layerType==="LAYER")&&(this.layerType=Ye.INNER_SHADOW)}}class AO extends Sn{constructor(n,s={},i){super(n,s,i);const{horizontalAlignment:r,verticalAlignment:o}=s;this.horizontalAlignment=r in Ri?r:Ri.LEFT,this.verticalAlignment=o in Ps?o:Ps.TOP,this.componentType=Re.TEXT_ALIGNMENT,this.name||(this.name="text-alignment")}set(n){super.set(n);const{horizontalAlignment:s,verticalAlignment:i}=n;s in Ri?this.updateProp("horizontalAlignment",s):s===null&&this.updateProp("horizontalAlignment",void 0),i in Ps?this.updateProp("verticalAlignment",i):i===null&&this.updateProp("verticalAlignment",void 0)}_clone(n){const s=super._clone(n);return s.horizontalAlignment=this.horizontalAlignment,s.verticalAlignment=this.verticalAlignment,s}_save(){const n=super._save();return this.horizontalAlignment in Ri&&(n.horizontalAlignment=this.horizontalAlignment),this.verticalAlignment in Ps&&(n.verticalAlignment=this.verticalAlignment),n}}AO.BASE_DEFAULT_DATA={horizontalAlignment:Ri.LEFT,verticalAlignment:Ps.TOP};class mO extends Sn{constructor(n,s={},i){super(n,s,i);const{underline:r,strikethrough:o,cases:a,subSuper:c}=s;this.underline=typeof r=="boolean"?r:!1,this.strikethrough=typeof o=="boolean"?o:!1,this.cases=Ji(a)?a:"NORMAL",this.subSuper=Ji(c)?c:"NORMAL",this.componentType=Re.TEXT_DECORATION,this.name||(this.name="text-decoration")}set(n){super.set(n);const{underline:s,strikethrough:i,cases:r,subSuper:o}=n;typeof s=="boolean"?this.updateProp("underline",n.underline):s===null&&this.updateProp("underline",void 0),typeof i=="boolean"?this.updateProp("strikethrough",n.strikethrough):i===null&&this.updateProp("strikethrough",void 0),Ji(r)?this.updateProp("cases",n.cases):r===null&&this.updateProp("cases",void 0),Ji(o)?this.updateProp("subSuper",n.subSuper):o===null&&this.updateProp("subSuper",void 0)}_clone(n){const s=super._clone(n);return s.underline=this.underline,s.strikethrough=this.strikethrough,s.cases=this.cases,s.subSuper=this.subSuper,s}_save(){const n=super._save();return ee(this.underline)&&(n.underline=this.underline),ee(this.strikethrough)&&(n.strikethrough=this.strikethrough),ee(this.cases)&&(n.cases=this.cases),ee(this.subSuper)&&(n.subSuper=this.subSuper),n}}mO.BASE_DEFAULT_DATA={underline:!1,strikethrough:!1,cases:"NORMAL",subSuper:"NORMAL"};class vM extends Sn{constructor(n,s={},i){super(n,s,i);const{textDirection:r}=s;this.textDirection=ee(r)?r:kh.LTR,this.componentType=Re.TEXT_DIRECTION,this.name||(this.name="text-direction")}set(n){super.set(n),n.textDirection in kh&&this.updateProp("textDirection",n.textDirection)}_clone(n){const s=super._clone(n);return s.textDirection=this.textDirection,s}_save(){const n=super._save();return n.textDirection=this.textDirection,n}}class RM extends Sn{constructor(n,s={},i){super(n,s,i);const{effects:r,effectsTypeSet:o}=s;this.componentType=Re.EFFECT,this.effects=ee(r)?r:[],this.effectsTypeSet=ee(r)?new Set(o):new Set,this.name||(this.name="effect")}set(n){super.set(n),ee(n.effects)&&this.updateProp("effects",n.effects),ee(n.effectsTypeSet)&&this.updateProp("effectsTypeSet",n.effectsTypeSet)}hasEffectType(n){return this.effectsTypeSet.has(n)}addEffect(n,s=-1){if(this.effects.includes(n))return;const i=s===-1?this.effects.length:s,r=this.effects.slice();r.splice(i,0,n);const o=this.dataStore.library.getEffect(n);this.set({effects:r,effectsTypeSet:new Set(this.effectsTypeSet).add(o.effectType)})}removeEffect(n){const s=this.effects.findIndex(a=>a===n);if(s===-1)return;const i=this.dataStore.library.getEffect(n),r=this.effects.slice();r.splice(s,1);const o=new Set(this.effectsTypeSet);o.delete(i.effectType),this.set({effects:r,effectsTypeSet:o})}_clone(n){const s=super._clone(n),i=this.dataStore.library.cloneComponentList(this.effects.map(r=>this.dataStore.library.getComponent(r)));return s.effects=[...i.values()],s.effectsTypeSet=new Set(this.effectsTypeSet),s}_save(){const n=super._save();return n.effects=this.effects,n.effectsTypeSet=[...this.effectsTypeSet],n}apply(n){super.apply(n),this.effects.forEach(s=>{this.dataStore.library.getEffect(s).apply(n)})}cancel(n){super.cancel(n),this.effects.forEach(s=>{this.dataStore.library.getEffect(s).cancel(n)})}}Re.TRANSLATE,Re.DIMENSIONS,Re.ROTATION,Re.OPACITY,Re.FILL,Re.STROKE,Re.SHADOW,Re.INNER_SHADOW,Re.FONT,Re.TEXT_ALIGNMENT,Re.TEXT_DECORATION,Re.TEXT_DIRECTION,Re.SCALE,Re.SKEW,Re.ORIGIN,Re.REFERENCE_POINT,Re.CONTENT_ANCHOR,Re.OVERFLOW,Re.BLUR_GAUSSIAN,Re.PAINT,Re.CORNER_RADIUS,Re.EFFECT,Re.IMAGE,Ja.INSIDE,Ja.CENTER,Ja.OUTSIDE,on.NONE,on.ROUND,on.LINE_ARROW,on.TRIANGLE_ARROW_SOLID,on.TRIANGLE_ARROW_OUTLINE,on.CIRCLE_SOLID,on.CIRCLE_OUTLINE,on.SQUARE_SOLID,on.SQUARE_OUTLINE,bs.MITER,bs.CONCAVE,bs.ROUND,bs.BEVEL,bs.NONE,ca.STRAIGHT,ca.ROUND,rc({position:{type:ne},translate:{type:ne},referencePoint:{type:ne},contentAnchor:{type:ne},size:{type:ne},scale:{type:ne},skew:{type:ne}}),er.FROM_MESH_CHANGE,er.FROM_CHILDREN_CHANGE,er.FROM_PARENT_EDIT,er.FROM_CHANGE_CONTAINER_TYPE,er.FROM_TEXT_EDIT;const wM=e=>e/180*Math.PI;function Au(e,n,s,i){return Math.hypot(e-s,n-i)}function OO(e,n,s,i,r,o){return e===s&&n===i||e===r&&n===o?0:s===r&&i===o?Math.sqrt((e-s)**2+(n-i)**2):Math.abs((i-o)*e+(r-s)*n+(s*o-r*i))/Math.sqrt((i-o)**2+(r-s)**2)}function IO(e,n,s,i,r,o,a){const c=i-o,l=r-s,h=s*o-r*i,d=(c*e+l*n+h)/(c**2+l**2);return a.set(e-c*d,n-l*d),d}function DM(e,n,s,i,r){let o=Math.atan2(-s.x,s.y);o<0&&(o+=Math.PI*2);const a=r.rotate(o);a.affine_inverse().xform(e,e),e.multiply(1,-1);const l=n.length(),h=s.length(),d=e.y/e.x,p=l*h*Math.sqrt(1/(h**2+l**2*d**2)),E=d*p,{pos:g,dis:T}=LM(e,[[p,E],[-p,-E]]),A=a.xform({x:g[0],y:g[1]}),m=A.set(A.x+i.x,-A.y+i.y);let O=Math.atan2(-g[0]*h/l,-g[1]);return O<0&&(O+=Math.PI*2),{pos:m,dis:T,per:O/Math.PI/2}}function LM(e,n){let s=null,i=Number.MAX_SAFE_INTEGER;for(let r=0;r<n.length;r++){const o=Au(e.x,e.y,n[r][0],n[r][1]);o<i&&(i=o,s=n[r])}return{pos:s,dis:i}}function MM(e,n,s,i,r){return Math.pow(e-s,2)+Math.pow(n-i,2)<=Math.pow(r,2)}const SO=new Int8Array(4),PM=new Int32Array(SO.buffer,0,1),bM=new Float32Array(SO.buffer,0,1),UM=e=>(PM[0]=e,bM[0]),GM=e=>UM(e&4278190079);function FM(e,n,s,i){const r=(i*255|0)<<24|(s*255|0)<<16|(n*255|0)<<8|(e*255|0);return GM(r)}function Zs(e=1,n=1,s=1,i=1){this.r=e,this.g=n,this.b=s,this.a=i,this._rgba=null}Zs.prototype={constructor:Zs,set(e,n,s,i=1){return this.r=e,this.g=n,this.b=s,this.a=i,this},set_with_hex(e){const[n,s,i]=yO(e);return this.r=n,this.g=s,this.b=i,this},set_with_array(e){return this.r=e[0],this.g=e[1],this.b=e[2],this.a=e[3],this},copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this},clone(){return new Zs().copy(this)},to_linear(){return new Zs().set(this.r<.04045?this.r*(1/12.92):Math.pow((this.r+.055)*(1/(1+.055)),2.4),this.g<.04045?this.g*(1/12.92):Math.pow((this.g+.055)*(1/(1+.055)),2.4),this.b<.04045?this.b*(1/12.92):Math.pow((this.b+.055)*(1/(1+.055)),2.4),this.a)},to_srgb(){return new Zs().set(this.r<.0031308?12.92*this.r:(1+.055)*Math.pow(this.r,1/2.4)-.055,this.g<.0031308?12.92*this.g:(1+.055)*Math.pow(this.g,1/2.4)-.055,this.b<.0031308?12.92*this.b:(1+.055)*Math.pow(this.b,1/2.4)-.055,this.a)},multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this.a*=e.a,this},blend(e){let n=0;const s=1-e.a;return n=this.a*s+e.a,n===0?this.set(0,0,0,0):this.set((this.r*this.a*s+e.r*e.a)/n,(this.g*this.a*s+e.g*e.a)/n,(this.b*this.a*s+e.b*e.a)/n,n)},linear_interpolate(e,n,s=new Zs){return s.copy(this),s.r+=n*(e.r-this.r),s.g+=n*(e.g-this.g),s.b+=n*(e.b-this.b),s.a+=n*(e.a-this.a),s},as_hex(){return this._rgba||(this._rgba=Array(4)),this._rgba[0]=this.r,this._rgba[1]=this.g,this._rgba[2]=this.b,this._rgba[3]=this.a,mp(this._rgba)},as_rgba8(){return FM(this.r,this.g,this.b,this.a)},as_array(e){if(!e&&!this._rgba)return this._rgba=[this.r,this.g,this.b,this.a],this._rgba;const n=e||this._rgba;return n[0]=this.r,n[1]=this.g,n[2]=this.b,n[3]=this.a,n},equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}},Zs.hex=e=>{const n=yO(e);return new Zs(n[0],n[1],n[2])},Zs.html=e=>Zs.hex(parseInt(e.replace(/^#/,"0x"),16));function yO(e,n=[]){return n[0]=(e>>16&255)/255,n[1]=(e>>8&255)/255,n[2]=(e&255)/255,n}function mp(e){return(e[0]*255<<16)+(e[1]*255<<8)+(e[2]*255|0)}const CO=new N;function ye(e=0,n=0,s=0,i=0){this.x=e,this.y=n,this.width=s,this.height=i}ye.prototype={constructor:ye,set(e=0,n=0,s=0,i=0){return this.x=e,this.y=n,this.width=s,this.height=i,this},setFrom(e){this.set(0,0,0,0);const n=e.next().value;n&&this.copy(n);for(const s of e)this.merge_with(s);return this},get left(){return this.x},get right(){return this.x+this.width},get top(){return this.y},get bottom(){return this.y+this.height},get center(){return new N(this.x+this.width/2,this.y+this.height/2)},get topCenter(){return new N(this.x+this.width/2,this.y)},get leftCenter(){return new N(this.x,this.y+this.height/2)},get rightCenter(){return new N(this.x+this.width,this.y+this.height/2)},get bottomCenter(){return new N(this.x+this.width/2,this.y+this.height)},get topLeft(){return new N(this.x,this.y)},get topRight(){return new N(this.x+this.width,this.y)},get bottomLeft(){return new N(this.x,this.y+this.height)},get bottomRight(){return new N(this.x+this.width,this.y+this.height)},get w(){return this.width},set w(e){this.width=e},get h(){return this.height},set h(e){this.height=e},getCenter(){return new N(this.x+this.width*.5,this.y+this.height*.5)},clone(){return new ye(this.x,this.y,this.width,this.height)},copy(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this},is_zero(){return this.x===0&&this.y===0&&this.width===0&&this.height===0},equals(e){return this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height},contains(e,n){let s,i;return n===void 0?(s=e.x,i=e.y):(s=e,i=n),this.width<=0||this.height<=0?!1:s>=this.x&&s<=this.x+this.width&&i>=this.y&&i<=this.y+this.height},containsRect(e){const n=e.x,s=e.y;return n>=this.x&&s>=this.y&&n+e.width<=this.x+this.width&&s+e.height<=this.y+this.height},has_no_area(){return this.width<=0||this.height<=0},has_point(e){return!(e.x<this.x||e.y<this.y||e.x>=this.x+this.width||e.y>=this.y+this.height)},get_area(){return this.width*this.height},abs(){return this.clone().abs_to()},abs_to(){return this.x+=Math.min(this.width,0),this.y+=Math.min(this.height,0),this.width=Math.abs(this.width),this.height=Math.abs(this.height),this},clip(e){return this.clone().clip_by(e)},clip_by(e){if(!this.intersects(e))return this.set(0,0,0,0);const n=Math.max(e.x,this.x),s=Math.max(e.y,this.y),i=e.x+e.width,r=e.y+e.height,o=this.x+this.width,a=this.y+this.height;return this.x=n,this.y=s,this.width=Math.min(i,o)-n,this.height=Math.min(r,a)-s,this},encloses(e){return e.x>=this.x&&e.y>=this.y&&e.x+e.width<this.x+this.width&&e.y+e.height<this.y+this.height},grow(e){return this.clone().grow_to(e)},grow_to(e){return this.x-=e,this.y-=e,this.width+=e*2,this.height+=e*2,this},grow_individual(e,n,s,i){const r=this.clone();return r.x-=e,r.y-=n,r.width+=e+s,r.height+=n+i,r},expand(e){return this.clone().expand_to(e)},expand_n(e,n){return this.clone().expand_to(CO.set(e,n))},expand_to(e){const n=kM.set(this.x,this.y),s=BM.set(this.x+this.width,this.y+this.height);return e.x<n.x&&(n.x=e.x),e.y<n.y&&(n.y=e.y),e.x>s.x&&(s.x=e.x),e.y>s.y&&(s.y=e.y),this.x=n.x,this.y=n.y,this.width=s.x-n.x,this.height=s.y-n.y,this},expand_to_n(e,n){return this.expand_to(CO.set(e,n))},offset(e,n){return this.x+=e,this.y+=n,this},fit_to(e){return this.x<e.x&&(this.width+=this.x,this.width<0&&(this.width=0),this.x=e.x),this.y<e.y&&(this.height+=this.y,this.height<0&&(this.height=0),this.y=e.y),this.x+this.width>e.x+e.width&&(this.width=e.width-this.x,this.width<0&&(this.width=0)),this.y+this.height>e.y+e.height&&(this.height=e.height-this.y,this.height<0&&(this.height=0)),this},merge(e){return this.clone().merge_with(e)},merge_with(e){const n=Math.min(this.x,e.x),s=Math.max(this.x+this.width,e.x+e.width),i=Math.min(this.y,e.y),r=Math.max(this.y+this.height,e.y+e.height);return this.x=n,this.width=s-n,this.y=i,this.height=r-i,this},intersects(e,n=0){return e.x+e.width>this.x-n&&e.y+e.height>this.y-n&&e.x<this.x+this.width+n&&e.y<this.y+this.height+n},intersects_segment(e,n,s,i){let r=0,o=1,a=0,c=0;{const h=e.x,d=n.x,p=this.x,E=p+this.width;let g=0,T=0,A=0;if(h<d){if(h>E||d<p)return!1;const m=d-h;g=h<p?(p-h)/m:0,T=d>E?(E-h)/m:1,A=-1}else{if(d>E||h<p)return!1;const m=d-h;g=h>E?(E-h)/m:0,T=d<p?(p-h)/m:1,A=1}if(g>r&&(r=g,a=0,c=A),T<o&&(o=T),o<r)return!1}{const h=e.y,d=n.y,p=this.y,E=p+this.height;let g=0,T=0,A=0;if(h<d){if(h>E||d<p)return!1;const m=d-h;g=h<p?(p-h)/m:0,T=d>E?(E-h)/m:1,A=-1}else{if(d>E||h<p)return!1;const m=d-h;g=h>E?(E-h)/m:0,T=d<p?(p-h)/m:1,A=1}if(g>r&&(r=g,a=1,c=A),T<o&&(o=T),o<r)return!1}const l=n.clone().subtract(e);return i&&(i.set(0,0),a===0?i.x=c:i.y=c),s&&s.copy(e).add(l.scale(r)),!0},overlaps(e,n=0){return!(this.actualBottom()<=e.actualTop()+n||this.actualTop()>=e.actualBottom()-n||this.actualLeft()>=e.actualRight()+n||this.actualRight()<=e.actualLeft()-n)},actualLeft(){return Math.min(this.x,this.x+this.w)},actualTop(){return Math.min(this.y,this.y+this.h)},actualRight(){return Math.max(this.x,this.x+this.w)},actualBottom(){return Math.max(this.y,this.y+this.h)},actualTopLeft(){return new N(this.actualLeft(),this.actualTop())},actualTopRight(){return new N(this.actualRight(),this.actualTop())},actualBottomLeft(){return new N(this.actualLeft(),this.actualBottom())},actualBottomRight(){return new N(this.actualRight(),this.actualBottom())},hash(e=1e-5){const n=1/e;return`${Math.round(this.x*n)}-${Math.round(this.y*n)}-${Math.round(this.width*n)}-${Math.round(this.height*n)}`}};const kM=new N,BM=new N;function Ce(e=1,n=0,s=0,i=1,r=0,o=0){this.a=e,this.b=n,this.c=s,this.d=i,this.tx=r,this.ty=o,this._array=null}Ce.prototype={constructor:Ce,get_origin(e=new N){return e.set(this.tx,this.ty)},set_origin(e){return this.tx=e.x,this.ty=e.y,this},set_origin_n(e,n){return this.tx=e,this.ty=n,this},get_rotation(){return Math.atan2(this.b,this.a)},set_rotation(e){const n=Math.cos(e),s=Math.sin(e);return this.a=n,this.b=s,this.c=-s,this.d=n,this},get_scale(e=new N){const n=Math.sign(this.a*this.d-this.b*this.c);return e.x=Math.sqrt(this.a*this.a+this.b*this.b),e.y=Math.sqrt(this.c*this.c+this.d*this.d)*n,e},set_scale(e){const n=new N;return n.set(this.a,this.b).normalize(),this.a=n.x*e.x,this.b=n.y*e.x,n.set(this.c,this.d).normalize(),this.c=n.x*e.y,this.d=n.y*e.y,this},set_scale_n(e,n){const s=new N;return s.set(this.a,this.b).normalize(),this.a=s.x*e,this.b=s.y*e,s.set(this.c,this.d).normalize(),this.c=s.x*n,this.d=s.y*n,this},set_rotation_and_scale(e,n){const s=Math.cos(e),i=Math.sin(e);return this.a=s*n.x,this.d=s*n.y,this.c=-i*n.y,this.b=i*n.x,this},set_rotation_and_origin(e,n){const s=Math.cos(e),i=Math.sin(e);return this.a=s,this.b=i,this.c=-i,this.d=s,this.tx=n.x,this.ty=n.y,this},get_skew(){const e=XM,n=zM,s=this.basis_determinant();return Math.acos(e.set(this.a,this.b).normalize().dot(n.set(this.c,this.d).normalize().scale(Math.sign(s))))-Math.PI*.5},set_skew(e){const n=KM,s=this.basis_determinant();return n.set(this.a,this.b).rotate(Math.PI*.5+e).normalize().scale(Math.sign(s)*Math.hypot(this.c,this.d)),this.c=n.x,this.d=n.y,this},set_rotation_scale_and_skew(e,n,s){return this.a=Math.cos(e)*n.x,this.d=Math.cos(e+s)*n.y,this.c=-Math.sin(e+s)*n.y,this.b=Math.sin(e)*n.x,this},fromArray(e){return this.a=e[0],this.b=e[1],this.c=e[2],this.d=e[3],this.tx=e[4],this.ty=e[5],this},reset(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},set(e=1,n=0,s=0,i=1,r=0,o=0){return this.a=e,this.b=n,this.c=s,this.d=i,this.tx=r,this.ty=o,this},to_array(e=!1,n){!n&&!this._array&&(this._array=new Array(9));const s=n||this._array;return e?(s[0]=this.a,s[1]=this.c,s[2]=this.tx,s[3]=this.b,s[4]=this.d,s[5]=this.ty,s[6]=0,s[7]=0,s[8]=1):(s[0]=this.a,s[1]=this.b,s[2]=0,s[3]=this.c,s[4]=this.d,s[5]=0,s[6]=this.tx,s[7]=this.ty,s[8]=1),s},get_elements(e){switch(e){case 0:return new N(this.a,this.b);case 1:return new N(this.c,this.d);case 2:return new N(this.tx,this.ty)}},get_axis(e){switch(e){case 0:return new N(this.a,this.b);case 1:return new N(this.c,this.d);case 2:return new N(this.tx,this.ty)}},basis_determinant(){return this.a*this.d-this.b*this.c},equals(e){return this.a===e.a&&this.b===e.b&&this.c===e.c&&this.d===e.d&&this.tx===e.tx&&this.ty===e.ty},basis_xform(e,n=new N){const s=this.a*e.x+this.c*e.y,i=this.b*e.x+this.d*e.y;return n.set(s,i)},basis_xform_inv(e,n=new N){const s=this.a*e.x+this.b*e.y,i=this.c*e.x+this.d*e.y;return n.set(s,i)},xform(e,n=new N){const s=this.a*e.x+this.c*e.y+this.tx,i=this.b*e.x+this.d*e.y+this.ty;return n.set(s,i)},xform_vec(e,n=new N){const s=this.xform(N.ZERO),i=this.xform(e,n);return i.sub(s),i},xform_inv(e,n=new N){const s=this.a*(e.x-this.tx)+this.b*(e.y-this.ty),i=this.c*(e.x-this.tx)+this.d*(e.y-this.ty);return n.set(s,i)},xform_rect(e,n=new ye){n.set(0,0,0,0);const s=VM.set(this.a*e.width,this.b*e.width),i=HM.set(this.c*e.height,this.d*e.height),r=WM.set(e.x,e.y);this.xform(r,r),n.x=r.x,n.y=r.y;const o=YM.set(0,0);return n.expand_to(o.copy(r).add(s)),n.expand_to(o.copy(r).add(i)),n.expand_to(o.copy(r).add(s).add(i)),n},xform_inv_rect(e,n=new ye){const s=QM.set(e.x,e.y),i=ZM.set(e.x,e.y+e.height),r=qM.set(e.x+e.width,e.y+e.height),o=jM.set(e.x+e.width,e.y);return this.xform_inv(s,s),this.xform_inv(i,i),this.xform_inv(r,r),this.xform_inv(o,o),n.x=s.x,n.y=s.y,n.expand_to(i),n.expand_to(r),n.expand_to(o),n},translate(e,n){return this.tx+=e,this.ty+=n,this},untranslated(){const e=this.clone();return e.tx=0,e.ty=0,e},scale(e,n){return this.a*=e,this.d*=n,this.c*=e,this.b*=n,this.tx*=e,this.ty*=n,this},scale_basis(e,n){return this.a*=e,this.b*=n,this.c*=e,this.d*=n,this},rotate(e){const n=Math.cos(e),s=Math.sin(e),i=this.a,r=this.c,o=this.tx;return this.a=i*n-this.b*s,this.b=i*s+this.b*n,this.c=r*n-this.d*s,this.d=r*s+this.d*n,this.tx=o*n-this.ty*s,this.ty=o*s+this.ty*n,this},rotate_basis(e){const n=Math.cos(e),s=Math.sin(e);return this.a=n*this.a+s*this.c,this.b=n*this.b+s*this.d,this.c=-s*this.a+n*this.c,this.d=-s*this.b+n*this.d,this},translate_right(e,n){return this.append(new Ce(1,0,0,1,e,n)),this},scale_right(e,n){return this.append(new Ce(e,0,0,n,0,0)),this},skew_right(e,n){return this.append(new Ce(1,Math.tan(n),Math.tan(e),1,0,0)),this},rotate_right(e){const n=Math.cos(e),s=Math.sin(e);return this.append(new Ce(n,s,-s,n,0,0)),this},invert(){const e=this.b;this.b=this.c,this.c=e;const n=this.a*-this.tx+this.c*-this.ty,s=this.b*-this.tx+this.d*-this.ty;return this.tx=n,this.ty=s,this},inverse(){return this.clone().invert()},orthonormalize(){const e=new N(this.a,this.b),n=new N(this.c,this.d);return e.normalize(),this.a=e.x,this.b=e.y,n.subtract(e.scale(e.dot(n))),n.normalize(),this.c=n.x,this.d=n.y,this},orthonormalized(){return this.clone().orthonormalize()},append(e){const n=this.a,s=this.b,i=this.c,r=this.d;return this.a=e.a*n+e.b*i,this.b=e.a*s+e.b*r,this.c=e.c*n+e.d*i,this.d=e.c*s+e.d*r,this.tx=e.tx*n+e.ty*i+this.tx,this.ty=e.tx*s+e.ty*r+this.ty,this},set_transform(e,n,s,i,r,o,a,c,l){return this.a=Math.cos(a+l)*r,this.b=Math.sin(a+l)*r,this.c=-Math.sin(a-c)*o,this.d=Math.cos(a-c)*o,this.tx=e-(s*this.a+i*this.c),this.ty=n-(s*this.b+i*this.d),this},prepend(e){const n=this.tx;if(e.a!==1||e.b!==0||e.c!==0||e.d!==1){const s=this.a,i=this.c;this.a=s*e.a+this.b*e.c,this.b=s*e.b+this.b*e.d,this.c=i*e.a+this.d*e.c,this.d=i*e.b+this.d*e.d}return this.tx=n*e.a+this.ty*e.c+e.tx,this.ty=n*e.b+this.ty*e.d+e.ty,this},affine_inverse(){const e=this.a*this.d-this.b*this.c;if(e===0)return this.pseudoInverseAffine();const n=1/e,s=this.d;this.d=this.a,this.a=s,this.a*=n,this.b*=-n,this.c*=-n,this.d*=n;const i=this.a*-this.tx+this.c*-this.ty,r=this.b*-this.tx+this.d*-this.ty;return this.tx=i,this.ty=r,this},pseudoInverseAffine(){const e=this.a*this.a+this.b*this.b,n=this.c*this.c+this.d*this.d;if(e===0&&n===0)return this.tx*=-1,this.ty*=-1,this;e===0?(this.a=0,this.b/=n,this.c=0,this.d/=n):(this.a/=e,this.b=0,this.c/=e,this.d=0);const s=this.a*-this.tx+this.c*-this.ty,i=this.b*-this.tx+this.d*-this.ty;return this.tx=s,this.ty=i,this},identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},interpolate(e,n){const s=ps.lerp(this.get_scale().x,e.get_scale().x,n),i=ps.lerp(this.get_scale().y,e.get_scale().y,n),r=ps.lerp_angle(this.get_rotation(),e.get_rotation(),n),o=ps.lerp(this.get_origin().x,e.get_origin().x,n),a=ps.lerp(this.get_origin().y,e.get_origin().y,n);return this.set_transform(o,a,0,0,s,i,r,0,0),this},clone(){return new Ce(this.a,this.b,this.c,this.d,this.tx,this.ty)},copy(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this},decompose2(){const e=this;let n=0;const s=new N,i=new N;n=Math.atan2(this.b,this.a);const r=Math.atan2(this.d,this.c)-Math.PI/2-n;return i.set(-r,0),s.set(Math.sqrt(this.a*this.a+this.b*this.b),Math.sqrt(this.c*this.c+this.d*this.d)*Math.cos(r)),{translation:new N(e.tx,e.ty),rotation:n,scale:s,skew:i}},decompose(){const e=this.a,n=this.b,s=this.c,i=this.d,r=this.tx,o=this.ty,a=e*i-n*s,c=Math.sqrt(e*e+n*n),l={translation:new N(r,o),rotation:0,scale:new N(1,1),skew:new N(0,0)};return e===n&&n===s&&s===i?(l.rotation=0,l.skew.x=0,l.scale.x=0,l.scale.y=0):e===0&&n===0?(l.rotation=-Math.atan2(s,i),l.skew.x=0,l.scale.x=0,l.scale.y=Math.sqrt(s*s+i*i)):s===0&&i===0?(l.rotation=-Math.atan2(-n,e),l.skew.x=0,l.scale.x=c,l.scale.y=0):(l.rotation=-Math.atan2(-n,e),l.skew.x=Math.atan2(e*s+n*i,a),l.scale.x=c,l.scale.y=a/c),l}},Ce.IDENTITY=new Ce;const VM=new N,HM=new N,WM=new N,YM=new N,XM=new N,zM=new N,KM=new N,QM=new N,ZM=new N,qM=new N,jM=new N;function JM(e,n,s,i,r,o,a,c){const l=[e.clone().sub(n),e.clone().sub(s),o.clone().sub(c),o.clone().sub(r)];let h=!0;for(const d of l)h&&!$M(d,e,n,s,i,r,o,a,c)&&(h=!1);return h}function $M(e,n,s,i,r,o,a,c,l){const h=1/e.length_squared(),d=e.dot(n)*h,p=e.dot(s)*h,E=e.dot(i)*h,g=e.dot(r)*h,T=e.dot(o)*h,A=e.dot(a)*h,m=e.dot(c)*h,O=e.dot(l)*h,S=Math.min(d,p,E,g),y=Math.max(d,p,E,g),v=Math.min(T,A,m,O),R=Math.max(T,A,m,O);return S<=R&&y>=v}const e2=.02,t2=256,Op=.001,Xt=.1,Es=Xt*.9995,mu=1e3,NO={color:8947848,padding:5},n2=65535,gs={line:1,quadratic:2,serpentine:3,cusp:4,loop:5,arch:6},s2=1e-8;function Ou(e,n,s,i){return e[0]=n,e[1]=s,e[2]=i,e}function Ip(e,n,s){const i=n[0],r=n[1],o=n[2],a=s[0],c=s[1],l=s[2];return e[0]=r*l-o*c,e[1]=o*a-i*l,e[2]=i*c-r*a,e}function Sp(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]}function Cl(e){return e>=0?e<s2:e>-1e-8}const Iu=[0,0,0],yp=[0,0,0],Cp=[0,0,0],Np=[0,0,0],xO=[0,0],vO=[0,0],RO=[0,0];function i2(e,n,s,i,r,o,a,c){Ou(Iu,e,n,1),Ou(yp,s,i,1),Ou(Cp,r,o,1),Ou(Np,a,c,1),Ip(xO,Np,Cp),Ip(vO,Iu,Np),Ip(RO,yp,Iu);const l=Sp(Iu,xO),h=Sp(yp,vO),d=Sp(Cp,RO),p=l-2*h+3*d,E=-h+3*d,g=3*d,T=3*E*E-4*p*g,A=p*p*T;return Cl(A)?Cl(p)&&Cl(E)?Cl(g)?gs.line:gs.quadratic:Cl(p)?T<0?gs.loop:gs.serpentine:gs.cusp:A>0?gs.serpentine:gs.loop}const r2=[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],o2=[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]],rs=Math.abs,wO=Math.sqrt,DO=Math.pow,a2=Math.log2||function(e){return Math.log(e)*Math.LOG2E},Nl=(e,n,s)=>e<n?n:e>s?s:e,Kn={getDiscriminant(e,n,s){function i(a){const c=a*134217729,h=a-c+c,d=a-h;return[h,d]}let r=n*n-e*s;const o=n*n+e*s;if(rs(r)*3<o){const a=i(e),c=i(n),l=i(s),h=n*n,d=c[0]*c[0]-h+2*c[0]*c[1]+c[1]*c[1],p=e*s,E=a[0]*l[0]-p+a[0]*l[1]+a[1]*l[0]+a[1]*l[1];r=h-p+(d-E)}return r},getNormalizationFactor(...e){const n=Math.max(...e);return n&&(n<1e-8||n>1e8)?DO(2,-Math.round(a2(n))):0},isZero:function(e){return e>=-1e-12&&e<=Xn},isMachineZero:function(e){return e>=-112e-18&&e<=Lf},clamp:Nl,integrate:function(e,n,s,i){let r=0;const o=r2[i-2],a=o2[i-2],c=(s-n)*.5,l=c+n,h=i+1>>1;let d=i&1?a[r++]*e(l):0;for(;r<h;){const p=c*o[r];d+=a[r++]*(e(l+p)+e(l-p))}return c*d},findRoot:function(e,n,s,i,r,o,a){for(let c=0;c<o;c++){const l=e(s),h=l/n(s),d=s-h;if(rs(h)<a){s=d;break}l>0?(r=s,s=d<=i?(i+r)*.5:d):(i=s,s=d>=r?(i+r)*.5:d)}return Nl(s,i,r)},solveQuadratic:function(e,n,s,i,r,o){let a,c=1/0;if(rs(e)<Xn){if(rs(n)<Xn)return rs(s)<Xn?-1:0;a=-s/n}else{n*=-.5;let E=Kn.getDiscriminant(e,n,s);if(E&&rs(E)<Lf){const g=Kn.getNormalizationFactor(rs(e),rs(n),rs(s));g&&(e*=g,n*=g,s*=g,E=Kn.getDiscriminant(e,n,s))}if(E>=-112e-18){const g=E<0?0:wO(E),T=n+(n<0?-g:g);T===0?(a=s/e,c=-a):(a=T/e,c=s/T)}}let l=0;const h=r==null,d=r-Xn,p=o+Xn;return isFinite(a)&&(h||a>d&&a<p)&&(i[l++]=h?a:Nl(a,r,o)),c!==a&&isFinite(c)&&(h||c>d&&c<p)&&(i[l++]=h?c:Nl(c,r,o)),l},solveCubic:function(e,n,s,i,r,o,a){const c=Kn.getNormalizationFactor(rs(e),rs(n),rs(s),rs(i));let l,h,d,p,E;c&&(e*=c,n*=c,s*=c,i*=c);function g(m){l=m;const O=e*l;h=O+n,d=h*l+s,p=(O+h)*l+d,E=d*l+i}if(rs(e)<Xn)e=n,h=s,d=i,l=1/0;else if(rs(i)<Xn)h=n,d=s,l=0;else{g(-(n/e)/3);const m=E/e,O=DO(rs(m),1/3),S=m<0?-1:1,y=-p/e,v=y>0?1.324717957244746*Math.max(O,wO(y)):O;let R=l-S*v;if(R!==l){do g(R),R=p===0?l:l-E/p/(1+Lf);while(S*R>S*l);rs(e)*l*l>rs(i/l)&&(d=-i/l,h=(d-s)/l)}}let T=Kn.solveQuadratic(e,h,d,r,o,a);const A=o==null;return isFinite(l)&&(T===0||T>0&&l!==r[0]&&l!==r[1])&&(A||l>o-Xn&&l<a+Xn)&&(r[T++]=A?l:Nl(l,o,a)),T}};function Qn(){this._px=void 0,this._py=void 0,this._vx=void 0,this._vy=void 0}Qn.intersect=(e,n,s,i,r,o,a,c,l,h)=>{l||(s-=e,i-=n,a-=r,c-=o);const d=s*c-i*a;if(!Kn.isMachineZero(d)){const p=e-r,E=n-o;let g=(a*E-c*p)/d;const T=(s*E-i*p)/d,A=Xn,m=-1e-12,O=1+A;if(h||m<g&&g<O&&m<T&&T<O)return h||(g=g<=0?0:g>=1?1:g),new N(e+g*s,n+g*i)}},Qn.getSide=(e,n,s,i,r,o,a,c)=>{a||(s-=e,i-=n);const l=r-e,h=o-n;let d=l*i-h*s;return!c&&Kn.isMachineZero(d)&&(d=(l*s+l*s)/(s*s+i*i),d>=0&&d<=1&&(d=0)),d<0?-1:d>0?1:0},Qn.getSignedDistance=(e,n,s,i,r,o,a)=>(a||(s-=e,i-=n),s===0?i>0?r-e:e-r:i===0?s<0?o-n:n-o:((r-e)*i-(o-n)*s)/(i>s?i*MO(1+s*s/(i*i)):s*MO(1+i*i/(s*s)))),Qn.getDistance=(e,n,s,i,r,o,a)=>LO(Qn.getSignedDistance(e,n,s,i,r,o,a)),Qn.prototype={constructor:Qn,initN(e,n,s,i){return this._px=e,this._py=n,this._vx=s-e,this._vy=i-n,this},initP(e,n){return this.initN(e.x,e.y,n.x,n.y)},getP0(){return new N(this._px,this._py)},getP1(){return new N(this._px+this._vx,this._py+this._vy)},getVector(){return new N(this._vx,this._vy)},getLength(){return this.getVector().length()},intersect(e,n){return Qn.intersect(this._px,this._py,this._vx,this._vy,e._px,e._py,e._vx,e._vy,!0,n)},getSide(e,n){return Qn.getSide(this._px,this._py,this._vx,this._vy,e.x,e.y,!0,n)},getDistance(e){return LO(this.getSignedDistance(e))},getSignedDistance(e){return Qn.getSignedDistance(this._px,this._py,this._vx,this._vy,e.x,e.y,!0)},isCollinear(e){return N.isCollinear(this._vx,this._vy,e._vx,e._vy)},isOrthogonal(e){return N.isOrthogonal(this._vx,this._vy,e._vx,e._vy)},eval(e){return new N(this._px+ps.lerp(0,this._vx,e),this._py+ps.lerp(0,this._vy,e))},nearest(e,n){const s=this.getP0(),i=this.getVector(),r=s.clone().add(i),o=i.dot(e.clone().sub(s)),a=i.dot(i);let c=0,l=0;return o<=0?(c=0,l=e.distance_squared_to(s)):o>=a?(c=1,l=e.distance_squared_to(r)):(c=o/a,l=this.eval(c).sub(e).length_squared()),{distance_sq:l,t:c}}};const LO=Math.abs,MO=Math.sqrt,PO=Math.min,bO=Math.max;function c2(e,n,s){function i(a){const c=new Array(a.length);for(let l=0;l<a.length;l++){const h=a[l].getBounds();c[l]=[h.left,h.top,h.right,h.bottom]}return c}const r=i(e);return Su(r,r,s)}function UO(e,n,s,i){const r=c=>{const l=Array(c.length);for(let h=0;h<c.length;h++){const d=c[h];l[h]=[PO(d[0],d[2],d[4],d[6]),PO(d[1],d[3],d[5],d[7]),bO(d[0],d[2],d[4],d[6]),bO(d[1],d[3],d[5],d[7])]}return l},o=r(e),a=!n||n===e?o:r(n);if(i){const c=Su(o,a,s||0,!1,!0),l=Su(o,a,s||0,!0,!0),h=[];for(let d=0,p=c.length;d<p;d++)h[d]={hor:c[d],ver:l[d]};return h}return Su(o,a,s||0)}function Su(e,n,s,i,r){const o=!n||e===n,a=o?e:e.concat(n),c=e.length,l=a.length,h=(O,S,y)=>{let v=0,R=O.length;for(;v<R;){const M=R+v>>>1;a[O[M]][S]<y?v=M+1:R=M}return v-1},d=i?1:0,p=d+2,E=i?0:1,g=E+2,T=Array(l);for(let O=0;O<l;O++)T[O]=O;T.sort(function(O,S){return a[O][d]-a[S][d]});const A=[],m=Array(c);for(let O=0;O<l;O++){const S=T[O],y=a[S],v=o?S:S-c,R=S<c,M=o||!R;let L=R?[]:null;if(A.length){const P=h(A,p,y[d]-s)+1;if(A.splice(0,P),o&&r){L=L.concat(A);for(let k=0;k<A.length;k++){const Q=A[k];m[Q].push(v)}}else{const k=y[g],Q=y[E];for(let b=0;b<A.length;b++){const X=A[b],K=a[X],V=X<c,J=o||X>=c;(r||(R&&J||M&&V)&&k>=K[E]-s&&Q<=K[g]+s)&&(R&&J&&L.push(o?X:X-c),M&&V&&m[X].push(v))}}}if(R&&(e===n&&L.push(S),m[S]=L),A.length){const P=y[p],k=h(A,p,P);A.splice(k+1,0,S)}else A.push(S)}for(let O=0;O<m.length;O++){const S=m[O];S&&S.sort(function(y,v){return y-v})}return m}const Aa={APPEARANCE:1,GEOMETRY:8,SEGMENTS:32},xl={GEOMETRY:Aa.GEOMETRY|Aa.APPEARANCE,SEGMENTS:Aa.SEGMENTS|Aa.GEOMETRY|Aa.APPEARANCE};function Fe(){this._point=new N,this._handleIn=new N,this._handleOut=new N,this._path=null,this._intersection=null,this._index=null,this._winding=null,this._visited=null}Fe.prototype={constructor:Fe,initP(e){return this.initN(e.x,e.y)},initN(e,n){return this._point.set(e,n),this._handleIn.set(0,0),this._handleOut.set(0,0),this._changed(this._point),this._changed(this._handleIn),this._changed(this._handleOut),this},initWithPoints(e,n,s){return this._point.set(e.x,e.y),this._changed(this._point),n&&(this._handleIn.set(n.x,n.y),this._changed(this._handleIn)),s&&(this._handleOut.set(s.x,s.y),this._changed(this._handleOut)),this},initWithPointsN(e,n,s,i,r,o){return this._point.set(e,n),this._handleIn.set(s,i),this._handleOut.set(r,o),this._changed(this._point),this._changed(this._handleIn),this._changed(this._handleOut),this},setPoint(e){this._point.set(e.x,e.y),this._changed(this._point)},setHandleIn(e){this._handleIn.set(e.x,e.y),this._changed(this._handleIn)},setHandleInN(e,n){this._handleIn.set(e,n),this._changed(this._handleIn)},setHandleOut(e){this._handleOut.set(e.x,e.y),this._changed(this._handleOut)},setHandleOutN(e,n){this._handleOut.set(e,n),this._changed(this._handleOut)},copy(e){return this.initWithPoints(e._point,e._handleIn,e._handleOut)},clone(){return new Fe().initWithPoints(this._point,this._handleIn,this._handleOut)},remove(){return this._path?!!this._path.removeSegment(this._index):!1},isFirst(){return!this._index},isLast(){const e=this._path;return e&&this._index===e._segments.length-1||!1},getPrevious(){const e=this._path&&this._path._segments;return e&&(e[this._index-1]||this._path._closed&&e[e.length-1])||null},getNext(){const e=this._path&&this._path._segments;return e&&(e[this._index+1]||this._path._closed&&e[0])||null},getCurve(){const e=this._path;let n=this._index;return e?(n>0&&!e._closed&&n===e._segments.length-1&&n--,e.getCurves()[n]||null):null},hasHandles(e){return!this._handleIn.is_zero(e)||!this._handleOut.is_zero(e)},_transformCoordinates(e){const n=this._point.x,s=this._point.y;let i=2;return e[0]=n,e[1]=s,this._handleIn&&(e[i++]=this._handleIn.x+n,e[i++]=this._handleIn.y+s),this._handleOut&&(e[i++]=this._handleOut.x+n,e[i++]=this._handleOut.y+s),e},_changed(e){const n=this._path;if(!n)return;const s=n._curves,i=this._index;let r;s&&((!e||e===this._point||e===this._handleIn)&&(r=i>0?s[i-1]:n._closed?s[s.length-1]:null)&&r._changed(),(!e||e===this._point||e===this._handleOut)&&(r=s[i])&&r._changed()),n._changed(xl.SEGMENTS)},toString(){return`Segment{ p:[${this._point.x}, ${this._point.y}], i:[${this._handleIn.x}, ${this._handleIn.y}], o:[${this._handleOut.x}, ${this._handleOut.y}] }`}};function yu(){this.p0=new N,this.p1=new N,this.p2=new N,this._bounds=null}yu.prototype={constructor:yu,initN(e,n,s,i,r,o){return this.p0.set(e,n),this.p1.set(s,i),this.p2.set(r,o),this},eval(e){const n=1-e;return this.p0.clone().scale(n*n).add(this.p1.clone().scale(n*2).add(this.p2.clone().scale(e)).scale(e))},deriv(){return new Qn().initN(2*(this.p1.x-this.p0.x),2*(this.p1.y-this.p0.y),2*(this.p2.x-this.p1.x),2*(this.p2.y-this.p1.y))},nearest(e,n){const s=this.p1.clone().sub(this.p0),i=this.p1.clone().scale(-2).add(this.p0).add(this.p2),r=this.p0.clone().sub(e),o=r.dot(s),a=2*s.length_squared()+r.dot(i),c=3*i.dot(s),l=i.length_squared(),h=Up(o,a,c,l),d={r_best:null,t_best:0};let p=!1;for(let E=0,g=h.length;E<g;E++)p|=l2(this,e,d,h[E]);return p&&(xp(e,d,0,this.p0),xp(e,d,1,this.p2)),{t:d.t_best,distance_sq:d.r_best}},getBounds(){if(this._bounds==null){const e=[this.p0,this.p1,this.p2];let n=e[0].x,s=e[0].y,i=e[0].x,r=e[0].y;for(let o=1;o<3;o++){const{x:a,y:c}=e[o];n=Math.min(n,a),s=Math.min(s,c),i=Math.max(i,a),r=Math.max(r,c)}this._bounds=new ye(n,s,i-n,r-s)}return this._bounds}};function xp(e,n,s,i){const r=i.distance_squared_to(e);(Number.isFinite(n.r_best)?r<n.r_best:!0)&&(n.r_best=r,n.t_best=s)}function l2(e,n,s,i){return i<0||i>1?!0:(xp(n,s,i,e.eval(i)),!1)}const GO={[an.SUBTRACT]:"subtract",[an.INTERSECT]:"intersect",[an.DIFFERENCE]:"exclude",[an.UNION]:"union"};function Ct(){this._closed=!1,this._segments=[],this._curves=null,this._bounds=null,this._version=0,this._length=null,this._area=null,this._overlapsOnly=!1,this._id=kO++}Ct.prototype={constructor:Ct,toPathData(){const e=this._segments,n=e.length,s=Array(6);let i=!0,r=0,o=0,a=0,c=0,l=0,h=0,d=0,p=0;const E={commands:[],vertices:[]};function g(A,m){const{x:O,y:S}=A._point;m[0]=O,m[1]=S,m[2]=A._handleIn.x+O,m[3]=A._handleIn.y+S,m[4]=A._handleOut.x+O,m[5]=A._handleOut.y+S}function T(A,m){g(A,s),r=s[0],o=s[1],i?(E.commands.push(1),E.vertices.push(r,o),i=!1):(l=s[2],h=s[3],l===r&&h===o&&d===a&&p===c?(E.commands.push(2),E.vertices.push(r,o)):(E.commands.push(4),E.vertices.push(d,p,l,h,r,o))),a=r,c=o,d=s[4],p=s[5]}if(!n)return E;for(let A=0;A<n;A++)T(e[A]);return this._closed&&n>0&&T(e[0]),this._closed&&E.commands.push(5),E},toSVG(e=!1,n=5){bi.setup(n);const s=this._segments,i=s.length,r=Array(6);let o=!0,a=0,c=0,l=0,h=0,d=0,p=0,E=0,g=0;const T=[];function A(O,S){const{x:y,y:v}=O._point;S[0]=y,S[1]=v,S[2]=O._handleIn.x+y,S[3]=O._handleIn.y+v,S[4]=O._handleOut.x+y,S[5]=O._handleOut.y+v}function m(O,S){if(A(O,r),a=r[0],c=r[1],o)T.push("M"+bi.pair(a,c)),o=!1;else if(d=r[2],p=r[3],d===a&&p===c&&E===l&&g===h){if(!S)if(e)T.push(`L${bi.pair(a,c)}`);else{const y=a-l,v=c-h;T.push(y===0?`v${bi.number(v)}`:v===0?`h${bi.number(y)}`:`l${bi.pair(y,v)}`)}}else e?T.push("C"+bi.pair(E,g)+" "+bi.pair(d,p)+" "+bi.pair(a,c)):T.push("c"+bi.pair(E-l,g-h)+" "+bi.pair(d-l,p-h)+" "+bi.pair(a-l,c-h));l=a,h=c,E=r[4],g=r[5]}if(!i)return"";for(let O=0;O<i;O++)m(s[O],!1);return this._closed&&i>0&&m(s[0],!0),this._closed&&T.push("z"),T.join("")},toString(){return this._segments.join(", ")},clear(){return this._closed=!1,this._segments.length=0,this._curves=null,this._bounds=null,this._version=0,this._length=null,this._area=null,this._overlapsOnly=!1,this._id=kO++,this},close(e=0){this.setClosed(!0),this.join(this,e)},join(e,n=0){const s=n||0;if(e&&e!==this){const o=e._segments,a=this.getLastSegment();let c=e.getLastSegment();if(!c)return-1;a&&a._point.isClose(c._point,s)&&e.reverse();const l=e.getFirstSegment();if(a&&a._point.isClose(l._point,s))a.setHandleOut(l._handleOut),this._add(o.slice(1));else{const h=this.getFirstSegment();h&&h._point.isClose(l._point,s)&&e.reverse(),c=e.getLastSegment(),h&&h._point.isClose(c._point,s)?(h.setHandleIn(c._handleIn),this._add(o.slice(0,o.length-1),0)):this._add(o.slice())}e._closed&&this._add([o[0]]),e.remove()}const i=this.getFirstSegment(),r=this.getLastSegment();return i!==r&&i._point.isClose(r._point,s)?(i.setHandleIn(r._handleIn),r.remove(),this.setClosed(!0),2):1},compare(e){const n=this.getCurves(),s=e.getCurves(),i=n.length,r=s.length;if(!i||!r)return i===r;let o=n[0].getValues();const a=[];let c=0,l=0,h,d;for(let T=0;T<r;T++){const A=s[T].getValues();a.push(A);const m=Gp(o,A);if(m){h=!T&&m[0][0]>0?r-1:T,d=m[0][1];break}}const p=Fs;let E=a[h],g;for(;o&&E;){const T=Gp(o,E);if(T){const A=T[0][0];if(di(A-l)<p){l=T[1][0],l===1&&(o=++c<i?n[c].getValues():null,l=0);const m=T[0][1];if(di(m-d)<p){if(g||(g=[h,m]),d=T[1][1],d===1&&(++h>=r&&(h=0),E=a[h]||s[h].getValues(),d=0),!o)return g[0]===h&&g[1]===d;continue}}}break}return!1},setSegments(e){let n=e.length;if(this._segments.length=0,this._curves=null,n>0){const s=e[n-1];typeof s=="boolean"&&(this.setClosed(s),n--),this._add(e)}return this},removeSegment(e){return this.removeSegments(e,e+1)[0]||null},removeSegments(e,n,s=!1){e=e||0,n=n||this._segments.length;const i=this._segments;let r=this._curves;const o=i.length,a=i.splice(e,n-e),c=a.length;if(!c)return a;for(let l=0;l<c;l++){const h=a[l];h._index=null,h._path=null}for(let l=e,h=i.length;l<h;l++)i[l]._index=l;if(r){const l=e>0&&n===o+(this._closed?1:0)?e-1:e;r=r.splice(l,c);for(let h=r.length-1;h>=0;h--)r[h]._path=null;s&&(a._curves=r.slice(1)),this._adjustCurves(l,l)}return this._changed(xl.SEGMENTS),a},setClosed(e){if(this._closed!=(e=!!e)){if(this._closed=e,this._curves){const n=this._countCurves();this._curves.length=n,e&&(this._curves[n-1]=new ae().initWithPathAndSegments(this,this._segments[n-1],this._segments[0]))}this._changed(xl.SEGMENTS)}},isClockwise(){return this.getArea()>=0},setClockwise(e){this.isClockwise()!==!!e&&this.reverse()},isEmpty(){return this._segments.length===0},getLength(){if(this._length==null){const e=this.getCurves();let n=0;for(let s=0,i=e.length;s<i;s++)n+=e[s].getLength();this._length=n}return this._length},getArea(){let e=this._area;if(e==null){e=0;const n=this._segments,s=this._closed;for(let i=0,r=n.length;i<r;i++){const o=i+1===r;e+=ae.getArea(ae.getValues(n[i],n[o?0:i+1],o&&!s))}this._area=e}return e},getFillRule(){return"nonzero"},getFirstSegment(){return this._segments[0]},getLastSegment(){return this._segments[this._segments.length-1]},getCurves(){if(!this._curves){const e=this._countCurves();this._curves=new Array(e);for(let n=0;n<e;n++)this._curves[n]=new ae().initWithPathAndSegments(this,this._segments[n],this._segments[n+1]||this._segments[0])}return this._curves},getLastCurve(){const e=this.getCurves();return e[e.length-1]},getPointAt(e){const n=this.getLocationAt(e);return n&&n.getPoint()},getLocationAt(e){if(typeof e=="number"){const n=this.getCurves();let s=0;for(let i=0,r=n.length;i<r;i++){const o=s,a=n[i];if(s+=a.getLength(),s>e)return a.getLocationAt(e-o)}if(n.length>0&&e<=this.getLength())return new qs().init(n[n.length-1],1)}else if(e&&e.getPath&&e.getPath()===this)return e;return null},getBounds(){return this._bounds==null&&(this._bounds=Ct.getBounds(this._segments,this._closed)),this._bounds},getHandleBounds(){return Ct.getHandleBounds(this._segments,this._closed)},getInteriorPoint(){return QO(this)},_contains(e){const n=e.isInside(this.getHandleBounds())?this._getWinding(e):{};return n.onPath||!!(this.getFillRule()==="evenodd"?n.windingL&1||n.windingR&1:n.winding)},contains(e){return!!this._contains(e)},reduce(e=!1){const n=this.getCurves(),s=e?tr:0;for(let i=n.length-1;i>=0;i--){const r=n[i];!r.hasHandles()&&(!r.hasLength(s)||e&&r.isCollinear(r.getNext()))&&r.remove()}return this},reverse(){this._segments.reverse();for(let e=0,n=this._segments.length;e<n;e++){const s=this._segments[e],i=s._handleIn;s._handleIn=s._handleOut,s._handleOut=i,s._index=e}this._curves=null,this._changed(xl.GEOMETRY)},transform(e){for(let n=0,s=this._segments.length;n<s;n++){const i=this._segments[n];e.xform(i._point,i._point),e.basis_xform(i._handleIn,i._handleIn),e.basis_xform(i._handleOut,i._handleOut)}return this},clone(){return Dp(this)},getIntersections(e,n){return YO(this,e,n)},resolveCrossings(){return zO(this)},reorient(e,n){return KO(this,e,n)},insert(e,n){return this._add([n],e)},add(e){return this._add([e])[0]},_add(e,n){const s=!Number.isFinite(n);s&&(n=this._segments.length);const i=e.length;for(let r=0;r<i;r++){let o=e[r];o._path&&(o=o.clone(),e[r]=o),o._path=this,o._index=n+r}if(s)ma(this._segments,e);else{this._segments.splice.apply(this._segments,[n,0].concat(e));for(let r=n+i,o=this._segments.length;r<o;r++)this._segments[r]._index=r}if(this._curves){const r=this._countCurves(),o=n>0&&n+i-1===r?n-1:n;let a=o;const c=Math.min(o+i,r);e._curves&&(this.curves.splice.apply(this._curves,[o,0].concat(e._curves)),a+=e._curves.length);for(let l=a;l<c;l++)this._curves.splice(l,0,new ae().initWithPathAndSegments(this,null,null));this._adjustCurves(o,c)}return this._changed(xl.SEGMENTS),e},_remove(){return wp(this)},remove(){return wp(this)},_countCurves(){const e=this._segments.length;return!this._closed&&e>0?e-1:e},_adjustCurves(e,n){const s=this._segments,i=this._curves;let r;for(let o=e;o<n;o++)r=i[o],r._path=this,r._segment1=s[o],r._segment2=s[o+1]||s[0],r._changed();(r=i[this._closed&&!e?s.length-1:e-1])&&(r._segment2=s[e]||s[0],r._changed()),(r=i[n])&&(r._segment1=s[n],r._changed())},_getWinding(e,n,s){return Ru(e,this.getCurves(),n,s)},_changed(e){if(e&Aa.GEOMETRY){if(this._bounds=null,this._length=null,this._area=null,e&Aa.SEGMENTS)this._version++;else if(this._curves)for(let n=0,s=this._curves.length;n<s;n++)this._curves[n]._changed()}},trim(e,n,s=!1){const i=this.getCurves();if(i.length===0)return this;const r=[];let o=0;for(let T=0;T<i.length;T++){const A=i[T].getLength();r.push(A),o+=A}const a=e*o,c=n*o;let l=0,h=0,d=0,p=0,E=0;for(let T=0;T<i.length&&(E<a&&(l=T,d=a-E),E<c&&(h=T,p=c-E),!(E>=a&&E>=c));T++)E+=r[T];const g=[];if(s){const T=[],A=[],m=i[l].getValues(),O=i[h].getValues(),S=ae.subdivide(m,ae.getTimeAt(m,d))[1],y=ae.subdivide(O,ae.getTimeAt(O,p))[0];T.push(new Fe().initWithPointsN(S[0],S[1],S[0]-S[2],S[1]-S[3],S[2]-S[0],S[3]-S[1]),new Fe().initWithPointsN(S[6],S[7],S[4]-S[6],S[5]-S[7],0,0));let v=!0;for(let R=l+1;R<i.length;R++)v&&(i[R]._segment1._handleIn=T.pop()._handleIn,T.push(i[R]._segment1),v=!1),T.push(i[R]._segment2);if(this._closed){for(let M=0;M<=h-1;M++)v&&(i[M]._segment1._handleIn=T.pop()._handleIn,T.push(i[M]._segment1),v=!1),T.push(i[M]._segment2);const R=T.pop();T.push(new Fe().initWithPointsN(y[0],y[1],R._handleIn.x,R._handleIn.y,y[2]-y[0],y[3]-y[1])),T.push(new Fe().initWithPointsN(y[6],y[7],y[4]-y[6],y[5]-y[7],0,0)),g.push(new Ct().setSegments(T))}else{let R=!0;for(let M=0;M<=h-1;M++)R&&(A.push(i[M]._segment1),R=!1),A.push(i[M]._segment2);if(R)A.push(new Fe().initWithPointsN(y[0],y[1],0,0,y[2]-y[0],y[3]-y[1]));else{const M=A.pop();A.push(new Fe().initWithPointsN(y[0],y[1],M._handleIn.x,M._handleIn.y,y[2]-y[0],y[3]-y[1]))}A.push(new Fe().initWithPointsN(y[6],y[7],y[4]-y[6],y[5]-y[7],y[6]-y[4],y[7]-y[5])),g.push(new Ct().setSegments(T)),g.push(new Ct().setSegments(A))}}else{const T=[];if(l===h){const A=i[l].getValues(),m=ae.getPart(A,ae.getTimeAt(A,d),ae.getTimeAt(A,p));T.push(new Fe().initWithPointsN(m[0],m[1],m[0]-m[2],m[1]-m[3],m[2]-m[0],m[3]-m[1]),new Fe().initWithPointsN(m[6],m[7],m[4]-m[6],m[5]-m[7],0,0))}else{const A=i[l].getValues(),m=i[h].getValues(),O=ae.subdivide(A,ae.getTimeAt(A,d))[1],S=ae.subdivide(m,ae.getTimeAt(m,p))[0];T.push(new Fe().initWithPointsN(O[0],O[1],O[0]-O[2],O[1]-O[3],O[2]-O[0],O[3]-O[1]),new Fe().initWithPointsN(O[6],O[7],O[4]-O[6],O[5]-O[7],0,0));let y=!0;for(let R=l+1;R<=h-1;R++)y&&(i[R]._segment1._handleIn=T.pop()._handleIn,T.push(i[R]._segment1),y=!1),T.push(i[R]._segment2);const v=T.pop();T.push(new Fe().initWithPointsN(S[0],S[1],v._handleIn.x,v._handleIn.y,S[2]-S[0],S[3]-S[1])),T.push(new Fe().initWithPointsN(S[6],S[7],S[4]-S[6],S[5]-S[7],S[6]-S[4],S[7]-S[5]))}g.push(new Ct().setSegments(T))}return g},moveTo(e,n){return this._segments.length===1&&this.removeSegment(0),this._segments.length===0&&this._add([new Fe().initN(e,n)]),this},lineTo(e,n){this._add([new Fe().initN(e,n)])},cubicCurveTo(e,n,s,i,r,o){const a=this.getLastSegment();a.setHandleOut(new N(e,n).subtract(a._point)),this._add([new Fe().initWithPointsN(r,o,s-r,i-o)])},quadraticCurveTo(e,n,s,i){const r=this.getLastSegment()._point,o=new N(e,n),a=new N(s,i),c=o.clone().add(r.clone().subtract(o).multiply(1/3,1/3)),l=o.clone().add(a.clone().subtract(o).multiply(1/3,1/3)),h=a;this.cubicCurveTo(c.x,c.y,l.x,l.y,h.x,h.y)},arcTo(e,n,s,i,r,o){const a=new N(e,n);i*=Math.PI/180;const c=this.getLastSegment(),l=c._point,h=Kn.isZero;if(h(s.width)||h(s.height))return this.lineTo(a.x,a.y);const d=l.clone().add(a.x,a.y).divide(2,2),p=l.clone().subtract(d.x,d.y).rotate(-i),E=p.x,g=p.y;let T=di(s.width),A=di(s.height),m=T*T,O=A*A;const S=E*E,y=g*g;let v=qO(S/m+y/O);if(v>1&&(T*=v,A*=v,m=T*T,O=A*A),v=(m*O-m*y-O*S)/(m*y+O*S),di(v)<Xn&&(v=0),v<0)throw new Error("Cannot create an arc with the given arguments");const R=(o===r?-1:1)*qO(v),M=new N(T*g/A,-A*E/T).multiply(R,R).rotate(i).clone().add(d),L=new Ce().translate(M.x,M.y).rotate_basis(i).scale_basis(T,A),P=new N;new Ce().copy(L).affine_inverse().xform(l,P);const k=new N;new Ce().copy(L).affine_inverse().xform(a,k);let Q=P.angle_to(k)*180/Math.PI;if(!r&&Q>0?Q-=360:r&&Q<0&&(Q+=360),Q){const b=Jx,X=di(Q),K=X>=360?4:Math.ceil((X-b)/90),V=Q/K,J=V*Math.PI/360,ge=4/3*Math.sin(J)/(1+Math.cos(J)),se=[];let ue=new N;for(let te=0;te<=K;te++){ue.copy(a);let ie=null;if(te<K&&(ie=P.clone().rotate(90*Math.PI/180).multiply(ge,ge),L?(L.xform(P,ue),L.xform(P.clone().add(ie),ie),ie.subtract(ue)):ue=M.clone().add(P)),!te)c.setHandleOut(ie);else{const re=P.clone().rotate(-90*Math.PI/180).multiply(ge,ge);L&&(L.xform(P.clone().add(re),re),re.subtract(ue)),se.push(new Fe().initWithPoints(ue,re,ie))}P.rotate(V*Math.PI/180)}this._add(se)}}},Ct.createPath=(e,n)=>{const s=new Ct;return s._add(e),s._closed=n,s},Ct.makeRectN=(e,n,s,i)=>{const r=s/2,o=i/2;return Ct.createPath([new Fe().initWithPointsN(e-r,n+o,0,0,0,0),new Fe().initWithPointsN(e-r,n-o,0,0,0,0),new Fe().initWithPointsN(e+r,n-o,0,0,0,0),new Fe().initWithPointsN(e+r,n+o,0,0,0,0)],!0).transform(new Ce().translate(r,o))},Ct.makeCircleN=(e,n,s)=>{const r=s*.55228475;return Ct.createPath([new Fe().initWithPointsN(e-s,n,0,r,0,-r),new Fe().initWithPointsN(e,n-s,-r,0,r,0),new Fe().initWithPointsN(e+s,n,0,-r,0,r),new Fe().initWithPointsN(e,n+s,r,0,-r,0)],!0)},Ct.getBounds=(e,n)=>{const s=e[0];if(!s)return new ye;const i=new Array(6),r=s._transformCoordinates(new Array(6)),o=r.slice(0,2),a=o.slice(),c=new Array(2);for(let l=1,h=e.length;l<h;l++)BO(e[l],i,r,o,a,c);return n&&BO(s,i,r,o,a,c),new ye(o[0],o[1],a[0]-o[0],a[1]-o[1])},Ct.getHandleBounds=(e,n)=>{const s=new Array(6);let i=1/0,r=-i,o=i,a=r;for(let c=0,l=e.length;c<l;c++){e[c]._transformCoordinates(s);for(let d=0;d<6;d+=2){const p=s[d],E=s[d+1],g=p,T=p,A=E,m=E;g<i&&(i=g),T>r&&(r=T),A<o&&(o=A),m>a&&(a=m)}}return new ye(i,o,r-i,a-o)};function qe(){this._children=[],this._bounds=new ye,this.version=0,this._currentPoint=null}qe.prototype={constructor:qe,toSVG(e,n){let s="";for(let i=0,r=this._children.length;i<r;i++){const o=this._children[i];s+=o.toSVG(e,n)}return s},toPathData(){const e=new Bs;for(let n=0,s=this._children.length;n<s;n++){const r=this._children[n].toPathData();e.commands=e.commands.concat(r.commands),e.vertices=e.vertices.concat(r.vertices)}return e},transform(e){for(let n=0,s=this._children.length;n<s;n++)this._children[n].transform(e);return this},copy(e){return this.setChildren(e._children),this.version=e.version,this._bounds=e._bounds,this},clone(){return Dp(this)},isEmpty(){for(let e=0,n=this._children.length;e<n;e++)if(!this._children[e].isEmpty())return!1;return!0},remove(){return wp(this)},addChild(e){return this.insertChild(void 0,e),this},insertChild(e,n){return this.insertChildren(e,[n])[0]},addChildren(e){return this.insertChildren(this._children.length,e),this},insertChildren(e,n){const s=this._children;if(s&&n&&n.length>0){n=n.slice();const i={};for(let r=n.length-1;r>=0;r--){const o=n[r],a=o&&o._id;!o||i[a]?n.splice(r,1):(o._remove(),i[a]=!0)}Rp(s,n,e,0);for(let r=0,o=n.length;r<o;r++){const a=n[r];a._parent=this}}else n=null;return n},reduce(e=!1){for(let n=this._children.length-1;n>=0;n--){const s=this._children[n].reduce(e);s.isEmpty()&&s._remove()}if(!this._children.length){const n=new qe;return this.remove(),n}return this},getIntersections(e,n){return YO(this,e,n)},resolveCrossings(){return zO(this)},reorient(e,n){return KO(this,e,n)},setChildren(e){this.removeChildren(),this.addChildren(e)},removeChildren(e,n){if(!this._children)return null;e=e||0,n=n!==void 0?n:this._children.length;const s=Rp(this._children,null,e,n-e);for(let i=s.length-1;i>=0;i--)s[i]._remove();return s},isClockwise(){return this.getArea()>=0},setClockwise(e){this.isClockwise()!==!!e&&this.reverse()},getLength(){const e=this._children;let n=0;for(let s=0,i=e.length;s<i;s++)n+=e[s].getLength();return n},getArea(){const e=this._children;let n=0;for(let s=0,i=e.length;s<i;s++)n+=e[s].getArea();return n},getCurves(){const e=this._children,n=[];for(let s=0,i=e.length;s<i;s++)ma(n,e[s].getCurves());return n},getFillRule(){return"nonzero"},reverse(){const e=this._children;for(let n=0,s=e.length;n<s;n++)e[n].reverse()},getInteriorPoint(){return QO(this)},_contains(e){const n=e.isInside(this.getBounds())?this._getWinding(e):{};return n.onPath||!!(this.getFillRule()==="evenodd"?n.windingL&1||n.windingR&1:n.winding)},contains(e){return!!this._contains(e)},getBounds(){const e=this.toPathData();this._bounds.set(0,0,0,0);const{commands:n,vertices:s}=e;let i=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,o=Number.MAX_SAFE_INTEGER,a=Number.MIN_SAFE_INTEGER,c=0,l=0,h=0,d=0,p=0,E=0,g=0,T=0,A=0,m=0,O=0;const S=()=>{const y=new ye(i,o,r-i,a-o);this._bounds.merge_with(y),i=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,o=Number.MAX_SAFE_INTEGER,a=Number.MIN_SAFE_INTEGER};for(const y of n)switch(l=d,h=p,y){case ve.M:l=s[c++],h=s[c++],d=l,p=h,i=Math.min(i,l),o=Math.min(o,h),r=Math.max(r,l),a=Math.max(a,h),c===2?this._bounds.set(l,h,0,0):S();break;case ve.L:d=s[c++],p=s[c++],i=Math.min(i,d),o=Math.min(o,p),r=Math.max(r,d),a=Math.max(a,p);break;case ve.Q:{E=s[c++],g=s[c++],d=s[c++],p=s[c++];const v=new yu().initN(l,h,E,g,d,p).getBounds();i=Math.min(i,v.x),o=Math.min(o,v.y),r=Math.max(r,v.x+v.width),a=Math.max(a,v.y+v.height)}break;case ve.C:{T=s[c++],A=s[c++],m=s[c++],O=s[c++],d=s[c++],p=s[c++];const R=new ae().initWith4PointsN(l,h,T,A,m,O,d,p).getBounds();i=Math.min(i,R.x),o=Math.min(o,R.y),r=Math.max(r,R.x+R.width),a=Math.max(a,R.y+R.height)}break}return c>2&&S(),this._bounds},_getWinding(e,n,s){return Ru(e,this.getCurves(),n,s)},union(e){return Nu(this,e,an.UNION)},intersect(e){return Nu(this,e,an.INTERSECT)},subtract(e){return Nu(this,e,an.SUBTRACT)},difference(e){return Nu(this,e,an.DIFFERENCE)},exclude(e){return this.difference(e)},trim(e,n,s,i){if(this._children.length===0)return this;const[r,o,a]=VO(e,n,s);if(cI(r,o)&&!a)return this._children=[],this._bounds=null,this;switch(i){case $i.SIMULTANEOUSLY:return this._trimSimultaneously(r,o,a);case $i.INDIVIDUALLY:default:return this._trimIndividually(r,o,a)}},trimmed(e,n,s,i){return this.clone().trim(e,n,s,i)},_trimIndividually(e,n,s=!1){if(this._children.length===1)return this._children=this._children[0].trim(e,n,s),this.reduce(),this;const i=[],r=[];let o=0;for(let T=0;T<this._children.length;T++){const m=this._children[T].getCurves();for(let O=0;O<m.length;O++){const S=m[O].getLength();S>0&&(o+=S,i.push(S),r.push([T,O]))}}if(r.length===0)return this;const a=e*o,c=n*o;let l=0,h=0,d=0,p=0,E=0;for(let T=0;T<i.length&&(E<a&&(l=T,d=a-E),E<c&&(h=T,p=c-E),!(E>=a&&E>=c));T++)E+=i[T];const g=this._children;if(this._children=[],s){const[T,A]=r[l],[m,O]=r[h],S=g[T].getCurves()[A].getValues(),y=g[m].getCurves()[O].getValues(),v=ae.subdivide(S,ae.getTimeAt(S,d))[1],R=ae.subdivide(y,ae.getTimeAt(y,p))[0];let M=T,L=[];L.push(new Fe().initWithPointsN(v[0],v[1],v[0]-v[2],v[1]-v[3],v[2]-v[0],v[3]-v[1]),new Fe().initWithPointsN(v[6],v[7],v[4]-v[6],v[5]-v[7],0,0));let P=!0;for(let Q=l+1;Q<=i.length+h-1;Q++){const[b,X]=r[Q%i.length],K=g[b].getCurves()[X];M!==b?(this.addChild(Ct.createPath(L,!1)),M=b,L=[K._segment1]):P&&(K._segment1._handleIn=L.pop()._handleIn,L.push(K._segment1),P=!1),L.push(K._segment2)}M!==m&&(this.addChild(Ct.createPath(L,!1)),M=m,L=[new Fe().initWithPointsN(R[0],R[1],0,0,R[2]-R[0],R[3]-R[1])]);const k=L.pop();L.push(new Fe().initWithPointsN(R[0],R[1],k._handleIn.x,k._handleIn.y,R[2]-R[0],R[3]-R[1])),L.push(new Fe().initWithPointsN(R[6],R[7],R[4]-R[6],R[5]-R[7],R[6]-R[4],R[7]-R[5])),this.addChild(Ct.createPath(L,!1))}else if(l===h){const[T,A]=r[l],m=g[T].getCurves()[A].getValues(),O=ae.getPart(m,ae.getTimeAt(m,d),ae.getTimeAt(m,p));this.addChild(Ct.createPath([new Fe().initWithPointsN(O[0],O[1],0,0,O[2]-O[0],O[3]-O[1]),new Fe().initWithPointsN(O[6],O[7],O[4]-O[6],O[5]-O[7],0,0)],!1))}else{const[T,A]=r[l],[m,O]=r[h],S=g[T].getCurves()[A].getValues(),y=g[m].getCurves()[O].getValues(),v=ae.subdivide(S,ae.getTimeAt(S,d))[1],R=ae.subdivide(y,ae.getTimeAt(y,p))[0];let M=T,L=[];L.push(new Fe().initWithPointsN(v[0],v[1],S[0]-S[2],S[1]-S[3],v[2]-v[0],v[3]-v[1]),new Fe().initWithPointsN(v[6],v[7],v[4]-v[6],v[5]-v[7],0,0));let P=!0;for(let Q=l+1;Q<h;Q++){const[b,X]=r[Q%i.length],K=g[b].getCurves()[X];M!==b?(this.addChild(Ct.createPath(L,!1)),M=b,L=[K._segment1]):P&&(K._segment1._handleIn=L.pop()._handleIn,L.push(K._segment1),P=!1),L.push(K._segment2)}M!==m&&(this.addChild(Ct.createPath(L,!1)),M=m,L=[new Fe().initWithPointsN(R[0],R[1],0,0,R[2]-R[0],R[3]-R[1])]);const k=L.pop();L.push(new Fe().initWithPointsN(R[0],R[1],k._handleIn.x,k._handleIn.y,R[2]-R[0],R[3]-R[1])),L.push(new Fe().initWithPointsN(R[6],R[7],R[4]-R[6],R[5]-R[7],R[6]-R[4],R[7]-R[5])),this.addChild(Ct.createPath(L,!1))}return this.reduce(),this},_trimSimultaneously(e,n,s=!1){return this._children=this._children.flatMap(i=>i.trim(e,n,s)),this.reduce(),this},moveTo(e,n){return this.addChild(Ct.createPath([new Fe().initWithPointsN(e,n,0,0,0,0)]),!1)},lineTo(e,n){return this.getCurrentPath().lineTo(e,n),this},quadraticCurveTo(e,n,s,i){return this.getCurrentPath().quadraticCurveTo(e,n,s,i),this},cubicCurveTo(e,n,s,i,r,o){return this.getCurrentPath().cubicCurveTo(e,n,s,i,r,o),this},arcTo(e,n,s,i,r,o){return this.getCurrentPath().arcTo(e,n,s,i,r,o),this},close(e=0){return this.getCurrentPath().close(e),this},getFirstPath(){return this._children.length===0?null:this._children[0]},getCurrentPath(){return this._children.length===0?null:this._children[this._children.length-1]}},qe.create=()=>new qe,qe.destroy=e=>{e._children.length=0,e.version=0,e._bounds=null},qe.createFromPathData=e=>{const{commands:n,vertices:s}=e,i=new qe;let r=ve.M;const o=new N,a=new N,c=new N;i.removeChildren();for(let l=0,h=n.length,d=0;l<h;l++){const p=n[l];switch(r===ve.Z&&!(p===ve.M||p===ve.Z)&&i.moveTo(c.x,c.y),p){case ve.M:{c.x=s[d++],c.y=s[d++],i.moveTo(c.x,c.y);break}case ve.L:{c.x=s[d++],c.y=s[d++],i.lineTo(c.x,c.y);break}case ve.Q:{o.x=s[d++],o.y=s[d++],c.x=s[d++],c.y=s[d++],i.quadraticCurveTo(o.x,o.y,c.x,c.y);break}case ve.C:{o.x=s[d++],o.y=s[d++],a.x=s[d++],a.y=s[d++],c.x=s[d++],c.y=s[d++],i.cubicCurveTo(o.x,o.y,a.x,a.y,c.x,c.y);break}case ve.Z:{i.close(Xn);break}}r=p}return i},qe.createFromSVG=e=>{const n=new qe,s=e&&e.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/ig);let i,r=!1,o,a,c=new N,l=new N;function h(p,E){let g=+i[p];return r&&(g+=c[E]),g}function d(p){return new N(h(p,"x"),h(p+1,"y"))}n.removeChildren();for(let p=0,E=s&&s.length;p<E;p++){const g=s[p],T=g[0],A=T.toLowerCase();i=g.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g);const m=i&&i.length;switch(r=T===A,o==="z"&&!/[mz]/.test(A)&&n.moveTo(c.x,c.y),A){case"m":case"l":let O=A==="m";for(let y=0;y<m;y+=2)c=d(y),n[O?"moveTo":"lineTo"](c.x,c.y),O&&(l=c,O=!1);a=c;break;case"h":case"v":const S=A==="h"?"x":"y";c=c.clone();for(let y=0;y<m;y++)c[S]=h(y,S),n.lineTo(c.x,c.y);a=c;break;case"c":for(let y=0;y<m;y+=6){const v=d(y);a=d(y+2),c=d(y+4),n.cubicCurveTo(v.x,v.y,a.x,a.y,c.x,c.y)}break;case"s":for(let y=0;y<m;y+=4){const v=/[cs]/.test(o)?c.multiply(2,2).subtract(a):c;a=d(y),c=d(y+2),n.cubicCurveTo(v.x,v.y,a.x,a.y,c.x,c.y),o=A}break;case"q":for(let y=0;y<m;y+=4)a=d(y),c=d(y+2),n.quadraticCurveTo(a.x,a.y,c.x,c.y);break;case"t":for(let y=0;y<m;y+=2)a=/[qt]/.test(o)?c.multiply(2,2).subtract(a):c,c=d(y),n.quadraticCurveTo(a.x,a.y,c.x,c.y),o=A;break;case"a":for(let y=0;y<m;y+=7)c=d(y+5),n.arcTo(c.x,c.y,{width:+i[y],height:+i[y+1]},+i[y+2],+i[y+4],+i[y+3]);break;case"z":n.close(Xn),c=l;break}o=A}return n},qe.trimMultiple=(e,n,s,i)=>{if(i.length===0)return i;const[r,o,a]=VO(e,n,s);if(cI(r,o)&&!a)return Array(i.length).fill(new qe);let c=0;const l=[];for(let m=0;m<i.length;m++)l.push(i[m].getLength()),c+=l[m];const h=r*c,d=o*c;let p=0,E=0,g=0,T=0,A=0;for(let m=0;m<i.length&&(A<h&&(p=m,g=h-A),A<d&&(E=m,T=d-A),!(A>=h&&A>=d));m++)A+=l[m];return p===E?l.map((m,O)=>O!==p?a?i[O].clone():new qe:i[O].clone()._trimIndividually(g/m,T/m,a)):l.map((m,O)=>(a?O>E&&O<p:O<p||O>E)?new qe:O===p?i[O].clone()._trimIndividually(g/m,1):O===E?i[O].clone()._trimIndividually(0,T/m):i[O])};function qs(){this._time=null,this._point=new N,this._overlap=!1,this._distance=null,this._offset=null,this._curveOffset=null,this._path=null,this._curve=null,this._segment=null,this._segment1=null,this._segment2=null,this._version=0,this._intersection=null,this._previous=null,this._next=null}qs.prototype={constructor:qs,init(e,n,s,i,r){if(n>=1-Fs){const o=e.getNext();o&&(n=0,e=o)}return this._setCurve(e),this._time=n,this._point=s||e.getPointAtTime(n),this._overlap=i,this._distance=r,this._intersection=null,this._next=null,this._previous=null,this},getPoint(){return this._point},getCurve(){const e=this._path;return e&&e._version!==this._version&&(this._time=null,this._offset=null,this._curveOffset=null,this._curve=null),this._curve||this.trySegment(this._segment)||this.trySegment(this._segment1)||this.trySegment(this._segment2.getPrevious())},trySegment(e){const n=e&&e.getCurve();if(n&&(this._time=n.getTimeOf(this._point))!==null)return this._setCurve(n),n},getSegment(){let e=this._segment;if(!e){const n=this.getCurve(),s=this.getTime();s===0?e=n._segment1:s===1?e=n._segment2:s!=null&&(e=n.getPartLength(0,s)<n.getPartLength(s,1)?n._segment1:n._segment2),this._segment=e}return e},getPath(){const e=this.getCurve();return e&&e._path},getIndex(){const e=this.getCurve();return e&&e.getIndex()},getTime(){const e=this.getCurve(),n=this._time;return e&&n==null?this._time=e.getTimeOf(this._point):n},getOffset(){let e=this._offset;if(e==null){e=0;const n=this.getPath(),s=this.getIndex();if(n&&s!=null){const i=n.getCurves();for(let r=0;r<s;r++)e+=i[r].getLength()}this._offset=e+=this.getCurveOffset()}return e},getCurveOffset(){let e=this._curveOffset;if(e==null){const n=this.getCurve(),s=this.getTime();this._curveOffset=e=s!=null&&n&&n.getPartLength(0,s)}return e},getTangent(){const e=this.getCurve(),n=this.getTime();return n!=null&&e&&e.getTangentAt(n,!0)},hasOverlap(){return!!this._overlap},isTouching(){const e=this._intersection;if(e&&this.getTangent().isCollinear(e.getTangent())){const n=this.getCurve(),s=e.getCurve();return!(n.isStraight()&&s.isStraight()&&n.getLine().intersect(s.getLine()))}return!1},isCrossing(){var M,L,P,k;const e=this._intersection;if(!e)return!1;const n=this.getTime(),s=e.getTime(),i=Fs,r=1-i,o=n>=i&&n<=r,a=s>=i&&s<=r;if(o&&a)return!this.isTouching();let c=this.getCurve();const l=c&&n<i?c.getPrevious():c;let h=e.getCurve();const d=h&&s<i?h.getPrevious():h;if(n>r&&(c=c.getNext()),s>r&&(h=h.getNext()),!l||!c||!d||!h)return!1;const p=[];o||(Cu(p,l,!0),Cu(p,c,!1)),a||(Cu(p,d,!0),Cu(p,h,!1));const E=this.getPoint(),g=Math.min.apply(Math,p),T=o?c.getTangentAtTime(n):(M=c.getPointAt(g))==null?void 0:M.clone().subtract(E),A=o?T==null?void 0:T.clone().negate():(L=l.getPointAt(-g))==null?void 0:L.clone().subtract(E),m=a?h.getTangentAtTime(s):(P=h.getPointAt(g))==null?void 0:P.clone().subtract(E),O=a?m==null?void 0:m.clone().negate():(k=d.getPointAt(-g))==null?void 0:k.clone().subtract(E),S=(A==null?void 0:A.angle())*180/Math.PI,y=(T==null?void 0:T.angle())*180/Math.PI,v=(O==null?void 0:O.angle())*180/Math.PI,R=(m==null?void 0:m.angle())*180/Math.PI;return!!(o?Ro(S,v,R)^Ro(y,v,R)&&Ro(S,R,v)^Ro(y,R,v):Ro(v,S,y)^Ro(R,S,y)&&Ro(v,y,S)^Ro(R,y,S))},equals(e,n){let s=this===e;if(!s&&e instanceof qs){const i=this.getCurve(),r=e.getCurve(),o=i._path,a=r._path;if(o===a){const c=tr,l=di(this.getOffset()-e.getOffset()),h=!n&&this._intersection,d=!n&&e._intersection;s=(l<c||o&&di(o.getLength()-l)<c)&&(!h&&!d||h&&d&&h.equals(d,!0))}}return s},_setSegment(e){const n=e.getCurve();n?this._setCurve(n):(this._setPath(e._path),this._segment1=e,this._segment2=null),this._segment=e,this._time=e===this._segment1?0:1,this._point=e._point.clone()},_setPath(e){this._path=e,this._version=e?e._version:0},_setCurve(e){this._setPath(e._path),this._curve=e,this._segment=null,this._segment1=e._segment1,this._segment2=e._segment2}},qs.insert=(e,n,s)=>{const i=e.length;let r=0,o=i-1;for(;r<=o;){const a=r+o>>>1,c=e[a];let l=null;if(s&&(l=n.equals(c)?c:FO(e,n,i,a,-1)||FO(e,n,i,a,1)))return n._overlap&&(l._overlap=!0,l._intersection._overlap=!0),l;const h=n.getPath(),d=c.getPath();(h!==d?h._id-d._id:n.getIndex()+n.getTime()-(c.getIndex()+c.getTime()))<0?o=a-1:r=a+1}return e.splice(r,0,n),n},qs.expand=e=>{const n=e.slice();for(let s=e.length-1;s>=0;s--)qs.insert(n,e[s]._intersection,!1);return n};function Cu(e,n,s){const i=n.getValues(),r=ae.classify(i).roots||ae.getPeaks(i),o=r.length,a=ae.getLength(i,s&&o?r[o-1]:0,!s&&o?r[0]:1);e.push(o?a:a/32)}function Ro(e,n,s){return typeof e!="number"||typeof n!="number"||typeof s!="number"?!1:n<s?e>n&&e<s:e>n||e<s}function FO(e,n,s,i,r){for(let o=i+r;o>=-1&&o<=s;o+=r){const a=e[(o%s+s)%s];if(!n.getPoint().isClose(a.getPoint(),tr))break;if(n.equals(a))return a}return null}let kO=1;const bi={precision:5,multiplier:1,setup(e=5){this.precision=e|0,this.multiplier=Math.pow(10,this.precision)},number(e){return this.precision<16?Math.round(e*this.multiplier)/this.multiplier:e},pair(e,n,s=","){return this.number(e)+s+this.number(n)}};function BO(e,n,s,i,r,o){e._transformCoordinates(n);for(let c=0;c<2;c++)ae._addBounds(s[c],s[c+4],n[c+2],n[c],c,i,r,o);const a=s;s=n,n=a}function VO(e,n,s){const i=vp(s);let[r,o]=[e,n];r>o&&([r,o]=[o,r]),r=HO(r),o=HO(o),r=Math.round((r+i)*1e4)*1e-4,o=Math.round((o+i)*1e4)*1e-4;let a=!1;return r>1&&(r=vp(r),a=!a),o>1&&(o=vp(o),a=!a),[r,o,a]}function HO(e){return h2(0,1,e)}function vp(e){return e-Math.floor(e)}function h2(e,n,s){return Math.min(n,Math.max(s,e))}function ma(e,n){const s=e,i=n.length;if(i<4096)s.push.apply(s,n);else{const r=s.length;s.length+=i;for(let o=0;o<i;o++)s[r+o]=n[o]}return s}function Rp(e,n,s,i){const r=n&&n.length,o=s===void 0;s=o?e.length:s,s>e.length&&(s=e.length);for(let a=0;a<r;a++)n[a]._index=s+a;if(o)return ma(e,n),[];{const a=[s,i];n&&ma(a,n);const c=e.splice.apply(e,a);for(let l=0,h=c.length;l<h;l++)c[l]._index=void 0;for(let l=s+r,h=e.length;l<h;l++)e[l]._index=l;return c}}function WO(e,n,s){for(let i=0,r=e.length;i<r;i++)n.call(s,e[i],i);return s}function wp(e){const n=e._parent,s=e._index;return n?(Number.isFinite(s)&&Rp(n._children,null,s,1),e._parent=null,!0):!1}function Dp(e){if(e._children){const n=new qe;for(let s=0,i=e._children.length;s<i;s++)n.addChild(Dp(e._children[s]),!0);return n.version=e.version,n}else{const n=new Ct;return n.setSegments(e._segments.slice()),n._closed=e._closed,n}}function YO(e,n,s,i){const r=e===n||!n;return r||e.getBounds().intersects(n.getBounds(),Xn)?ae.getIntersections(e.getCurves(),!r&&n.getCurves(),s,i):[]}function XO(e,n){const s=e&&e._intersection;return s&&s._overlap&&s._path===n}const zO=e=>{const n=e._children;let s=n||[e],i=!1,r=!1,o=e.getIntersections(null,function(h){return h.hasOverlap()&&(i=!0)||h.isCrossing()&&(r=!0)});const a=i&&r&&[];if(o=qs.expand(o),i){const h=vu(o,d=>d.hasOverlap(),a);for(let d=h.length-1;d>=0;d--){const p=h[d],E=p._path,g=p._segment,T=g.getPrevious(),A=g.getNext();XO(T,E)&&XO(A,E)&&(g.remove(),T._handleOut.set(0,0),A._handleIn.set(0,0),T._changed(T._handleOut),A._changed(A._handleIn),T!==g&&!T.getCurve().hasLength()&&(A._handleIn.set(T._handleIn.x,T._handleIn.y),A._changed(A._handleIn),T.remove()))}}r&&(vu(o,i&&(h=>{const d=h.getCurve(),p=h.getSegment(),E=h._intersection,g=E._curve,T=E._segment;if(d&&g&&d._path&&g._path)return!0;p&&(p._intersection=null),T&&(T._intersection=null)}),a),a&&ZO(a),s=nI(WO(s,function(h){ma(this,h._segments)},[])));const c=s.length;let l;return c>1&&n?(s!==n&&e.setChildren(s),l=e):c===1&&!n&&(s[0]!==e&&e.setSegments(s[0].removeSegments()),l=e),l||(l=new qe,l.addChildren(s),l=l.reduce()),l};function KO(e,n,s){const i=e._children;return i&&i.length?e.setChildren(rI(e.removeChildren(),r=>!!(n?r:r&1),s)):s!==void 0&&e.setClockwise(s),e}function QO(e){const s=e.getBounds().getCenter();if(!e.contains(s)){const i=e.getCurves(),r=s.y,o=[],a=[];for(let c=0,l=i.length;c<l;c++){const h=i[c].getValues(),d=h[1],p=h[3],E=h[5],g=h[7];if(r>=vl(d,p,E,g)&&r<=fc(d,p,E,g)){const T=ae.getMonoCurves(h);for(let A=0,m=T.length;A<m;A++){const O=T[A],S=O[1],y=O[7];if(S!==y&&(r>=S&&r<=y||r>=y&&r<=S)){const v=r===S?O[0]:r===y?O[6]:ae.solveCubic(O,1,r,a,0,1)===1?ae.getPoint(O,a[0]).x:(O[0]+O[6])/2;o.push(v)}}}}o.length>1&&(o.sort((c,l)=>c-l),s.x=(o[0]+o[1])/2)}return s}function ZO(e){for(let n=e.length-1;n>=0;n--)e[n].clearHandles()}const vl=Math.min,fc=Math.max,di=Math.abs,qO=Math.sqrt,u2={[an.UNION]:{1:!0,2:!0},[an.INTERSECT]:{2:!0},[an.SUBTRACT]:{1:!0},[an.DIFFERENCE]:{1:!0,"-1":!0}};function d2(e,n){const s=new qe;s.moveTo(0,0),s.lineTo(n.width,0),s.lineTo(n.width,n.height),s.lineTo(0,n.height),s.close();const i=xu(e,!1),r=xu(s,!0),a=qs.expand(i.getIntersections(r,oI)).filter(d=>d._curve._path!==r.getCurrentPath()),c=n.clone();if(c.x-=Fs,c.y-=Fs,c.width+=Fs*2,c.height+=Fs*2,!a.length)return null;const l=new qe,h=vu(a);for(const d of e._children)c.containsRect(d.getBounds())&&l.addChild(d.clone());for(let d=0;d<h.length;d++){let p=[];const E=h[d]._path._segments;for(let g=0;g<E.length-1;g++){const T=E[g],A=E[g+1];c.contains(T._point)&&c.contains(A._point)?(p.length===0&&p.push(T),p.push(A)):(p.length>=2&&l.addChild(Ct.createPath(p,!1)),p=[])}p.length>=2&&l.addChild(Ct.createPath(p,!1))}return l}function Nu(e,n,s){const i=xu(e,!0),r=n&&e!==n&&xu(n,!0),o=u2[s];o[s-10]=!0,r&&(o[an.SUBTRACT-10]||o[an.DIFFERENCE-10])^(r.isClockwise()^i.isClockwise())&&r.reverse();const a=qs.expand(i.getIntersections(r,oI)),c=vu(a),l=Lp(i),h=r&&Lp(r),d=[],p=[];let E;if(c.length){jO(l,d,p),h&&jO(h,d,p);const g=Array(p.length);for(let m=0,O=p.length;m<O;m++)g[m]=p[m].getValues();const T=UO(g,g,0,!0),A={};for(let m=0;m<p.length;m++){const O=p[m],S=O._path._id;A[S]=A[S]||{};const y=A[S];y[O.getIndex()]={hor:JO(T[m].hor,p),ver:JO(T[m].ver,p)}}for(let m=0,O=c.length;m<O;m++)tI(c[m]._segment,i,r,A,o);for(let m=0,O=d.length;m<O;m++){const S=d[m],y=S._intersection;S._winding||tI(S,i,r,A,o),y&&y._overlap||(S._path._overlapsOnly=!1)}E=nI(d,o)}else E=rI(h?l.concat(h):l.slice(),g=>!!o[g]);return p2(E,!0)}function jO(e,n,s){for(let i=0,r=e.length;i<r;i++){const o=e[i];ma(n,o._segments),ma(s,o.getCurves()),o._overlapsOnly=!0}}function JO(e,n){const s=[];for(let i=0,r=e&&e.length;i<r;i++)s.push(n[e[i]]);return s}function xu(e,n){let s=e,i=s.clone(!1).reduce(!0);if(n){const r=Lp(i);for(let o=0,a=r.length;o<a;o++)s=r[o],!s._closed&&!s.isEmpty()&&(s.close(Xn),s.getFirstSegment().setHandleIn(new N(0,0)),s.getLastSegment().setHandleOut(new N(0,0)));i=i.resolveCrossings().reorient(i.getFillRule()==="nonzero",!0)}return i}function vu(e,n,s){const i=n&&[],r=Fs,o=1-r;let a=!1;const c=s||[],l=s&&{};let h,d,p;for(let E=(s&&s.length)-1;E>=0;E--){const g=s[E];g._path&&(l[$O(g)]=!0)}for(let E=e.length-1;E>=0;E--){const g=e[E];let T=g._time;const A=T,m=n&&!n(g),O=g._curve;let S;if(O&&(O!==d?(a=!O.hasHandles()||l&&l[$O(O)],h=[],p=null,d=O):p>=r&&(T/=p)),m){h&&h.push(g);continue}else n&&i.unshift(g);if(p=A,T<r)S=O._segment1;else if(T>o)S=O._segment2;else{const R=O.divideAtTime(T,!0);a&&c.push(O,R),S=R._segment1;for(let M=h.length-1;M>=0;M--){const L=h[M];L._time=(L._time-T)/(1-T)}}g._setSegment(S);const y=S._intersection,v=g._intersection;if(y){eI(y,v);let R=y;for(;R;)eI(R._intersection,y),R=R._next}else S._intersection=v}return s||ZO(c),i||e}function $O(e){return e._path._id+"."+e._segment1._index}function eI(e,n){let s=e;for(;s;){if(s===n)return;s=s._previous}for(;e._next&&e._next!==n;)e=e._next;if(!e._next){for(;n._previous;)n=n._previous;e._next=n,n._previous=e}}function Ru(e,n,s,i,r){const o=Array.isArray(n)?n:n[s?"hor":"ver"],a=s?1:0,c=a^1,l=[e.x,e.y],h=l[a],d=l[c],p=1e-9,E=1e-6,g=h-p,T=h+p;let A=0,m=0,O=0,S=0,y=!1,v=!1,R=1;const M=[];let L,P;function k(b){const X=b[c+0],K=b[c+6];if(d<vl(X,K)||d>fc(X,K))return;const V=b[a+0],J=b[a+2],ge=b[a+4],se=b[a+6];if(X===K){(V<T&&se>g||se<T&&V>g)&&(y=!0);return}const ue=d===X?0:d===K||g>fc(V,J,ge,se)||T<vl(V,J,ge,se)?1:ae.solveCubic(b,c,d,M,0,1)>0?M[0]:1,te=ue===0?V:ue===1?se:ae.getPoint(b,ue)[s?"y":"x"],ie=X>K?1:-1,re=L[c]>L[c+6]?1:-1,fe=L[a+6];return d!==X?(te<g?O+=ie:te>T?S+=ie:y=!0,te>h-E&&te<h+E&&(R/=2)):(ie!==re?V<g?O+=ie:V>T&&(S+=ie):V!==fe&&(fe<T&&te>T?(S+=ie,y=!0):fe>g&&te<g&&(O+=ie,y=!0)),R/=4),L=b,!r&&te>g&&te<T&&ae.getTangent(b,ue)[s?"x":"y"]===0&&Ru(e,n,!s,i,!0)}function Q(b){const X=b[c+0],K=b[c+2],V=b[c+4],J=b[c+6];if(d<=fc(X,K,V,J)&&d>=vl(X,K,V,J)){const ge=b[a+0],se=b[a+2],ue=b[a+4],te=b[a+6],ie=g>fc(ge,se,ue,te)||T<vl(ge,se,ue,te)?[b]:ae.getMonoCurves(b,s);let re;for(let fe=0,Ne=ie.length;fe<Ne;fe++)if(re=k(ie[fe]),re)return re}}for(let b=0,X=o.length;b<X;b++){const K=o[b],V=K._path,J=K.getValues();let ge;if((!b||o[b-1]._path!==V)&&(L=null,V._closed||(P=ae.getValues(V.getLastCurve().getSegment2(),K.getSegment1(),!i),P[c]!==P[c+6]&&(L=P)),!L)){L=J;let se=V.getLastCurve();for(;se&&se!==K;){const ue=se.getValues();if(ue[c]!==ue[c+6]){L=ue;break}se=se.getPrevious()}}if(ge=Q(J),ge)return ge;if(b+1===X||o[b+1]._path!==V){if(P&&(ge=Q(P)))return ge;y&&!O&&!S&&(O=V.isClockwise(i)^s?1:-1,S=O),A+=O,m+=S,O=0,S=0,y&&(v=!0,y=!1),P=null}}return A=di(A),m=di(m),{winding:fc(A,m),windingL:A,windingR:m,quality:R,onPath:v}}function tI(e,n,s,i,r){const o=[],a=e;let c=0,l;do{const E=e.getCurve();if(E){const g=E.getLength();o.push({segment:e,curve:E,length:g}),c+=g}e=e.getNext()}while(e&&!e._intersection&&e!==a);const h=[.5,.25,.75];l={winding:0,quality:-1};const d=.001,p=1-d;for(let E=0;E<h.length&&l.quality<.5;E++){let g=c*h[E];for(let T=0,A=o.length;T<A;T++){const m=o[T],O=m.length;if(g<=O){const S=m.curve,y=S._path,v=y._parent,R=v instanceof qe?v:y,M=Kn.clamp(S.getTimeAt(g),d,p),L=S.getPointAtTime(M),P=di(S.getTangentAtTime(M).y)<Math.SQRT1_2;let k=null;if(r[an.SUBTRACT-10]&&s){const b=(R===n?s:n)._getWinding(L,P,!0);if(R===n&&b.winding||R===s&&!b.winding){if(b.quality<1)continue;k={winding:0,quality:1}}}k=k||Ru(L,i[y._id][S.getIndex()],P,!0),k.quality>l.quality&&(l=k);break}g-=O}}for(let E=o.length-1;E>=0;E--)o[E].segment._winding=l}function nI(e,n){const s=[],i=[];e.sort(function(r,o){const a=r._intersection,c=o._intersection,l=!!(a&&a._overlap),h=!!(c&&c._overlap),d=r._path,p=o._path;return l^h?l?1:-1:!a^!c?a?1:-1:d!==p?d._id-p._id:r._index-o._index});for(let r=0,o=e.length;r<o;r++){let a=e[r],c=pc(a,n),l=null,h=!1,d=!0;const p=[];let E,g,T;if(c&&a._path._overlapsOnly){const A=a._path,m=a._intersection._segment._path;A.compare(m)&&(A.getArea()&&s.push(A.clone(!1)),sI(A),sI(m),c=!1)}for(;c;){const A=!l,m=f2(a,A,i,n),O=m.shift();h=!A&&(wu(a,i)||wu(O,i));const S=!h&&O;if(A&&(l=new Ct,E=null),h){(a.isFirst()||a.isLast())&&(d=a._path._closed),a._visited=!0;break}if(S&&E&&(p.push(E),E=null),E||(S&&m.push(a),E={start:l._segments.length,crossings:m,visited:g=[],handleIn:T}),S&&(a=O),!pc(a,n)){l.removeSegments(E.start);for(let v=0,R=g.length;v<R;v++)g[v]._visited=!1;g.length=0;do a=E&&E.crossings.shift(),(!a||!a._path)&&(a=null,E=p.pop(),E&&(g=E.visited,T=E.handleIn));while(E&&!pc(a,n));if(!a)break}const y=a.getNext();l.add(new Fe().initWithPoints(a._point,T,y&&a._handleOut)),a._visited=!0,g.push(a),a=y||a._path.getFirstSegment(),T=y&&y._handleIn}h&&(d&&(l.getFirstSegment().setHandleIn(T),l.setClosed(d)),l.getArea()!==0&&s.push(l))}return s}function pc(e,n){let s;return!!(e&&!e._visited&&(!n||n[(s=e._winding||{}).winding]&&!(n[an.UNION-10]&&s.winding===2&&s.windingL&&s.windingR)))}function wu(e,n){if(e){for(let s=0,i=n.length;s<i;s++)if(e===n[s])return!0}return!1}function sI(e){const n=e._segments;for(let s=0,i=n.length;s<i;s++)n[s]._visited=!0}function f2(e,n,s,i){let r=e._intersection;const o=r,a=[];if(n&&(s.length=0,s[0]=e),r){for(iI(r,null,e,a,n,s,i);r&&r._previous;)r=r._previous;iI(r,o,e,a,n,s,i)}return a}function iI(e,n,s,i,r,o,a){for(;e&&e!==n;){const c=e._segment,l=c&&c._path;if(l){const h=c.getNext()||l.getFirstSegment(),d=h._intersection;c!==s&&(wu(c,o)||wu(h,o)||h&&pc(c,a)&&(pc(h,a)||d&&pc(d._segment,a)))&&i.push(c),r&&o.push(c)}e=e._next}}function rI(e,n,s){const i=e&&e.length;if(i){const r=WO(e,function(l,h){this[l._id]={container:null,winding:l.isClockwise()?1:-1,index:h}},{}),o=e.slice().sort((l,h)=>di(h.getArea())-di(l.getArea())),a=o[0],c=c2(o,null,tr);s==null&&(s=a.isClockwise());for(let l=0;l<i;l++){const h=o[l],d=r[h._id];let p=0;const E=c[l];if(E){let g=null;for(let T=E.length-1;T>=0;T--)if(E[T]<l){g=g||h.getInteriorPoint();const A=o[E[T]];if(A.contains(g)){const m=r[A._id];p=m.winding,d.winding+=p,d.container=m.exclude?m.container:A;break}}}if(n(d.winding)===n(p))d.exclude=!0,e[d.index]=null;else{const g=d.container;h.setClockwise(g?!g.isClockwise():s)}}}return e}function p2(e,n){let s=new qe;return s.addChildren(e,!0),s=s.reduce(n),s}function oI(e){return e.hasOverlap()||e.isCrossing()}function Lp(e){return e._children||[e]}const aI=1e-10;function E2(e,n,s=aI){return e-n>=0?e-n<=s:n-e<=s}function cI(e,n){return E2(e,n,aI)}function ae(){this._path=null,this._segment1=null,this._segment2=null,this._length=null,this._bounds=null}ae.prototype={constructor:ae,initWithSegments(e,n){return this._segment1=new Fe().copy(e),this._segment2=new Fe().copy(n),this},initWithPathAndSegments(e,n,s){return this._path=e,this._segment1=n,this._segment2=s,this},initWith4Points(e,n,s,i){return this._segment1=new Fe().initWithPointsN(e.x,e.y,0,0,n.x-e.x,n.y-e.y),this._segment2=new Fe().initWithPointsN(i.x,i.y,s.x-i.x,s.y-i.y,0,0),this},initWithPointsAndHandles(e,n,s,i){return this._segment1=new Fe().initWithPoints(e,null,n),this._segment2=new Fe().initWithPoints(i,s,null),this},initWith4PointsN(e,n,s,i,r,o,a,c){return this._segment1=new Fe().initWithPointsN(e,n,0,0,s-e,i-n),this._segment2=new Fe().initWithPointsN(a,c,r-a,o-c,0,0),this},initWithPointsAndHandlesN(e,n,s,i,r,o,a,c){return this._segment1=new Fe().initWithPointsN(e,n,0,0,s,i),this._segment2=new Fe().initWithPointsN(a,c,r,o,0,0),this},regularize(e){const n=this.getP0(),s=this.getP1(),i=this.getP2(),r=this.getP3(),o=e*e;if(n.distance_squared_to(s)<o){const c=n.distance_squared_to(i);if(c>=o)s.copy(n).linear_interpolate(i,wo(o/c));else return s.copy(n).linear_interpolate(r,1/3),i.copy(r).linear_interpolate(n,1/3),this.initWith4Points(n,s,i,r)}if(r.distance_squared_to(i)<o){const c=s.distance_squared_to(i);if(c>=o)i.copy(r).linear_interpolate(s,wo(o/c));else return s.copy(n).linear_interpolate(r,1/3),i.copy(r).linear_interpolate(n,1/3),this.initWith4Points(n,s,i,r)}const a=this.detectCusp(e);if(a!==Tc.None){const c=s.clone().sub(n),l=c.length(),h=r.clone().sub(i),d=h.length();switch(a){case Tc.Loop:{s.add(c.scale(e/l)),i.sub(h.scale(e/d));break}case Tc.DoubleInflection:{l>2*e&&s.sub(c.scale(e/l)),d>2*e&&i.add(h.scale(e/d));break}}}return this.initWith4Points(n,s,i,r)},detectCusp(e){const n=this.getP0(),s=this.getP1(),i=this.getP2(),r=this.getP3(),o=s.clone().sub(n),a=i.clone().sub(n),c=r.clone().sub(n),l=i.clone().sub(s),h=r.clone().sub(i),d=o.cross(a),p=l.cross(h),E=o.cross(c),g=a.cross(c);if(d*p>0&&d*E<0&&d*g<0){const T=this.deriv(),A=T.nearest(N.ZERO,1e-9),m=T.eval(A.t),O=T.deriv().eval(A.t),S=m.cross(O);if(Pp(A.distance_sq,3)<Pp(S*e,2)){const y=3*d+g-2*E,v=-3*d+E,R=d;return v*v-4*y*R>0?Tc.DoubleInflection:Tc.Loop}}return Tc.None},deriv(){const e=this.getP0(),n=this.getP1(),s=this.getP2(),i=this.getP3();return new yu().initN(3*(n.x-e.x),3*(n.y-e.y),3*(s.x-n.x),3*(s.y-n.y),3*(i.x-s.x),3*(i.y-s.y))},eval(e){const n=this.getP0(),s=this.getP1(),i=this.getP2(),r=this.getP3(),o=1-e,a=new N;return a.copy(n).scale(o*o*o).add(s.clone().scale(o*o*3).add(i.clone().scale(o*3).add(r.clone().scale(e)).scale(e)).scale(e)),a},weightsum(e,n,s,i){const r=this.getP0(),o=this.getP1(),a=this.getP2(),c=this.getP3(),l=e*r.x+n*o.x+s*a.x+i*c.x,h=e*r.y+n*o.y+s*a.y+i*c.y;return new N(l,h)},getDerivativeAt(e){const[n,s]=[e,1-e],i=-3*s*s,r=3*s*s-6*n*s,o=-3*n*n+6*n*s,a=3*n*n;return this.weightsum(i,r,o,a)},getSecondDerivativeAt(e){const[n,s]=[e,1-e],i=6*s,r=-12*s+6*n,o=-12*n+6*s,a=6*n;return this.weightsum(i,r,o,a)},arclen(e){return Mu(this.getValues(),e,0)},invArclen(e,n){if(e<=0)return 0;const s=this.arclen(n);if(e>=s)return 1;const i=n/s,r=this.getValues();return EI(a=>Mu(ae.getPart(r,0,a),n,0)-e,0,1,i,1,2,-e,s-e)},clone(){return new ae().initWithSegments(this._segment1.clone(),this._segment2.clone())},remove(){let e=!1;if(this._path){const n=this._segment2,s=n._handleOut;e=n.remove(),e&&(this._segment1._handleOut.set(s.x,s.y),this._segment1._changed(this._segment1._handleOut))}return e},divideAtTime(e,n){const s=Fs,i=1-s;let r=null;if(e>=s&&e<=i){const o=ae.subdivide(this.getValues(),e),a=o[0],c=o[1],l=n||this.hasHandles(),h=this._segment1,d=this._segment2,p=this._path;l&&(h._handleOut.set(a[2]-a[0],a[3]-a[1]),d._handleIn.set(c[4]-c[6],c[5]-c[7]),h._changed(h._handleOut),d._changed(d._handleIn));const E=a[6],g=a[7],T=new Fe().initWithPoints(new N(E,g),l&&new N(a[4]-E,a[5]-g),l&&new N(c[2]-E,c[3]-g));p?(p.insert(h._index+1,T),r=this.getNext()):(this._segment2=T,this._changed(),r=new ae().initWithSegments(T,d))}return r},clearHandles(){this._segment1._handleOut.set(0,0),this._segment2._handleIn.set(0,0),this._segment1._changed(this._segment1._handleOut),this._segment2._changed(this._segment2._handleIn)},getIndex(){return this._segment1._index},getPrevious(){const e=this._path&&this._path._curves;return e&&(e[this._segment1._index-1]||this._path._closed&&e[e.length-1])||null},getNext(){const e=this._path&&this._path._curves;return e&&(e[this._segment1._index+1]||this._path._closed&&e[0])||null},getPoint1(){return this._segment1._point},getHandle1(){return this._segment1._handleOut},getHandle2(){return this._segment2._handleIn},getPoint2(){return this._segment2._point},getP0(){return this._segment1._point},getP1(){return this._segment1._handleOut.clone().add(this._segment1._point)},getP2(){return this._segment2._handleIn.clone().add(this._segment2._point)},getP3(){return this._segment2._point},getLength(){return this._length==null&&(this._length=ae.getLength(this.getValues(),0,1)),this._length},getSegment1(){return this._segment1},getSegment2(){return this._segment2},getPartLength(e,n){return ae.getLength(this.getValues(),e,n)},getTimeOf(e){return ae.getTimeOf(this.getValues(),e)},getPointAt(e,n){const s=this.getValues();return ae.getPoint(s,n?e:ae.getTimeAt(s,e))},getPointAtTime(e){return ae.getPoint(this.getValues(),e)},getTangentAtTime(e){return ae.getTangent(this.getValues(),e)},getTangentAt(e,n){const s=this.getValues();return ae.getTangent(s,n?e:ae.getTimeAt(s,e))},getOffsetAtTime(e){return this.getPartLength(0,e)},getLocationAt(e,n){return this.getLocationAtTime(n?e:this.getTimeAt(e))},getLocationAtTime(e){return e!=null&&e>=0&&e<=1?new qs().init(this,e):null},getTimeAt(e,n){return ae.getTimeAt(this.getValues(),e,n)},getIntersections(e){const n=this.getValues(),s=e&&e!==this&&e.getValues();return s?hI(n,s,this,e,[]):lI(n,this,[])},hasHandles(){return!this._segment1._handleOut.is_zero(fs)||!this._segment2._handleIn.is_zero(fs)},hasLength(e){return(!this.getPoint1().equals(this.getPoint2())||this.hasHandles())&&this.getLength()>(e||0)},isCollinear(e){return e&&this.isStraight()&&e.isStraight()&&this.getLine().isCollinear(e.getLine())},isStraight(){return ae.isStraight(this.getValues(),tr)},getValues(){return ae.getValues(this._segment1,this._segment2)},getBounds(){if(this._bounds==null){const e=this.getValues();this._bounds=ae.getBounds(e)}return this._bounds},getLine(){return new Qn().initP(this._segment1._point,this._segment2._point)},classify(){return ae.classify(this.getValues())},_changed(){this._length=null,this._bounds=null},toString(){return`CubicBez{ s1: ${this._segment1.toString()}, s2: ${this._segment2.toString()} }`}},ae.getLength=(e,n=0,s=1,i)=>{if(ae.isStraight(e)){let r=e;s<1&&(r=ae.subdivide(r,s)[0],n/=s),n>0&&(r=ae.subdivide(r,n)[1]);const o=r[6]-r[0],a=r[7]-r[1];return wo(o*o+a*a)}return Kn.integrate(i||fI(e),n,s,pI(n,s))},ae.getPart=(e,n,s)=>{let i=e,r=n,o=s;const a=r>o;if(a){const c=r;r=o,o=c}return r>0&&(i=ae.subdivide(i,r)[1]),o<1&&(i=ae.subdivide(i,(o-r)/(1-r))[0]),a?[i[6],i[7],i[4],i[5],i[2],i[3],i[0],i[1]]:i},ae.getPoint=(e,n)=>_c(e,n,0,!1),ae.getTangent=(e,n)=>_c(e,n,1,!0),ae.getWeightedTangent=(e,n)=>_c(e,n,1,!1),ae.getNormal=(e,n)=>_c(e,n,2,!0),ae.getWeightedNormal=(e,n)=>_c(e,n,2,!1),ae.getCurvature=(e,n)=>_c(e,n,3,!1).x,ae.getTimeOf=(e,n)=>{const s=new N(e[0],e[1]),i=new N(e[6],e[7]),r=Xn,o=tr;if((n.isClose(s,r)?0:n.isClose(i,r)?1:null)===null){const c=[n.x,n.y],l=[];for(let h=0;h<2;h++){const d=ae.solveCubic(e,h,c[h],l,0,1);for(let p=0;p<d;p++){const E=l[p];if(n.isClose(ae.getPoint(e,E),o))return E}}}return n.isClose(s,o)?0:n.isClose(i,o)?1:null},ae.getTimeAt=(e,n,s)=>{if(s===void 0&&(s=n<0?1:0),n===0)return s;const i=tr,r=n>0,o=r?s:0,a=r?1:s,c=fI(e),l=ae.getLength(e,o,a,c),h=Mp(n)-l;if(Mp(h)<i)return r?a:o;if(h>i)return null;const d=n/l;let p=0;function E(g){return p+=Kn.integrate(c,s,g,pI(s,g)),s=g,p-n}return Kn.findRoot(E,c,s+d,o,a,32,Xn)},ae.getPeaks=e=>{const n=e[0],s=e[1],i=e[2],r=e[3],o=e[4],a=e[5],c=e[6],l=e[7],h=-n+3*i-3*o+c,d=3*n-6*i+3*o,p=-3*n+3*i,E=-s+3*r-3*a+l,g=3*s-6*r+3*a,T=-3*s+3*r,A=Fs,m=1-A,O=[];return Kn.solveCubic(9*(h*h+E*E),9*(h*d+g*E),2*(d*d+g*g)+3*(p*h+T*E),p*d+g*T,O,A,m),O.sort()},ae.getIntersections=(e,n,s,i)=>{const r=tr,o=!n;o&&(n=e);const a=e.length,c=n.length,l=Array(a),h=o?l:Array(c),d=[];for(let E=0;E<a;E++)l[E]=e[E].getValues();if(!o)for(let E=0;E<c;E++)h[E]=n[E].getValues();const p=UO(l,h,r);for(let E=0;E<a;E++){const g=e[E],T=l[E];o&&lI(T,g,d,s);const A=p[E];if(A)for(let m=0;m<A.length;m++){if(i&&d.length)return d;const O=A[m];if(!o||O>E){const S=n[O],y=h[O];hI(T,y,g,S,d,s)}}}return d},ae.isStraight=e=>{const n=e[0],s=e[1],i=e[6],r=e[7],o=new N(n,s),a=new N(e[2]-n,e[3]-s),c=new N(e[4]-i,e[5]-r),l=new N(i,r);if(a.is_zero(fs)&&c.is_zero(fs))return!0;{const h=l.clone().subtract(o);if(h.is_zero(fs))return!1;if(h.isCollinear(a)&&h.isCollinear(c)){const d=new Qn().initP(o,l),p=tr;if(d.getDistance(o.clone().add(a.x,a.y))<p&&d.getDistance(l.clone().add(c.x,c.y))<p){const E=h.clone().dot(h),g=h.clone().dot(a)/E,T=h.clone().dot(c)/E;return g>=0&&g<=1&&T<=0&&T>=-1}}}return!1},ae.subdivide=(e,n=.5)=>{const s=e[0],i=e[1],r=e[2],o=e[3],a=e[4],c=e[5],l=e[6],h=e[7],d=1-n,p=d*s+n*r,E=d*i+n*o,g=d*r+n*a,T=d*o+n*c,A=d*a+n*l,m=d*c+n*h,O=d*p+n*g,S=d*E+n*T,y=d*g+n*A,v=d*T+n*m,R=d*O+n*y,M=d*S+n*v;return[[s,i,p,E,O,S,R,M],[R,M,y,v,A,m,l,h]]},ae.getValues=(e,n,s)=>{const i=e._point,r=e._handleOut,o=n._handleIn,a=n._point,c=i.x,l=i.y,h=a.x,d=a.y;return s?[c,l,c,l,h,d,h,d]:[c,l,c+r.x,l+r.y,h+o.x,d+o.y,h,d]},ae.getArea=e=>{const n=e[0],s=e[1],i=e[2],r=e[3],o=e[4],a=e[5],c=e[6],l=e[7];return 3*((l-s)*(i+o)-(c-n)*(r+a)+r*(n-o)-i*(s-a)+l*(o+n/3)-c*(a+s/3))/20},ae.getBounds=e=>{const n=e.slice(0,2),s=n.slice(),i=[0,0];for(let r=0;r<2;r++)ae._addBounds(e[r],e[r+2],e[r+4],e[r+6],r,n,s,i);return new ye(n[0],n[1],s[0]-n[0],s[1]-n[1])},ae._addBounds=(e,n,s,i,r,o,a,c)=>{const l=o[r],h=a[r];if(e<l||n<l||s<l||i<l||e>h||n>h||s>h||i>h)if(n<e!=n<i&&s<e!=s<i)Lu(e,r,o,a),Lu(i,r,o,a);else{const d=3*(n-s)-e+i,p=2*(e+s)-4*n,E=n-e,g=Kn.solveQuadratic(d,p,E,c),T=Fs,A=1-T;Lu(i,r,o,a);for(let m=0;m<g;m++){const O=c[m],S=1-O;T<=O&&O<=A&&Lu(S*S*S*e+3*S*S*O*n+3*S*O*O*s+O*O*O*i,r,o,a)}}},ae.solveCubic=(e,n,s,i,r,o)=>{const a=e[n],c=e[n+2],l=e[n+4],h=e[n+6];let d=0;if(!(a<s&&h<s&&c<s&&l<s||a>s&&h>s&&c>s&&l>s)){const p=3*(c-a),E=3*(l-c)-p,g=h-a-p-E;d=Kn.solveCubic(g,E,p,a-s,i,r,o)}return d},ae.getMonoCurves=(e,n)=>{const s=[],i=n?0:1,r=e[i+0],o=e[i+2],a=e[i+4],c=e[i+6];if(r>=o==o>=a&&o>=a==a>=c||ae.isStraight(e))s.push(e);else{const l=3*(o-a)-r+c,h=2*(r+a)-4*o,d=o-r,p=Fs,E=1-p,g=[],T=Kn.solveQuadratic(l,h,d,g,p,E);if(!T)s.push(e);else{g.sort();let A=g[0],m=ae.subdivide(e,A);s.push(m[0]),T>1&&(A=(g[1]-A)/(1-A),m=ae.subdivide(m[1],A),s.push(m[0])),s.push(m[1])}}return s},ae.classify=e=>{const n=e[0],s=e[1],i=e[2],r=e[3],o=e[4],a=e[5],c=e[6],l=e[7],h=n*(l-a)+s*(o-c)+c*a-l*o,d=i*(s-l)+r*(c-n)+n*l-s*c;let E=3*(o*(r-s)+a*(n-i)+i*s-r*n),g=E-d,T=g-d+h;const A=wo(T*T+g*g+E*E),m=A===0?0:1/A,O=Kn.isZero;if(T*=m,g*=m,E*=m,O(T))return O(g)?Du(O(E)?gs.line:gs.quadratic):Du(gs.serpentine,E/(3*g));const S=3*g*g-4*T*E;if(O(S))return Du(gs.cusp,g/(2*T));const y=S>0?wo(S/3):wo(-S),v=2*T;return Du(S>0?gs.serpentine:gs.loop,(g+y)/v,(g-y)/v)};const Ec=Math.min,Oa=Math.max,Mp=Math.abs,g2=Math.ceil,Pp=Math.pow,wo=Math.sqrt,_2=Math.atan2;function Du(e,n,s){const i=n!==void 0;let r=i&&n>0&&n<1,o=i&&s>0&&s<1,a=e;i&&(!(r||o)||a===gs.loop)&&!(r&&o)&&(a=gs.arch,r=!1,o=!1);let c=null;return(r||o)&&(r&&o?c=n<s?[n,s]:[s,n]:c=[r?n:s]),{type:a,roots:c}}function gc(e,n,s,i,r,o,a){const c=!a&&s.getPrevious()===r,l=!a&&s!==r&&s.getNext()===r,h=Fs,d=1-h;if(i!==null&&i>=(c?h:0)&&i<=(l?d:1)&&o!==null&&o>=(l?h:0)&&o<=(c?d:1)){const p=new qs().init(s,i,null,a),E=new qs().init(r,o,null,a);p._intersection=E,E._intersection=p,(!n||n(p))&&qs.insert(e,p,!0)}}function T2(e,n,s,i,r,o){const a=Qn.intersect(e[0],e[1],e[6],e[7],n[0],n[1],n[6],n[7]);a&&gc(r,o,s,ae.getTimeOf(e,a),i,ae.getTimeOf(n,a))}function lI(e,n,s,i){const r=ae.classify(e);if(r.type===gs.loop){const o=r.roots;gc(s,i,n,o[0],n,o[1])}return s}function hI(e,n,s,i,r,o){const a=Xn;if(Oa(e[0],e[2],e[4],e[6])+a>Ec(n[0],n[2],n[4],n[6])&&Ec(e[0],e[2],e[4],e[6])-a<Oa(n[0],n[2],n[4],n[6])&&Oa(e[1],e[3],e[5],e[7])+a>Ec(n[1],n[3],n[5],n[7])&&Ec(e[1],e[3],e[5],e[7])-a<Oa(n[1],n[3],n[5],n[7])){const c=Gp(e,n);if(c)for(let l=0;l<2;l++){const h=c[l];gc(r,o,s,h[0],i,h[1],!0)}else{const l=ae.isStraight(e),h=ae.isStraight(n),d=l&&h,p=l&&!h,E=r.length;if((d?T2:l||h?m2:Ia)(p?n:e,p?e:n,p?i:s,p?s:i,r,o,p,0,0,0,1,0,1),!d||r.length===E)for(let g=0;g<4;g++){const T=g>>1,A=g&1,m=T*6,O=A*6,S=new N(e[m],e[m+1]),y=new N(n[O],n[O+1]);S.isClose(y,a)&&gc(r,o,s,T,i,A)}}}return r}function Lu(e,n,s,i){const r=e,o=e;r<s[n]&&(s[n]=r),o>i[n]&&(i[n]=o)}function _c(e,n,s,i){if(n==null||n<0||n>1)return null;const r=e[0],o=e[1];let a=e[2],c=e[3],l=e[4],h=e[5];const d=e[6],p=e[7],E=Kn.isZero;E(a-r)&&E(c-o)&&(a=r,c=o),E(l-d)&&E(h-p)&&(l=d,h=p);const g=3*(a-r),T=3*(l-a)-g,A=d-r-g-T,m=3*(c-o),O=3*(h-c)-m,S=p-o-m-O;let y,v;if(s===0)y=n===0?r:n===1?d:((A*n+T)*n+g)*n+r,v=n===0?o:n===1?p:((S*n+O)*n+m)*n+o;else{const R=Fs,M=1-R;if(n<R?(y=g,v=m):n>M?(y=3*(d-l),v=3*(p-h)):(y=(3*A*n+2*T)*n+g,v=(3*S*n+2*O)*n+m),i){y===0&&v===0&&(n<R||n>M)&&(y=l-a,v=h-c);const L=wo(y*y+v*v);L&&(y/=L,v/=L)}if(s===3){const L=6*A*n+2*T,P=6*S*n+2*O,k=Pp(y*y+v*v,3/2);y=k===0?0:(y*P-v*L)/k,v=0}}return s===2?new N(v,-y):new N(y,v)}function Ia(e,n,s,i,r,o,a,c,l,h,d,p,E){if(++l>=4096||++c>=40)return l;const g=1e-9,T=n[0],A=n[1],m=n[6],O=n[7],S=Qn.getSignedDistance,y=S(T,A,m,O,n[2],n[3]),v=S(T,A,m,O,n[4],n[5]),R=y*v>0?3/4:4/9,M=R*Ec(0,y,v),L=R*Oa(0,y,v),P=S(T,A,m,O,e[0],e[1]),k=S(T,A,m,O,e[2],e[3]),Q=S(T,A,m,O,e[4],e[5]),b=S(T,A,m,O,e[6],e[7]),X=A2(P,k,Q,b),K=X[0],V=X[1];let J,ge;if(y===0&&v===0&&P===0&&k===0&&Q===0&&b===0||(J=uI(K,V,M,L))==null||(ge=uI(K.reverse(),V.reverse(),M,L))==null)return l;const se=h+(d-h)*J,ue=h+(d-h)*ge;let te,ie;if(Oa(E-p,ue-se)<g)te=(se+ue)/2,ie=(p+E)/2,gc(r,o,a?i:s,a?ie:te,a?s:i,a?te:ie);else{e=ae.getPart(e,J,ge);const re=E-p;if(ge-J>.8)if(ue-se>re){const fe=ae.subdivide(e,.5);te=(se+ue)/2,l=Ia(n,fe[0],i,s,r,o,!a,c,l,p,E,se,te),l=Ia(n,fe[1],i,s,r,o,!a,c,l,p,E,te,ue)}else{const fe=ae.subdivide(n,.5);ie=(p+E)/2,l=Ia(fe[0],e,i,s,r,o,!a,c,l,p,ie,se,ue),l=Ia(fe[1],e,i,s,r,o,!a,c,l,ie,E,se,ue)}else re===0||re>=g?l=Ia(n,e,i,s,r,o,!a,c,l,p,E,se,ue):l=Ia(e,n,s,i,r,o,a,c,l,se,ue,p,E)}return l}function A2(e,n,s,i){const r=[0,e],o=[1/3,n],a=[2/3,s],c=[1,i],l=n-(2*e+i)/3,h=s-(e+2*i)/3;let d;if(l*h<0)d=[[r,o,c],[r,a,c]];else{const p=l/h;d=[p>=2?[r,o,c]:p<=.5?[r,a,c]:[r,o,a,c],[r,c]]}return(l||h)<0?d.reverse():d}function uI(e,n,s,i){return e[0][1]<s?dI(e,!0,s):n[0][1]>i?dI(n,!1,i):e[0][0]}function dI(e,n,s){let i=e[0][0],r=e[0][1];for(let o=1,a=e.length;o<a;o++){const c=e[o][0],l=e[o][1];if(n?l>=s:l<=s)return l===s?c:i+(s-r)*(c-i)/(l-r);i=c,r=l}return null}const fI=e=>{const n=e[0],s=e[1],i=e[2],r=e[3],o=e[4],a=e[5],c=e[6],l=e[7],h=9*(i-o)+3*(c-n),d=6*(n+o)-12*i,p=3*(i-n),E=9*(r-a)+3*(l-s),g=6*(s+a)-12*r,T=3*(r-s);return function(A){const m=(h*A+d)*A+p,O=(E*A+g)*A+T;return wo(m*m+O*O)}},pI=(e,n)=>Oa(2,Ec(16,g2(Mp(n-e)*32)));function m2(e,n,s,i,r,o,a){const c=n[0],l=n[1],h=n[6],d=n[7],p=O2(e,c,l,h-c,d-l);for(let E=0,g=p.length;E<g;E++){const T=p[E],A=ae.getPoint(e,T),m=ae.getTimeOf(n,A);m!==null&&gc(r,o,a?i:s,a?m:T,a?s:i,a?T:m)}}function O2(e,n,s,i,r){const o=Kn.isZero;if(o(i)&&o(r)){const p=ae.getTimeOf(e,new N(n,s));return p===null?[]:[p]}const a=_2(-r,i),c=Math.sin(a),l=Math.cos(a),h=[],d=[];for(let p=0;p<8;p+=2){const E=e[p]-n,g=e[p+1]-s;h.push(E*l-g*c,E*c+g*l)}return ae.solveCubic(h,1,0,d,0,1),d}const I2=[.362683783378362,-.1834346424956498,.362683783378362,.1834346424956498,.3137066458778873,-.525532409916329,.3137066458778873,.525532409916329,.2223810344533745,-.7966664774136267,.2223810344533745,.7966664774136267,.1012285362903763,-.9602898564975363,.1012285362903763,.9602898564975363],S2=[.362683783378362,.1834346424956498,.3137066458778873,.525532409916329,.2223810344533745,.7966664774136267,.1012285362903763,.9602898564975363],y2=[.1894506104550685,.0950125098376374,.1826034150449236,.2816035507792589,.1691565193950025,.4580167776572274,.1495959888165767,.6178762444026438,.1246289712555339,.755404408355003,.0951585116824928,.8656312023878318,.0622535239386479,.9445750230732326,.0271524594117541,.9894009349916499],C2=[.1279381953467522,.0640568928626056,.1258374563468283,.1911188674736163,.1216704729278034,.3150426796961634,.1155056680537256,.4337935076260451,.1074442701159656,.5454214713888396,.0976186521041139,.6480936519369755,.0861901615319533,.7401241915785544,.0733464814110803,.820001985973903,.0592985849154368,.8864155270044011,.0442774388174198,.9382745520027328,.0285313886289337,.9747285559713095,.0123412297999872,.9951872199970213];function Mu(e,n,s){const[i,r,o,a,c,l,h,d]=e,p=h-i,E=d-r,g=o-i,T=a-r,A=c-o,m=l-a,O=h-c,S=d-l,y=Math.hypot(g,T)+Math.hypot(A,m)+Math.hypot(O,S)-Math.hypot(p,E),v=A-g,R=m-T,M=O-A,L=S-m,P=.25*(g+O)+.5*A,k=.25*(T+S)+.5*m,Q=.5*(M+v),b=.5*(L+R),X=.25*(M-v),K=.25*(L-R),V=I2;let J=0;for(let te=0;te<V.length;te+=2){const ie=V[te+1],re=P+Q*ie+X*(ie*ie),fe=k+b*ie+K*(ie*ie),Ne=Q+X*(2*ie),At=b+K*(2*ie);J+=V[te]*(Ne*Ne+At*At)/(re*re+fe*fe)}const ge=J*J*J;let se=null;if(Math.min(ge*25e-7,.03)*y<n)se=S2;else if(Math.min(ge*ge*15e-12,.009)*y<n)se=y2;else if(Math.min(ge*ge*ge*35e-17,.0035)*y<n||s>=20)se=C2;else{const[te,ie]=ae.subdivide(e,.5);return Mu(te,n*.5,s+1)+Mu(ie,n*.5,s+1)}let ue=0;for(let te=0;te<se.length;te+=2){const ie=se[te+1],re=se[te],fe=P+X*(ie*ie),Ne=k+K*(ie*ie),At=Math.hypot(fe+Q*ie,Ne+b*ie),Ke=Math.hypot(fe-Q*ie,Ne-b*ie);ue+=re*(At+Ke)}return 1.5*ue}const Tc={None:0,Loop:1,DoubleInflection:2};function Do(e,n){const s=Lt(e);return n<0?-s:s}function EI(e,n,s,i,r,o,a,c){const l=Math.max(Math.ceil(Math.log2((s-n)/i))-1,0),h=r+l;let d=i*Math.exp(h*Math.LN2);for(;s-n>2*i;){const p=.5*(n+s),E=d-.5*(s-n),g=(c*n-a*s)/(c-a),T=p-g,A=o*(s-n)*(s-n),m=A<=Math.abs(p-g)?g+Do(A,T):p,O=Math.abs(m-p)<=E?m:p-Do(E,T),S=e(O);if(S>0)s=O,c=S;else if(S<0)n=O,a=S;else return O;d*=.5}return .5*(n+s)}function bp(e,n,s){const i=e/s,r=n/s;if(!(isFinite(i)&&isFinite(r))){const l=-e/n;return isFinite(l)?[l]:e==0&&n==0?[0]:[]}const o=r*r-4*i;let a=0;if(isFinite(o)){if(o<0)return[];if(o==0)return[-.5*r];a=-.5*(r+Do(os(o),r))}else a=-r;const c=i/a;return isFinite(c)?c>a?[a,c]:[c,a]:[a]}function Up(e,n,s,i){const r=s/(3*i),o=n/(3*i),a=e/i;if(!(isFinite(a)&&isFinite(o)&&isFinite(r)))return bp(e,n,s);const c=-r*r+o,l=-o*r+a,h=r*a-o*o,d=4*c*h-l*l,p=-2*r*c+l;if(d<0){const E=os(-.25*d),g=-.5*p;return[Fp(g+E)+Fp(g-E)-r]}else if(d==0){const E=Do(os(-c),p);return[E-r,-2*E-r]}else{const E=D2(os(d),-p)/3,g=_I(E),T=R2(E)*os(3),A=.5*(-g+T),m=.5*(-g-T),O=2*os(-c);return[O*g-r,O*A-r,O*m-r]}}function N2(e,n,s,i,r){function o(se,ue,te,ie){const re=Sa(se+te,e),fe=Sa(ue+se*te+ie,n),Ne=Sa(ue*te+se*ie,s);return re+fe+Ne}function a(se,ue,te,ie){return o(se,ue,te,ie)+Sa(ue*ie,i)}const c=9*e*e-24*n,l=c>=0?-2*n/(3*e+Do(os(c),e)):-.25*e,h=e+4*l,d=n+3*l*(e+2*l),p=s+l*(2*n+l*(3*e+4*l)),E=i+l*(s+l*(n+l*(e+l)));let g=0,T=0;if(g=h*p-4*E-1/3*d*d,T=(h*p+8*E-2/9*d*d)*(1/3)*d-p*p-h*h*E,!isFinite(g)&&isFinite(T))return null;let A=x2(g,T);const m=e*.5,O=1/6*n+.5*A,S=s-e*O,y=2/3*n-A-m*m,v=.5*S/y,R=2*(i-O*O)/S,M=.5*S/R;let L=0,P=0,k=1/0;for(let se=0;se<3;se++){const ue=se==1?M:y,te=se==0?v:R,ie=Sa(ue+m*m+2*O,n),re=Sa(2*(ue*te+m*O),s),fe=Sa(ue*te*te+O*O,i),Ne=ie+re+fe;(se==0||Ne<k)&&(L=ue,P=te,k=Ne)}const Q=L,b=P;let X=0,K=0,V=0,J=0;if(Q<0){const se=os(-Q);if(X=m+se,K=O+se*b,V=m-se,J=O-se*b,Lt(J)<Lt(K)?J=i/K:Lt(J)>Lt(K)&&(K=i/J),Lt(X)!=Lt(V)){let ue=null,te=null;if(Lt(X)<Lt(V)){const re=(s-K*V)/J,fe=(n-J-K)/V;ue=[e-V,re,fe],te=[V,V,V]}else{const re=(s-X*J)/K,fe=(n-J-K)/X,Ne=e-X;ue=[X,X,X],te=[Ne,re,fe]}let ie=0;for(let re=0;re<3;re++){const fe=ue[re],Ne=te[re];if(isFinite(fe)&&isFinite(Ne)){const At=o(fe,K,Ne,J);(re==0||At<ie)&&(X=fe,V=Ne,ie=At)}}}}else if(Q==0){const se=i-O*O;X=m,K=O+os(-se),V=m,J=O-os(-se),Lt(K)>Lt(J)?J=i/K:Lt(J)>Lt(K)&&(K=i/J)}else return[];let ge=a(X,K,V,J);for(let se=0;se<8&&ge!=0;se++){const ue=K*J-i,te=K*V+X*J-s,ie=K+X*V+J-n,re=X+V-e,fe=X-V,Ne=K*K-K*(V*fe+2*J)+J*(X*fe+J);if(Ne==0)break;const At=1/Ne,Ke=J-K,St=K*V-X*J,hn=fe*ue+Ke*te+St*ie-(K*Ke+X*St)*re,_t=(X*fe+Ke)*ue-K*(fe*te+Ke*ie+St*re),qn=-fe*ue-Ke*te-St*ie+(V*St+J*Ke)*re,ni=-(V*fe+Ke)*ue+J*(fe*te+Ke*ie+St*re),ys=X-At*hn,Hi=K-At*_t,Xo=V-At*qn,jn=J-At*ni,On=a(ys,Hi,Xo,jn);if(On<ge)X=ys,K=Hi,V=Xo,J=jn,ge=On;else break}return[X,K,V,J]}function Gp(e,n){const s=Qn.getDistance,i=Fs,r=tr;let o=ae.isStraight(e),a=ae.isStraight(n),c=o&&a;const l=gI(e)<gI(n),h=l?n:e,d=l?e:n,p=h[0],E=h[1],g=h[6]-p,T=h[7]-E;if(s(p,E,g,T,d[0],d[1],!0)<r&&s(p,E,g,T,d[6],d[7],!0)<r)!c&&s(p,E,g,T,h[2],h[3],!0)<r&&s(p,E,g,T,h[4],h[5],!0)<r&&s(p,E,g,T,d[2],d[3],!0)<r&&s(p,E,g,T,d[4],d[5],!0)<r&&(o=!0,a=!0,c=!0);else if(c)return null;if(o^a)return null;const A=[e,n];let m=[];for(let O=0;O<4&&m.length<2;O++){const S=O&1,y=S^1,v=O>>1,R=ae.getTimeOf(A[S],new N(A[y][v?6:0],A[y][v?7:1]));if(R!=null){const M=S?[v,R]:[R,v];(!m.length||Lt(M[0]-m[0][0])>i&&Lt(M[1]-m[0][1])>i)&&m.push(M)}if(O>2&&!m.length)break}if(m.length!==2)m=null;else if(!c){const O=ae.getPart(e,m[0][0],m[1][0]),S=ae.getPart(n,m[0][1],m[1][1]);(Lt(S[2]-O[2])>r||Lt(S[3]-O[3])>r||Lt(S[4]-O[4])>r||Lt(S[5]-O[5])>r)&&(m=null)}return m}function Sa(e,n){return n==0?Lt(e):Lt((e-n)/n)}function x2(e,n){const s=-.3333333333333333*e,i=.5*n;let r,o=null;if((Lt(s)>=1e102||Lt(i)>=1e164)&&(Lt(s)<Lt(i)?o=1-s*(s/i)*(s/i):o=Math.sign(s)*(i/s*(i/s)/s-1)),o!==null&&i==0)e>0?r=0:r=os(-e);else if(o!==null?o<0:i*i<s*s*s){const h=o!==null?i/s/os(s):i/os(s*s*s);r=-2*os(s)*Do(_I(w2(Lt(h))*(1/3)),h)}else{let h;o!==null?Lt(s)<Lt(i)?h=-i*(1+os(o)):h=-i-Do(os(Lt(s))*s*os(o),i):h=Fp(-i-Do(os(i*i-s*s*s),i));const d=h==0?0:s/h;r=h+d}let a=r,c=(a*a+e)*a+n;if(Lt(c)<222045e-21*v2(a*a*a,e*a,n))return a;for(let h=0;h<8;h++){const d=3*a*a+e;if(d==0)break;const p=a-c/d,E=(p*p+e)*p+n;if(E==0)return p;if(Lt(E)>=Lt(c))break;a=p,c=E}return a}function gI(e){const n=e[6]-e[0],s=e[7]-e[1];return n*n+s*s}const v2=Math.max,Lt=Math.abs,os=Math.sqrt,R2=Math.sin,_I=Math.cos,w2=Math.acos,D2=Math.atan2,Fp=Math.cbrt;function L2(){this.width=1,this.join=bs.BEVEL,this.miterLimit=4,this.startCap=on.NONE,this.endCap=on.NONE,this.dashPattern=[0,0,0,0],this.scale=!1}function M2(e,n,s=.001){if(!Array.isArray(n.dashPattern)||n.dashPattern.length<=1)return TI(e,n,s);{const i=n.startCap===on.ROUND||n.endCap===on.ROUND,r=W2(e,n.dashPattern,i);return r.isEmpty()?r:TI(r,n,s)}}function TI(e,n,s=.001){const i=new kp;i.join_thresh=2*s/n.width;const r=new N,o=new N,a=new N,c=new N,l=new ae;for(let h=0,d=e._children.length;h<d;h++){const p=e._children[h];if(p.isEmpty())continue;const E=p._segments;i.finish(n);const g=E[0];r.copy(g._point),o.copy(g._point).add(g._handleOut),i.last_pt.copy(r),i.start_pt.copy(r);for(let T=1,A=E.length,m=p._closed?A+1:A;T<m;T++){const O=E[T%A];if(a.copy(O._point).add(O._handleIn),c.copy(O._point),i2(r.x,r.y,o.x,o.y,a.x,a.y,c.x,c.y)===gs.line){if(!c.equals(r)){const y=c.clone().sub(r);i.doJoin(n,y,!!O._path._closed),i.last_tan.copy(y),i.doLine(n,y,c)}}else if(!o.equals(r)||!a.equals(r)||!c.equals(r)){l.initWith4Points(r,o,a,c);const[y,v]=H2(r,o,a,c);i.doJoin(n,y,!!O._path._closed),i.last_tan.copy(v),i.doCubic(n,l,s)}r.copy(O._point),o.copy(O._point).add(O._handleOut),i.last_pt.copy(r)}p._closed&&i.finishClosed(n)}return i.finish(n),i.output.reduce(),i.output.isEmpty()||i.output.close(),i.output}function kp(){this.output=new qe,this.forward_path=new Ct,this.backward_path=new Ct,this.start_pt=new N,this.start_norm=new N,this.start_tan=new N,this.last_pt=new N,this.last_tan=new N,this.join_thresh=0}kp.prototype={constructor:kp,finish(e){if(this.forward_path.isEmpty())return;const n=.001,s=this.backward_path.getLastSegment()._point,i=this.last_pt.clone().sub(s);switch(Bp(this.output,this.forward_path),e.endCap){case on.ROUND:{OI(this.output,n,this.last_pt,i);break}case on.SQUARE:{II(this.output,!1,this.last_pt,i);break}default:{this.output.lineTo(s.x,s.y);break}}switch(AI(this.output,this.backward_path,!0),e.startCap){case on.ROUND:{OI(this.output,n,this.start_pt,this.start_norm);break}case on.SQUARE:{II(this.output,!0,this.start_pt,this.start_norm);break}default:{this.output.close();break}}this.forward_path.clear(),this.backward_path.clear()},finishClosed(e){this.doJoin(e,this.start_tan),Bp(this.output,this.forward_path),this.output.close(.001);const s=this.backward_path.getLastSegment();this.output.moveTo(s._point.x,s._point.y),AI(this.output,this.backward_path),this.output.close(.001),this.forward_path.clear(),this.backward_path.clear()},doJoin(e,n,s=!0){const r=n.length()===0?0:.5*e.width/n.length(),o=new N(-n.y,n.x).scale(r),a=this.last_pt;if(this.forward_path.isEmpty())this.forward_path.moveTo(a.x-o.x,a.y-o.y),this.backward_path.moveTo(a.x+o.x,a.y+o.y),this.start_tan.copy(n),this.start_norm.copy(o);else{const c=this.last_tan,l=n,h=c.cross(l),d=c.dot(l),p=Math.hypot(h,d);if(!s||Math.abs(h)>=p*this.join_thresh)switch(e.join){case bs.MITER:{if(p*2<(p+d)*(e.miterLimit*e.miterLimit)){const E=c.length()===0?0:.5*e.width/c.length(),g=new N(-c.y,c.x).scale(E);if(h>0){const T=a.clone().sub(g),A=a.clone().sub(o),m=c.cross(A.clone().sub(T))/h,O=l.clone().scale(-m).add(A);this.forward_path.lineTo(O.x,O.y)}else if(h<0){const T=a.clone().add(g),A=a.clone().add(o),m=c.cross(A.clone().sub(T))/h,O=l.clone().scale(-m).add(A);this.backward_path.lineTo(O.x,O.y)}}this.forward_path.lineTo(a.x-o.x,a.y-o.y),this.backward_path.lineTo(a.x+o.x,a.y+o.y);break}case bs.ROUND:{const E=Math.atan2(h,d);h>0?(this.backward_path.lineTo(a.x+o.x,a.y+o.y),Vp(this.forward_path,.001,a,o,E)):h<0?(this.forward_path.lineTo(a.x-o.x,a.y-o.y),mI(this.backward_path,.001,a,o.negate(),-E)):E<=0?(this.forward_path.lineTo(a.x-o.x,a.y-o.y),mI(this.backward_path,.001,a,o.negate(),-E)):(this.backward_path.lineTo(a.x+o.x,a.y+o.y),Vp(this.forward_path,.001,a,o,E));break}default:{this.forward_path.lineTo(a.x-o.x,a.y-o.y),this.backward_path.lineTo(a.x+o.x,a.y+o.y);break}}}},doLine(e,n,s){const i=.5*e.width/n.length(),r=new N(-n.y,n.x).scale(i);this.forward_path.lineTo(s.x-r.x,s.y-r.y),this.backward_path.lineTo(s.x+r.x,s.y+r.y),this.last_pt.copy(s)},doCubic(e,n,s){const r=s*.25;let o=null;o=Ac.regularized(n,-.5*e.width,r);const a=NI(o,s);this.forward_path.join(a),o=Ac.regularized(n,.5*e.width,r);const c=NI(o,s);this.backward_path.join(c),this.last_pt.copy(n.getP3())}};function Bp(e,n,s=!1){if(n.isEmpty())return e;if(!s||e.isEmpty())return e.addChild(n.clone());const i=e._children[e._children.length-1],r=i.getLastSegment(),o=n.getFirstSegment();if(o._point.isClose(r._point,tr)){r.setHandleOut(o._handleOut);for(let a=1,c=n._segments.length;a<c;a++)i.add(n._segments[a])}else e.addChild(n.clone());return e}function AI(e,n,s){return n.reverse(),Bp(e,n,s)}function Vp(e,n,s,i,r){const o=new Hs([i.x,i.y,-i.y,i.x,s.x,s.y]),c=new bu(new N(0,0),new N(1,1),Math.PI-r,r,0).toCubicBeziers(n);for(let l=0;l<c.length;l+=3){const h=c[l],d=c[l+1],p=c[l+2];o.applyPoint(h,h),o.applyPoint(d,d),o.applyPoint(p,p),e.cubicCurveTo(h.x,h.y,d.x,d.y,p.x,p.y)}}function mI(e,n,s,i,r){const o=new Hs([i.x,i.y,i.y,-i.x,s.x,s.y]),c=new bu(new N(0,0),new N(1,1),Math.PI-r,r,0).toCubicBeziers(n);for(let l=0;l<c.length;l+=3){const h=c[l],d=c[l+1],p=c[l+2];o.applyPoint(h,h),o.applyPoint(d,d),o.applyPoint(p,p),e.cubicCurveTo(h.x,h.y,d.x,d.y,p.x,p.y)}}function OI(e,n,s,i){Vp(e,n,s,i,Math.PI)}function II(e,n,s,i){const r=new Hs([i.x,i.y,-i.y,i.x,s.x,s.y]),o=new N;r.applyPoint(o.set(1,1),o),e.lineTo(o.x,o.y),r.applyPoint(o.set(-1,1),o),e.lineTo(o.x,o.y),n?e.close():(r.applyPoint(o.set(-1,0),o),e.lineTo(o.x,o.y))}function Pu(e,n,s){const i=Math.sin(s),r=Math.cos(s),o=e.x*r,a=e.y*i;return P2(o,a,n)}function P2(e,n,s){const i=Math.sin(s),r=Math.cos(s);return new N(e*r-n*i,e*i+n*r)}function b2(e,n,s,i){const[r,o]=[Math.cos(e),Math.sin(e)],[a,c]=[Math.cos(n),Math.sin(n)],l=-9*r*(((2*c*a*r+o*(2*a*a-1))*r-2*c*a)*r-a*a*o),h=12*((((a*(30*s*a-c)-15*s)*r+2*o-a*o*(a+30*s*c))*r+a*(c-15*s*a))*r-o*a*a),d=12*((((70*i+15*s)*c*c+a*(9*c-70*a*i-5*a*s))*r-5*o*c*(3*c-4*a*(7*i+s)))*r-a*(9*c-70*a*i-5*a*s)),p=16*(((12*o-5*r*(42*i-17*s))*c-70*a*(3*i-s)*o-75*r*a*s*s)*c-75*a*a*s*s*o),E=80*c*(42*c*i-25*s*(c-a*s));let g=[];const T=1e-12;if(Math.abs(l)>T){const O=h/l,S=d/l,y=p/l,v=E/l,R=N2(O,S,y,v);if(R!==null)for(let M=0;M<R.length;M+=2){const L=R[M],P=R[M+1],k=bp(P,L,1);k.length>0?g=g.concat(k):g.push(-.5*L)}}else Math.abs(h)>T?g=g.concat(Up(E,p,d,h)):g=g.concat(bp(E,p,d));const A=o*a+c*r,m=[];for(let O=0,S=g.length;O<S;O++){let y=g[O],v=0;y>0?(v=(y*o-s*(10/3))/(.5*y*A-c),v<=0&&(y=c/A,v=0)):(y=0,v=o/A),y>=0&&v>=0&&m.push({cand:new ae().initWith4PointsN(0,0,y*r,y*o,1-v*a,v*c,1,0),d0:y,d1:v})}return m}const SI=Math.PI*2,yI=e=>{const n=e*k2*.5;return SI*(n-Math.round(n))},U2=.65,G2=2,CI=e=>1+Math.max(e-U2,0)*G2;function F2(e,n,s,i){const r=e.samplePointTangent(n,1),o=e.samplePointTangent(s,-1),a=o.p.clone().sub(r.p),c=a.length_squared(),l=i*i;if(c<=l)return xI(e,i,n,s,r.p,o.p);const h=a.angle(),d=yI(r.tangent.angle()-h),p=yI(h-o.tangent.angle());let{area:E,x:g,y:T}=e.momentIntegrals(n,s);const[A,m]=[r.p.x,r.p.y],[O,S]=[a.x,a.y];E-=O*(m+.5*S);const y=S*(1/3);g-=O*(A*m+.5*(A*S+m*O)+y*O),T-=O*(m*m+m*S+y*S),g-=A*E,T=.5*T-m*E;const v=a.x*g+a.y*T,R=1/c,M=E*R,L=v*R*R,P=Math.sqrt(c),k=Hs.translate(r.p).multiply(Hs.rotate(h)).multiply(Hs.scale(P)),Q=new Wp(e,n,s);let b=null,X=null;const K=b2(d,p,M,L);for(let V=0,J=K.length;V<J;V++){const{cand:ge,d0:se,d1:ue}=K[V],te=k.applyCubic(ge);let ie=Q.evalDist(e,te,l);if(ie!==null){const re=Math.pow(Math.max(CI(se),CI(ue)),2);ie*=re,ie<l&&(X!==null&&ie<X||X===null)&&(b=te,X=ie)}}return b!==null&&X!==null?{c:b,err:X}:null}function NI(e,n){const s=new Ct;return Rl(e,0,1,n,s),s}function xI(e,n,s,i,r,o){const a=n*n,c=new Qn().initP(r,o),l=7;let h=0;const d=(i-s)/(l+1);for(let T=0;T<l;T++){const A=s+(T+1)*d,m=e.samplePointDeriv(A).p,O=c.nearest(m,n).distance_sq;if(O>a)return null;h=O>h?O:h}const p=r.clone().linear_interpolate(o,1/3),E=o.clone().linear_interpolate(r,1/3);return{c:new ae().initWith4Points(r,p,E,o),err:h}}function Rl(e,n,s,i,r){const o=n,a=s,c=e.samplePointTangent(n,1).p,l=e.samplePointTangent(s,-1).p;if(c.distance_squared_to(l)<=i*i){const d=xI(e,i,n,s,c,l);if(d){const p=d.c;if(r.isEmpty()){const A=p.getP0();r.moveTo(A.x,A.y)}const E=p.getP1(),g=p.getP2(),T=p.getP3();r.cubicCurveTo(E.x,E.y,g.x,g.y,T.x,T.y);return}}let h=e.breakCusp(n,s);if(h!==null)Rl(e,o,h,i,r),Rl(e,h,a,i,r);else{const d=F2(e,n,s,i);if(d!==null){if(r.isEmpty()){const T=d.c.getP0();r.moveTo(T.x,T.y)}const p=d.c.getP1(),E=d.c.getP2(),g=d.c.getP3();r.cubicCurveTo(p.x,p.y,E.x,E.y,g.x,g.y)}else h=.5*(o+a),Rl(e,o,h,i,r),Rl(e,h,a,i,r)}}function Hs(e){this.c=e}Hs.prototype={constructor:Hs,applyPoint(e,n=new N){const s=this.c,i=s[0]*e.x+s[2]*e.y+s[4],r=s[1]*e.x+s[3]*e.y+s[5];return n.set(i,r)},applyCubic(e){const n=this.c,s=e.getP0(),i=e.getP1(),r=e.getP2(),o=e.getP3();return new ae().initWith4PointsN(n[0]*s.x+n[2]*s.y+n[4],n[1]*s.x+n[3]*s.y+n[5],n[0]*i.x+n[2]*i.y+n[4],n[1]*i.x+n[3]*i.y+n[5],n[0]*r.x+n[2]*r.y+n[4],n[1]*r.x+n[3]*r.y+n[5],n[0]*o.x+n[2]*o.y+n[4],n[1]*o.x+n[3]*o.y+n[5])},multiply(e){const n=this.c,s=e.c;return new Hs([n[0]*s[0]+n[2]*s[1],n[1]*s[0]+n[3]*s[1],n[0]*s[2]+n[2]*s[3],n[1]*s[2]+n[3]*s[3],n[0]*s[4]+n[2]*s[5]+n[4],n[1]*s[4]+n[3]*s[5]+n[5]])}},Hs.translate=e=>new Hs([1,0,0,1,e.x,e.y]),Hs.rotate=e=>{const n=Math.cos(e),s=Math.sin(e);return new Hs([n,s,-s,n,0,0])},Hs.scale=e=>new Hs([e,0,0,e,0,0]);const vI=Math.PI*.5,k2=1/Math.PI;function bu(e,n,s,i,r){this.center=e,this.radii=n,this.start_angle=s,this.sweep_angle=i,this.x_rotation=r}bu.prototype={constructor:bu,toCubicBeziers(e){const n={idx:0,center:new N().copy(this.center),radii:new N().copy(this.radii),x_rotation:this.x_rotation,n:0,arm_len:0,angle_step:0,p0:new N,angle0:0},s=Math.sign(this.sweep_angle),i=Math.max(this.radii.x,this.radii.y)/e,r=Math.max(Math.pow(1.1163*i,1/6),3.999999);n.n=Math.ceil(r*Math.abs(this.sweep_angle)*(1/SI)),n.angle_step=this.sweep_angle/n.n,n.arm_len=Math.tan(Math.abs(4/3*(.25*n.angle_step)))*s,n.angle0=this.start_angle,n.p0=Pu(this.radii,this.x_rotation,n.angle0);const o=[];for(;n.idx<n.n;){const a=n.angle0+n.angle_step,l=n.p0.clone().clone().add(Pu(n.radii,n.x_rotation,n.angle0+vI).scale(n.arm_len)),h=Pu(n.radii,n.x_rotation,a),d=h.clone().sub(Pu(n.radii,n.x_rotation,a+vI).scale(n.arm_len));n.angle0=a,n.p0=h,n.idx+=1,o.push(l.clone().add(n.center),d.clone().add(n.center),h.clone().add(n.center))}return o}};const B2=[.1894506104550685,-.0950125098376374,.1894506104550685,.0950125098376374,.1826034150449236,-.2816035507792589,.1826034150449236,.2816035507792589,.1691565193950025,-.4580167776572274,.1691565193950025,.4580167776572274,.1495959888165767,-.6178762444026438,.1495959888165767,.6178762444026438,.1246289712555339,-.755404408355003,.1246289712555339,.755404408355003,.0951585116824928,-.8656312023878318,.0951585116824928,.8656312023878318,.0622535239386479,-.9445750230732326,.0622535239386479,.9445750230732326,.0271524594117541,-.9894009349916499,.0271524594117541,.9894009349916499],V2=[.0965400885147278,-.0483076656877383,.0965400885147278,.0483076656877383,.0956387200792749,-.1444719615827965,.0956387200792749,.1444719615827965,.0938443990808046,-.2392873622521371,.0938443990808046,.2392873622521371,.0911738786957639,-.3318686022821277,.0911738786957639,.3318686022821277,.0876520930044038,-.4213512761306353,.0876520930044038,.4213512761306353,.0833119242269467,-.5068999089322294,.0833119242269467,.5068999089322294,.0781938957870703,-.5877157572407623,.0781938957870703,.5877157572407623,.0723457941088485,-.6630442669302152,.0723457941088485,.6630442669302152,.0658222227763618,-.7321821187402897,.0658222227763618,.7321821187402897,.0586840934785355,-.7944837959679424,.0586840934785355,.7944837959679424,.0509980592623762,-.84936761373257,.0509980592623762,.84936761373257,.0428358980222267,-.8963211557660521,.0428358980222267,.8963211557660521,.0342738629130214,-.9349060759377397,.0342738629130214,.9349060759377397,.0253920653092621,-.9647622555875064,.0253920653092621,.9647622555875064,.0162743947309057,-.9856115115452684,.0162743947309057,.9856115115452684,.0070186100094701,-.9972638618494816,.0070186100094701,.9972638618494816];function Ac(e,n){this.c=e,this.d=n,this.q=e.deriv();const s=this.q.p0.clone(),i=this.q.p1.clone().sub(this.q.p0).scale(2),r=this.q.p0.clone().sub(this.q.p1.clone().scale(2)).add(this.q.p2);this.c0=n*i.cross(s),this.c1=n*2*r.cross(s),this.c2=n*r.cross(i)}Ac.prototype={constructor:Ac,evalOffset(e){const n=this.q.eval(e),s=new N(-n.y,n.x);return n.length()===0?new N(0,0):s.scale(this.d/n.length())},eval(e){return this.c.eval(e).add(this.evalOffset(e))},evalDeriv(e){return this.q.eval(e).scale(this.cuspSign(e))},samplePoints(e){const n=[];let s=0;const i=V2,r=1/(e+1);for(let o=0;o<e;o++){for(let h=0;h<i.length;h+=2){const d=r*(o+.5+.5*i[h+1]);s+=i[h]*this.evalDeriv(d).length()}const a=r*(o+1),c=this.evalOffset(a),l=this.c.eval(a).add(c);n.push({arclen:s*.5*r,p:l,d:c})}return n},cuspSign(e){const n=this.q.eval(e).length_squared();return(n===0?1/0:((this.c2*e+this.c1)*e+this.c0)/(n*Math.sqrt(n)))+1},samplePointTangent(e,n){const s=this.eval(e),i=1e-8;let r=this.cuspSign(e);Math.abs(r)<i&&(r=n*(this.cuspSign(e+i)-this.cuspSign(e-i)));const o=this.q.eval(e).scale(Math.sign(r));return new Hp(s,o)},samplePointDeriv(e){return{p:this.eval(e),dp:this.evalDeriv(e)}},momentIntegrals(e,n){const s=.5*(e+n),i=.5*(n-e);let r=0,o=0,a=0;const c=B2;for(let l=0;l<c.length;l+=2){const[h,d]=[c[l],c[l+1]],p=s+d*i,{p:E,dp:g}=this.samplePointDeriv(p),T=h*g.x*E.y,A=E.x*T,m=E.y*T;r+=T,o+=A,a+=m}return{area:r*i,x:o*i,y:a*i}},breakCusp(e,n){const i=(E,g)=>{let T=this.cuspSign(E);for(;Math.abs(T)<1e-8&&g<1;){E+=g;const A=T;if(T=this.cuspSign(E),Math.abs(T)>Math.abs(A))break;g*=2}return[E,T]},[r,o]=i(e,1e-12),[a,c]=i(n,-1e-12);if(r>=a||o*c>=0)return null;const l=Math.sign(c),h=E=>l*this.cuspSign(E),d=.2/(a-r);return EI(h,r,a,1e-12,1,d,l*o,l*c)}},Ac.regularized=(e,n,s)=>new Ac(e.clone().regularize(s),n);function Hp(e,n){this.p=e,this.tangent=n}Hp.prototype={constructor:Hp,intersect(e){const n=e.getP1().clone().sub(e.getP0()).scale(3),s=e.getP2().clone().scale(3).sub(e.getP1().clone().scale(6)).add(e.getP0().clone().scale(3)),i=e.getP3().clone().sub(e.getP0()).sub(e.getP2().clone().sub(e.getP1()).scale(3)),r=e.getP0().clone().sub(this.p).dot(this.tangent),o=n.dot(this.tangent),a=s.dot(this.tangent),c=i.dot(this.tangent),l=Up(r,o,a,c),h=[];for(let d=0;d<l.length;d++){const p=l[d];p>=0&&p<=1&&h.push(p)}return h}};const mc=20;function Wp(e,n,s){this.samples=[],this.arcparams=[],this.rangeStart=n,this.rangeEnd=s,this.spicy=!1;const i=(s-n)*(1/(mc+1));let r=null;const o=.2;for(let a=0;a<mc+2;a++){const c=e.samplePointTangent(n+a*i,1);if(r!==null){const l=c.tangent.cross(r),h=c.tangent.dot(r);Math.abs(l)>o*Math.abs(h)&&(this.spicy=!0)}c.tangent&&(r=c.tangent),a>0&&a<mc+1&&this.samples.push(c)}}Wp.prototype={constructor:Wp,computeArcParams(e){const[s,i]=[this.rangeStart,this.rangeEnd],r=(i-s)*(1/((mc+1)*10));let o=0;for(let c=0;c<mc+1;c++){for(let l=0;l<10;l++){const h=s+r*(c*10+l+.5);o+=e.samplePointDeriv(h).dp.length()}c<mc&&this.arcparams.push(o)}const a=1/o;for(let c=0;c<this.arcparams.length;c++)this.arcparams[c]*=a},evalArc(e,n){const i=e.arclen(1e-9);let r=0;for(let o=0;o<this.samples.length;o++){const a=this.samples[o],c=this.arcparams[o],l=e.invArclen(i*c,1e-9),h=a.p.distance_squared_to(e.eval(l));if(r=Math.max(h,r),r>n)return null}return r},evalRay(e,n){let s=0;for(let i=0,r=this.samples.length;i<r;i++){const o=this.samples[i];let a=n+1;const c=o.intersect(e);for(let l=0,h=c.length;l<h;l++){const d=c[l],p=o.p.distance_squared_to(e.eval(d));a=Math.min(a,p)}if(s=Math.max(a,s),s>n)return null}return s},evalDist(e,n,s){const i=this.evalRay(n,s);if(i===null)return null;if(!this.spicy)return i;this.arcparams.length===0&&this.computeArcParams(e),this.evalArc(n,s)}};function H2(e,n,s,i){const o=new N,a=new N,c=n.clone().sub(e);if(c.length_squared()>1e-12)o.copy(c);else{const h=s.clone().sub(e);h.length_squared()>1e-12?o.copy(h):o.copy(i).sub(e)}const l=i.clone().sub(s);if(l.length_squared()>1e-12)a.copy(l);else{const h=i.clone().sub(n);h.length_squared()>1e-12?a.copy(h):a.copy(i).sub(e)}return[o,a]}function W2(e,n,s){var a;const i=n.length%2?n.slice(0,n.length-1):n,r=.1;if(i.every(c=>c<r))return e;for(let c=0;c<i.length;c+=2)i[c]<r&&(i[c+1]>=r&&s?i[c]=r:(i.splice(c,2),c-=2));const o=new qe;if(i.length===0)return o;for(let c=0,l=e._children.length;c<l;c++){const h=e._children[c];if(h.isEmpty())continue;const d=h.getCurves();let p=0;const E=d.length-1;let g=h.getLength(),T=(a=d[p])==null?void 0:a.clone(),A=0,m=i[A];for(;g>0&&T;){const O=A%2===0;T||(T=d[p++].clone());const S=O?[T._segment1]:null;let y=m,v=T.getLength();for(;v<y;)if(O&&S.push(T._segment2),y-=v,p>=E){T=null;break}else p+=1,T=d[p].clone(),v=T.getLength(),O&&T&&S.pop();if(T&&y>0){const R=ae.getTimeAt(T.getValues(),y),M=T.divideAtTime(R,!0);O&&S.push(T._segment2),T=M}if(O&&S.length>1){const R=new Ct;R.setSegments(S),o.addChild(R)}g-=m,A=(A+1)%i.length,m=i[A]}}return o}function RI(e,n,s){var a;const i=n.length%2?n.slice(0,n.length-1):n,r=.1;if(i.every(c=>c<r))return e;for(let c=0;c<i.length;c+=2)i[c]<r&&(i[c+1]>=r&&s||(i.splice(c,2),c-=2));const o=new qe;if(i.length===0)return o;for(let c=0,l=e._children.length;c<l;c++){const h=e._children[c];if(h.isEmpty())continue;const d=h.getCurves();let p=0;const E=d.length-1;let g=h.getLength(),T=(a=d[p])==null?void 0:a.clone(),A=0,m=i[A];for(;g>0&&T;){const O=A%2===0;T||(T=d[p++].clone());const S=O?[T._segment1]:null;let y=m,v=T.getLength();for(;v<y;)if(O&&S.push(T._segment2),y-=v,p>=E){T=null;break}else p+=1,T=d[p].clone(),v=T.getLength(),O&&T&&(S[0].hasHandles()||S[1].hasHandles())&&S.pop();if(T&&y>0){const R=ae.getTimeAt(T.getValues(),y),M=T.divideAtTime(R,!1);O&&S.push(T._segment2),T=M}if(O&&S.length>1){const R=new Ct;R.setSegments(S),o.addChild(R)}g-=m,A=(A+1)%i.length,m=i[A]}}return o}const Y2=new Ce(0,-1,1,0,0,1);function Yp(){this.visible=!0,this.bounds=new ye,this.paint=null,this.effect=null,this.blendMode=Ut.PASS_THROUGH,this.storage=null}Yp.prototype={constructor:Yp,clear(){return this.visible=!0,this.vectorData=null,this.textData=null,this.bounds.set(0,0,0,0),this.paint&&(this.paint.gradient&&this.storage.destroyGradientResource(this.paint.gradient.id),this.paint=null),this.effect=null,this.blendMode=Ut.PASS_THROUGH,this.storage=null,!0},solid(e,n){const s=this.paint||new Oc;return this.paint=s,s.type=Oe.SOLID,s.params.opacity=s.params.opacity||[1],s.params.opacity[0]=n,s.params.fill_color=e.as_array(s.params.fill_color||[1,1,1,1]),s.params.fill_color[3]=1,this},gradient(e,n,s=Y2,i=1){const r=this.paint||new Oc;return this.paint=r,r.type=e,r.params.opacity=r.params.opacity||[1],r.params.opacity[0]=i,r.gradient=n,r.transform.copy(s),this},image(e,n,s=1){const i=this.paint||new Oc;return this.paint=i,i.type=Oe.IMAGE,i.params.opacity=i.params.opacity||[1],i.params.opacity[0]=s,i.image=this.storage.getImageResource(e),i.imageOptions=n,this},isPaintable(){if(!this.paint)return!1;switch(this.paint.type){case Oe.GRADIENT_LINEAR:case Oe.GRADIENT_RADIAL:case Oe.GRADIENT_ANGULAR:case Oe.GRADIENT_DIAMOND:return!0;case Oe.IMAGE:return this.paint.image&&this.paint.image.texture_id!==null;case Oe.SOLID:default:return!0}},dropShadow(e,n,s,i){const r=this.effect||new wl;this.effect=r,r.type="drop_shadow",r.params.blur=r.params.blur||[1],r.params.blur[0]=s,r.params.offset=r.params.offset||{x:e,y:n},r.params.offset.x=e,r.params.offset.y=n,r.params.color=i.as_array(r.params.color||[1,1,1,1]);const o=new Zs().set_with_array(r.params.color);this.solid(o,r.params.color[3])},innerShadow(e,n,s,i){const r=this.effect||new wl;this.effect=r,r.type="inner_shadow",r.params.blur=r.params.blur||[1],r.params.blur[0]=s,r.params.offset=r.params.offset||{x:e,y:n},r.params.offset.x=e,r.params.offset.y=n,r.params.color=i.as_array(r.params.color||[1,1,1,1])}};function Oc(){this.type=Oe.SOLID,this.params=Object.create(null),this.transform=new Ce,this.gradient=null,this.image=null,this.imageOptions=null}Oc.prototype={constructor:Oc,clone(){const e=new Oc;return e.type=this.type,e.params=Object.assign(Object.create(null),this.params),e.transform.copy(this.transform),e.gradient=this.gradient,e.image=this.image,e.imageOptions=this.imageOptions,e}};function wl(){this.type="drop_shadow",this.params=Object.create(null)}wl.prototype={constructor:wl,clone(){const e=new wl;return e.type=this.type,e.params=Object.assign(Object.create(null),this.params),e}};class Uu extends al.EventEmitter{constructor(n=void 0){super(),this._ref=n,this._init()}get ref(){return this._ref}connectRef(n){n&&(this._ref!==n&&this._clean(),this._ref=n)}disconnectRef(){this._ref&&(this._ref=void 0,this._init())}_init(){this._ref||(this._local=new Ce,this._world=new Ce,this._worldInv=new Ce,this._parent=new Ce,this._saveLocal=new Ce,this._saveWorld=new Ce,this._data={referencePoint:new N(0,0),contentAnchor:new N(0,0),translate:new N,size:new N,scale:new N(1,1),skew:new N(0,0),rotation:0,orient:0},this._dirty=!0)}reset(){return this.removeAllListeners(),this._local.identity(),this._world.identity(),this._worldInv.identity(),this._parent.identity(),this._saveLocal.identity(),this._saveWorld.identity(),this._data.referencePoint.set(0,0),this._data.contentAnchor.set(0,0),this._data.translate.set(0,0),this._data.size.set(0,0),this._data.scale.set(1,1),this._data.skew.set(0,0),this._data.rotation=0,this._dirty=!0,!0}clean(){this.removeAllListeners(),this._clean()}_clean(){return this._local=void 0,this._world=void 0,this._worldInv=void 0,this._parent=void 0,this._saveLocal=void 0,this._saveWorld=void 0,this._data=void 0,this._dirty=!0,!0}get local(){return this._ref?this._ref.local:this._local}get world(){return this._ref?this._ref.world:this._world}get saveLocal(){return this._ref?this._ref.saveLocal:this._saveLocal}get saveWorld(){return this._ref?this._ref.saveWorld:this._saveWorld}get worldInv(){return this._ref?this._ref.worldInv:this._worldInv}get parent(){return this._ref?this._ref.parent:this._parent}get position(){return this._ref?this._ref.position:this._data.position}get size(){return this._ref?this._ref.size:this._data.size}get scale(){return this._ref?this._ref.scale:this._data.scale}get skew(){return this._ref?this._ref.skew:this._data.skew}get referencePoint(){return this._ref?this._ref.referencePoint:this._data.referencePoint}get contentAnchor(){return this._ref?this._ref.contentAnchor:this._data.contentAnchor}get rotation(){return this._ref?this._ref.rotation:this._data.rotation}get translate(){return this._ref?this._ref.translate:this._data.translate}getPivotOffset(){return this.referencePoint.clone().add(this.contentAnchor)}get worldPivot(){const n=this.translate.clone();return this.parent.xform(n,n)}setTranslateX(n){this._data.translate.x=n,this._dirty=!0}setTranslateY(n){this._data.translate.y=n,this._dirty=!0}setReferencePoint(n){this._data.referencePoint.copy(n),this._dirty=!0}setContentAnchor(n){this._data.contentAnchor.copy(n),this._dirty=!0}setScale(n){this._data.scale.copy(n),this._dirty=!0}setSkew(n){this._data.skew.copy(n),this._dirty=!0}setRotation(n){this._data.rotation=n,this._dirty=!0}setOrient(n){this._data.orient=n,this._dirty=!0}setSize(n){this._data.size.copy(n),this._dirty=!0}getInnerT(n=new Ce){const{rotation:s,scale:i,skew:r}=this;return n.reset().rotate_right(s).skew_right(wt(r.x),wt(r.y)).scale_right(i.x,i.y)}update(){if(this._ref||!this._dirty)return!1;this._dirty=!1;const{translate:n,rotation:s,scale:i,skew:r}=this,o=this.getPivotOffset();return this._local.reset().translate_right(n.x,n.y).rotate_right(s).skew_right(wt(r.x),wt(r.y)).scale_right(i.x,i.y).translate_right(-o.x,-o.y),this._saveLocal.reset().translate_right(n.x,n.y).rotate_right(s).skew_right(Math.abs(r.x+Math.PI*.5)%Math.PI===0?0:r.x,Math.abs(r.y+Math.PI*.5)%Math.PI===0?0:r.y).scale_right(i.x===0?1:i.x,i.y===0?1:i.y).translate_right(-o.x,-o.y),!0}updateWorld(n){return this._ref?!1:(this.parent.copy(n.world),this.world.copy(n.world).append(this.local),this.worldInv.copy(this.world).affine_inverse(),this.saveWorld.copy(n.saveWorld).append(this.saveLocal),this.emit("updateWorld"),!0)}}const wI=Math.PI/2,Xp=.001;function wt(e){const n=Math.sign(e);let s=Math.abs(e)%Math.PI;return(Math.abs(s/wI-1)<Xp||Math.abs(s/wI-3)<Xp)&&(s+=Xp/180*Math.PI),s*n}class X2 extends al.EventEmitter{constructor(){super(),this.rect=new ye,this.local=new ye,this.world=new ye,this.visual=new ye,this.visualWorld=new ye,this._data={size:new N},this._dirty=!0}get calcFromContent(){return this._data.size===null}reset(){return this.rect.set(0,0,0,0),this.world.set(0,0,0,0),this.visual.set(0,0,0,0),this.visualWorld.set(0,0,0,0),this._data.size?this._data.size.set(0,0):this._data.size=new N(0,0),this._dirty=!0,!0}recalculateFromContent(){this.calcFromContent&&(this._dirty=!0)}setSize(n){n===null?this._data.size=null:this._data.size.copy(n),this._dirty=!0}updateLocal(n){n.xform_rect(this.rect,this.local),this.emit("updateLocal")}updateWorld(n){n.xform_rect(this.rect,this.world),n.xform_rect(this.visual,this.visualWorld),this.emit("updateWorld")}containsPoint(n,s){const i=s.xform(n);return this.rect.has_point(i)}intersectWith(n,s){const[i,r,o,a]=DI(this.rect),c=s.xform_rect(n),[l,h,d,p]=DI(c);return JM(o,i,a,r,d,l,p,h)}}const DI=e=>{const n=new N(e.x,e.y),s=new N(e.x,e.y+e.height),i=new N(e.x+e.width,e.y),r=new N(e.x+e.width,e.y+e.height);return[n,s,i,r]};function Gu(){this.id=0,this.geo_type=0,this.data={type:"RAW"},this.path=null,this.vertices=null,this.triangles=null,this.bounds=new ye,this.rect=null}Gu.prototype={constructor:Gu,getData(){return this.triangles},setDataType(e){this.data.type=e},setPathDirectly(e){this.path=e,this._dirty=!0},clear(){this.vertices=null,this.triangles=null,this.buffer&&(this.gfx.destroyBuffer(this.buffer),this.buffer=null,this.vertLen=0),this.bounds.set(0,0,0,0)},free(){this.clear(),this.path=null}};const ya={};class z2 extends Uu{setTranslate({translateX:n,translateY:s}=ya){const i=this._data.translate;ee(n)&&(i.x=n),ee(s)&&(i.y=s),this._dirty=!0}setReferencePoint({referencePointX:n,referencePointY:s}=ya){if(!this._data)return;const i=this._data.referencePoint;ee(n)&&(i.x=n),ee(s)&&(i.y=s),this._dirty=!0}setContentAnchor({contentAnchorX:n,contentAnchorY:s}=ya){const i=this._data.contentAnchor;ee(n)&&(i.x=n),ee(s)&&(i.y=s),this._dirty=!0}setScale({scaleX:n,scaleY:s}=ya){const i=this._data.scale;ee(n)&&(i.x=n),ee(s)&&(i.y=s),this._dirty=!0}setSkew({skewX:n,skewY:s}=ya){const i=this._data.skew;ee(n)&&(i.x=n),ee(s)&&(i.y=s),this._dirty=!0}setSize({width:n,height:s}=ya){const i=this._data.size;ee(n)&&(i.x=n),ee(s)&&(i.y=s),this._dirty=!0}setRotation({rotation:n}=ya){ee(n)&&(this._data.rotation=n),this._dirty=!0}}const Z={TRANSFORM:1,GEOMETRY:2,STYLE:4,NODE_SETTING:8},Ca={NONE:0,ALPHA:1,INV_ALPHA:2,LUMEN:3,INV_LUMEN:4},gt={BASE:"BASE",CORNER:"CORNER",SELF_TRIM:"SELF_TRIM",PARENT_TRIM:"PARENT_TRIM"},LI=[gt.BASE,gt.CORNER,gt.SELF_TRIM,gt.PARENT_TRIM];function Dl(){this.id="",this.shape=null,this.vector=new Gu,this.modVector=null,this.mods=[],this.style=new L2}Dl.prototype={constructor:Dl,getFinalShape(e=1,n=gt.PARENT_TRIM){for(let s=this.mods.length-1;s>=0;s--){if(!this.mods[s])continue;if(e===1)return this.mods[s][2];if(this.mods[s][0]>=e){if(e===0){const r=LI.indexOf(n)-1;if(r>=0){for(let o=r;o>=0;o--)if(this.mods[o])return this.mods[o][2]}return this.mods[0][2]}return this.mods[s][2]}}},setShape(e,n,s){switch(n){case gt.BASE:this.mods[0]=[0,n,s];break;case gt.CORNER:this.mods[1]=[0,n,s];break;case gt.SELF_TRIM:this.mods[2]=[0,n,s];break;case gt.PARENT_TRIM:this.mods[2-e]=[e,n,s];break;default:console.error("setShape() get wrong path type");break}},deleteShape(e,n){if(e===gt.PARENT_TRIM)this.mods[2-n]=null;else{const s=LI.indexOf(e);this.mods[s]=null}this.modVector=null},getFinalVector(){return this.getFinalShape()===this.shape?this.vector:(this.modVector||(this.modVector=new Gu,this.modVector.geo_type=1),this.modVector)},hasMods(){for(let e=this.mods.length-1;e>=0;e--)if(this.mods[e])return!0;return!1}};class Fu{constructor(){$e(this,"id","");$e(this,"root_id",0);$e(this,"fills",new Ui);$e(this,"strokes",new Ui);$e(this,"children",new Ui);$e(this,"path_id",0);$e(this,"base_path_id",0);$e(this,"text_node_id",0);$e(this,"text_doc_id",0)}}class Ui{constructor(){$e(this,"id",0);$e(this,"children",[]);$e(this,"text_doc_id",0);$e(this,"path_id",0);$e(this,"fill_id",0);$e(this,"fill_tag",0);$e(this,"stroke_id",0);$e(this,"stroke_tag",0);$e(this,"stroke_data_id",0);$e(this,"comp_id",0);$e(this,"compose",[null,null])}}function zp(e){this.id=e,this.name="",this.type="group",this.maskType=Ca.NONE,this.booleanType=an.NONE,this.depth=0,this.childUnionBounds=new ye,this.events=new al.EventEmitter,this.transform=new Uu,this.baseTransform=new z2(this.transform),this.bounds=new X2,this.bbox=new ye,this.blendMode=Ut.NORMAL,this.trim={get enabled(){return this.begin!==0||this.end!==1||this.offset!==0},offset:0,begin:0,end:1,mode:$i.SIMULTANEOUSLY,version:0},this.blur={visible:!1,amount:0},this.opacity=1,this.base=new Dl,this.strokes=[],this.fillLayers=[],this.strokeLayers=[],this.innerShadows=[],this.dropShadows=[],this.sizeFlag={w:"!0",h:"!0"},this.scaleFlag={x:"!0",y:"!0"},this.visible=!0,this.locked=!1,this.freed=!1,this.clipping=!1,this.autoOrient=!1,this.orientRotation=0,this.isEmpty=!1,this.version=0,this.updateFlags=0,this.visualServer=null,this.content=null,this.fontFamily=null,this.fontStyle=null,this.fontWeight=null,this.fontSize=null,this.letterSpacing=null,this.lineSpacing=null,this.paragraphSpacing=null,this.horizontalAlignment=null,this.verticalAlignment=null,this.resizingMode=eo[kt.AUTO_WIDTH],this._cornerRadius=-1}zp.prototype={constructor:zp,isVisible(){return this.freed?!1:this.visible},isContainer(){return this.type==="container"},isContainerNormalGroup(){return this.type==="container"||this.type==="group"},isNormalGroup(){return(this.type==="group"||this.type==="workspace")&&!this.isMaskGroup()&&!this.isBooleanGroup()},isComputedGroup(){return this.type==="group"||this.isMaskGroup()||this.isBooleanGroup()},isWorkspace(){return this.type==="workspace"},isScreen(){return this.type==="screen"},isMaskGroup(){return this.maskType===Ca.ALPHA||this.maskType===Ca.INV_ALPHA||this.maskType===Ca.LUMEN||this.maskType===Ca.INV_LUMEN},isBooleanGroup(){return this.booleanType===an.UNION||this.booleanType===an.SUBTRACT||this.booleanType===an.INTERSECT||this.booleanType===an.DIFFERENCE},onTransformUpdated(){this.update(Z.TRANSFORM)},update(e){this.updateFlags|=e,this.visualServer.updateList.add(this),this.version=this.visualServer.currentVersion()},clear(){if(this.removeFills(),this.removeStrokes(),this.removeInnerShadows(),this.removeDropShadows(),this.version=0,this.clipping=!1,this.isEmpty=!1,this.updateFlags=0,this.freed=!1,this.visible=!0,this.depth=0,this.blur.amount=0,this.blur.visible=!1,this.blendMode=Ut.NORMAL,this.maskType=Ca.NONE,this.booleanType=an.NONE,this.bounds.reset(),this.bbox.set(0,0,0,0),this.transform.reset(),this.baseTransform.connectRef(this.transform),this.transform.off("updateWorld",this.onTransformUpdated,this),this.events.removeAllListeners(),this.name="",this.type="group",this.base.vector&&(this.base.vector.free(),this.base.vector=null),this.strokes.length)for(const e of this.strokes)e.vector&&(e.vector.free(),e.vector=null);return!0},setSizeFlag(e){this.sizeFlag.w=Lo(e.x),this.sizeFlag.h=Lo(e.y)},setScaleFlag(e){const n=e.x,s=e.y;this.scaleFlag.x=Math.abs(n)<.005?"0":"!0",this.scaleFlag.y=Math.abs(s)<.005?"0":"!0"},setVisible(e){this.visible!==e&&(this.visible=e,this.update(Z.NODE_SETTING))},setOpacity(e){this.opacity!==e&&(this.opacity=e,this.update(Z.NODE_SETTING))},setLocked(e){this.locked!==e&&(this.locked=e)},setBlendMode(e){this.blendMode!==e&&(this.blendMode=e,this.update(Z.NODE_SETTING))},setLayerVisible(e,n,s){const i=Bu(this,e,n);i&&(i.visible=s),this.update(Z.STYLE|Z.TRANSFORM)},setInnerShadowVisible(e,n){const s=MI(this,e);s&&(s.visible=n),this.update(Z.STYLE|Z.TRANSFORM)},setDropShadowVisible(e,n){const s=PI(this,e);s&&(s.visible=n),this.update(Z.STYLE|Z.TRANSFORM)},solid(e,n,s,i){Bu(this,e,n).solid(s,i),this.update(Z.STYLE)},gradient(e,n,s,i,r,o){var l;const a=Bu(this,e,n);let c=(l=a==null?void 0:a.paint)==null?void 0:l.gradient;c||(c=this.visualServer.storage.createGradientResource()),a.gradient(s,c,r,o),c.setColorStops(i),this.update(Z.STYLE)},image(e,n,s,i,r){Bu(this,e,n).image(s,i,r),this.update(Z.STYLE)},styleUpdated(){this.update(Z.STYLE)},removeFills(){for(let e=0;e<this.fillLayers.length;e++)this.fillLayers[e].clear();this.fillLayers.length=0,this.update(Z.STYLE)},removeStrokes(){for(let e=0;e<this.strokeLayers.length;e++)this.strokeLayers[e].clear();this.strokeLayers.length=0,this.update(Z.STYLE|Z.GEOMETRY|Z.TRANSFORM)},removeInnerShadows(){for(const e of this.innerShadows)e.clear();this.innerShadows.length=0,this.update(Z.STYLE)},removeDropShadows(){for(const e of this.dropShadows)e.clear();this.dropShadows.length=0,this.update(Z.STYLE|Z.TRANSFORM)},setBlur(e){this.blur.amount=e,this.blur.visible=e>.5,this.update(Z.STYLE|Z.TRANSFORM)},setDropShadow(e,n,s,i,r){PI(this,e).dropShadow(n,s,i,r),this.update(Z.STYLE|Z.TRANSFORM)},setInnerShadow(e,n,s,i,r){MI(this,e).innerShadow(n,s,i,r),this.update(Z.STYLE)},setTrimPath(e,n,s,i){this.trim.offset=Number.isFinite(e)?e:0,this.trim.begin=Number.isFinite(n)?n:0,this.trim.end=Number.isFinite(s)?s:1,this.trim.mode=i||$i.SIMULTANEOUSLY,this.trim.version=-1,this.update(Z.GEOMETRY|Z.TRANSFORM)},get cornerRadius(){return this._cornerRadius},set cornerRadius(e){this._cornerRadius!==e&&(this._cornerRadius=e,this.update(Z.GEOMETRY|Z.TRANSFORM))}};function ku(e){const n=new Yp;return n.storage=e.visualServer.storage,n}function Bu(e,n,s){let i=null;return n<0?(s>=e.fillLayers.length&&(e.fillLayers[s]=ku(e)),i=e.fillLayers[s]):(s>=e.strokeLayers.length&&(e.strokeLayers[s]=ku(e)),i=e.strokeLayers[s]),i}function MI(e,n){let s=null;return n>=e.innerShadows.length&&(e.innerShadows[n]=ku(e)),s=e.innerShadows[n],s}function PI(e,n){let s=null;return n>=e.dropShadows.length&&(e.dropShadows[n]=ku(e)),s=e.dropShadows[n],s}function Lo(e){return e===0?"t0":e<Xt?"f0":"!0"}rc({mesh:{type:Wh}}),me.MESH_CHANGES,me.GROUP_ADD_CHILDREN,me.GROUP_REMOVE_CHILDREN,rc({pan:{type:ne},color:{type:ts}}),me.SCENE_TREE_CHANGES,me.GROUP_ADD_CHILDREN,me.GROUP_REMOVE_CHILDREN;const K2={TEXT:"com.phase/clip-text"};Le.SCREEN,Le.SCREEN,Le.CONTAINER,new Gn,new Gn,new ne,new ne;const Kp={baseUrl:"/"};let ln;const Qp=()=>ln;function tt(){return ot}function fi(e){if(!e||e.length===0)return{ptr:0,len:0};const n=e.length,s=ln._ph_allocArena(e.length)>>>0;return new Uint8Array(ln.HEAP8.buffer,s,n).set(e),{ptr:s,len:n}}function Zp(e){if(!e||e.length===0)return{ptr:0,len:0};const n=e.length,s=ln._ph_allocArena32(n)>>>0;return new Float32Array(ln.HEAP32.buffer,s,n).set(e),{ptr:s,len:n}}function bI(e){const n=ot.getPathBBoxEx(e)>>>0,s=new Float32Array(ln.HEAP32.buffer,n,4),i=new Float32Array(s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength));return{x:i[0],y:i[1],w:i[2],h:i[3]}}function UI(e){return ot.getTextLineLength(e)}function Q2(e){const n=ot.getTextLineLength(e)*4,s=ot.getTextBaseline(e)>>>0,i=new Float32Array(ln.HEAP32.buffer,s,n);return new Float32Array(i.buffer.slice(i.byteOffset,i.byteOffset+i.byteLength))}function Z2(e){const s=1+ot.getTextLineLength(e)*4,i=ot.getTextSelectionBlockEx(e)>>>0,r=new Float32Array(ln.HEAP32.buffer,i,s);return new Float32Array(r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength))}function q2(){return ot.getTextEditingNodeIdEx()}function j2(){const e=ot.getTextCaretPosEx()>>>0,n=new Float32Array(ln.HEAP32.buffer,e,4);return new Float32Array(n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength))}function GI(e,n){const s=ot.getStrokeBBox(e,n)>>>0,i=new Float32Array(ln.HEAP32.buffer,s,4),r=new Float32Array(i.buffer.slice(i.byteOffset,i.byteOffset+i.byteLength));return{x:r[0],y:r[1],w:r[2],h:r[3]}}const ot={initialized:!1,readU8Array:(e,n)=>new Uint8Array(ln.HEAP8.buffer,e,n),setWindowSize:(e,n)=>{console.warn("API missing")},getCanvasWidth:()=>(console.warn("API missing"),0),getCanvasHeight:()=>(console.warn("API missing"),0),allocArena:e=>{console.warn("API missing")},allocArena32:e=>{console.warn("API missing")},allocPerm:e=>{console.warn("API missing")},allocPerm32:e=>{console.warn("API missing")},freePerm:e=>{console.warn("API missing")},freePerm32:e=>{console.warn("API missing")},setAssetsPath:e=>{const s=new TextEncoder().encode(e),i=fi(s);ot.setAssetsPathEx(i.ptr,i.len)},setAssetsPathEx:(e,n)=>{console.warn("API missing")},getPathBBoxEx:e=>{console.warn("API missing")},getPathBBox(e){const n=ot.getPathBBoxEx(e)>>>0,s=new Float32Array(ln.HEAP32.buffer,n,4),i=new Float32Array(s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength));return{x:i[0],y:i[1],w:i[2],h:i[3]}},getTextPathBBoxEx:e=>{console.warn("API missing")},getTextPathBBox:e=>{const n=ot.getTextPathBBoxEx(e)>>>0,s=new Float32Array(ln.HEAP32.buffer,n,4),i=new Float32Array(s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength));return{x:i[0],y:i[1],w:i[2],h:i[3]}},getTextLineLength:e=>{console.warn("API missing")},getTextBaseline:e=>{console.warn("API missing")},getTextEditingNodeIdEx:()=>{console.warn("API missing")},getTextSelectionBlockEx:e=>{console.warn("API missing")},getStrokeBBox:(e,n)=>{console.warn("API missing")},GROUP:0,PATH:1,TEXT:2,markNodeChanged:e=>{console.warn("API missing")},makeNode:e=>{console.warn("API missing")},destroyNode:e=>{console.warn("API missing")},addNodeChild:(e,n)=>{console.warn("API missing")},getNodeChildCount:e=>{console.warn("API missing")},insertNodeChild:(e,n,s)=>{console.warn("API missing")},addNodeToRoot:e=>{console.warn("API missing")},reorderNode:(e,n)=>{console.warn("API missing")},removeNode:e=>{console.warn("API missing")},setNodeTransform:(e,n,s,i,r,o,a,c)=>{console.warn("API missing")},setNodeVisible:(e,n)=>{console.warn("API missing")},setNodeOpacity:(e,n)=>{console.warn("API missing")},setNodeBlend:(e,n)=>{console.warn("API missing")},setNodeCompose:(e,n,s)=>{console.warn("API missing")},removeNodeCompose:(e,n)=>{console.warn("API missing")},destroyNodeCompose:(e,n)=>{console.warn("API missing")},setNodePath:(e,n)=>{console.warn("API missing")},updatePageOffset:(e,n)=>{console.warn("API missing")},COLOR:1,GRADIENT:2,IMAGE:3,PATTERN:4,setNodeFillPaint:(e,n,s)=>{console.warn("API missing")},setNodeFillOpacity:(e,n)=>{console.warn("API missing")},setNodeStrokePaint:(e,n,s)=>{console.warn("API missing")},setNodeStrokeOpacity:(e,n)=>{console.warn("API missing")},setNodeStrokeData:(e,n)=>{console.warn("API missing")},makePath:e=>{if(e.commands.length===0||e.vertices.length===0)return ot.makeEmptyPath();const n=fi(e.commands),s=Zp(e.vertices);return ot.makePathEx(n.ptr,n.len,s.ptr,s.len)},makeEmptyPath:()=>{console.warn("API missing")},makePathEx:(e,n,s,i)=>{console.warn("API missing")},setPath:(e,n)=>{if(n.commands.length===0||n.vertices.length===0)ot.setEmptyPath(e);else{const s=fi(n.commands),i=Zp(n.vertices);ot.setPathEx(e,s.ptr,s.len,i.ptr,i.len)}},setEmptyPath:e=>{console.warn("API missing")},setPathEx:(e,n,s,i,r)=>{console.warn("API missing")},destroyPath:e=>{console.warn("API missing")},fetchFontEx(e,n,s,i,r,o){console.warn("API missing")},fetchFont(e,n,s,i){const r=fi(Array.from(new TextEncoder().encode(e))),o=fi(Array.from(new TextEncoder().encode(n))),a=s==="Regular"?0:1;return ot.fetchFontEx(r.ptr,r.len,o.ptr,o.len,a,i)},getTextDocID:e=>ot.getTextDocIDEx(e),getTextDocIDEx:e=>{console.warn("API missing")},setTextDoc:(e,n,s,i)=>{const{ptr:r,len:o}=fi(Array.from(new TextEncoder().encode(n)));return ot.setTextDocEx(e,r,o,s,i)},setTextDocEx:(e,n,s,i,r)=>{console.warn("API missing")},destroyTextDoc:e=>{console.warn("API missing")},setTextStyleEx(e,n,s,i,r,o,a,c,l,h,d){console.warn("API missing")},setTextStyle(e,n,s,i,r,o,a,c,l,h){const d=s==="Regular"?0:1,{ptr:p,len:E}=fi(Array.from(new TextEncoder().encode(n)));ot.setTextStyleEx(e,p,E,d,i,r,o,a,c,l,h)},enterTextEditingMode(e,n=-1,s,i,r,o,a){console.warn("API missing")},changeTextEditingNode(e,n){console.warn("API missing")},exitTextEditingMode(){console.warn("API missing")},setForceDefaultCursor(e){console.warn("API missing")},setTextSelection(e,n,s,i,r,o,a){console.warn("API missing")},buildLayoutAndPathEx(e,n,s,i){console.warn("API missing")},buildLayoutAndPath(e,n,s,i){ot.buildLayoutAndPathEx(e,n,s,i)},getTextOffsetEx(e){console.warn("API missing")},getTextOffset(e){const n=ot.getTextOffsetEx(e)>>>0,s=new Float32Array(ln.HEAP32.buffer,n,2),i=new Float32Array(s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength));return new N(i[0],i[1])},getTextLayoutBoxEx(e){console.warn("API missing")},getTextLayoutBox(e){const n=ot.getTextLayoutBoxEx(e)>>>0,s=new Float32Array(ln.HEAP32.buffer,n,4),i=new Float32Array(s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength));return new ye(i[0],i[1],i[2],i[3])},getTextAutoLineHeightValue(e){console.warn("API missing")},makeColor:(e,n,s,i)=>(console.warn("API missing"),0),setColor:(e,n,s,i,r)=>{console.warn("API missing")},destroyColor:e=>{console.warn("API missing")},makeGradientEx:(e,n,s,i,r,o,a)=>(console.warn("API missing"),0),makeGradient:(e,n)=>ot.makeGradientEx(e,n.a,n.b,n.c,n.d,n.tx,n.ty),setGradientMatrixEx:(e,n,s,i,r,o,a)=>{console.warn("API missing")},setGradientMatrix:(e,n)=>{ot.setGradientMatrixEx(e,n.a,n.b,n.c,n.d,n.tx,n.ty)},setGradientTag:(e,n)=>{console.warn("API missing")},setGradientStopLen:(e,n)=>{console.warn("API missing")},setGradientStop:(e,n,s,i,r,o,a)=>{console.warn("API missing")},updateGradientPixels:e=>{console.warn("API missing")},destroyGradient:e=>{console.warn("API missing")},makeStroke:(e,n,s,i,r,o)=>(console.warn("API missing"),0),setStroke:(e,n,s,i,r,o,a)=>{console.warn("API missing")},destroyStrokePathCacheEx:(e,n)=>{console.warn("API missing")},destroyStrokePathCache:(e,n)=>{ot.destroyStrokePathCacheEx(e,n)},destroyStroke:e=>{console.warn("API missing")},getPathVtxEx:e=>(console.warn("API missing"),0),getPathVtx:e=>{const n=ot.getPathVtxEx(e)>>>0,s=new Uint32Array(ln.HEAP32.buffer,n,2);if(s[1]===0)return[];const i=new Float32Array(ln.HEAP32.buffer,s[0],s[1]),r=new Float32Array(i.buffer.slice(i.byteOffset,i.byteOffset+i.byteLength));return Array.from(r)},getPathCmdEx:e=>(console.warn("API missing"),0),getPathCmd:e=>{const n=ot.getPathCmdEx(e)>>>0,s=new Uint32Array(ln.HEAP32.buffer,n,2);if(s[1]===0)return[];const i=new Uint8Array(ln.HEAP8.buffer,s[0],s[1]),r=new Uint8Array(i.buffer.slice(i.byteOffset,i.byteOffset+i.byteLength));return Array.from(r)},getStrokePathCmdEx:(e,n)=>(console.warn("API missing"),0),getStrokePathCmd:(e,n)=>{const s=ot.getStrokePathCmdEx(e,n)>>>0,i=new Uint32Array(ln.HEAP32.buffer,s,2);if(i[1]===0)return[];const r=new Uint8Array(ln.HEAP8.buffer,i[0],i[1]),o=new Uint8Array(r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength));return Array.from(o)},getStrokePathVtxEx:(e,n)=>(console.warn("API missing"),0),getStrokePathVtx:(e,n)=>{const s=ot.getStrokePathVtxEx(e,n)>>>0,i=new Uint32Array(ln.HEAP32.buffer,s,2);if(i[1]===0)return[];const r=new Float32Array(ln.HEAP32.buffer,i[0],i[1]),o=new Float32Array(r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength));return Array.from(o)},getTextPathEx:e=>(console.warn("API missing"),0),getTextPathData:(e,n)=>{const i=ot.getTextPathEx(n)>>>0,r=new Uint32Array(ln.HEAP32.buffer,i,4);if(r[1]===0||r[3]===0)return{commands:[],vertices:[]};const o=new Uint8Array(ln.HEAP8.buffer,r[0],r[1]),a=new Float32Array(ln.HEAP32.buffer,r[2],r[3]),c=new Uint8Array(o.buffer.slice(o.byteOffset,o.byteOffset+o.byteLength)),l=new Float32Array(a.buffer.slice(a.byteOffset,a.byteOffset+a.byteLength));return{commands:c,vertices:l}},destoryTextPath:e=>{console.warn("API missing")},getTextPathWithStyle:(e,n,s)=>{ot.destoryTextPath(n),ot.setTextStyle(n,s.font_family,s.font_style,s.font_weight,s.font_size,s.letter_spacing,s.line_spacing,s.paragraph_spacing,s.text_horizontal_alignment,s.text_vertical_alignment),ot.buildLayoutAndPath(e,n,-1,-1);const i=ot.getTextPathData(e,n),r=ot.makePath(i),o=tt().getPathCmd(r),a=tt().getPathVtx(r);return ot.destoryTextPath(n),{vertices:a,commands:o}},allocImage:()=>(console.warn("API missing"),0),makeImageWithURLEx:(e,n)=>(console.warn("API missing"),0),makeImageWithURL:e=>{const{ptr:n,len:s}=fi(Array.from(new TextEncoder().encode(e)));return ot.makeImageWithURLEx(n,s)},makeImageWithPixelsEx:(e,n,s,i)=>(console.warn("API missing"),0),makeImageWithPixels:(e,n,s)=>{const{ptr:i,len:r}=fi(e);return ot.makeImageWithPixelsEx(i,r,n,s)},makeImageWithFileDataEx:(e,n)=>(console.warn("API missing"),0),makeImageWithFileData:e=>{const{ptr:n,len:s}=fi(e);return ot.makeImageWithFileDataEx(n,s)},setImageWithPixels:(e,n,s,i)=>{const{ptr:r,len:o}=fi(n);ot.setImageWithPixelsEx(e,r,o,s,i)},setImageWithPixelsEx:(e,n,s,i,r)=>{console.warn("API missing")},setImageFillMode:(e,n)=>{console.warn("API missing")},destroyImage:e=>{console.warn("API missing")},makeCompose:(e,n)=>(console.warn("API missing"),0),setComposeRoot:(e,n)=>{console.warn("API missing")},destroyCompose:e=>{console.warn("API missing")},setBackgroundColor:(e,n,s,i)=>{console.warn("API missing")},numNodesRender:()=>(console.warn("API missing"),0),numTilesRender:()=>(console.warn("API missing"),0),setTransform:(e,n,s,i,r,o)=>{console.warn("API missing")},fillStyle:(e,n,s,i)=>{console.warn("API missing")},strokeStyle:(e,n,s,i,r)=>{console.warn("API missing")},drawPathEx:(e,n,s,i,r,o,a)=>{console.warn("API missing")},drawPath:(e,n,s,i)=>{if(i.commands.length===0||i.vertices.length===0)return;const r=fi(i.commands),o=Zp(i.vertices);ot.drawPathEx(e,n,s,r.ptr,r.len,o.ptr,o.len)},drawLine:(e,n,s,i,r)=>{console.warn("API missing")},drawLineShadow:(e,n,s,i,r)=>{console.warn("API missing")},drawRect:(e,n,s,i,r)=>{console.warn("API missing")},drawRoundedRect:(e,n,s,i,r,o)=>{console.warn("API missing")},drawSolidRect:(e,n,s,i,r)=>{console.warn("API missing")},drawSolidRoundedRect:(e,n,s,i,r,o)=>{console.warn("API missing")},drawCircle:(e,n,s,i)=>{console.warn("API missing")},drawSolidCircle:(e,n,s,i)=>{console.warn("API missing")},drawCircleShadow:(e,n,s,i)=>{console.warn("API missing")},drawEllipse:(e,n,s,i,r,o=0)=>{console.warn("API missing")},drawSolidEllipse:(e,n,s,i,r,o=0)=>{console.warn("API missing")},drawEllipseShadow:(e,n,s,i,r,o)=>{throw new Error("API missing")},uploadImageEx:(e,n,s,i)=>(console.warn("API missing"),0),uploadImage:(e,n,s)=>{const{ptr:i,len:r}=fi(e);return ot.uploadImageEx(i,r,n,s)},destroyCanvasImage:e=>{console.warn("API missing")},drawImage:(e,n,s,i,r,o)=>{console.warn("API missing")},purge:()=>{console.warn("API missing")},isPointInPath:(e,n,s)=>(console.warn("API missing"),!1),isPointInStroke:(e,n,s,i)=>(console.warn("API missing"),!1),isPointInText:(e,n,s)=>(console.warn("API missing"),!1),isPointInSelectedText:(e,n,s)=>(console.warn("API missing"),!1),setCaptureBackgroundColor:(e,n,s,i)=>{console.warn("API missing")},capture:(e,n,s,i,r,o,a)=>{console.warn("API missing")},pauseApp:()=>{console.warn("API missing")},resumeApp:()=>{console.warn("API missing")},setNodeFontFamily:(e,n)=>{},setNodeFontWeight:(e,n)=>{},setNodeLineHeight:(e,n)=>{},setNodeLetterSpacing:(e,n)=>{},setNodeFontSize:(e,n)=>{},setNodeTextContent:(e,n)=>{},setNodeHorizontalAlignment:(e,n)=>{},setNodeVerticalAlignment:(e,n)=>{},getNodeStorageCount:()=>(console.warn("API missing"),0),getColorStorageCount:()=>(console.warn("API missing"),0),getPathStorageCount:()=>(console.warn("API missing"),0),getStrokeStorageCount:()=>(console.warn("API missing"),0)},Ll=150,Vr=new N,Ml=[new N(-150,-150),new N(Vr.x+Ll,-150),new N(Vr.x+Ll,Vr.y+Ll),new N(-150,Vr.y+Ll),new N(-150,-150)],Vt=tt(),qp=[],Vu=new Map;let Ic=null;const J2=(e,n)=>{let s=Vu.get(`${e}x${n}`);s||(s=[],Vu.set(`${e}x${n}`,s));let i=s.pop();return i||(i=document.createElement("canvas")),i.width=e,i.height=n,i},$2=e=>{const n=e.width,s=e.height;let i=Vu.get(`${n}x${s}`);i||(i=[],Vu.set(`${n}x${s}`,i)),i.push(e)},eP=()=>{for(const e of qp)tt().destroyCanvasImage(e);qp.length=0};class tP{constructor(n){this.index=0,this.viewport=n,this.transform=new Ce,this.globalAlpha=1,this.fill={color:16777215,alpha:1},this.stroke={width:1,color:16777215,alpha:1},this.resetTransform()}reset(){return this.transform.identity(),this.globalAlpha=1,this.fill.color=16777215,this.fill.alpha=1,this.stroke.width=1,this.stroke.color=16777215,this.stroke.alpha=1,this.clear(),this.resetTransform(),!0}clear(){return iP(this.viewport),this.resetTransform(),this}setAlpha(n){return this.globalAlpha=n,this}resetTransform(){return this.transform.identity(),Vt.setTransform(this.transform.a,this.transform.b,this.transform.c,this.transform.d,this.transform.tx,this.transform.ty),this}appendTransform(n){return this.transform.append(n),Vt.setTransform(this.transform.a,this.transform.b,this.transform.c,this.transform.d,this.transform.tx,this.transform.ty),this}fillStyle(n,s=1){this.fill.color=n,this.fill.alpha=s;const i=(n>>16&255)/255,r=(n>>8&255)/255,o=(n&255)/255;return Vt.fillStyle(i,r,o,s),this}lineStyle(n,s,i=1){this.stroke.width=n*this.viewport.pixelRatio,this.stroke.color=s,this.stroke.alpha=i;const r=(s>>16&255)/255,o=(s>>8&255)/255,a=(s&255)/255;return Vt.strokeStyle(n,r,o,a,i),this}drawLine(n,s,i,r){return Vt.setTransform(this.transform.a,this.transform.b,this.transform.c,this.transform.d,this.transform.tx,this.transform.ty),Vt.drawLine(this.layer_id,n,s,i,r),this}drawLineShadow(n,s,i,r){return Vt.setTransform(this.transform.a,this.transform.b,this.transform.c,this.transform.d,this.transform.tx,this.transform.ty),Vt.drawLineShadow(this.layer_id,n,s,i,r),this}drawRect(n,s,i,r,o=0){return Vt.setTransform(this.transform.a,this.transform.b,this.transform.c,this.transform.d,this.transform.tx,this.transform.ty),o===0?Vt.drawRect(this.layer_id,n,s,i,r):Vt.drawRoundedRect(this.layer_id,n,s,i,r,o),this}drawSolidRect(n,s,i,r,o=0){return Vt.setTransform(this.transform.a,this.transform.b,this.transform.c,this.transform.d,this.transform.tx,this.transform.ty),o===0?Vt.drawSolidRect(this.layer_id,n,s,i,r):Vt.drawSolidRoundedRect(this.layer_id,n,s,i,r,o),this}drawEllipse(n,s,i,r=i,o=0){return Vt.setTransform(this.transform.a,this.transform.b,this.transform.c,this.transform.d,this.transform.tx,this.transform.ty),i===r?Vt.drawCircle(this.layer_id,n,s,i):Vt.drawEllipse(this.layer_id,n,s,i,r,o),this}drawEllipseShadow(n,s,i,r=i,o=0){return Vt.setTransform(this.transform.a,this.transform.b,this.transform.c,this.transform.d,this.transform.tx,this.transform.ty),Vt.drawEllipseShadow(this.layer_id,n,s,i,r,o),this}drawSolidEllipse(n,s,i,r=i){return Vt.setTransform(this.transform.a,this.transform.b,this.transform.c,this.transform.d,this.transform.tx,this.transform.ty),Vt.drawSolidEllipse(this.layer_id,n,s,this.transform.a*i*.5,this.transform.d*r*.5,0),this}drawPath(n,s,i){return Vt.setTransform(this.transform.a,this.transform.b,this.transform.c,this.transform.d,this.transform.tx,this.transform.ty),Vt.drawPath(this.layer_id,n,s,i),this}measureTextImage(n,s=12,i="left",r="top"){Ic=Ic||document.createElement("canvas");const o=Ic.getContext("2d"),a=s*this.viewport.pixelRatio;o.font=`${a}px Inter`,o.textAlign=i,o.textBaseline=r,o.lineWidth=.5;const c=o.measureText(n),l=c.actualBoundingBoxAscent+c.actualBoundingBoxDescent;return[c.width/Pl.pixelRatio,l/Pl.pixelRatio]}drawTextImage(n,s,i,r={font:"Inter",fontSize:12,h_align:"left",v_align:"alphabetic"}){const{font:o,fontSize:a,h_align:c,v_align:l}=r;tt().setTransform(this.transform.a,this.transform.b,this.transform.c,this.transform.d,this.transform.tx,this.transform.ty),Ic=Ic||document.createElement("canvas");const h=Ic.getContext("2d"),d=a*this.viewport.pixelRatio;h.font=`${d}px ${o||"Inter"}}`,h.textAlign=c,h.textBaseline=l,h.lineWidth=.5;const p=h.measureText(i),E=p.actualBoundingBoxAscent,g=p.actualBoundingBoxDescent,T=E+g,A=2*this.viewport.pixelRatio,m=T+A,O=k=>Math.pow(2,Math.ceil(Math.log2(k))),S=O(p.width),y=O(m),v=J2(S,y),R=v.getContext("2d",{willReadFrequently:!0});R.clearRect(0,0,S,y),R.font=`${d}px ${o||"Inter"}`,R.textAlign=c,R.textBaseline=l,R.fillStyle="white",R.lineWidth=.5,R.fillText(i,0,E+A/2);const M=R.getImageData(0,0,S,y).data,L=tt().uploadImage(M,S,y);qp.push(L);const P=s-A/2/this.viewport.pixelRatio;return tt().drawImage(this.layer_id,L,n,P,S/this.viewport.pixelRatio,y/this.viewport.pixelRatio),$2(v),this}drawImage(n,s,i,r,o){return Vt.setTransform(this.transform.a,this.transform.b,this.transform.c,this.transform.d,this.transform.tx,this.transform.ty),Vt.drawImage(this.layer_id,n,s,i,r,o),this}drawImageFromAtlas(n,s,i,r,o,a=!0,c=!0){const l=Mt(n);if(!l||!l.valid)return console.log(`image [${n}] not loaded into atlas yet`),this;const h=l.imageInfo;let d=s-h.w*.5*r/h.pixelRatio,p=i-h.h*.5*o/h.pixelRatio;const E=h.w*r/h.pixelRatio,g=h.h*o/h.pixelRatio;return a||(d=s),c||(p=i),this.drawImage(l.image,d,p,E,g),this}drawSolidRectTexture(n,s,i,r,o=0){return Vt.setTransform(this.transform.a,this.transform.b,this.transform.c,this.transform.d,this.transform.tx,this.transform.ty),Vt.drawSolidRoundedRect(this.layer_id,n,s,i,r,o),this}drawRectTexture(n,s,i,r,o,a=0){return Vt.setTransform(this.transform.a,this.transform.b,this.transform.c,this.transform.d,this.transform.tx,this.transform.ty),Vt.drawRoundedRect(this.layer_id,n,s,i,r,a),this}}class nP{constructor(n,s){this.visualServer=n,this.viewport=s,Pl=s,this.panes=[]}createPane(n){const s=new tP(this.viewport);return s.layer_id=n,this.panes[n]=s,s}destroyPane(n){this.panes[n]&&(this.panes[n]=null)}setSize(n,s){sP.identity().scale(2/n,-2/s).translate(-1,1)}clearPanes(){for(const n of this.panes)n.clear()}clear(){this.panes.length=0}}const sP=new Ce;function iP(e){Vr.set(e.width*e.pixelRatio,e.height*e.pixelRatio);const n=Ll*e.pixelRatio*Math.max(1,e.scale);Ml[0].set(-n,-n),Ml[1].set(Vr.x+n,-n),Ml[2].set(Vr.x+n,Vr.y+n),Ml[3].set(-n,Vr.y+n),Ml[4].set(-n,-n)}const _s=document.createElement("canvas");let Pl=null;const pi=_s.getContext("2d",{willReadFrequently:!0}),Hr=new Map,Mt=e=>{if(Hr.has(e))return Hr.get(e);const n={image:null,valid:!1,imageInfo:{x:0,y:0,w:0,h:0,pixelRatio:Pl.pixelRatio*5}};Hr.set(e,n);const s=new Image;return s.src=e,s.onload=()=>{pi.clearRect(0,0,_s.width,_s.height);const i=n.imageInfo.pixelRatio;_s.width=Math.max(s.width*i,1),_s.height=Math.max(s.height*i,1),pi.scale(i,i),pi.drawImage(s,0,0);const o=pi.getImageData(0,0,_s.width,_s.height).data,a=Vt.uploadImage(o,_s.width,_s.height);n.image=a,n.valid=!0,n.imageInfo.x=0,n.imageInfo.y=0,n.imageInfo.w=_s.width,n.imageInfo.h=_s.height,n.imageInfo.pixelRatio=i,Hr.set(e,n)},n},jp=new Map,FI="Arial",rP=(e,n,s,i=400,r="normal")=>{const o=`${n}`;let a=`${FI}-${i}-${r}-${s}-${e}`,c=`${i} ${s}px ${FI}`;if(jp.has(o)){if(jp.get(o)){if(a=`${n}-${i}-${r}-${s}-${e}`,Hr.has(a))return Hr.get(a);c=`${i} ${s}px ${n}`}}else jp.set(o,!1);if(Hr.has(a))return Hr.get(a);const l={image:null,valid:!1,imageInfo:{x:0,y:0,w:0,h:0,pixelRatio:Pl.pixelRatio*5}};Hr.set(a,l);const h=l.imageInfo.pixelRatio;pi.font=c;const d=pi.measureText(`${e}`);return _s.width=Math.max(d.width*h,1),_s.height=Math.max((d.fontBoundingBoxAscent+d.fontBoundingBoxDescent)*h,1),pi.clearRect(0,0,_s.width,_s.height),pi.font=c,pi.textBaseline="top",pi.fillStyle="#ffffff",pi.globalAlpha=1,pi.scale(h,h),pi.fillText(e,0,0),l.imageInfo.x=0,l.imageInfo.y=0,l.imageInfo.w=_s.width,l.imageInfo.h=_s.height,l},oP=new Set([Oe.GRADIENT_LINEAR,Oe.GRADIENT_RADIAL,Oe.GRADIENT_ANGULAR,Oe.GRADIENT_DIAMOND]);let Wr=null,xs=null,kI=-1;function aP(e,n){const{dataStore:s,viewport:i,snapping:r}=e,o=s.editor,a=p=>{if(p.layerProps.size){for(const E of p.layerProps.keys())if(p.layerProps.get(E).has("paintType")){c();return}}},c=()=>{o&&Wr&&oP.has(o.getLayerProp(Wr,"paintType"))?(xs=new cP(o,Wr),s1(xs),s.eam.activateEditGradient()):(s1(null),s.setFeature("editGradient",!1))},l=(p,E)=>{p!==Wr&&(Wr&&(Wr=null),p&&(Wr=p),c())};o.on(me.EDITOR_CHANGES,a),s.selection.on("focusedLayer",l),s.on("mode",()=>{Wr&&(s.eam.activateElementEditMode(),Wr=null)}),s.selection.on("activeGradientStopIdx",p=>{kI=p});let h;s.eam.on(Y.HOVER_GRADIENT_HANDLE,p=>{const E=e.selection.first;let g,T;if(E.element.get("elementType")===Le.PATH&&E.element.get("geometryType")===gn.LINE){const{x:O,y:S,width:y,height:v}=E.node.boundsVisualLocal;g=new N(y,v),T=new N(-O,-S)}else{const{width:O,height:S}=E.node.boundsLocal;g=new N(O,S),T=eE(E)}const m=new Ce(...xs.getGradientTransform()).affine_inverse().scale(g.x,g.y).translate(-T.x,-T.y).prepend(E.node.item.transform.world).prepend(i.projectionTransform);if(h=xs.searchHandle(p.mousePos,m,i.scale),p.handled=!1,n("default"),h)switch(h.type){case Un.STOP:n("default"),s.eam.changeHover(Gt.GRADIENT_STOP_HANDLE);break;case Un.GRADIENT:n("crossMove"),s.eam.changeHover(Gt.GRADIENT_TRANSFORM_START_HANDLE);break;case Un.HANDLE:n("crossMove"),s.eam.changeHover(Gt.GRADIENT_TRANSFORM_END_HANDLE);break;case Un.ASPECT_RATIO:n("crossMove"),s.eam.changeHover(Gt.GRADIENT_TRANSFORM_SHAPE_HANDLE);break;case Un.REFERENCE:n("add"),s.eam.changeHover(Gt.GRADIENT_TRANSFORM_REFERENCE_LINE);break}});let d=null;s.eam.on(Y.SELECT_GRADIENT_HANDLE,p=>{h&&h.type!==Un.REFERENCE?h.type===Un.STOP&&(s.eam.setActiveGradientStop(h.idx),s.editor.setLayerProps(xs.layerItemId,{gradientStops:xs.getGradientStops(),activeGradientStopIdx:h.idx})):p.handled=!1}),s.eam.on(Y.START_DRAG_GRADIENT_HANDLE,(p,E,{snapToGrid:g=!0})=>{if(h&&h.type!==Un.REFERENCE){const T=e.selection.first;if(!T)return;d=lP(h,xs,T,p.mousePos,i,r)}else p.handled=!1}).on(Y.UPDATE_DRAG_GRADIENT_HANDLE,(p,E)=>{d(p.mousePos,E)}).on(Y.END_DRAG_GRADIENT_HANDLE,()=>{d=null,r.setEndSnapping(),s.commitUndo()}),s.eam.on(Y.MOVE_GRADIENT_HANDLE_KEY,p=>{const E=xs.getGradientStops().map((g,T)=>T===xs.activeGradientStopIdx?{...g,position:Cx(g.position+p/100,0,1)}:g);s.editor.setLayerProps(xs.layerItemId,{gradientStops:E})}),s.eam.on(Y.ADD_NEW_GRADIENT_STOP,()=>{const p=xs.getGradientStops();if(p.length>=32)return;const E=cv(p,xs.activeGradientStopIdx,h.pos),g=[...p,{color:E,position:h.pos}];xs.setGradientStops(g),xs.setLayerProp("activeGradientStopIdx",p.length)})}const nn=new N,BI=new N(0,.5),VI=new N(.5,.5),HI=new N(1,.5),WI=new N(.5,1),Sc=new ye;class cP{constructor(n,s){this._editor=n,this._layerItemId=s;const i=n.getLayerProp(s,"paintType");this.isLinear=i===Oe.GRADIENT_LINEAR,this.isAngular=i===Oe.GRADIENT_ANGULAR,this.center=this.isLinear?BI:VI,this.bottom=HI,this.left=WI,this.handleSize=10,this.stopSize=12,this.activeStopSize=16,this.referenceSize=2,this.stopOutlineSize=1.5,this.activeStopOutlineSize=2,this.enlargeHitSize=3,this.stopHitSize=this.stopSize/2+this.stopOutlineSize,this.activeStopHitSize=this.activeStopSize/2+this.activeStopOutlineSize,this.handleHitSize=this.handleSize}get layerItemId(){return this._layerItemId}get activeGradientStopIdx(){return this._editor.getLayerProp(this._layerItemId,"activeGradientStopIdx")}setLayerProp(n,s,i){this._editor.setLayerProp(this._layerItemId,n,s,i)}getGradientStops(){return this._editor.getLayerProp(this._layerItemId,"gradientStops",!0)}setGradientStops(n){this.setLayerProp("gradientStops",n,_n)}getGradientTransform(){return this._editor.getLayerProp(this._layerItemId,"gradientTransform")}setGradientTransform(n){const s=n instanceof Ce?new ks().copy(n):n;this.setLayerProp("gradientTransform",s,_n)}getColorStopPos(n,s){if(this.isAngular){const i=n*z_;s.set(Math.cos(i),Math.sin(i)).add(1,1).scale(.5)}else s.copy(this.center).linear_interpolate(this.bottom,n)}searchHandle(n,s,i){const r=this.getGradientStops();for(let c=0;c<r.length;c++){const l=r[c];this.getColorStopPos(l.position,nn),s.xform(nn,nn);const h=c===kI?this.activeStopHitSize:this.stopHitSize;if(MM(n.x,n.y,nn.x,nn.y+h/2,h)){const d=n.clone().sub(nn);return{type:Un.STOP,idx:c,stop:l,stops:r,offset:d}}}const o=this.handleHitSize,a=this.handleHitSize*2;if(s.xform(this.bottom,nn),Sc.set(nn.x-o,nn.y-o*3/4,a,a),Sc.contains(n.x,n.y)){const c=n.clone().sub(nn);return{type:Un.HANDLE,pivot:this.center,pos:this.bottom,offset:c}}if(s.xform(this.left,nn),Sc.set(nn.x-o,nn.y-o/2,a,a),!this.isLinear&&Sc.contains(n.x,n.y)){const c=n.clone().sub(nn);return{type:Un.ASPECT_RATIO,offset:c}}if(s.xform(this.center,nn),Sc.set(nn.x-o,nn.y-o*3/4,a,a),Sc.contains(n.x,n.y))if(this.isLinear){const c=n.clone().sub(nn);return{type:Un.HANDLE,pivot:this.bottom,pos:this.center,offset:c}}else return{type:Un.GRADIENT};if(this.isAngular){const c=s.xform(this.center),l=s.xform(this.left).sub(c),h=s.xform(this.bottom).sub(c),d=n.clone().sub(c),{dis:p,per:E}=DM(d,l,h,c,new Ce);if(p<(this.enlargeHitSize+this.referenceSize/2)/i)return{type:Un.REFERENCE,pos:E}}else{s.xform(this.center,nn);const c=nn.clone();s.xform(this.bottom,nn);const l=nn.clone();if(OO(n.x,n.y,c.x,c.y,l.x,l.y)<this.enlargeHitSize){IO(n.x,n.y,c.x,c.y,l.x,l.y,nn);const d=Au(c.x,c.y,nn.x,nn.y),p=Au(l.x,l.y,nn.x,nn.y),E=Au(c.x,c.y,l.x,l.y);if(d<E&&p<E){const g=aa(0,1,d/E);return{type:Un.REFERENCE,pos:g}}}}return null}}const yc=new Ce,Jp=new N,YI=new N,bl=new Ce,Ul=new Ce,XI=new N;function lP(e,n,s,i,r,o){const{node:a,element:c}=s,l=c.get("elementType")===Le.PATH&&c.get("geometryType")===gn.LINE;let h,d;if(l){const{x:p,y:E,width:g,height:T}=a.boundsVisualLocal;d=new N(g,T),h=new N(-p,-E)}else{const{width:p,height:E}=a.boundsLocal;d=new N(p,E),h=eE(s)}switch(yc.copy(n.getGradientTransform()),bl.copy(r.invProjectionTransform).prepend(a.item.transform.worldInv).translate(h.x,h.y).scale(1/d.x,1/d.y).prepend(yc),e.type){case Un.STOP:return p=>hP(p,n,e);case Un.HANDLE:{Ul.set(...xs.getGradientTransform()).affine_inverse().scale(d.x,d.y).prepend(a.item.transform.world).prepend(r.projectionTransform);const p=r.toWorld(Ul.xform(n.center.clone())).round();return o.setSnappingOriginalPos(p),(E,g,T=!0)=>uP(E,n,e,h,d.x,d.y,s,r,o,g,T)}case Un.GRADIENT:{Ul.set(...xs.getGradientTransform()).affine_inverse().scale(d.x,d.y).prepend(a.item.transform.world).prepend(r.projectionTransform);const p=r.toWorld(Ul.xform(n.center.clone())),E=p.clone().round(),g=r.toScreen(E),T=r.toScreen(p);XI.copy(g.sub(T)),o.setSnappingOriginalPos(E);const A=r.toWorld(i).round(),m=r.toScreen(A).round();return Jp.copy(A),bl.xform(m,YI),(O,S,y=!0)=>dP(O,n,r,o,S,y)}case Un.ASPECT_RATIO:return p=>fP(p,n,e)}}const $p=(e,n)=>{n.offset&&e.sub(n.offset)},hP=(e,n,s)=>{$p(e,s);const i=n.bottom.clone().sub(n.center),r=bl.xform(e).sub(n.center);n.isAngular?s.stop.position=i.angle_to_2(r)/z_:s.stop.position=ps.clamp(r.divide(i).x,0,1),n.setGradientStops(s.stops)},uP=(e,n,s,i,r,o,a,c,l,h,d)=>{const{node:p}=a,E=new Ce(r,0,0,o);E.translate(-i.x,-i.y);const g=yc.clone().affine_inverse().prepend(E),T=c.invProjectionTransform.clone().prepend(p.item.transform.worldInv);$p(e,s);const A=g.xform(s.pivot);if(n.isLinear){const M=p.item.transform.world.xform(A);l.setSnappingOriginalPos(M)}const m=g.xform(s.pos).sub(A),O=T.xform(e).sub(A);if(d){const M=c.toWorld(Ul.xform(s.pivot)),P=M.clone().round().clone().sub(M);O.round().add(P);const k=O.clone();if(h.shift){k.add(A),p.item.transform.world.xform(k,k);const b=p.item.transform.world.xform(A);k.sub(b)}const Q=l.snapAxisAndDiagonal(k,h.shift,"POINT");O.copy(Q)}const S=O.angle_to(m),y=m.length()/O.length(),v=E.translate(-A.x,-A.y),R=new Ce().prepend(v).rotate(S).scale(y,y).prepend(v.affine_inverse());n.setGradientTransform(R.prepend(yc))},dP=(e,n,s,i,r,o)=>{const a=o?s.toWorld(e).round():s.toWorld(e),c=a.clone().sub(Jp),l=i.snapAxisAndDiagonal(c,r.shift,"POINT");a.copy(Jp).add(l);const h=o?s.toScreen(a).round().add(XI):s.toScreen(a),d=bl.xform(h),p=YI.clone().sub(d),E=new Ce().set_origin(p);n.setGradientTransform(E.append(yc))},fP=(e,n,s)=>{$p(e,s);const i=bl.xform(e),r=(n.left.y-n.center.y)/(i.y-n.center.y),o=new Ce().translate(-n.center.x,-n.center.y).scale(1,r).translate(n.center.x,n.center.y);n.setGradientTransform(o.append(yc))},eE=({element:e,node:n})=>{const s=e.get("referencePoint");return n.item.isComputedGroup()?s:new N(0,0)};Te.LINEAR;const pP={x:"translateX",y:"translateY",translateX:"x",translateY:"y"};new Set(Object.keys(pP));const EP={[Te.STEP_START]:[[0,0,1],[0,1,1]],[Te.STEP_MIDDLE]:[[0,.5,0],[.5,1,1]],[Te.STEP_END]:[[0,1,0],[1,1,1]]};Te.LINEAR+"",Te.EASE_IN+"",Te.EASE_OUT+"",Te.EASE_IN_OUT+"",Te.EASE_IN_BACK+"",Te.EASE_OUT_BACK+"",Te.EASE_IN_OUT_BACK+"",Te.HOP_IN+"",Te.HOP_OUT+"",Te.HOP_IN_OUT+"",Te.STEP_END+"",EP[Te.STEP_END];class gP extends Array{constructor(){super(2),this[0]=null,this[1]=null}get start(){return this[0]}get end(){return this[1]}get isEmpty(){return!this[0]&&!this[1]}update(n,s){return this[0]=n,this[1]=s,this}copy(n,s=!1){return this[0]=s?this._copyKFData(n[0],this[0]):n[0],this[1]=s?this._copyKFData(n[1],this[1]):n[1],this}updateValues(n,s){return this[0]?this[0].value=n:this[0]={value:n},this[1]?this[1].value=s:this[1]={value:s},this}updateTimes(n,s){return this[0]?this[0].time=n:this[0]={time:n},this[1]?this[1].time=s:this[1]={time:s},this}updateEasingType(n){return this[1]?this[1].easingType=n:this[1]={easingType:n},this}_copyKFData(n,s){const i=s||{};return i.id=n.id,i.type=n.type,i.frameType=n.frameType,i.trackId=n.trackId,i.easingType=n.easingType,i.bezier=n.bezier,i.steps=n.steps,i.time=n.time,i.value=n.value,i.delta=n.delta,i.ref=n.ref,i.extra=n.extra?{...n.extra}:null,i}clear(){return this[0]=null,this[1]=null,this}}new gP,wi.TRIM_PATH+"",Oe.GRADIENT_LINEAR,Oe.GRADIENT_RADIAL,Oe.GRADIENT_ANGULAR,Oe.GRADIENT_DIAMOND,Rn.FADE_IN+"",Rn.FADE_OUT+"",Rn.MOVE_IN+"",Rn.MOVE_OUT+"",Rn.SCALE_IN+"",Rn.SCALE_OUT+"",Rn.SPIN_IN+"",Rn.SPIN_OUT+"",Rn.TRIM_IN+"",Rn.TRIM_OUT+"",Sf.NON_EDITABLE;const _P=new Set;function TP(){for(const e of _P)try{e.clear()}catch(n){console.error("Error clearing transition manager:",n)}}const tE=4*(Math.SQRT2-1)/3,Mo=tE-1;function Gi([e,n],s=0){const i=Array.isArray(s);let r=i?s[0]||0:s,o=i?s[1]||0:s,a=i?s[2]||0:s,c=i?s[3]||0:s;const l=Math.min(e,n)/2;r=ps.clamp(r,0,l),o=ps.clamp(o,0,l),a=ps.clamp(a,0,l),c=ps.clamp(c,0,l);const h=new Bs;return h.commands.push(ve.M,ve.L),h.vertices.push(e,o,e,n-a),a>0&&(h.commands.push(ve.C),h.vertices.push(e,n+a*Mo,e+a*Mo,n,e-a,n)),h.commands.push(ve.L),h.vertices.push(c,n),c>0&&(h.commands.push(ve.C),h.vertices.push(-c*Mo,n,0,n+c*Mo,0,n-c)),h.commands.push(ve.L),h.vertices.push(0,r),r>0&&(h.commands.push(ve.C),h.vertices.push(0,-r*Mo,-r*Mo,0,r,0)),h.commands.push(ve.L),h.vertices.push(e-o,0),o>0&&(h.commands.push(ve.C),h.vertices.push(e+o*Mo,0,e,-o*Mo,e,o)),h.commands.push(ve.Z),h}function AP([e,n]){const s=e*.5,i=n*.5,r=s*tE,o=i*tE,a=s-r,c=s+r,l=i-o,h=i+o;return new Bs([s,0,c,0,e,l,e,i,e,h,c,n,s,n,a,n,0,h,0,i,0,l,a,0,s,0],[ve.M,ve.C,ve.C,ve.C,ve.C,ve.Z])}function mP(e,n,s,i){const r=n.dot(n),o=n.dot(s)+r,a=Math.sqrt(2*r*o)-o,c=4/3*a/n.cross(s),l=i.x+n.x-c*n.y,h=i.y+n.y+c*n.x,d=i.x+s.x+c*s.y,p=i.y+s.y-c*s.x,E=i.x+s.x,g=i.y+s.y;e.cubic(l,h,d,p,E,g)}function OP(e,n,s,i,r=!1,o=!1){e.assure_vec(s);const a=r?Math.PI*2-i:i,c=Math.ceil(2*a/Math.PI),l=a/c,h=new N;h.copy(s).sub(n);const d=(o?-1:1)*(r?-1:1);for(let p=0;p<c;p++){const E=h,g=E.clone().rotate(l*d);mP(e,E,g,n),h.copy(g)}}function nE(e,n){if(n<=0){if(Object.keys(e.cornerRadiusOverrides).length===0)return e;let r=!0;for(const o of Object.values(e.cornerRadiusOverrides))if(o>0){r=!1;break}if(r)return e}const s=new Gf,i=e.commands;e.commands=i.filter(r=>r!==ve.Z);for(const r of e.iter()){const o=s.path.commands.length,a=s.path.vertices.length;if(r.first().isLast)s.copySubpath(r);else{const c=r.isClosed,h=(r.hasCurves?SP:IP)(s,r,n),d=(p,E,g,T)=>{if(g&&s.start_vec(p.p0),h(p,E,g,T),!c&&T)switch(E.cmd){case ve.L:s.line_vec(E.p1);break;case ve.Q:case ve.C:{const A=E.bezier().project({x:s.lastX,y:s.lastY}).t,m=1;if(A!==m){const O=E.bezier().split(A,m);s.bezier_assure_first_point(O)}}}};r.forEach(d),c&&s.path.vertices.length>=2&&(s.path.vertices[a]=s.lastX,s.path.vertices[a+1]=s.lastY,s.firstX=s.lastX,s.firstY=s.lastY),s.end(c)}s.path.attachMetadata(o,"isEnd0Cap",r.isEnd0Cap),s.path.attachMetadata(o,"isEnd1Cap",r.isEnd1Cap)}return s.path.hasOpenOrNetworkSubaths=e.hasOpenOrNetworkSubaths,e.commands=i,s.path}function IP(e,n,s){const i=n.isClosed,r=[],o=[],a=[],c=(d,p,E,g)=>{o.push(d.p0.distance_to(d.p1));const T=d.p1.clone().sub(d.p0),A=d.p1.clone().sub(p.p1),m=T.angle_to(A);a.push(Math.tan(Math.abs(m)/2)),!i&&g&&o.push(p.p0.distance_to(p.p1))};if(n.forEach(c),!i){const d=o[0]*a[0];r.push(d)}let l=i?a[a.length-1]:a[0];for(let d=i?0:1;d<a.length;d++){const p=a[d],E=o[d]*l*p/(l+p);r.push(E),l=p}if(i)r.push(r[0]);else{const d=o[o.length-1]*a[a.length-1];r.push(d)}for(let d=0;d<r.length;d++)r[d]-=fs;const h=[];for(let d=0;d<r.length-1;d++)h.push(Math.min(r[d],r[d+1]));return(d,p)=>{const E=d.cornerRadiusOverride1===void 0?s:d.cornerRadiusOverride1,g=Math.min(h.shift(),E);g<=0?e.assure_vec(d.p1):Hu(e,d.p0,d.p1,p.p1,g)}}function zI(e,n,s,i,r,o,a,c){const l=new N(e,n),h=r?1:.5,d=s.derivative(i),p=new N(d.x,d.y).normalize();c&&p.negate();const E=yP(l,p,a,o,h);if(E!==null){const g=E.clone().sub(l),T=E.clone().sub(o.clone().scale_with_center(h,a)),A=g.angle_to(T),m=Math.tan(Math.abs(A)/2),O=Math.min(g.length(),T.length())*m;return{p:l,i:E,r:O,t:i}}}function SP(e,n,s){const i=n.isClosed,r=[],o=(c,l,h,d)=>{let p=c.cornerRadiusOverride1===void 0?s:c.cornerRadiusOverride1;if(p<=0){r.push({r:p});return}if(c.isCurve&&!l.isCurve){const E=l.p0.distance_to(l.p1);p=Math.min(p,E*.5);const g=c.bezier(),T=g.getLUT(256).map(m=>{const O=h&&!i?0:.5;if(m.t>=O)return zI(m.x,m.y,g,m.t,d&&!i,l.p1,l.p0,!1)}).filter(m=>!!m);T.reverse();const A=T.find(m=>m.r>p);A?r.push(A):(T.sort((m,O)=>O.r-m.r),r.push(T[0]))}if(!c.isCurve&&l.isCurve){const E=c.p0.distance_to(c.p1)*.5;p=Math.min(p,E*.5);const g=l.bezier(),T=g.getLUT(256).map(m=>{const O=d&&!i?1:.5;if(m.t<=O)return zI(m.x,m.y,g,m.t,h&&!i,c.p0,c.p1,!0)}).filter(m=>!!m),A=T.find(m=>m.r>p);A?r.push(A):(T.sort((m,O)=>O.r-m.r),r.push(T[0]))}if(c.isCurve&&l.isCurve&&r.push({r:0}),!c.isCurve&&!l.isCurve){const E=c.p0.distance_to(c.p1)*.5,g=l.p0.distance_to(l.p1)*.5,T=c.p1.clone().sub(c.p0),A=c.p1.clone().sub(l.p1),m=T.angle_to(A),O=Math.tan(Math.abs(m)/2),S=Math.min(E,g)*O,y=Math.min(p,S);r.push({r:y})}};n.forEach(o);let a=i&&r[r.length-1].t||0;return(c,l)=>{const h=r.shift();if(c.isCurve){const d=a,p=h.t||1;if(d!==p){const E=c.bezier().split(d,p);e.bezier_assure_first_point(E)}}a=h.t||0,h.r<=0?e.assure_vec(c.p1):!c.isCurve&&!l.isCurve?Hu(e,c.p0,c.p1,l.p1,h.r):!c.isCurve&&l.isCurve?Hu(e,c.p0,h.i,h.p,h.r):c.isCurve&&!l.isCurve&&Hu(e,h.p,h.i,l.p1,h.r)}}function Hu(e,n,s,i,r){const o=n.clone().sub(s),a=i.clone().sub(s),c=o.angle_to(a),l=Math.abs(c),h=r/Math.tan(l/2),d=o.clone().normalize().scale(h).add(s),p=n.normal(s).scale(r).scale(Math.sign(c)).add(d);OP(e,p,d,Math.PI-l,!1,c>0)}function yP(e,n,s,i,r=.5){const o=i.clone().sub(s),a=new N(-n.y,n.x),c=o.dot(a);if(Math.abs(c)<fs)return s.clone();const l=e.clone().sub(s),h=o.cross(l)/c,d=l.dot(a)/c;return h>=0&&d<=r?n.clone().scale(h).add(e):null}const Cc=["fills","strokes","shadows","innerShadows"],CP=new Map([[Cc[0],{}],[Cc[1],{}],[Cc[2],{}],[Cc[3],{}]]);let Gl=Object.create(null);const Na=new Zs;function NP(e,n){if(Gl[n.id]){console.warn(`already watching node ${n.id}`);return}const s=new RP;Gl[n.id]=s,s.element=e,s.node=n,s.connect()}const Yr=e=>{const n=Gl[e];if(!n){console.warn(`No watcher for node ${e}`);return}n.update()};function xP(e){const n=Gl[e];return n?(delete Gl[e],n.disconnect()):!1}function KI(e,n){e.clipping=n,e.update(Z.STYLE|Z.TRANSFORM)}function QI(e,n){e.autoOrient=n,e.update(Z.STYLE|Z.TRANSFORM)}function vP(e,n){e.orientRotation=n,e.update(Z.STYLE|Z.TRANSFORM)}function ZI(e,n){e.setVisible(n),e.update(Z.NODE_SETTING|Z.GEOMETRY|Z.TRANSFORM)}function qI(e,n){e.setOpacity(n),e.update(Z.NODE_SETTING)}function jI(e,n){e.setLocked(n)}function JI(e,n){e.fontFamily=n,e.update(Z.STYLE|Z.GEOMETRY)}function $I(e,n){e.fontStyle=n,e.update(Z.STYLE|Z.GEOMETRY)}function eS(e,n){e.fontWeight=n,e.update(Z.STYLE|Z.GEOMETRY)}function tS(e,n){e.lineHeight=n,e.update(Z.GEOMETRY|Z.STYLE)}function nS(e,n){e.letterSpacing=n,e.update(Z.GEOMETRY)}function sS(e,n){e.fontSize=n,e.update(Z.GEOMETRY)}function iS(e,n){e.content=n,e.update(Z.GEOMETRY)}function rS(e,n){e.horizontalAlignment=n,e.update(Z.STYLE|Z.GEOMETRY)}function oS(e,n){e.verticalAlignment=n,e.update(Z.STYLE|Z.GEOMETRY)}function aS(e,n){e.resizingMode=eo[n],e.update(Z.STYLE|Z.GEOMETRY)}function cS(e,n){e.setBlendMode(n),e.update(Z.NODE_SETTING)}function sE(e,n,s,i){const r=e.visualServer;switch(i.get("paintType")){case Oe.IMAGE:{const c=i.get("imageId")||"default";let l=r.storage.getImageResource(c);if(!l){l=r.storage.createImageResource(c);const d=r.dataStore.images.getImage(c),p=d&&d.src?d.src:yv;c!=="default"&&(!d||!d.src)&&console.warn(`Cannot find the image src. imageId: ${c}`),r.storage.loadImage(c,p);const E=tt();l.dino_image_id=E.allocImage()}l.node_ids.add(e.id);const h={mode:i.get("imageMode")||_r.FILL};e.image(n,s,c,h,i.get("opacity"));break}case Oe.GRADIENT_LINEAR:case Oe.GRADIENT_RADIAL:case Oe.GRADIENT_ANGULAR:case Oe.GRADIENT_DIAMOND:{const c=i.get("paintType");if(c){const l=i.get("gradientStops"),h=i.get("gradientTransform"),d=new Ce;d.fromArray(h),e.gradient(n,s,c,l,d,i.get("opacity"))}break}case Oe.SOLID:default:{Na.set_with_array(i.get("color")),e.solid(n,s,Na,i.get("opacity"));break}}const o=i.get("visible");e.setLayerVisible(n,s,o);const a=e.type==="text"?Z.STYLE|Z.GEOMETRY:Z.STYLE;e.update(a)}function lS(e,n,s,i){Na.set_with_array(i.get("color")),n.setInnerShadow(s,i.get("offsetX"),i.get("offsetY"),i.get("blur"),Na),n.setInnerShadowVisible(s,i.get("visible")),n.update(Z.STYLE)}function hS(e,n,s,i){Na.set_with_array(i.get("color")),Na.a*=i.get("opacity"),n.setDropShadow(s,i.get("offsetX"),i.get("offsetY"),i.get("blur"),Na),n.setDropShadowVisible(s,i.get("visible")),n.update(Z.STYLE|Z.TRANSFORM)}class Wu{constructor(){this.type=null,this.geometryIndex=-1,this.itemIndex=-1,this.element=null,this.node=null,this.layer=null}clear(){return this.type=null,this.geometryIndex=-1,this.itemIndex=-1,this.element=null,this.node=null,this.layer=null,!0}onChanged(n,s){switch(this.type){case"paint":sE(this.node,this.geometryIndex,this.itemIndex,this.layer);break;case"inner_shadow":lS(this.element,this.node,this.itemIndex,this.layer);break;case"drop_shadow":hS(this.element,this.node,this.itemIndex,this.layer);break}Xr(this.node.visualServer,s.updateType,!1)}}class RP{constructor(){this.element=null,this.node=null,this.fills=[],this.strokes=[],this.innerShadows=[],this.shadows=[],this.trim=null,this.isWatching=!1}clear(){return this.disconnect(),this.node=null,this.element=null,!0}connect(){if(this.isWatching)return!1;this.isWatching=!0,this.connectModeWatcher(),this.update();const{element:n}=this;n.on("name",this.onNameChanged,this),n.on("visible",this.onVisibleChanged,this),n.on("opacity",this.onOpacityChanged,this),n.on("locked",this.onLockedChanged,this),n.on("blendMode",this.onBlendModeChanged,this),n.on("autoOrient",this.onAutoOrientChanged,this),n.on("orientRotation",this.onOrientRotationChanged,this),n.on("overflowX",this.onOverflowChanged,this),n.on("overflowY",this.onOverflowChanged,this),n.on("booleanType",this.onBooleanTypeChanged,this),n.on("maskType",this.onMaskTypeChanged,this),n.on("containerType",this.onContainerTypeChange,this),n.on("cornerRadius",this.onCornerRadiusChanged,this),n.on("fontFamily",this.onFontFamilyChange,this),n.on("fontStyle",this.onFontStyleChange,this),n.on("fontWeight",this.onFontWeightChange,this),n.on("fontSize",this.onFontSizeChange,this),n.on("letterSpacing",this.onLetterSpacingChange,this),n.on("lineHeight",this.onLineHeightChange,this),n.on("content",this.onTextContentChange,this),n.on("elementType",this.onElementTypeChange,this),n.on("horizontalAlignment",this.onHorizontalAlignmentChange,this),n.on("verticalAlignment",this.onVerticalAlignmentChange,this),n.on("resizingMode",this.onResizingModeChange,this);const s=n.get("computedStyle");return s.on(me.LAYER_LIST_CHANGES,this.onLayersChanged,this),n.get("type")===Us.WORKSPACE||n.get("elementType")===Le.GROUP||s.on("size",this.onBoundsResizeChanged,this),s.on("translateX",this.onTranslateXChanged,this),s.on("translateY",this.onTranslateYChanged,this),n.isComputedGroup||s.on("referencePoint",this.onReferencePointChanged,this),s.on("contentAnchor",this.onContentAnchorChanged,this),s.on("scale",this.onScaleChanged,this),s.on("skew",this.onSkewChanged,this),s.on("rotation",this.onRotationChanged,this),s.on("size",this.onSizeChanged,this),s.on(me.EFFECT_LIST_CHANGES,this.onEffectsChanged,this),n.dataStore.isActionMode&&this._initializeBaseTransform(),!0}update(){const{element:n,node:s}=this;ZI(s,n.get("visible")),qI(s,n.get("opacity")),jI(s,n.get("locked")),cS(s,n.get("blendMode")),QI(s,n.get("autoOrient")),vP(s,n.get("orientRotation")),KI(s,n.get("overflowX")),Yu(s,n.get("cornerRadius")),n.get("elementType")===Le.TEXT&&(JI(s,n.get("fontFamily")),$I(s,n.get("fontStyle")),eS(s,n.get("fontWeight")),sS(s,n.get("fontSize")),nS(s,n.get("letterSpacing")),tS(s,n.get("lineHeight")),iS(s,n.get("content")),rS(s,n.get("horizontalAlignment")),oS(s,n.get("verticalAlignment")),aS(s,n.get("resizingMode")));const i=n.get("computedStyle");this.onLayersChanged(CP,null,!0),n.get("type")===Us.WORKSPACE||n.get("elementType")===Le.GROUP?s.bounds.setSize(null):s.bounds.setSize(i.get("size")),s.transform.setTranslateX(i.get("translateX")),s.transform.setTranslateY(i.get("translateY")),n.isComputedGroup||s.transform.setReferencePoint(i.get("referencePoint")),s.transform.setContentAnchor(i.get("contentAnchor")),s.transform.setScale(i.get("scale")),s.setScaleFlag(i.get("scale")),s.transform.setSkew(i.get("skew")),s.transform.setRotation(i.get("rotation")),s.transform.setSize(i.get("size")),s.setSizeFlag(i.get("size")),s.update(Z.TRANSFORM),this.onEffectsChanged()}connectModeWatcher(){const{dataStore:n}=this.element;n.on("mode",this.onModeChanged,this),this.onModeChanged(n.get("mode")),n.on("state",this.onDocumentModeChanged,this),this.onDocumentModeChanged(n.get("state"))}disconnectModeWatcher(){this.element.dataStore.off("mode",this.onModeChanged,this),this.element.dataStore.off("state",this.onDocumentModeChanged,this)}disconnect(){if(!this.isWatching)return!1;const{element:n}=this;this.disconnectModeWatcher(),n.off("name",this.onNameChanged,this),n.off("visible",this.onVisibleChanged,this),n.off("opacity",this.onOpacityChanged,this),n.off("locked",this.onLockedChanged,this),n.off("blendMode",this.onBlendModeChanged,this),n.off("autoOrient",this.onAutoOrientChanged,this),n.off("overflowX",this.onOverflowChanged,this),n.off("overflowY",this.onOverflowChanged,this),n.off("booleanType",this.onBooleanTypeChanged,this),n.off("maskType",this.onMaskTypeChanged,this),n.off("cornerRadius",this.onCornerRadiusChanged,this),n.off("fontFamily",this.onFontFamilyChange,this),n.off("fontStyle",this.onFontWeightChange,this),n.off("fontWeight",this.onFontWeightChange,this),n.off("fontSize",this.onFontSizeChange,this),n.off("letterSpacing",this.onLetterSpacingChange,this),n.off("lineHeight",this.onLineHeightChange,this),n.off("content",this.onTextContentChange,this),n.off("elementType",this.onElementTypeChange,this),n.off("horizontalAlignment",this.onHorizontalAlignmentChange,this),n.off("verticalAlignment",this.onVerticalAlignmentChange,this),n.off("resizingMode",this.onResizingModeChange,this);const s=n.get("computedStyle");return s.off(me.LAYER_LIST_CHANGES,this.onLayersChanged,this),s.off("size",this.onBoundsResizeChanged,this),this.disconnectFillLayers(),this.disconnectBorderLayers(),this.disconnectShadowLayers(),this.disconnectInnerShadowLayers(),s.off("translateX",this.onTranslateXChanged,this),s.off("translateY",this.onTranslateYChanged,this),s.off("referencePoint",this.onReferencePointChanged,this),s.off("contentAnchor",this.onContentAnchorChanged,this),s.off("scale",this.onScaleChanged,this),s.off("skew",this.onSkewChanged,this),s.off("rotation",this.onRotationChanged,this),s.off("size",this.onSizeChanged,this),s.off(me.EFFECT_LIST_CHANGES,this.onEffectsChanged,this),this.trim&&this.trim.off("CHANGES",this.onTrimChanged,this),this.isWatching=!1,!0}disconnectFillLayers(n=!0){for(const s of this.fills)s.layer.off(me.DEFAULT_CHANGES,s.onChanged,s);n&&this.node.removeFills();for(const s of this.fills)s.clear();this.fills.length=0}disconnectBorderLayers(n=!0){for(const s of this.strokes)s.layer.off(me.DEFAULT_CHANGES,s.onChanged,s);n&&this.node.removeStrokes();for(const s of this.strokes)s.clear();this.strokes.length=0}disconnectInnerShadowLayers(n=!0){for(const s of this.innerShadows)s.layer.off(me.DEFAULT_CHANGES,s.onChanged,s);n&&this.node.removeInnerShadows();for(const s of this.innerShadows)s.clear();this.innerShadows.length=0}disconnectShadowLayers(n=!0){for(const s of this.shadows)s.layer.off(me.DEFAULT_CHANGES,s.onChanged,s);n&&this.node.removeDropShadows();for(const s of this.shadows)s.clear();this.shadows.length=0}onModeChanged(n){switch(n){case Dn.ACTION:{this._initializeBaseTransform();break}case Dn.DESIGN:{this._resetBaseTransforms();break}}}onDocumentModeChanged(n){switch(n){case Qs.PROTOTYPING:{this._initializeBaseTransform();break}}}_initializeBaseTransform(){const n=this.node.baseTransform;n.disconnectRef();let s=this.element.getBaseProp("translate");n.setTranslate(s),s.on(me.DEFAULT_CHANGES,this.onBaseTransitChanged,this),s=this.element.getBaseProp("dimensions"),n.setSize(s),s.on(me.DEFAULT_CHANGES,this.onBaseSizeChanged,this),s=this.element.getBaseProp("rotation"),n.setRotation(s),s.on(me.DEFAULT_CHANGES,this.onBaseRotationChanged,this),s=this.element.getBaseProp("scale"),n.setScale(s),s.on(me.DEFAULT_CHANGES,this.onBaseScaleChanged,this),s=this.element.getBaseProp("skew"),n.setSkew(s),s.on(me.DEFAULT_CHANGES,this.onBaseSkewChanged,this),this.element.isComputedGroup||(s=this.element.getBaseProp("referencePoint"),n.setReferencePoint(s),s.on(me.DEFAULT_CHANGES,this.onBaseReferencePointChanged,this)),s=this.element.getBaseProp("contentAnchor"),n.setContentAnchor(s),s.on(me.DEFAULT_CHANGES,this.onBaseContentAnchorChanged,this),this.node.update(Z.TRANSFORM)}_resetBaseTransforms(){this.node.baseTransform.connectRef(this.node.transform);let n=this.element.getBaseProp("translate");n&&n.off(me.DEFAULT_CHANGES,this.onBaseTransitChanged,this),n=this.element.getBaseProp("dimensions"),n&&n.off(me.DEFAULT_CHANGES,this.onBaseSizeChanged,this),n=this.element.getBaseProp("rotation"),n&&n.off(me.DEFAULT_CHANGES,this.onBaseRotationChanged,this),n=this.element.getBaseProp("scale"),n&&n.off(me.DEFAULT_CHANGES,this.onBaseScaleChanged,this),n=this.element.getBaseProp("skew"),n&&n.off(me.DEFAULT_CHANGES,this.onBaseSkewChanged,this),n=this.element.getBaseProp("referencePoint"),n&&n.off(me.DEFAULT_CHANGES,this.onBaseReferencePointChanged,this),n=this.element.getBaseProp("contentAnchor"),n&&n.off(me.DEFAULT_CHANGES,this.onBaseContentAnchorChanged,this),this.node.update(Z.TRANSFORM)}onBaseTransitChanged(n){const s={};let i=n.get("translateX");i&&(s.translateX=i.after),i=n.get("translateY"),i&&(s.translateY=i.after),this.node.baseTransform.setTranslate(s),this.node.update(Z.TRANSFORM)}onBaseRotationChanged(n){const s={},i=n.get("rotation");i&&(s.rotation=i.after),this.node.baseTransform.setRotation(s),this.node.update(Z.TRANSFORM)}onBaseSizeChanged(n){const s={};let i=n.get("width");i&&(s.width=i.after),i=n.get("height"),i&&(s.height=i.after),this.node.baseTransform.setSize(s),this.node.update(Z.TRANSFORM|Z.GEOMETRY)}onBaseScaleChanged(n){const s={};let i=n.get("scaleX");i&&(s.scaleX=i.after),i=n.get("scaleY"),i&&(s.scaleY=i.after),this.node.baseTransform.setScale(s),this.node.update(Z.TRANSFORM)}onBaseSkewChanged(n){const s={};let i=n.get("skewX");i&&(s.skewX=i.after),i=n.get("skewY"),i&&(s.skewY=i.after),this.node.baseTransform.setSkew(s),this.node.update(Z.TRANSFORM)}onBaseReferencePointChanged(n){const s={};let i=n.get("referencePointX");i&&(s.referencePointX=i.after),i=n.get("referencePointY"),i&&(s.referencePointY=i.after),this.node.baseTransform.setReferencePoint(s),this.node.update(Z.TRANSFORM)}onBaseContentAnchorChanged(n){const s={};let i=n.get("contentAnchorX");i&&(s.contentAnchorX=i.after),i=n.get("contentAnchorY"),i&&(s.contentAnchorY=i.after),this.node.baseTransform.setContentAnchor(s),this.node.update(Z.TRANSFORM)}onTranslateXChanged(n,s,i){this.node.transform.setTranslateX(n),this.node.update(Z.TRANSFORM),Xr(this.node.visualServer,i.updateType,!0)}onTranslateYChanged(n,s,i){this.node.transform.setTranslateY(n),this.node.update(Z.TRANSFORM),Xr(this.node.visualServer,i.updateType,!0)}onReferencePointChanged(n,s,i){this.node.transform.setReferencePoint(n),this.node.update(Z.TRANSFORM),Xr(this.node.visualServer,i.updateType,!0)}onContentAnchorChanged(n,s,i){this.node.transform.setContentAnchor(n),this.node.update(Z.TRANSFORM),Xr(this.node.visualServer,i.updateType,!0)}onScaleChanged(n,s,i){this.node.transform.setScale(n),this.node.transform.update(),this.node.setScaleFlag(n),this.node.update(Z.TRANSFORM),Xr(this.node.visualServer,i.updateType,!0)}onSkewChanged(n,s,i){this.node.transform.setSkew(n),this.node.transform.update(),this.node.update(Z.TRANSFORM),Xr(this.node.visualServer,i.updateType,!0)}onRotationChanged(n,s,i){const r=this.node.visualServer.dataStore.isAnimationMode&&this.node.autoOrient?n+this.node.orientRotation:n;this.node.transform.setRotation(r),this.node.transform.update(),this.node.update(Z.TRANSFORM),Xr(this.node.visualServer,i.updateType,!0)}onSizeChanged(n,s,i){this.node.transform.setSize(n),this.node.setSizeFlag(n),this.node.update(Z.TRANSFORM),Xr(this.node.visualServer,i.updateType,!0)}onEffectsChanged(){const{element:n,node:s}=this,i=n.get("computedStyle");let r=!1;for(const o of i.effects)o.get("effectType")===wi.TRIM_PATH&&(this.trim&&this.trim!==o&&this.trim.off("CHANGES",this.onTrimChanged,this),this.trim=o,this.trim.on("CHANGES",this.onTrimChanged,this),this.onTrimChanged(),r=!0);r||(this.trim&&this.trim.off("CHANGES",this.onTrimChanged,this),s.setTrimPath(0,0,1,$i.SIMULTANEOUSLY))}onTrimChanged(){const{node:n,trim:s}=this;n.setTrimPath(s.get("offset")*.01,s.get("start")*.01,s.get("end")*.01,s.get("mode"))}onBoundsResizeChanged(n){this.node.bounds.setSize(n),this.node.update(Z.TRANSFORM)}onNameChanged(n){this.node.name=n}onVisibleChanged(n){ZI(this.node,n)}onOpacityChanged(n){qI(this.node,n)}onLockedChanged(n){jI(this.node,n)}onBlendModeChanged(n){cS(this.node,n)}onLayersChanged(n,s,i=!1){if(!n.size)return;const{element:r,node:o}=this,a=o.visualServer.storage,c=r.get("computedStyle"),l=[];for(let h=0;h<Cc.length;h++){const d=Cc[h];n.get(d)&&l.push(d)}for(let h=0;h<l.length;h++)switch(l[h]){case"fills":{this.disconnectFillLayers(!i);let d=0;for(const p of c.fills){o.base&&(o.base.vector.setDataType("FILL"),sE(o,-1,d,p));const E=new Wu;E.type="paint",E.geometryIndex=-1,E.itemIndex=d,E.element=r,E.node=o,E.layer=p,p.on(me.DEFAULT_CHANGES,E.onChanged,E),this.fills.push(E),d+=1}}break;case"strokes":{this.disconnectBorderLayers(!i);let d=0;for(const p of c.strokes){DP(a,o,d,p),o.strokes[d]&&(o.strokes[d].vector.setDataType("STROKE"),sE(o,d,d,p));const E=new Wu;E.type="paint",E.geometryIndex=d,E.itemIndex=d,E.element=r,E.node=o,E.layer=p,p.on(me.DEFAULT_CHANGES,E.onChanged,E),this.strokes.push(E),d++}}break;case"innerShadows":{this.disconnectInnerShadowLayers(!i);let d=0;for(const p of c.innerShadows){o.base&&lS(r,o,d,p);const E=new Wu;E.type="inner_shadow",E.geometryIndex=-1,E.itemIndex=d,E.element=r,E.node=o,E.layer=p,p.on(me.DEFAULT_CHANGES,E.onChanged,E),this.innerShadows.push(E),d+=1}}break;case"shadows":{this.disconnectShadowLayers(!i);let d=0;for(const p of c.shadows){o.base&&hS(r,o,d,p);const E=new Wu;E.type="drop_shadow",E.geometryIndex=-1,E.itemIndex=d,E.element=r,E.node=o,E.layer=p,p.on(me.DEFAULT_CHANGES,E.onChanged,E),this.shadows.push(E),d+=1}}break}}onOverflowChanged(n){this.node.clipping!==n&&KI(this.node,n)}onAutoOrientChanged(n){if(this.node.autoOrient!==n&&(QI(this.node,n),this.node.visualServer.dataStore.isAnimationMode)){const s=this.node.autoOrient?this.node.transform.rotation+this.node.orientRotation:this.node.transform.rotation-this.node.orientRotation;this.node.transform.setRotation(s),this.node.transform.update(),this.node.update(Z.TRANSFORM)}}onOrientRotationChanged(n){if(this.node.visualServer.dataStore.isAnimationMode){const s=this.node.autoOrient?this.node.transform.rotation-this.node.orientRotation+n:this.node.transform.rotation;this.node.transform.setRotation(s),this.node.transform.update(),this.node.update(Z.TRANSFORM)}else this.node.transform.setRotation(this.node.baseTransform.rotation),this.node.transform.update(),this.node.update(Z.TRANSFORM);this.node.orientRotation=n}onBooleanTypeChanged(n){this.node.booleanType!==n&&(this.node.booleanType=n,this.node.update(Z.STYLE|Z.TRANSFORM|Z.GEOMETRY))}onMaskTypeChanged(n){this.node.maskType!==n&&(this.node.maskType=n,this.node.update(Z.STYLE))}onCornerRadiusChanged(n){Yu(this.node,n)}onContainerTypeChange(n){const s=n===Of.NORMAL_GROUP?"group":"container";this.node.type!==s&&(this.node.type=s,this._switchReferencePointEventRecieve(),this.node.update(Z.GEOMETRY|Z.TRANSFORM))}onElementTypeChange(n){this.node.type=n===Le.TEXT?"text":"path",this.node.update(Z.GEOMETRY|Z.TRANSFORM)}onFontFamilyChange(n){this.node.fontFamily!==n&&JI(this.node,n)}onFontStyleChange(n){this.node.fontStyle!==n&&$I(this.node,n)}onFontWeightChange(n){this.node.fontWeight!==n&&eS(this.node,n)}onFontSizeChange(n){this.node.fontSize!==n&&sS(this.node,n)}onLetterSpacingChange(n){this.node.letterSpacing!==n&&nS(this.node,n)}onLineHeightChange(n){this.node.lineHeight!==n&&tS(this.node,n)}onTextContentChange(n){this.node.textContent!==n&&iS(this.node,n)}onHorizontalAlignmentChange(n){this.node.horizontalAlignment!==n&&rS(this.node,n)}onVerticalAlignmentChange(n){this.node.verticalAlignment!==n&&oS(this.node,n)}onResizingModeChange(n){this.node.resizingMode!==n&&aS(this.node,n)}_switchReferencePointEventRecieve(){const n=this.element.get("computedStyle"),s=this.element.getBaseProp("referencePoint"),i=this.element.get("referencePoint");this.node.type==="group"?(this.node.transform.setReferencePoint(new N(0,0)),n.off("referencePoint"),s.off(me.DEFAULT_CHANGES,this.onBaseReferencePointChanged,this)):(this.node.transform.setReferencePoint(i),this.node.baseTransform.setReferencePoint(s),n.on("referencePoint",this.onReferencePointChanged,this),s.on(me.DEFAULT_CHANGES,this.onBaseReferencePointChanged,this))}}function wP(e,n){const s=n.item,i=e.get("elementType");if(i===Le.PATH){const r=e.get("geometry"),o=()=>{const d=e.get("size");if(Yu(s,e.get("cornerRadius")),n.setGeometry(Gi([d[0],d[1]]),[d[0],d[1]]),Fl(s.cornerRadius)){const p=Gi([d[0],d[1]],s.cornerRadius),E=qe.createFromPathData(p);E.version=-1,s.base.setShape(0,gt.CORNER,E)}else s.base.mods[1]&&s.base.deleteShape(gt.CORNER);s.update(Z.TRANSFORM|Z.GEOMETRY),s.base.shape.version=-1},a=()=>{const d=e.get("size");n.setGeometry(AP(d)),s.update(Z.TRANSFORM|Z.GEOMETRY),s.base.shape.version=-1},c=()=>{const d=r.get("mesh");d.recalculateBounds();const p=zh(d);if(n.setGeometry(p),e.get("needOrient")&&(s.base.shape=qe.createFromPathData(p),s.base.shape.version=-1,s.base.shape.reorient(!1),s.base.setShape(0,gt.BASE,s.base.shape),s.update(Z.GEOMETRY)),Object.keys(p.cornerRadiusOverrides).length>0||Fl(s.cornerRadius)){const g=nE(p,s.cornerRadius),T=qe.createFromPathData(g);T.version=-1,s.base.setShape(0,gt.CORNER,T)}else s.base.mods[1]&&s.base.deleteShape(gt.CORNER);s.update(Z.TRANSFORM|Z.GEOMETRY),s.base.shape.version=-1,n.parent&&n.parent.item.trim.enabled&&(n.parent.item.trim.version=-1,n.parent.item.update(Z.GEOMETRY))},l=()=>{switch(e.get("geometryType")){case gn.RECTANGLE:{e.on("size",o),e.on("cornerRadius",o),o();break}case gn.ELLIPSE:{e.on("size",a),a();break}case gn.POLYGON:case gn.LINE:{e.on("cornerRadius",c),e.on("needOrient",c),e.on(me.MESH_CHANGES,c),e.on(me.TRIGGER_VECTOR_FORCE_UPDATE,c),c();break}}},h=d=>{d.off("size",o),d.off("cornerRadius",o),d.off("size",a),d.off("needOrient",c),d.off("cornerRadius",c),d.off(me.MESH_CHANGES,c),d.off(me.TRIGGER_VECTOR_FORCE_UPDATE,c)};e.on("geometryType",()=>{h(e),l()}),l()}else if(i===Le.TEXT){const r=e.get("geometry"),o=()=>{const h=r.get("mesh");h.recalculateBounds(),Yu(s,e.get("cornerRadius"));const d=zh(h);if(n.setGeometry(d),Object.keys(d.cornerRadiusOverrides).length>0||Fl(s.cornerRadius)){const E=nE(d,s.cornerRadius),g=qe.createFromPathData(E);g.version=-1,s.base.setShape(0,gt.CORNER,g)}else s.base.mods[1]&&s.base.deleteShape(gt.CORNER);s.update(Z.TRANSFORM|Z.GEOMETRY),s.base.shape.version=-1,n.parent&&n.parent.item.trim.enabled&&(n.parent.item.trim.version=-1,n.parent.item.update(Z.GEOMETRY))},a=()=>{const h=e.get("size");n.setGeometry(Gi([h[0],h[1]]),[h[0],h[1]]),s.update(Z.TRANSFORM|Z.GEOMETRY),s.base.shape.version=-1},c=()=>{switch(e.get("geometryType")){case gn.TEXT:{e.on("size",a),a();break}case gn.POLYGON:case gn.LINE:{e.on("cornerRadius",o),e.on(me.MESH_CHANGES,o),e.on(me.TRIGGER_VECTOR_FORCE_UPDATE,o),o();break}}},l=h=>{h.off("size",a)};e.on("geometryType",()=>{l(e),c()}),e.on("size",a),a()}else if(i===Le.SCREEN){const r=()=>{const o=e.get("size");if(!s.isBooleanGroup()){if(s.isMaskGroup()||e.isNormalGroup){const a=Gi([o[0],o[1]]),c=e.get("referencePoint");for(let l=0;l<a.vertices.length;l+=2)a.vertices[l]-=c[0],a.vertices[l+1]-=c[1];n.setGeometry(a)}else n.setGeometry(Gi([o[0],o[1]]),[o[0],o[1]]);if(Fl(s.cornerRadius)){const a=Gi([o[0],o[1]],s.cornerRadius),c=qe.createFromPathData(a);c.version=-1,s.base.setShape(0,gt.CORNER,c)}else s.base.mods[1]&&s.base.deleteShape(gt.CORNER);s.update(Z.TRANSFORM|Z.GEOMETRY),s.base.shape.version=-1}};e.on("size",r),e.on("cornerRadius",r),e.on("containerType",r),r()}else if(i===Le.CONTAINER){const r=()=>{const o=e.get("size"),a=e.get("cornerRadius");if(!s.isBooleanGroup()){if(s.isMaskGroup()||e.isNormalGroup){const c=Gi([o[0],o[1]]),l=e.get("referencePoint");for(let h=0;h<c.vertices.length;h+=2)c.vertices[h]-=l[0],c.vertices[h+1]-=l[1];n.setGeometry(c)}else n.setGeometry(Gi([o[0],o[1]]),[o[0],o[1]]);if(Fl(a)){const c=Gi([o[0],o[1]],a),l=qe.createFromPathData(c);l.version=-1,s.base.setShape(0,gt.CORNER,l)}else s.base.mods[1]&&s.base.deleteShape(gt.CORNER);s.update(Z.TRANSFORM|Z.GEOMETRY),s.base.shape.version=-1}};e.on("size",r),e.on("cornerRadius",r),e.on("containerType",r),r()}else Le.GROUP}function DP(e,n,s,i){n.strokes[s]=new Dl(`${n.id}[stroke@${s}]`);const r=()=>{n.strokes[s]||(n.strokes[s]=new Dl(`${n.id}[stroke@${s}]`));const o=LP(i),a=n.strokes[s].style;a.width=o.width,a.join=o.joinType;let c=o.capType;a.miterLimit=1/Math.sin(wM(o.miter)*.5),c===on.NONE&&o.ends===ca.ROUND&&(c=on.ROUND),a.startCap=c,a.endCap=c,a.dashPattern.length=0;for(let l=0;l<o.dashes.length;l++)a.dashPattern.push(o.dashes[l]||0,o.gaps[l]||0);n.update(Z.GEOMETRY|Z.TRANSFORM)};i.ons("width","growDirection","offset","dash","gap","join","joinSize","miter","ends","cap","capSize",r),r()}function LP(e){const{width:n,growDirection:s,offset:i,dash:r,gap:o,join:a,joinSize:c,miter:l,ends:h,cap:d,capSize:p}=e.gets("width","growDirection","offset","dash","gap","join","joinSize","miter","ends","cap","capSize");return{width:n,offset:i,dashes:r,gaps:o,joinType:a,joinSize:c,miter:l,ends:h,capType:d,capSize:p,growDirection:s}}function Yu(e,n){e.cornerRadius=n}function Fl(e){if(Array.isArray(e)){for(const n of e)if(n!==0)return!0}else return e!==0;return!1}const Xr=(e,n,s=!1)=>{switch(n){case Gs.UNDO_REDO:e.updateUpdateLevel(s?ds.UPDATE_ALL_NEED_BBOX_RECALC:ds.UPDATE_ALL);break;case Gs.USER_EDITING:e.updateUpdateLevel(s?ds.UPDATE_NEED_BBOX_RECALC:ds.UPDATE);break}},B=tt();function MP(e,n,s){n.item.name=s.get("name");const i=s.get("type"),r=s.get("elementType");n.item.booleanType=an.NONE,i!==Us.WORKSPACE&&r===Le.CONTAINER&&(s.get("isMask")&&(n.item.maskType=Ca.ALPHA),n.item.booleanType=s.get("booleanType")||an.NONE),n.item.type=HP(n.item,s),i===Us.ELEMENT&&wP(s,n),NP(s,n.item),YG(n)}const kl=(e,n)=>{const s=e.view.getOrCreateDinoTree(n.id),i=n.item.type;iE(i,s),n.item.type==="text"&&e.view.setParent(s.text_node_id,n.id)},iE=(e,n)=>{switch(e){case"screen":{n.root_id=B.makeNode(B.GROUP),n.fills.id=B.makeNode(B.GROUP),B.addNodeChild(n.root_id,n.fills.id),n.children.id=B.makeNode(B.GROUP),B.addNodeChild(n.root_id,n.children.id);break}case"workspace":case"group":{n.root_id=B.makeNode(B.GROUP),n.children.id=B.makeNode(B.GROUP),B.addNodeChild(n.root_id,n.children.id);break}case"container":{n.root_id=B.makeNode(B.GROUP),n.fills.id=B.makeNode(B.GROUP),B.addNodeChild(n.root_id,n.fills.id),n.strokes.id=B.makeNode(B.GROUP),B.addNodeChild(n.root_id,n.strokes.id),n.children.id=B.makeNode(B.GROUP),B.addNodeChild(n.root_id,n.children.id);break}case"text":{n.text_node_id=B.makeNode(B.TEXT),n.text_doc_id=B.getTextDocID(n.text_node_id),n.root_id=B.makeNode(B.GROUP),n.fills.id=B.makeNode(B.GROUP),B.addNodeChild(n.root_id,n.fills.id),n.strokes.id=B.makeNode(B.GROUP),B.addNodeChild(n.root_id,n.strokes.id);break}case"path":{n.root_id=B.makeNode(B.GROUP),n.fills.id=B.makeNode(B.GROUP),B.addNodeChild(n.root_id,n.fills.id),n.strokes.id=B.makeNode(B.GROUP),B.addNodeChild(n.root_id,n.strokes.id);break}case"mask":{n.root_id=B.makeNode(B.GROUP),n.children.id=B.makeNode(B.GROUP),B.addNodeChild(n.root_id,n.children.id);break}default:throw new Error(`Unknown node type: ${e}`)}},Xu=(e,n,s,i)=>{const r=e.view.getOrCreateDinoTree(n.id),o=e.view.getOrCreateDinoTree(s.id),a=o.children.compose[1]!==null,c=B.getNodeChildCount(o.children.id)+(a?1:0);if(s.item.isMaskGroup())if(c===0){o.children.compose[1]=new Ui,o.children.compose[1].id=r.root_id;const h=2;o.children.compose[1].comp_id=B.makeCompose(h,o.children.compose[1].id),B.setNodeCompose(o.children.id,1,o.children.compose[1].comp_id)}else c===i?(B.setComposeRoot(o.children.compose[1].comp_id,r.root_id),B.insertNodeChild(o.children.id,o.children.compose[1].id,i-1),o.children.compose[1].id=r.root_id,B.markNodeChanged(o.children.id)):B.insertNodeChild(o.children.id,r.root_id,i);else B.insertNodeChild(o.children.id,r.root_id,i)},rE=(e,n,s,i)=>{const r=e.view.getOrCreateDinoTree(n.id),o=e.view.getOrCreateDinoTree(s.id),a=o.children.compose[1]!==null,c=B.getNodeChildCount(o.children.id)+(a?1:0);if(s.item.isMaskGroup()){if(r.root_id===o.children.compose[1].id){const d=s.getLastChild(),p=e.view.getOrCreateDinoTree(d.id);d.item.update(Z.GEOMETRY|Z.TRANSFORM),B.removeNode(p.root_id),B.setComposeRoot(o.children.compose[1].comp_id,p.root_id),B.insertNodeChild(o.children.id,o.children.compose[1].id,i),o.children.compose[1].id=p.root_id,B.markNodeChanged(o.root_id)}i===c-1?(B.removeNode(r.root_id),B.setComposeRoot(o.children.compose[1].comp_id,r.root_id),B.insertNodeChild(o.children.id,o.children.compose[1].id,i),o.children.compose[1].id=r.root_id,B.markNodeChanged(o.root_id)):B.reorderNode(r.root_id,i)}else B.reorderNode(r.root_id,i)},PP=(e,n)=>{const s=e.view.getRootDinoTree(),i=e.view.getOrCreateDinoTree(n.id);B.insertNodeChild(s.children.id,i.root_id,0)},oE=(e,n,s,i)=>{const r=e.view.getOrCreateDinoTree(n.id),o=e.view.getOrCreateDinoTree(s.id);if(i){const a=s.getLastChild();if(a){const c=e.view.getOrCreateDinoTree(a.id);a.item.update(Z.GEOMETRY|Z.TRANSFORM),B.removeNode(c.root_id),B.setComposeRoot(o.children.compose[1].comp_id,c.root_id),o.children.compose[1].id=c.root_id,B.markNodeChanged(o.children.id)}else B.setComposeRoot(o.children.compose[1].comp_id,0)}else B.removeNode(r.root_id)},aE=(e,n)=>{const s=e.view.getAndDeleteDinoTree(n.id);Bl(s)},Bl=e=>{if(e.children.compose[0]!==null&&B.destroyNodeCompose(e.children.id,0),e.children.compose[1]!==null&&B.removeNodeCompose(e.children.id,1),e.children.compose[0]=null,e.children.compose[1]=null,e.path_id!==0&&B.destroyPath(e.path_id),e.base_path_id!==0&&B.destroyPath(e.base_path_id),e.text_doc_id!==0&&B.destroyTextDoc(e.text_doc_id),e.path_id=0,e.base_path_id=0,e.fills.children.length>0)for(let n=0;n<e.fills.children.length;n++){const s=e.fills.children[n];Vl(s),s.text_doc_id!==0&&B.destroyTextDoc(s.text_doc_id),B.destroyNode(s.id),s.id=0}if(e.strokes.children.length>0)for(let n=0;n<e.strokes.children.length;n++){const s=e.strokes.children[n];Hl(s),s.text_doc_id!==0&&B.destroyTextDoc(s.text_doc_id),B.destroyNode(s.id),s.id=0,s.stroke_data_id!==0&&(B.destroyStroke(s.stroke_data_id),s.stroke_data_id=0)}e.root_id!==0&&B.destroyNode(e.root_id),e.children.id!==0&&B.destroyNode(e.children.id),e.fills.id!==0&&B.destroyNode(e.fills.id),e.strokes.id!==0&&B.destroyNode(e.strokes.id),e.text_node_id!==0&&B.destroyNode(e.text_node_id),e.root_id=0,e.children.id=0,e.fills.id=0,e.strokes.id=0},bP=(e,n)=>{const s=e.view.getOrCreateDinoTree(n.id),i=n.parent&&n.parent.item.isMaskGroup()&&n.parent.getLastChild().id===n.id,r=n.item.transform;if(i){const{scale:o,skew:a,rotation:c,translation:l}=r.world.decompose();B.setNodeTransform(s.root_id,l.x,l.y,c,o.x,o.y,wt(a.x),wt(a.y)),B.setNodeTransform(s.fills.id,0,0,0,1,1,0,0),B.setNodeTransform(s.strokes.id,0,0,0,1,1,0,0),B.setNodeTransform(s.children.id,0,0,0,1,1,0,0)}else{B.setNodeTransform(s.root_id,r.translate.x,r.translate.y,r.rotation,r.scale.x,r.scale.y,wt(r.skew.x),wt(r.skew.y));const o=r.getPivotOffset();B.setNodeTransform(s.fills.id,-o.x,-o.y,0,1,1,0,0),B.setNodeTransform(s.strokes.id,-o.x,-o.y,0,1,1,0,0),B.setNodeTransform(s.children.id,-o.x,-o.y,0,1,1,0,0)}if(s.children.compose[0]!==null){const{scale:o,skew:a,rotation:c,translation:l}=r.world.decompose();B.setNodeTransform(s.children.compose[0].id,l.x,l.y,c,o.x,o.y,wt(a.x),wt(a.y))}},UP=(e,n)=>{const s=n.item.fillLayers;for(let r=0;r<s.length;r++)GP(e,n,r,s[r]);const i=e.view.getOrCreateDinoTree(n.id);for(let r=n.item.fillLayers.length;r<i.fills.children.length;r++){const o=i.fills.children[r];Vl(o),B.destroyNode(o.id),o.id=0}i.fills.children.length=s.length},GP=(e,n,s,i)=>{var a,c;const r=e.view.getOrCreateDinoTree(n.id);switch(i.paint.type){case Oe.SOLID:{const l=i.paint.params.fill_color,h=i.paint.params.opacity[0];if(r.fills.children[s]&&r.fills.children[s].fill_id>0&&r.fills.children[s].fill_tag===B.COLOR)B.setColor(r.fills.children[s].fill_id,l[0],l[1],l[2],h),B.markNodeChanged(r.fills.children[s].id);else{r.fills.children[s]?Vl(r.fills.children[s]):(r.fills.children[s]=new Ui,n.item.type==="text"?(r.fills.children[s].id=B.makeNode(B.TEXT),r.fills.children[s].text_doc_id=B.getTextDocID(r.fills.children[s].id)):r.fills.children[s].id=B.makeNode(B.PATH),e.view.setParent(r.fills.children[s].id,n.id),B.addNodeChild(r.fills.id,r.fills.children[s].id));const d=B.makeColor(l[0],l[1],l[2],h);r.fills.children[s].fill_id=d,r.fills.children[s].fill_tag=B.COLOR,B.setNodeFillPaint(r.fills.children[s].id,B.COLOR,d)}break}case Oe.GRADIENT_LINEAR:case Oe.GRADIENT_RADIAL:case Oe.GRADIENT_ANGULAR:case Oe.GRADIENT_DIAMOND:{const l=i.paint.gradient,h=i.paint.params.opacity[0],d=i.paint.transform,p=uS(i.paint.type);if(((a=r.fills.children[s])==null?void 0:a.fill_id)>0&&((c=r.fills.children[s])==null?void 0:c.fill_tag)===B.GRADIENT){const g=r.fills.children[s].fill_id;B.setGradientMatrix(g,d),B.setGradientTag(g,p),B.setGradientStopLen(g,l.colorStops.length);for(let T=0;T<l.colorStops.length;T++){const A=l.colorStops[T];B.setGradientStop(g,T,A.pos,A.color[0],A.color[1],A.color[2],A.color[3])}B.updateGradientPixels(g),B.setNodeFillOpacity(r.fills.children[s].id,h),B.markNodeChanged(r.fills.children[s].id)}else{r.fills.children[s]?Vl(r.fills.children[s]):(r.fills.children[s]=new Ui,r.fills.children[s].id=B.makeNode(B.PATH),e.view.setParent(r.fills.children[s].id,n.id),B.addNodeChild(r.fills.id,r.fills.children[s].id));const g=B.makeGradient(p,d);r.fills.children[s].fill_id=g,r.fills.children[s].fill_tag=B.GRADIENT,B.setGradientStopLen(g,l.colorStops.length);for(let T=0;T<l.colorStops.length;T++){const A=l.colorStops[T];B.setGradientStop(g,T,A.pos,A.color[0],A.color[1],A.color[2],A.color[3])}B.updateGradientPixels(g),B.setNodeFillPaint(r.fills.children[s].id,B.GRADIENT,g),B.setNodeFillOpacity(r.fills.children[s].id,h)}break}case Oe.IMAGE:{const l=i.paint.image,h=i.paint.params.opacity[0],d=dS(i.paint.imageOptions.mode);if(r.fills.children[s]&&r.fills.children[s].fill_id>0&&r.fills.children[s].fill_tag===B.IMAGE){const p=l.dino_image_id;r.fills.children[s].fill_id=p,B.setImageFillMode(p,d),B.setNodeFillPaint(r.fills.children[s].id,B.IMAGE,p),B.setNodeFillOpacity(r.fills.children[s].id,h)}else{r.fills.children[s]?Vl(r.fills.children[s]):(r.fills.children[s]=new Ui,r.fills.children[s].id=B.makeNode(B.PATH),e.view.setParent(r.fills.children[s].id,n.id),B.addNodeChild(r.fills.id,r.fills.children[s].id));const p=l.dino_image_id;r.fills.children[s].fill_id=p,r.fills.children[s].fill_tag=B.IMAGE,B.setImageFillMode(p,d),B.setNodeFillPaint(r.fills.children[s].id,B.IMAGE,p),B.setNodeFillOpacity(r.fills.children[s].id,h)}break}default:throw new Error(`Unsupported fill type: ${i.paint.type}`)}const o=i.visible;B.setNodeVisible(r.fills.children[s].id,o)},Vl=e=>{switch(e.fill_tag){case B.COLOR:{B.destroyColor(e.fill_id),e.fill_id=0,e.fill_tag=0;break}case B.GRADIENT:{B.destroyGradient(e.fill_id),e.fill_id=0,e.fill_tag=0;break}case B.IMAGE:{e.fill_id=0,e.fill_tag=0;break}}},Hl=e=>{switch(e.stroke_tag){case B.COLOR:{B.destroyColor(e.stroke_id),e.stroke_id=0,e.stroke_tag=0;break}case B.GRADIENT:{B.destroyGradient(e.stroke_id),e.stroke_id=0,e.stroke_tag=0;break}case B.IMAGE:{e.stroke_id=0,e.stroke_tag=0;break}}},FP=(e,n)=>{const s=n.item.strokeLayers;for(let r=0;r<s.length;r++)kP(e,n,r,s[r]);const i=e.view.getOrCreateDinoTree(n.id);for(let r=s.length;r<i.strokes.children.length;r++){const o=i.strokes.children[r];Hl(o),B.destroyNode(o.id),o.id=0,o.stroke_data_id!==0&&(B.destroyStroke(o.stroke_data_id),o.stroke_data_id=0)}i.strokes.children.length=s.length},kP=(e,n,s,i)=>{var a,c;const r=e.view.getOrCreateDinoTree(n.id);switch(i.paint.type){case Oe.SOLID:{const l=i.paint.params.fill_color,h=i.paint.params.opacity[0];if(r.strokes.children[s]&&r.strokes.children[s].stroke_id>0&&r.strokes.children[s].stroke_tag===B.COLOR)B.setColor(r.strokes.children[s].stroke_id,l[0],l[1],l[2],h),B.markNodeChanged(r.strokes.children[s].id);else{r.strokes.children[s]?Hl(r.strokes.children[s]):(r.strokes.children[s]=new Ui,n.item.type==="text"?(r.strokes.children[s].id=B.makeNode(B.TEXT),r.strokes.children[s].text_doc_id=B.getTextDocID(r.strokes.children[s].id)):r.strokes.children[s].id=B.makeNode(B.PATH),e.view.setParent(r.strokes.children[s].id,n.id),B.addNodeChild(r.strokes.id,r.strokes.children[s].id));const d=B.makeColor(l[0],l[1],l[2],h);r.strokes.children[s].stroke_id=d,r.strokes.children[s].stroke_tag=B.COLOR,B.setNodeStrokePaint(r.strokes.children[s].id,B.COLOR,d)}break}case Oe.GRADIENT_LINEAR:case Oe.GRADIENT_RADIAL:case Oe.GRADIENT_ANGULAR:case Oe.GRADIENT_DIAMOND:{const l=i.paint.gradient,h=i.paint.params.opacity[0],d=i.paint.transform,p=uS(i.paint.type);if(((a=r.strokes.children[s])==null?void 0:a.stroke_id)>0&&((c=r.strokes.children[s])==null?void 0:c.stroke_tag)===B.GRADIENT){const g=r.strokes.children[s].stroke_id;B.setGradientMatrix(g,d),B.setGradientTag(g,p),B.setGradientStopLen(g,l.colorStops.length);for(let T=0;T<l.colorStops.length;T++){const A=l.colorStops[T];B.setGradientStop(g,T,A.pos,A.color[0],A.color[1],A.color[2],A.color[3])}B.updateGradientPixels(g),B.setNodeStrokeOpacity(r.strokes.children[s].id,h),B.markNodeChanged(r.strokes.children[s].id)}else{r.strokes.children[s]?Hl(r.strokes.children[s]):(r.strokes.children[s]=new Ui,r.strokes.children[s].id=B.makeNode(B.PATH),e.view.setParent(r.strokes.children[s].id,n.id),B.addNodeChild(r.strokes.id,r.strokes.children[s].id));const g=B.makeGradient(p,d);r.strokes.children[s].stroke_id=g,r.strokes.children[s].stroke_tag=B.GRADIENT,B.setGradientStopLen(g,l.colorStops.length);for(let T=0;T<l.colorStops.length;T++){const A=l.colorStops[T];B.setGradientStop(g,T,A.pos,A.color[0],A.color[1],A.color[2],A.color[3])}B.updateGradientPixels(g),B.setNodeStrokePaint(r.strokes.children[s].id,B.GRADIENT,g),B.setNodeStrokeOpacity(r.strokes.children[s].id,h)}break}case Oe.IMAGE:{const l=i.paint.image,h=i.paint.params.opacity[0],d=dS(i.paint.imageOptions.mode);if(r.strokes.children[s]&&r.strokes.children[s].stroke_id>0&&r.strokes.children[s].stroke_tag===B.IMAGE){const p=l.dino_image_id;r.strokes.children[s].stroke_id=p,B.setImageFillMode(p,d),B.setNodeStrokeOpacity(r.strokes.children[s].id,h),B.setNodeStrokePaint(r.strokes.children[s].id,B.IMAGE,p)}else{r.strokes.children[s]?Hl(r.strokes.children[s]):(r.strokes.children[s]=new Ui,r.strokes.children[s].id=B.makeNode(B.PATH),e.view.setParent(r.strokes.children[s].id,n.id),B.addNodeChild(r.strokes.id,r.strokes.children[s].id));const p=l.dino_image_id;r.strokes.children[s].stroke_id=p,r.strokes.children[s].stroke_tag=B.IMAGE,B.setImageFillMode(p,d),B.setNodeStrokePaint(r.strokes.children[s].id,B.IMAGE,p),B.setNodeStrokeOpacity(r.strokes.children[s].id,h)}break}default:throw new Error(`Unsupported stroke type: ${i.paint.type}`)}const o=i.visible;B.setNodeVisible(r.strokes.children[s].id,o)},uS=e=>{switch(e){case Oe.GRADIENT_LINEAR:return 0;case Oe.GRADIENT_RADIAL:return 1;case Oe.GRADIENT_ANGULAR:return 2;case Oe.GRADIENT_DIAMOND:return 3}return 0},dS=e=>{switch(e){case _r.STRETCH:return 0;case _r.FILL:return 1;case _r.FIT:return 2}},BP=e=>{switch(e){case Ut.NORMAL:case Ut.PASS_THROUGH:return 0;case Ut.DARKEN:return 1;case Ut.MULTIPLY:return 2;case Ut.COLOR_BURN:return 3;case Ut.LIGHTEN:return 4;case Ut.SCREEN:return 5;case Ut.COLOR_DODGE:return 6;case Ut.OVERLAY:return 7;case Ut.SOFT_LIGHT:return 8;case Ut.HARD_LIGHT:return 9;case Ut.DIFFERENCE:return 10;case Ut.EXCLUSION:return 11;case Ut.HUE:return 12;case Ut.SATURATION:return 13;case Ut.COLOR:return 14;case Ut.LUMINOSITY:return 15}return 0};function VP(e){let n=e.parent;for(;n;)n.item.isBooleanGroup()&&n.item.update(Z.GEOMETRY),n=n.parent}function HP(e,n){const s=n.get("type"),i=n.get("elementType");if(s===Us.WORKSPACE)return"workspace";switch(i){case Le.CONTAINER:return n.isNormalGroup?"group":n.isBooleanType()?"path":n.isMaskGroup()?"mask":"container";case Le.SCREEN:return"screen";case Le.PATH:return"path";case Le.TEXT:return"text"}return"group"}const WP=8,Wl=tt();class fS{constructor(n){this.VS=n,this.rootId=null,this.nodeMap=new Map,this.dinoParentMap=new Map,this.rootDinoTree=null,this.actionSelectionChangeHandler=null}setup(n,s,i=null){this.cleanup();const r=this.VS.indexer.getNode(s);if(!r){console.error("Root RenderItem not found:",s);return}this.rootId=s,this.rootDinoTree=new Fu,iE("group",this.rootDinoTree),Wl.addNodeToRoot(this.rootDinoTree.root_id),ES(this.VS,r);const o=i||n.selection.selectedActionId,a=n.transition.currentTime;xa(this.VS,o,a),this.bindEvents()}reload(){const n=this.VS.dataStore.selection.selectedActionId,s=this.VS.dataStore.transition.currentTime;xa(this.VS,n,s)}bindEvents(){this.actionSelectionChangeHandler=this.actionSelectionChange.bind(this),this.VS.dataStore.selection.on(me.SELECT,this.actionSelectionChangeHandler)}unbindEvents(){this.actionSelectionChangeHandler&&(this.VS.dataStore.selection.off(me.SELECT,this.actionSelectionChangeHandler),this.actionSelectionChangeHandler=null)}createDinoNode(n){kl(this.VS,n),Yr(n.id)}removeDinoNode(n,s,i){oE(this.VS,n,s,i),Yr(n.id)}insertDinoNode(n,s,i){Xu(this.VS,n,s,i),Yr(n.id)}destroyDinoNode(n){aE(this.VS,n)}reorderDinoNode(n,s,i){rE(this.VS,n,s,i),Yr(n.id)}update(){}updateAll(){}cleanup(){for(const[,n]of this.nodeMap.entries())Bl(n);this.rootDinoTree!==null&&(Bl(this.rootDinoTree),this.rootDinoTree=null),this.rootId=null,this.dinoParentMap.clear(),this.nodeMap.clear(),this.unbindEvents()}actionSelectionChange(n){const s=n.get("action");if(!s)return;const i=s.after;xa(this.VS,i)}getOrCreateDinoTree(n){let s=this.nodeMap.get(n);return s||(s=new Fu,s.id=n,this.nodeMap.set(n,s)),s}setParent(n,s){this.dinoParentMap.set(n,s)}hasParent(n){return this.dinoParentMap.has(n)}getParent(n){return this.dinoParentMap.get(n)}getRootDinoTree(){return this.rootDinoTree}getAndDeleteDinoTree(n){const s=this.getOrCreateDinoTree(n);return this.nodeMap.delete(n),s}getActiveOffset(){return new N(0,0)}updateBounds(){}layout(){}}class YP{constructor(n,s){this.row=n,this.col=s,this.actionId=null,this.actionName=null,this.originalBounds=new ye,this.mergedBounds=new ye,this.alignedBounds=new ye,this.worldBounds=new ye,this.offset=new N,this.nodeMap=new Map,this.dinoParentMap=new Map,this.rootDinoTree=null}}class cE{constructor(n){this.VS=n,this.rootId=null,this.rows=0,this.cols=0,this.cells=[],this._activeCell=null,this._dirtyLayout=!1,this._lastViewOffset=null,this.offset=new N,this.padding=40,this.leftClickDownHandler=null,this.actionSelectionChangeHandler=null}setup(n,s){this.cleanup();const i=this.VS.indexer.getNode(s);if(!i){console.error("Root RenderItem not found:",s);return}this.rootId=s;const r=n.elementInteractionManager.getActionIdListByElementId(s);this.rows=r.length+1,this.cols=1;for(let l=0;l<this.cols;l++){this.cells[l]=[];for(let h=0;h<this.rows;h++){const d=new YP(h,l),p=h===0?null:r[h-1];d.actionId=p;const E=g=>{const T="Unknown",A=this.VS.dataStore.interaction.getAction(g);if(!A)return T;const m=this.VS.dataStore.interaction.getTrigger(A.triggerList[0]);if(!m)return T;const S={[li.CLICK]:"Click",[li.DOUBLE_CLICK]:"Double Click",[li.HOVER]:"Hover",[li.PRESS]:"Press",[li.LONG_PRESS]:"Long Press",[li.KEY_PRESS]:"Key Press",[li.MOUSE_ENTER]:"Mouse In",[li.MOUSE_LEAVE]:"Mouse Out",[li.MOUSE_UP]:"Mouse Up",[li.MOUSE_DOWN]:"Mouse Down",[li.DRAG]:"Drag"}[m.triggerType]??T;return A.name||`${S}`};d.actionName=p?E(p):null,this.cells[l][h]=d,this.activeCell=d,d.rootDinoTree=new Fu,iE("group",d.rootDinoTree),Wl.addNodeToRoot(d.rootDinoTree.root_id),ES(this.VS,i)}}const o=n.selection.selectedActionId,a=n.transition.currentTime,c=this.getCellByActionId(o);this.activeCell=c,xa(this.VS,c.actionId,a),this.updateAll(!0),this.bindEvents()}bindEvents(){this.leftClickDownHandler=this.leftClickDown.bind(this),this.actionSelectionChangeHandler=this.actionSelectionChange.bind(this),H.get(H.Events.LEFT_CLICK_DOWN).on("trigger",this.leftClickDownHandler),this.VS.dataStore.selection.on(me.SELECT,this.actionSelectionChangeHandler)}unbindEvents(){this.leftClickDownHandler&&(H.get(H.Events.LEFT_CLICK_DOWN).off("trigger",this.leftClickDownHandler),this.leftClickDownHandler=null),this.actionSelectionChangeHandler&&(this.VS.dataStore.selection.off(me.SELECT,this.actionSelectionChangeHandler),this.actionSelectionChangeHandler=null)}update(){this.activeCell.originalBounds.copy(zu(this.VS,this.activeCell.actionId).worldBoundsAABB),this._dirtyLayout=!0}updateAll(n=!1){console.log("update all cells at background (silently)");const s=this.activeCell,i=this.VS.dataStore.transition.currentTime;for(let r=0;r<this.cols;r++)for(let o=0;o<this.rows;o++){const a=this.cells[r][o];a!==s&&(this.activeCell=a,this.VS.dataStore.set("mode",this.activeCell.actionId===null?Dn.DESIGN:Dn.ACTION,{fire:!1,undoable:!1}),xa(this.VS,this.activeCell.actionId,void 0,!0),n&&(this.activeCell.originalBounds.copy(zu(this.VS,this.activeCell.actionId).worldBoundsAABB),this._dirtyLayout=!0))}this.activeCell=s,this.VS.dataStore.set("mode",this.activeCell.actionId===null?Dn.DESIGN:Dn.ACTION,{fire:!1,undoable:!1}),xa(this.VS,this.activeCell.actionId,i,!0),n&&(this.activeCell.originalBounds.copy(zu(this.VS,this.activeCell.actionId).worldBoundsAABB),this._dirtyLayout=!0)}createDinoNode(n){const s=this.activeCell;for(let i=0;i<this.rows;i++){const r=this.cells[s.col][i];r!==s&&(this.activeCell=r,kl(this.VS,n))}this.activeCell=s,kl(this.VS,n),Yr(n.id)}removeDinoNode(n,s,i){const r=this.activeCell;for(let o=0;o<this.rows;o++){const a=this.cells[r.col][o];a!==r&&(this.activeCell=a,oE(this.VS,n,s,i))}this.activeCell=r,oE(this.VS,n,s,i),Yr(n.id)}insertDinoNode(n,s,i){const r=this.activeCell;for(let o=0;o<this.rows;o++){const a=this.cells[r.col][o];a!==r&&(this.activeCell=a,Xu(this.VS,n,s,i))}this.activeCell=r,Xu(this.VS,n,s,i),Yr(n.id)}destroyDinoNode(n){const s=this.activeCell;for(let i=0;i<this.rows;i++){const r=this.cells[s.col][i];r!==s&&(this.activeCell=r,aE(this.VS,n))}this.activeCell=s,aE(this.VS,n)}reorderDinoNode(n,s,i){const r=this.activeCell;for(let o=0;o<this.rows;o++){const a=this.cells[r.col][o];a!==r&&(this.activeCell=a,rE(this.VS,n,s,i))}this.activeCell=r,rE(this.VS,n,s,i),Yr(n.id)}cleanup(){for(let n=0;n<this.cols;n++){for(let s=0;s<this.rows;s++){const i=this.cells[n][s];this.activeCell=i;for(const[,r]of i.nodeMap.entries())Bl(r);i.rootDinoTree!==null&&Bl(i.rootDinoTree),i.nodeMap.clear(),i.dinoParentMap.clear()}this.cells[n].length=0}this.cells.length=0,this.activeCell=null,this.rootId=null,this.rows=0,this.cols=0,this._lastViewOffset=null,this.unbindEvents()}leftClickDown(n){const s=this.getCellAt(n.mousePos.x,n.mousePos.y);s&&zP(this.VS,s.actionId)}actionSelectionChange(n){const s=n.get("action");if(!s)return;const i=s.after,r=this.getCellByActionId(i);r?this.activeCell=r:this.activeCell=this.cells[0][0],xa(this.VS,this.activeCell.actionId),this._dirtyLayout=!0,this.layout(!0)}get activeCell(){if(this._activeCell===null)throw new Error("Active cell not found");return this._activeCell}set activeCell(n){this._activeCell=n}getOrCreateDinoTree(n){const s=this.activeCell;let i=s.nodeMap.get(n);return i||(i=new Fu,i.id=n,s.nodeMap.set(n,i)),i}setParent(n,s){this.activeCell.dinoParentMap.set(n,s)}hasParent(n){return this.activeCell.dinoParentMap.has(n)}getParent(n){return this.activeCell.dinoParentMap.get(n)}getRootDinoTree(){return this.activeCell.rootDinoTree}getAndDeleteDinoTree(n){const s=this.activeCell,i=s.nodeMap.get(n);return i?(s.nodeMap.delete(n),i):(console.error("Dino tree not found:",n),null)}getCellAt(n,s){const i=this.VS.viewport.toWorld(new N(n,s));for(let r=0;r<this.cols;r++)for(let o=0;o<this.rows;o++){const a=this.cells[r][o];if(a.worldBounds.contains(i.x,i.y))return a}return null}getCellByActionId(n){for(let s=0;s<this.cols;s++)for(let i=0;i<this.rows;i++){const r=this.cells[s][i];if(r.actionId===n)return r}return this.cells[0][0]}getActiveOffset(){const n=this.activeCell;return new N(n.offset.x,n.offset.y)}layout(n=!1){if(!this._dirtyLayout)return;this._dirtyLayout=!1,lE.set(0,0,0,0);for(let h=0;h<this.cols;h++)for(let d=0;d<this.rows;d++){const p=this.cells[h][d];p.actionId===null?(lE.copy(p.originalBounds),p.mergedBounds.copy(p.originalBounds)):p.mergedBounds.copy(lE).merge_with(p.originalBounds.clone())}const s=[],i=[],r=[],o=[];for(let h=0;h<this.cols;h++){let d=1/0,p=-1/0;for(let E=0;E<this.rows;E++){const g=this.cells[h][E];d=Math.min(d,g.mergedBounds.x),p=Math.max(p,g.mergedBounds.x+g.mergedBounds.w)}s.push({minX:d-this.padding,maxX:p+this.padding})}for(let h=0;h<this.rows;h++){let d=1/0,p=-1/0;for(let E=0;E<this.cols;E++){const g=this.cells[E][h];d=Math.min(d,g.mergedBounds.y),p=Math.max(p,g.mergedBounds.y+g.mergedBounds.h)}i.push({minY:d-this.padding,maxY:p+this.padding})}this.offset.x=s[0].minX,this.offset.y=i[0].minY;let a=0;for(let h=0;h<s.length;h++){h===0&&(a=s[h].minX);const d=s[h].maxX-s[h].minX;r.push({accumulatedX:a,w:d}),a+=d}let c=0;for(let h=0;h<i.length;h++){h===0&&(c=i[h].minY);const d=i[h].maxY-i[h].minY;o.push({accumulatedY:c,h:d}),c+=d}for(let h=0;h<this.cols;h++)for(let d=0;d<this.rows;d++){const p=this.cells[h][d];p.alignedBounds.x=s[h].minX,p.alignedBounds.y=i[d].minY,p.alignedBounds.w=s[h].maxX-s[h].minX,p.alignedBounds.h=i[d].maxY-i[d].minY,p.worldBounds.x=r[h].accumulatedX,p.worldBounds.y=o[d].accumulatedY,p.worldBounds.w=r[h].w,p.worldBounds.h=o[d].h,p.offset.x=p.worldBounds.x-p.alignedBounds.x,p.offset.y=p.worldBounds.y-p.alignedBounds.y}const l=this.getActiveOffset();for(let h=0;h<this.cols;h++)for(let d=0;d<this.rows;d++){const p=this.cells[h][d];p.worldBounds.x-=l.x,p.worldBounds.y-=l.y;const E=new N(p.offset.x-l.x,p.offset.y-l.y);Wl.setNodeTransform(p.rootDinoTree.root_id,E.x,E.y,0,1,1,0,0);for(const[,g]of p.nodeMap.entries()){if(g.children.compose[0]){const T=this.VS.indexer.getNode(g.id),{scale:A,skew:m,rotation:O,translation:S}=T.item.transform.world.decompose();Wl.setNodeTransform(g.children.compose[0].id,S.x+E.x,S.y+E.y,O,A.x,A.y,wt(m.x),wt(m.y))}if(g.children.compose[1]){const A=this.VS.indexer.getNode(g.id).getLastChild(),{scale:m,skew:O,rotation:S,translation:y}=A.item.transform.world.decompose();Wl.setNodeTransform(g.children.compose[1].id,y.x+E.x,y.y+E.y,S,m.x,m.y,wt(O.x),wt(O.y))}}}if(this._lastViewOffset===null)this._lastViewOffset=l;else if(!this._lastViewOffset.equals(l)){if(n){const h=l.clone().sub(this._lastViewOffset);this.VS.viewport.projectionTransform.xform_vec(h,h),this.VS.viewport.offsetPos(h)}this._lastViewOffset.copy(l)}}}const pS=(e,n,s,i)=>{i(e,n,s);for(let r=0;r<e.children.length;r++)pS(e.children[r],e,r,i)},ES=(e,n)=>{kl(e,n),PP(e,n);let s=0;for(const i of n.children)pS(i,n,s,(r,o,a)=>{kl(e,r),Xu(e,r,o,a)}),s++},xa=(e,n,s=void 0,i=!1)=>{console.log("reloadNodes",e.dataStore.isDesignMode?"Design":"Action",n,s,i);const r=e.indexer.getWorkspaceNode();for(const o of e.dataStore.traverseSubtree(r.id,!0,!0))e.dataStore.getElement(o).computedStyle.reload(),Yr(o);if(n===null)e.updateNodes();else{TP(),e.dataStore.transition.loadInteraction(e.dataStore.interaction,n);let o=s;if(o===void 0){const a=e.dataStore.interaction.getResponseList(n)[0];o=e.dataStore.interaction.getResponseDuration(a)}i&&e.dataStore.transition.setPlayheadTime(o,!0,!i,i),e.updateNodes()}},zu=(e,n,s=!0,i=1/0)=>{console.log("calculateBiggestBounds",n,i);const r=e.view.rootId,o=e.indexer.getNode(r),a=s||!o.item.clipping?"subtreeBounds":"boundsVisualWorldAABB",{interaction:c,transition:l}=e.dataStore,h={};if(n===null)h.worldBoundsAABB=o[a].clone(),h.isClamped=!1;else{const d=l.currentTime,p=c.getResponseList(n)[0],E=c.getResponseDuration(p);let g=null;const T=Math.ceil(1e3/WP);for(let A=0;A<=E;A+=T)l.setPlayheadTime(A,!0,!1,!0),e.updateNodes(),g===null?(g=new ye,g.copy(o[a])):g.merge_with(o[a].clone());E%T!==0&&(l.setPlayheadTime(E,!0,!1,!0),e.updateNodes(),g.merge_with(o[a].clone())),l.setPlayheadTime(d,!0,!1,!0),e.updateNodes(),h.worldBoundsAABB=g,h.isClamped=!1}return h};function XP(e,n,s=1/0){return zu(e,n,!1,s)}const zP=(e,n)=>{e.dataStore.isActionMode&&(e.dataStore.transition.stop(),e.updateNodes()),e.dataStore.eam.switchMode(n===null?Dn.DESIGN:Dn.ACTION),e.dataStore.selection.selectAction(n)},lE=new ye,gS="data:image/svg+xml,%3csvg%20width='16'%20height='16'%20viewBox='0%200%2016%2016'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M6.25%204.40212V2C6.25%201.0335%207.0335%200.25%208%200.25C8.9665%200.25%209.75%201.0335%209.75%202V4.40212C10.5535%204.79367%2011.2063%205.44648%2011.5979%206.25H14C14.9665%206.25%2015.75%207.0335%2015.75%208C15.75%208.9665%2014.9665%209.75%2014%209.75H11.5979C11.2063%2010.5535%2010.5535%2011.2063%209.75%2011.5979V14C9.75%2014.9665%208.9665%2015.75%208%2015.75C7.0335%2015.75%206.25%2014.9665%206.25%2014V11.5979C5.44648%2011.2063%204.79367%2010.5535%204.40212%209.75H2C1.0335%209.75%200.25%208.9665%200.25%208C0.25%207.0335%201.0335%206.25%202%206.25H4.40212C4.79367%205.44648%205.44648%204.79367%206.25%204.40212Z'%20fill='white'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M8%201.25C8.41421%201.25%208.75%201.58579%208.75%202V5.09451C9.80421%205.36585%2010.6342%206.19579%2010.9055%207.25H14C14.4142%207.25%2014.75%207.58579%2014.75%208C14.75%208.41421%2014.4142%208.75%2014%208.75H10.9055C10.6342%209.80421%209.80421%2010.6342%208.75%2010.9055V14C8.75%2014.4142%208.41421%2014.75%208%2014.75C7.58579%2014.75%207.25%2014.4142%207.25%2014V10.9055C6.19579%2010.6342%205.36585%209.80421%205.09451%208.75H2C1.58579%208.75%201.25%208.41421%201.25%208C1.25%207.58579%201.58579%207.25%202%207.25H5.09451C5.36585%206.19579%206.19579%205.36585%207.25%205.09451V2C7.25%201.58579%207.58579%201.25%208%201.25ZM9.5%208C9.5%208.82843%208.82843%209.5%208%209.5C7.17157%209.5%206.5%208.82843%206.5%208C6.5%207.17157%207.17157%206.5%208%206.5C8.82843%206.5%209.5%207.17157%209.5%208Z'%20fill='%231C6EE8'/%3e%3c/svg%3e",_S="data:image/svg+xml,%3csvg%20width='20'%20height='20'%20viewBox='0%200%2020%2020'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M7.8125%205.50265V2.5C7.8125%201.29188%208.79188%200.3125%2010%200.3125C11.2081%200.3125%2012.1875%201.29188%2012.1875%202.5V5.50265C13.1919%205.99209%2014.0079%206.8081%2014.4974%207.8125H17.5C18.7081%207.8125%2019.6875%208.79188%2019.6875%2010C19.6875%2011.2081%2018.7081%2012.1875%2017.5%2012.1875H14.4974C14.0079%2013.1919%2013.1919%2014.0079%2012.1875%2014.4974V17.5C12.1875%2018.7081%2011.2081%2019.6875%2010%2019.6875C8.79188%2019.6875%207.8125%2018.7081%207.8125%2017.5V14.4974C6.8081%2014.0079%205.99209%2013.1919%205.50265%2012.1875H2.5C1.29188%2012.1875%200.3125%2011.2081%200.3125%2010C0.3125%208.79188%201.29188%207.8125%202.5%207.8125H5.50265C5.99209%206.8081%206.8081%205.99209%207.8125%205.50265Z'%20fill='white'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M10%201.5625C10.5178%201.5625%2010.9375%201.98223%2010.9375%202.5V6.36814C12.2553%206.70731%2013.2927%207.74474%2013.6319%209.0625H17.5C18.0178%209.0625%2018.4375%209.48223%2018.4375%2010C18.4375%2010.5178%2018.0178%2010.9375%2017.5%2010.9375H13.6319C13.2927%2012.2553%2012.2553%2013.2927%2010.9375%2013.6319V17.5C10.9375%2018.0178%2010.5178%2018.4375%2010%2018.4375C9.48223%2018.4375%209.0625%2018.0178%209.0625%2017.5V13.6319C7.74474%2013.2927%206.70731%2012.2553%206.36814%2010.9375H2.5C1.98223%2010.9375%201.5625%2010.5178%201.5625%2010C1.5625%209.48223%201.98223%209.0625%202.5%209.0625H6.36814C6.70731%207.74474%207.74474%206.70731%209.0625%206.36814V2.5C9.0625%201.98223%209.48223%201.5625%2010%201.5625ZM11.875%2010C11.875%2011.0355%2011.0355%2011.875%2010%2011.875C8.96447%2011.875%208.125%2011.0355%208.125%2010C8.125%208.96447%208.96447%208.125%2010%208.125C11.0355%208.125%2011.875%208.96447%2011.875%2010Z'%20fill='%231C6EE8'/%3e%3c/svg%3e",TS="data:image/svg+xml,%3csvg%20width='12'%20height='12'%20viewBox='0%200%2012%2012'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='6'%20cy='6'%20r='5'%20fill='%231C6EE8'%20stroke='white'%20stroke-width='2'/%3e%3c/svg%3e",KP="data:image/svg+xml,%3csvg%20width='64'%20height='64'%20viewBox='0%200%2064%2064'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20opacity='0.4'%20width='64'%20height='64'%20fill='url(%23paint0_linear_53_58)'/%3e%3cpath%20d='M0%2025.6H64V38.4H0L0%2025.6Z'%20fill='white'/%3e%3cpath%20d='M0%2025.6H64V38.4H0L0%2025.6Z'%20fill='white'/%3e%3cdefs%3e%3clinearGradient%20id='paint0_linear_53_58'%20x1='32'%20y1='0'%20x2='32'%20y2='64'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-opacity='0'/%3e%3cstop%20offset='0.358891'%20stop-opacity='0.25'/%3e%3cstop%20offset='0.647229'%20stop-opacity='0.25'/%3e%3cstop%20offset='1'%20stop-opacity='0'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",AS="data:image/svg+xml,%3csvg%20width='12'%20height='12'%20viewBox='0%200%2012%2012'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3crect%20width='12'%20height='12'%20rx='6'%20transform='matrix(-1%200%200%201%2012%200)'%20fill='white'/%3e%3crect%20width='12'%20height='12'%20rx='6'%20transform='matrix(-1%200%200%201%2012%200)'%20fill='url(%23pattern0)'%20fill-opacity='0.12'/%3e%3cdefs%3e%3cpattern%20id='pattern0'%20patternContentUnits='objectBoundingBox'%20width='0.666667'%20height='0.666667'%3e%3cuse%20xlink:href='%23image0_64_5'%20transform='scale(0.0104167)'/%3e%3c/pattern%3e%3cimage%20id='image0_64_5'%20width='64'%20height='64'%20xlink:href='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAA40lEQVR4Xu3bQQ6EQAhEUbj/oXsO8Sdh4XOvJAi/qkF3Zt6E6710++xuiD6T40uACtACqYlzD2IACFKBkoHcgmSQDJJBMngKIT6ADygF6DSYfcCLTzg/z0eGrASogDbT0gKxB2MB5pkiBoBgrEEMwIBjLx9fAAiCIAhygmkkRgYjhWMHditsL2AvYC+QIHjdwzk+BmAABmBAWc1kCF0bKRAEQRAEQRAMGaACbaCUz/P5BRiKxhQaiV07uRjfYgQDMKDpGAhGCMUCzD4CBEEw1iAGYIBPZMJh+g8/P8cKpAJfV4EfMee/sLtaEFIAAAAASUVORK5CYII='/%3e%3c/defs%3e%3c/svg%3e",mS="data:image/svg+xml,%3csvg%20width='120'%20height='120'%20viewBox='0%200%20120%20120'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20filter='url(%23filter0_f_73_20)'%3e%3crect%20width='64'%20height='64'%20rx='32'%20transform='matrix(-1%200%200%201%2092%2028)'%20fill='black'%20fill-opacity='0.4'/%3e%3crect%20x='1'%20y='-1'%20width='66'%20height='66'%20rx='33'%20transform='matrix(-1%200%200%201%2094%2028)'%20stroke='white'%20stroke-width='2'/%3e%3c/g%3e%3cdefs%3e%3cfilter%20id='filter0_f_73_20'%20x='0.4'%20y='0.4'%20width='119.2'%20height='119.2'%20filterUnits='userSpaceOnUse'%20color-interpolation-filters='sRGB'%3e%3cfeFlood%20flood-opacity='0'%20result='BackgroundImageFix'/%3e%3cfeBlend%20mode='normal'%20in='SourceGraphic'%20in2='BackgroundImageFix'%20result='shape'/%3e%3cfeGaussianBlur%20stdDeviation='12.8'%20result='effect1_foregroundBlur_73_20'/%3e%3c/filter%3e%3c/defs%3e%3c/svg%3e",OS="data:image/svg+xml,%3csvg%20width='64'%20height='64'%20viewBox='0%200%2064%2064'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20width='64'%20height='64'%20rx='32'%20transform='matrix(-1%200%200%201%2064%200)'%20fill='white'%20fill-opacity='1'/%3e%3c/svg%3e",IS="data:image/svg+xml,%3csvg%20width='116'%20height='116'%20viewBox='0%200%20116%20116'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20filter='url(%23filter0_d_58_2)'%3e%3crect%20width='64'%20height='64'%20rx='32'%20transform='matrix(-1%200%200%201%2090%2026)'%20fill='white'/%3e%3c/g%3e%3cdefs%3e%3cfilter%20id='filter0_d_58_2'%20x='0.4'%20y='0.4'%20width='115.2'%20height='115.2'%20filterUnits='userSpaceOnUse'%20color-interpolation-filters='sRGB'%3e%3cfeFlood%20flood-opacity='0'%20result='BackgroundImageFix'/%3e%3cfeColorMatrix%20in='SourceAlpha'%20type='matrix'%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%20127%200'%20result='hardAlpha'/%3e%3cfeOffset/%3e%3cfeGaussianBlur%20stdDeviation='12.8'/%3e%3cfeComposite%20in2='hardAlpha'%20operator='out'/%3e%3cfeColorMatrix%20type='matrix'%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200.4%200'/%3e%3cfeBlend%20mode='normal'%20in2='BackgroundImageFix'%20result='effect1_dropShadow_58_2'/%3e%3cfeBlend%20mode='normal'%20in='SourceGraphic'%20in2='effect1_dropShadow_58_2'%20result='shape'/%3e%3c/filter%3e%3c/defs%3e%3c/svg%3e",SS="data:image/svg+xml,%3csvg%20width='32'%20height='32'%20viewBox='0%200%2032%2032'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M16%2016V27L18.909%2024.1822L19.0658%2024.0455H24L16%2016Z'%20fill='white'/%3e%3c/svg%3e",yS="data:image/svg+xml,%3csvg%20width='32'%20height='32'%20viewBox='0%200%2032%2032'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20filter='url(%23filter0_d_2637_1859)'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M16%2016V27L18.909%2024.1822L19.0658%2024.0455H24L16%2016Z'%20fill='white'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M15%2013.5742L26.4046%2025.0437H19.455L15%2029.3591V13.5742ZM19.0658%2024.0437H24L16%2015.9982V26.9982L18.909%2024.1803L19.0658%2024.0437Z'%20fill='white'/%3e%3c/g%3e%3cdefs%3e%3cfilter%20id='filter0_d_2637_1859'%20x='12'%20y='11.5742'%20width='17.4062'%20height='21.7852'%20filterUnits='userSpaceOnUse'%20color-interpolation-filters='sRGB'%3e%3cfeFlood%20flood-opacity='0'%20result='BackgroundImageFix'/%3e%3cfeColorMatrix%20in='SourceAlpha'%20type='matrix'%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%20127%200'%20result='hardAlpha'/%3e%3cfeOffset%20dy='1'/%3e%3cfeGaussianBlur%20stdDeviation='1.5'/%3e%3cfeColorMatrix%20type='matrix'%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200.35%200'/%3e%3cfeBlend%20mode='normal'%20in2='BackgroundImageFix'%20result='effect1_dropShadow_2637_1859'/%3e%3cfeBlend%20mode='normal'%20in='SourceGraphic'%20in2='effect1_dropShadow_2637_1859'%20result='shape'/%3e%3c/filter%3e%3c/defs%3e%3c/svg%3e",Po={scaleVisible:9,size:1,color:0,alpha:.05};let Nc,hE;function QP(e,n){hE=e,Nc=hE.overlay.createPane(n)}function CS(){Nc.clear();const e=hE.viewport,n=e.scale,s=e.width,i=e.height,r=1/e.scale,o=-e.x*r,a=-e.y*r;if(n>=Po.scaleVisible-1){const c=n>=Po.scaleVisible?Po.alpha:Po.alpha-Po.alpha*(Po.scaleVisible-n);Nc.lineStyle(Po.size,Po.color,c);const l=(Math.floor(o)-o)*n,h=(Math.floor(a)-a)*n;for(let d=l;d<s;d+=n)Nc.drawLine(d,0,d,i);for(let d=h;d<i;d+=n)Nc.drawLine(0,d,s,d)}}function ZP(){Nc.clear()}let Yl=null,Xl=null;function qP(e,n){Yl=e,Xl=Yl.overlay.createPane(n)}function uE(){Xl.clear();for(const e of Yl.dataStore.workspace.children){const n=Yl.getRenderItemOfElement(e);if(Ue(n)||e.get("elementType")!==Le.SCREEN||!e.get("visible"))continue;const s=e.get("name"),i=Yl.viewport.projectionTransform.clone().append(n.transform.world);Xl.fillStyle(NO.color);const r={fontSize:12,h_align:"left",v_align:"top"};Xl.drawTextImage(i.tx,i.ty-NO.padding*3,s,r)}}function jP(){Xl.clear()}const zr={selectedColor:1863400,hoverAndSelectedColor:4819949,unselectedColor:14437212,unselectedAlpha:.4,unselectedHoverAlpha:.6,highlightAlpha:1,width:1},bo=new Set;function NS(e,n,s=!1){bo.clear();const i=e.dataStore.get("state");if(i==="VERSIONING"||i==="INSPECTING")return;const r=e.viewport,o=e.viewport.projectionTransform,a=e.dataStore.selection.get("guidelines"),c=e.dataStore.selection.get("hoverGuideline");a.forEach(l=>{const h=c&&l.id===c.id?zr.hoverAndSelectedColor:zr.selectedColor;Ku(n,l,h,1,o,r,s),bo.add(l.id)}),xS(e,n,e.snapping.xHighlightGuide,ut.VERTICAL,o,r,s),xS(e,n,e.snapping.yHighlightGuide,ut.HORIZONTAL,o,r,s),c&&!bo.has(c.id)&&(bo.add(c.id),Ku(n,c,zr.unselectedColor,zr.unselectedHoverAlpha,o,r,s)),vS(e,n,e.dataStore.guidelines.getGuidelineListVertical(),ut.VERTICAL,o,r,s),vS(e,n,e.dataStore.guidelines.getGuidelineListHorizontal(),ut.HORIZONTAL,o,r,s)}function Ku(e,n,s,i,r,o,a){const c={width:zr.width,color:s,alpha:i};if(n.direction===ut.VERTICAL){const l=r.a*n.position+r.tx;e.lineStyle(c.width,c.color,c.alpha).drawLine(l,0,l,a?dt.size:o.height)}else{const l=r.d*n.position+r.ty;e.lineStyle(c.width,c.color,c.alpha).drawLine(0,l,a?dt.size:o.width,l)}}function xS(e,n,s,i,r,o,a){for(const c of s){if(bo.has(c))continue;const l=e.dataStore.guidelines.getGuideline(c);l&&(Ku(n,l,zr.unselectedColor,zr.highlightAlpha,r,o,a),bo.add(c))}}function vS(e,n,s,i,r,o,a){for(const c of s){if(bo.has(c))continue;const l=e.dataStore.guidelines.getGuideline(c);l&&(Ku(n,l,zr.unselectedColor,zr.unselectedAlpha,r,o,a),bo.add(c))}}let Fi=null,zt=null;const Fn=[],ki=[],xc=new Set;function JP(e,n){Fi=e,zt=Fi.overlay.createPane(n)}function $P(e){const n=[1,2,5,10,25,50,100,250,500,1e3,2500,5e3];let s=1/0,i;for(const r of n){const o=Math.abs(e-r);o<s&&(s=o,i=r)}return i}function eb(){const e=dt.size;zt.fillStyle(dt.background),zt.drawSolidRectTexture(0,0,e,e),zt.lineStyle(1,dt.borderColor),zt.drawRect(-.5,-.5,e,e)}function tb(){const e=Fi.viewport.width+1,n=Fi.viewport.height+1,s=dt.size;zt.lineStyle(1,dt.borderColor),zt.fillStyle(dt.background),zt.drawSolidRect(-.5,-.5,e,s),zt.drawRect(-.5,-.5,e,s),zt.drawSolidRect(-.5,-.5,s,n),zt.drawRect(-.5,-.5,s,n)}function RS(e,n,s,i,r){const o=i?-1:1,a=1/e,c=-n*a,l=(s-n)*a,h=rP("8","Inter",dt.fontSize).imageInfo,d=h.w/h.pixelRatio,p=d*(Math.max(Math.abs(Math.ceil(c)).toString().length,Math.abs(Math.ceil(l)).toString().length)+1),E=p*dt.spacingMultiple,g=s/E,T=$P((l-c)/g),A=T*e,m=_x(-c,T)*e,O=dt.size-dt.dashSize,S=O*.5+h.h/h.pixelRatio*-.3,y=s+p,v=T*Math.ceil(c/T)*o;Fn.length=0,ki.length=0;let R=v;for(let b=m;b<y;b+=A)Fn.push(b),ki.push(R.toString()),R+=o*T;const M=Fi.viewport.projectionTransform;for(const b of r){if(!b)continue;const K=(Math.round(b.position*100)/100).toString();let V;i?(V=M.d*b.position+M.ty,V=Fi.viewport.height-V):V=M.a*b.position+M.tx,ib(Fn,ki,V,K),xc.add(V)}const L=[[],[],[],[]],P=[[],[],[],[]],k=[[],[],[],[]];zt.lineStyle(1,dt.color,dt.alpha),zt.fillStyle(16777215);const Q=10;for(let b=0;b<Fn.length;b++)if(xc.has(Fn[b]))if(b>0&&xc.has(Fn[b-1])){const X=Fn[b-1],K=Fn[b],V=K-d*ki[b].length*.5-(X+d*ki[b-1].length*.5),J=wS(V);J!==null&&L[J].push([K,ki[b]])}else L[3].push([Fn[b],ki[b]]);else{let X=1/0,K=1/0;b>0&&xc.has(Fn[b-1])&&(X=Fn[b]-d*ki[b].length*.5-(Fn[b-1]+d*ki[b-1].length+Q)),b<Fn.length-1&&xc.has(Fn[b+1])&&(K=Fn[b+1]-(Fn[b]+d*ki[b].length*.5+Q));const V=Math.min(X,K);if(V<=4){const J=wS(V);J!==null&&(P[J].push([Fn[b],ki[b]]),k[J].push(Fn[b]))}else P[3].push([Fn[b],ki[b]]),zt.drawLine(Fn[b],O-1,Fn[b],dt.size-1)}for(let b=0;b<3;b++)if(k[b].length>0){zt.lineStyle(1,dt.color,dt.overlapAlpha[b]),zt.fillStyle(16777215);for(let X=0;X<k[b].length;X++)zt.drawLine(k[b][X],O-1,k[b][X],dt.size-1)}for(let b=0;b<4;b++){const X={fontSize:10,h_align:"left",v_align:"top"};if(L[b].length>0){zt.fillStyle(dt.guidelineColor,dt.overlapAlpha[b]);for(let K=0;K<L[b].length;K++)i?zt.drawTextImage(L[b][K][0]+Q/2,S*1.6,L[b][K][1],X):zt.drawTextImage(L[b][K][0]+Q/2,S,L[b][K][1],X)}if(P[b].length>0){zt.fillStyle(dt.color,dt.overlapAlpha[b]);for(let K=0;K<P[b].length;K++){const V=new N().fromArray(zt.measureTextImage(P[b][K][1],X.fontSize,"left","top"));zt.drawTextImage(P[b][K][0]-V.x/2,S,P[b][K][1],X)}}}}function nb(){zt.clear(),tb(),xc.clear();const e=Fi.dataStore.selection.get("hoverGuideline"),n=Fi.dataStore.selection.get("guidelines"),s=n.filter(h=>h.direction===ut.HORIZONTAL),i=n.filter(h=>h.direction===ut.VERTICAL);e&&(e.direction===ut.HORIZONTAL?s.push(e):e.direction===ut.VERTICAL&&i.push(e));const r=Fi.viewport,o={x:0,y:0};if(Fi.view instanceof cE){const h=Fi.view.offset.clone();o.x=h.x,o.y=h.y}const a=r.x+o.x*r.scale;RS(r.scale,a,r.width,!1,i);const c=new Ce().rotate(-Math.PI*.5).translate(0,r.height);zt.appendTransform(c);const l=r.height-r.y-o.y*r.scale;RS(r.scale,l,r.height,!0,s),zt.resetTransform(),NS(Fi,zt,!0),eb()}function sb(){zt.clear()}function ib(e,n,s,i){if(e.length===0)return e.push(s),e;const r=rb(e,s);return n.splice(r,0,i),e.splice(r,0,s),e}function rb(e,n){let s=0,i=e.length;for(;s<i;){const r=Math.floor((s+i)/2);e[r]<n?s=r+1:i=r}return s}function wS(e){return e>4?3:e>3?2:e>2?1:e>1?0:null}const or={size:20,padding:5,color:8947848,colorHover:13421772,borderRadius:5};let zl=null,dE=null,Qu=0,fE=null,Or=null;function ob(e,n){return dE=e,zl=dE.overlay.createPane(n),zl}function ab(e){fE=e}function cb(e){Or=e}function DS(e){Qu=e}function lb(){if(zl.clear(),Or===null||Qu<Number.EPSILON)return;const e=dE.viewport,n=or.padding;hb(e,n,Or.left,Or.width,Or.top,Or.height)}function hb(e,n,s,i,r,o){Math.round(Or.right-Or.left)<e.width&&zl.fillStyle(fE==="x"?or.colorHover:or.color,Qu).drawSolidRect(s,e.height-or.size+n,i,or.size-n*2,or.borderRadius),Math.round(Or.bottom-Or.top)<e.height&&zl.fillStyle(fE==="y"?or.colorHover:or.color,Qu).drawSolidRect(e.width-or.size+n,r,or.size-n*2,o,or.borderRadius)}const Kl="data:image/svg+xml,%3csvg%20width='13'%20height='12'%20viewBox='0%200%2013%2012'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20x='6.5'%20y='1.0529'%20width='7'%20height='7'%20transform='rotate(45%206.5%201.0529)'%20fill='white'%20stroke='%231C6EE8'/%3e%3c/svg%3e",Ql="data:image/svg+xml,%3csvg%20width='13'%20height='12'%20viewBox='0%200%2013%2012'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20x='6.5'%20y='1.0529'%20width='7'%20height='7'%20transform='rotate(45%206.5%201.0529)'%20fill='white'%20stroke='%2395BEF2'/%3e%3c/svg%3e",Zl="data:image/svg+xml,%3csvg%20width='17'%20height='18'%20viewBox='0%200%2017%2018'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20x='8.5'%20y='1.92575'%20width='10'%20height='10'%20transform='rotate(45%208.5%201.92575)'%20fill='%2395BEF2'%20stroke='white'%20stroke-width='2'/%3e%3c/svg%3e",ql="data:image/svg+xml,%3csvg%20width='17'%20height='18'%20viewBox='0%200%2017%2018'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20x='8.5'%20y='1.92587'%20width='10'%20height='10'%20transform='rotate(45%208.5%201.92587)'%20fill='%231C6EE8'%20stroke='white'%20stroke-width='2'/%3e%3c/svg%3e",Zu="data:image/svg+xml,%3csvg%20width='11'%20height='10'%20viewBox='0%200%2011%2010'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='5.5'%20cy='5'%20r='4.5'%20fill='white'%20stroke='%231C6EE8'/%3e%3c/svg%3e",pE="data:image/svg+xml,%3csvg%20width='11'%20height='10'%20viewBox='0%200%2011%2010'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='5.5'%20cy='5'%20r='4.5'%20fill='white'%20stroke='%2395BEF2'/%3e%3c/svg%3e",EE="data:image/svg+xml,%3csvg%20width='15'%20height='14'%20viewBox='0%200%2015%2014'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='7.5'%20cy='7'%20r='6'%20fill='%2395BEF2'%20stroke='white'%20stroke-width='2'/%3e%3c/svg%3e",gE="data:image/svg+xml,%3csvg%20width='15'%20height='14'%20viewBox='0%200%2015%2014'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='7.5'%20cy='7'%20r='6'%20fill='%231C6EE8'%20stroke='white'%20stroke-width='2'/%3e%3c/svg%3e";let Ei=null,Kr=null,_E=null,qu=null,jl=null;const Ir=new Ce,ju=new N,Ht=new N;let Jl=null,Ju=null,$t=null,$l=!0,TE=null;const Wn={visible:!1,dirty:!1,position:new N,snapId:null,builder:new Gf,curved:!0},gi={visible:!1,position:new N,highlighted:!1},as={visible:!1,dirty:!1,edgeIds:[],builder:new Gf};let LS=[];const at={LINE_WIDTH:1,LINE_COLOR:9145227,SELECTED_LINE_COLOR:1863400,SVG_COLOR:16777215,GHOST_COLOR:1863400,CURVE_OFFSET:4,HIGHLIGHTED_COLOR:16724530,ASSIST_LINE_CROSS_SIZE:3},eh=new Map;eh.set(0,e=>{const n=$t.getVertPos(e.id);Ir.xform(Ht.set(n[0],n[1]),Ht),Kr.fillStyle(at.SVG_COLOR).drawImageFromAtlas(Zu,Ht.x,Ht.y,1,1)});const AE=1<<Ge.SELECTED;eh.set(AE,e=>{const n=$t.getVertPos(e.id);Ir.xform(Ht.set(n[0],n[1]),Ht),Kr.fillStyle(at.SVG_COLOR).drawImageFromAtlas(gE,Ht.x,Ht.y,1,1)});const mE=1<<Ge.CURVE_VERT;eh.set(mE,e=>{if(!e.adjacentMainVertex||!$t.vertices.has(e.adjacentMainVertex)||e.adjacentMainVertex.pos.eq(e.pos))return;const n=e.adjacentMainVertex;n.isFlagged(Ge.CONNECT_SELECTED)&&(Wn.visible&&!Wn.curved&&e.id===n.unlinkedCurveControl&&n.isFlagged(Ge.SELECTED)||(PS(e.id,n.id,!1),MS(e.id,!1)))}),eh.set(mE|AE,e=>{if(!e.adjacentMainVertex||!$t.vertices.has(e.adjacentMainVertex)||e.adjacentMainVertex.pos.eq(e.pos))return;const n=e.adjacentMainVertex.id;PS(e.id,n,!0),MS(e.id,!0)});function MS(e,n){const s=$t.getVertPos(e);Ir.xform(Ht.set(s[0],s[1]),Ht),ub(Ht.x,Ht.y,n)}function ub(e,n,s){const i=s?ql:Kl;Kr.fillStyle(at.SVG_COLOR).drawImageFromAtlas(i,e,n,1,1)}function PS(e,n,s){const i=$t.getVertPos(e,fb),r=$t.getVertPos(n,pb);Ir.xform(Ht.set(i[0],i[1]),Ht),Ir.xform(ju.set(r[0],r[1]),ju),db(Ht.x,Ht.y,ju.x,ju.y,s)}function db(e,n,s,i,r){const o=new N(s-e,i-n),a=o.length(),c=1/a;o.scale(c);const l=r?at.SELECTED_LINE_COLOR:at.LINE_COLOR;Kr.lineStyle(at.LINE_WIDTH,l).drawLine(e,n,e+o.x*(a-at.CURVE_OFFSET),n+o.y*(a-at.CURVE_OFFSET))}const fb=new Float32Array(2),pb=new Float32Array(2);function Eb(e,n,s,i,r){Ei=e,qu=e.overlay.createPane(n),_E=Ei.overlay.createPane(s),Kr=Ei.overlay.createPane(i),jl=Ei.overlay.createPane(r),Ei.dataStore.selection.on(me.SELECT_CELL,o=>{const a=o.get("vertices").after;_b(a),!a.length>0&&(Wn.visible=!1)}),Ei.dataStore.on(me.DEFAULT_CHANGES,o=>{o.has("activeTool")&&o.get("activeTool").after!==et.PEN&&(Wn.visible=!1,gi.visible=!1,gi.highlighted=!1)}),gb()}function gb(){Mt(Kl),Mt(Ql),Mt(Zl),Mt(ql),Mt(Zu),Mt(pE),Mt(EE),Mt(gE)}function _b(e){if(Jl){for(const n of $t.vertices)n.removeFlag(Ge.SELECTED),n.removeFlag(Ge.CONNECT_SELECTED);for(const n of e)n.flag(Ge.SELECTED),n.flag(Ge.CONNECT_SELECTED),n.isFlagged(Ge.CURVE_VERT)&&(n.controllingEdge?(n.controllingEdge.v.flag(Ge.CONNECT_SELECTED),n.controllingEdge.w.flag(Ge.CONNECT_SELECTED)):n.adjacentMainVertex&&n.adjacentMainVertex.flag(Ge.CONNECT_SELECTED));for(const n of $t.getEdges())n.v.isFlagged(Ge.SELECTED)&&n.w.flag(Ge.CONNECT_SELECTED),n.w.isFlagged(Ge.SELECTED)&&n.v.flag(Ge.CONNECT_SELECTED)}}function Tb(){$l&&(TE=zh($t),$l=!1),TE&&qu.lineStyle(at.LINE_WIDTH,at.LINE_COLOR).drawPath(0,0,TE.applyXorm(Ir)),Wn.visible&&(Wn.visible=mb(Wn)),Wn.visible&&qu.lineStyle(at.LINE_WIDTH,at.GHOST_COLOR).drawPath(0,0,Wn.builder.path.applyXorm(Ir)),as.visible&&(Ob(),as.builder.path.commands.length>0&&jl.lineStyle(at.LINE_WIDTH,at.HIGHLIGHTED_COLOR).drawPath(0,0,as.builder.path.applyXorm(Ir)));for(const e of[...$t.vertices].sort((n,s)=>n.index-s.index))eh.get(e.flags&(mE|AE))(e);Ab();for(const e of LS)jl.lineStyle(1,at.HIGHLIGHTED_COLOR).drawLine(e[0].x,e[0].y,e[1].x,e[1].y).drawLine(e[0].x-at.ASSIST_LINE_CROSS_SIZE,e[0].y-at.ASSIST_LINE_CROSS_SIZE,e[0].x+at.ASSIST_LINE_CROSS_SIZE,e[0].y+at.ASSIST_LINE_CROSS_SIZE).drawLine(e[0].x-at.ASSIST_LINE_CROSS_SIZE,e[0].y+at.ASSIST_LINE_CROSS_SIZE,e[0].x+at.ASSIST_LINE_CROSS_SIZE,e[0].y-at.ASSIST_LINE_CROSS_SIZE).drawLine(e[1].x-at.ASSIST_LINE_CROSS_SIZE,e[1].y-at.ASSIST_LINE_CROSS_SIZE,e[1].x+at.ASSIST_LINE_CROSS_SIZE,e[1].y+at.ASSIST_LINE_CROSS_SIZE).drawLine(e[1].x-at.ASSIST_LINE_CROSS_SIZE,e[1].y+at.ASSIST_LINE_CROSS_SIZE,e[1].x+at.ASSIST_LINE_CROSS_SIZE,e[1].y-at.ASSIST_LINE_CROSS_SIZE)}function Ab(){const e=Ei.dataStore.selection.get("hoverVertex");if(!e||!Jl)return;const n=$t.getVertPos(e.id);Ir.xform(Ht.set(n[0],n[1]),Ht);let s=Ql,i=pE;e.isFlagged(Ge.SELECTED)&&(s=Zl,i=EE),e.isFlagged(Ge.CURVE_VERT)?Kr.fillStyle(at.SVG_COLOR).drawImageFromAtlas(s,Ht.x,Ht.y,1,1):Kr.fillStyle(at.SVG_COLOR).drawImageFromAtlas(i,Ht.x,Ht.y,1,1),gi.highlighted&&jl.lineStyle(at.LINE_WIDTH,at.HIGHLIGHTED_COLOR).drawLine(Ht.x-at.ASSIST_LINE_CROSS_SIZE,Ht.y-at.ASSIST_LINE_CROSS_SIZE,Ht.x+at.ASSIST_LINE_CROSS_SIZE,Ht.y+at.ASSIST_LINE_CROSS_SIZE).drawLine(Ht.x-at.ASSIST_LINE_CROSS_SIZE,Ht.y+at.ASSIST_LINE_CROSS_SIZE,Ht.x+at.ASSIST_LINE_CROSS_SIZE,Ht.y-at.ASSIST_LINE_CROSS_SIZE)}function mb(e){if(!e.dirty)return!0;e.dirty=!1,e.builder.clear();const n=Ei.dataStore.selection.get("vertices");if(n.length!==1||n[0].isFlagged(Ge.CURVE_VERT))return!1;const s=n[0],i=$t.getVertPos(s.id,th);let r=!1;if(e.snapId){const o=$t.cellTable.get(e.snapId);if(o.isFlagged(Ge.CURVE_VERT))return!1;for(const a of o.upperTierIDs){const c=$t.cellTable.get(a);if(!c.isCurve&&(c.v===s&&c.w===o||c.w===s&&c.v===o))return!1}$t.getVertPos(e.snapId,ar),o.unlinkedCurveControl?(r=!0,$t.getVertPos(o.unlinkedCurveControl,va)):(va[0]=ar[0],va[1]=ar[1])}else{if(Ju.transform.worldInv.xform(e.position,e.position),new N(th[0],th[1]).distance_to(e.position)<Number.EPSILON)return!1;ar[0]=e.position.x,ar[1]=e.position.y,va[0]=ar[0],va[1]=ar[1]}return(s.unlinkedCurveControl||r)&&e.curved?(s.unlinkedCurveControl?$t.getVertPos(s.unlinkedCurveControl,nh):(nh[0]=i[0],nh[1]=i[1]),e.builder.start(i[0],i[1]),e.builder.cubic(nh[0],nh[1],va[0],va[1],ar[0],ar[1]),e.builder.end(),!0):(e.builder.start(th[0],th[1]),e.builder.line(ar[0],ar[1]),e.builder.end(),!0)}function Ob(){if(as.dirty){as.dirty=!1,as.builder.clear();for(const e of as.edgeIds){const n=$t.cellTable.get(e);if(!n){console.error(`Could not find edge ${e}`);continue}if(n.isCurve){const s=$t.getEdgeCurve(e),i=new N(s[0].x,s[0].y),r=new N(s[1].x,s[1].y),o=$t.getVertPos(n.v.id),a=new N(o.x,o.y),c=$t.getVertPos(n.w.id),l=new N(c.x,c.y);as.builder.start(a.x,a.y),as.builder.cubic(i.x,i.y,r.x,r.y,l.x,l.y),as.builder.end()}else{const s=$t.getVertPos(n.v.id),i=new N(s.x,s.y),r=$t.getVertPos(n.w.id),o=new N(r.x,r.y);as.builder.start(i.x,i.y),as.builder.line(o.x,o.y),as.builder.end()}}}}const th=new Float32Array(2),ar=new Float32Array(2),nh=new Float32Array(2),va=new Float32Array(2);function Ib(){Kr.clear(),_E.clear(),qu.clear(),jl.clear(),gi.visible&&_E.fillStyle(at.SVG_COLOR).drawImageFromAtlas(Zu,gi.position.x,gi.position.y,1,1),Jl!==null&&(Ir.copy(Ju.transform.world).prepend(Ei.viewport.projectionTransform),Tb())}function Sb(e){e.canMorph||console.error(`${e.get("id")} can't edit path`),Jl=e,Ju=Ei.getRenderItemOfElement(e),$t=e.get("geometry").get("mesh"),$l=!0}function yb(){if($t)for(const e of $t.vertices)e.removeFlag(Ge.SELECTED);Jl=null,$t=null,Ju=null,Kr.clear(),$l=!0}function sh(e,n,s){if(gi.visible=!0,gi.highlighted=!1,s){const i=new N(e,n),o=Ei.viewport.toWorld(i).round(),a=Ei.viewport.toScreen(o);gi.position.copy(a)}else gi.position.set(e,n)}function OE(e){gi.visible=!1,gi.highlighted=e}function Cb(e,n,s){Wn.visible=!0,Wn.dirty=!0,Wn.snapId=null,Wn.position.copy(Ei.viewport.toWorld(gi.position)),Wn.curved=s}function Nb(e,n){Wn.visible=!0,Wn.dirty=!0,Wn.snapId=e,Wn.curved=n}function vc(){Wn.visible=!1,Wn.dirty=!0}function Rc(e){as.edgeIds=e,as.dirty=!0,as.visible=e.length>0}function xb(){as.visible=!1,as.dirty=!0}function Uo(e){LS=e}function $u(){$l=!0}const bS="data:image/svg+xml,%3csvg%20width='16'%20height='16'%20viewBox='0%200%2016%2016'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M12.6769%207.0297L9.13808%202.90796C8.53951%202.2108%207.46049%202.21079%206.86192%202.90796L3.32308%207.0297C2.84052%207.59175%202.84052%208.42191%203.32308%208.98396L6.86192%2013.1057C7.46049%2013.8029%208.53951%2013.8029%209.13808%2013.1057L12.6769%208.98396C13.1595%208.42191%2013.1595%207.59175%2012.6769%207.0297Z'%20fill='white'%20stroke='%231C6EE8'/%3e%3c/svg%3e",US="data:image/svg+xml,%3csvg%20width='16'%20height='18'%20viewBox='0%200%2016%2018'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M14.2705%207.69822L9.51744%202.16226C8.71935%201.23272%207.28066%201.23271%206.48256%202.16226L1.72951%207.69822C1.08609%208.44762%201.08609%209.5545%201.72951%2010.3039L6.48256%2015.8399C7.28065%2016.7694%208.71934%2016.7694%209.51744%2015.8399L14.2705%2010.3039C14.9139%209.5545%2014.9139%208.44762%2014.2705%207.69822Z'%20fill='%231C6EE8'%20stroke='white'%20stroke-width='2'/%3e%3c/svg%3e",GS="data:image/svg+xml,%3csvg%20width='16'%20height='16'%20viewBox='0%200%2016%2016'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M9.13808%202.90796C8.53951%202.2108%207.46049%202.21079%206.86192%202.90796L3.32308%207.0297C2.84052%207.59175%202.84052%208.42191%203.32308%208.98396L6.86192%2013.1057C7.46049%2013.8029%208.53951%2013.8029%209.13808%2013.1057L12.6769%208.98396C13.1595%208.42191%2013.1595%207.59175%2012.6769%207.0297L9.13808%202.90796Z'%20fill='white'%20stroke='%231C6EE8'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M13.0561%206.70416L9.51722%202.58242C8.71913%201.65287%207.28044%201.65287%206.48234%202.58242L2.9435%206.70416C2.30008%207.45356%202.30008%208.56044%202.9435%209.30984L6.48234%2013.4316C7.28043%2014.3611%208.71912%2014.3611%209.51721%2013.4316L13.0561%209.30984C13.6995%208.56044%2013.6995%207.45356%2013.0561%206.70416ZM12.2973%208.6584C12.2973%208.65841%2012.2973%208.65841%2012.2973%208.65841V8.65842C12.2973%208.65841%2012.2973%208.65841%2012.2973%208.6584Z'%20fill='white'%20fill-opacity='0.6'/%3e%3c/svg%3e",FS="data:image/svg+xml,%3csvg%20width='16'%20height='18'%20viewBox='0%200%2016%2018'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M9.51744%202.16226C8.71935%201.23272%207.28066%201.23271%206.48256%202.16226L1.72951%207.69822C1.08609%208.44762%201.08609%209.5545%201.72951%2010.3039L6.48256%2015.8399C7.28065%2016.7694%208.71934%2016.7694%209.51744%2015.8399L14.2705%2010.3039C14.9139%209.5545%2014.9139%208.44762%2014.2705%207.69822L9.51744%202.16226Z'%20fill='%231C6EE8'%20stroke='white'%20stroke-width='2'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M14.2706%207.69833L9.51756%202.16237C8.71947%201.23282%207.28078%201.23282%206.48269%202.16237L1.72963%207.69833C1.08622%208.44773%201.08622%209.55461%201.72963%2010.304L6.48269%2015.84C7.28078%2016.7695%208.71947%2016.7695%209.51756%2015.84L14.2706%2010.304C14.914%209.55461%2014.914%208.44773%2014.2706%207.69833ZM2.38279%209.50439C2.41295%209.55612%202.44814%209.60575%202.48835%209.65259L7.24141%2015.1885L2.48835%209.65258C2.44814%209.60574%202.41295%209.55612%202.38279%209.50439Z'%20fill='white'%20fill-opacity='0.6'/%3e%3c/svg%3e",kS="data:image/svg+xml,%3csvg%20width='8'%20height='8'%20viewBox='0%200%208%208'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M1.75%204C1.75%202.75736%202.75736%201.75%204%201.75C5.24264%201.75%206.25%202.75736%206.25%204C6.25%205.24264%205.24264%206.25%204%206.25C2.75736%206.25%201.75%205.24264%201.75%204Z'%20fill='white'/%3e%3ccircle%20cx='4'%20cy='4'%20r='2'%20fill='%238B8B8B'/%3e%3c/svg%3e";let Tn=null,Me=null,BS=null,Ra=null,VS=null;const IE=new Ce,SE=new Ce;let ih=null,Sr=null,yr=null,yn=null,Ts=null,yE=!1;const HS=new N;let WS=null;const YS=new Map,Cr="FAKE_INIT_KF_ID",XS=new Set(["delay","start","end"]),Nr=new Bt(0,0,0,0,0,0,0,0),Ve=new Map,Bi=new Map,_i=new Map,zS={VERT_HALF_BOX_WIDTH:8},Qr={HOVER_SEGMENT_WIDTH:2.5,HOVER_SEGMENT_COLOR:1863400,LINE_WIDTH:1.5,LINE_COLOR:9145227,SVG_COLOR:16777215};function vb(e,n,s,i){Tn=e,Me=Tn.dataStore,Ra=Tn.overlay.createPane(n),BS=Tn.overlay.createPane(s),VS=Tn.overlay.createPane(i),Me.selection.on(me.SELECT,a=>{const c=a.get("motionPoints");c&&(Ts=c.after)}),Me.eam.on(Y.HOVER_MOTION_POINT,({mousePos:a},{modifier:c=!1})=>{const l=Me.selection.get("elements");if(Me.get("mode")!==Dn.ACTION||l.length!==1||l[0].get("locked")||Tn.dataStore.getFeature("editOrigin")||Tn.dataStore.getFeature("editSelector")){yn=null;return}const h=Tn.viewport.toWorld(a);yn=kb(h),yn&&(Me.eam.changeHover(Gt.MOTION_POINT),ih(c?"arrowCurve":"default")),Me.selection.set("hoverMotionPoint",yn)}),Me.eam.on(Y.SELECT_MOTION_POINT,(a,{shift:c,modifier:l})=>{const h=Me.selection,d=h.get("elements");if(!yn||Me.get("mode")!==Dn.ACTION||d.length!==1||yr.item.locked||Tn.dataStore.getFeature("editOrigin")||Tn.dataStore.getFeature("editSelector")){yn=null;return}const p=Ts.length>0&&(Ts[0].type==="point"&&yn.type==="point"||Ts[0].type!=="point"&&yn.type!=="point");l&&Rb(yn),c&&p?Me.selection.toggleMotionPoints([yn],td):td(Ts,yn)||Me.selection.selectMotionPoints([yn]),Ts=h.get("motionPoints"),jS(Ts)}),Me.eam.on(Y.SELECT_ALL_MOTION_POINTS,()=>{const a=Me.selection.get("elements")[0],l=Me.transition.getPropertyKeyframesByElementId(a.get("id"),"motionPath").map(h=>({type:"point",key:h.id,trackId:h.trackId,time:h.time}));Me.selection.selectMotionPoints(l)}),Me.eam.on(Y.DESELECT_MOTION_POINT,()=>{Me.selection.selectMotionPoints([]),Ts=null}),Me.eam.on(Y.START_DRAG_MOTION_POINT,a=>{if(!yn){a.handled=!1;return}if(!Ve.has(yn.key)){a.handled=!1;return}Ts=Me.selection.get("motionPoints");for(const c of Ts){const l=c.type==="point"?"pos":c.type;YS.set(c.key+c.type,new N().fromArray(Ve.get(c.key)[l]))}WS=Tn.viewport.toWorld(a.mousePos),HS.set(0,0)}).on(Y.UPDATE_DRAG_MOTION_POINT,({mousePos:a})=>{ih("default");const c=Tn.viewport.toWorld(a);HS.copy(c).sub(WS);const l=yr.item.transform.parent,d=IE.copy(l).affine_inverse().xform(c);Ve.has(yn.key)&&(Me.editor.setMotionPathProps(d,yn,{commit:!1,delta:!1}),yn=Me.selection.get("hoverMotionPoint"))}).on(Y.END_DRAG_MOTION_POINT,()=>{YS.clear(),Me.commitUndo()});const r=2,o={lastMousePos:new N,isPressingShift:!1,hoverMotionSegment:null,hasDragged:!1,initMousePos:new N};Me.eam.on(Y.HOVER_MOTION_SEGMENT,({mousePos:a})=>{if(Me.selection.get("hoverMotionPoint")){Me.selection.set("hoverMotionSegment",null);return}o.hoverMotionSegment=Wb(a),o.hoverMotionSegment&&(Me.eam.changeHover(Gt.MOTION_SEGMENT),ih("arrowCurve")),Me.selection.set("hoverMotionSegment",o.hoverMotionSegment)}),Me.eam.on(Y.START_DRAG_MOTION_SEGMENT,(a,{shift:c})=>{o.hasDragged=!1,o.initMousePos.copy(a.mousePos);const l=Tn.viewport.toWorld(a.mousePos);o.lastMousePos.copy(l),o.isPressingShift=c}).on(Y.UPDATE_DRAG_MOTION_SEGMENT,(a,{shift:c})=>{o.isPressingShift=c;const l=Tn.viewport.toWorld(a.mousePos),h=l.clone().sub(o.lastMousePos);if(o.lastMousePos.copy(l),o.hasDragged===!1){if(o.initMousePos.clone().sub(a.mousePos).length()>r){if(o.hasDragged=!0,!o.hoverMotionSegment){a.handled=!1;return}const p=o.hoverMotionSegment.keyStart,E=o.hoverMotionSegment.keyEnd,g=wb(p,E,o.hoverMotionSegment);if(g.length!==2||!g[0]||!g[1]){a.handled=!1;return}Me.selection.selectMotionPoints([g[0]],_n),Me.selection.addMotionPoints([g[1]],_n);const T=Ve.get(g[0].key),A=Ve.get(g[1].key),m=new N().fromArray(T.out),O=new N().fromArray(A.in),S=new N().fromArray(T.pos),y=new N().fromArray(A.pos);if(m&&O&&m.is_zero()&&O.is_zero()){const{oneThird:v,twoThirds:R}=N.getThirds(S,y);KS(T,A,v.sub(S),R.sub(y))}}}else{const d=Array.from(Me.selection.get("motionPoints")).sort((R,M)=>R.time-M.time),p=Ve.get(d[0].key),E=Ve.get(d[1].key),g=new N().fromArray(p.pos),T=new N().fromArray(E.pos),A=new N().fromArray(p.out).add(g),m=new N().fromArray(E.in).add(T),{deltaP1:O,deltaP2:S}=Qb(o.hoverMotionSegment.t,h.x,h.y),y=A.clone().add(O).sub(g),v=m.clone().add(S).sub(T);KS(p,E,y,v)}}).on(Y.END_DRAG_MOTION_SEGMENT,()=>{Me.commitUndo()}),Me.eam.on(Y.START_DRAG_ELEMENT,()=>{yE=!0}).on(Y.END_DRAG_ELEMENT,()=>{yE=!1}),Db()}function Rb(e){if(e.type==="point"){yr=Tn.indexer.getNode(Sr.get("id"));const n=yr.item.baseTransform.translate,s=Ve.get(e.key);let i;switch(s.mirror){case pe.ANGLE:i=pe.NONE;break;case pe.ANGLE_AND_LENGTH:i=pe.NONE;break;case pe.INDEPENDENT:i=pe.NONE;break;default:i=pe.ANGLE_AND_LENGTH}JS(e,n,i)}else if(e.type==="in"){const n=Ve.get(e.key),s=new N().fromArray(n.out);Me.editor.setMotionPathProps({mirror:s.is_zero()?pe.NONE:pe.INDEPENDENT,x:-n.in[0],y:-n.in[1]},{key:n.id,type:"in",time:n.time,trackId:n.trackId},{commit:!1,delta:!0}),Me.selection.removeMotionPoints([e],td,{commit:!1});const i=Bi.get(e.key);_i.get(e.key).in.copy(i)}else if(e.type==="out"){const n=Ve.get(e.key),s=new N().fromArray(n.in);Me.editor.setMotionPathProps({mirror:s.is_zero()?pe.NONE:pe.INDEPENDENT,x:-n.out[0],y:-n.out[1]},{key:n.id,type:"out",time:n.time,trackId:n.trackId},{commit:!1,delta:!0}),Me.selection.removeMotionPoints([e],td,{commit:!1});const i=Bi.get(e.key);_i.get(e.key).out.copy(i)}}function KS(e,n,s,i){if(e.mirror===pe.ANGLE||e.mirror===pe.ANGLE_AND_LENGTH){const o=new N().fromArray(e.in),a=Math.atan2(s.y,s.x)+Math.PI,c=e.mirror===pe.ANGLE?o.length():s.length();o.set(Math.cos(a)*c,Math.sin(a)*c),Me.editor.setMotionPathProps({mirror:e.mirror,x:o.x-e.in[0],y:o.y-e.in[1]},{key:e.id,type:"in",time:e.time,trackId:e.trackId},{commit:!1,delta:!0})}Me.editor.setMotionPathProps({mirror:e.mirror===pe.NONE?pe.INDEPENDENT:e.mirror,x:s.x-e.out[0],y:s.y-e.out[1]},{key:e.id,type:"out",time:e.time,trackId:e.trackId},{commit:!1,delta:!0});const r=new N().fromArray(n.out);if(n.mirror===pe.ANGLE||n.mirror===pe.ANGLE_AND_LENGTH){const o=Math.atan2(i.y,i.x)+Math.PI,a=n.mirror===pe.ANGLE?r.length():i.length();r.set(Math.cos(o)*a,Math.sin(o)*a),Me.editor.setMotionPathProps({mirror:n.mirror,x:r.x-n.out[0],y:r.y-n.out[1]},{key:n.id,type:"out",time:n.time,trackId:n.trackId},{commit:!1,delta:!0})}Me.editor.setMotionPathProps({mirror:n.mirror===pe.NONE?pe.INDEPENDENT:n.mirror,x:i.x-n.in[0],y:i.y-n.in[1]},{key:n.id,type:"in",time:n.time,trackId:n.trackId},{commit:!1,delta:!0})}function wb(e,n,s){const i=[];let r,o;const a=yr.item.baseTransform.translate;if(e===Cr)r=CE(0,0,0,s.trackIds[0]);else if(XS.has(e)){const c=SE.xform(s.points[0]).sub(a);r=CE(c.x,c.y,s.times[0],s.trackIds[0])}else r={type:"point",key:e,data:new N().fromArray(Ve.get(e).pos),time:Ve.get(e).time,trackId:Ve.get(e).trackId};if(!r)return[];if(i.push(r),XS.has(n)){const c=SE.xform(s.points[1]).sub(a);o=CE(c.x,c.y,s.times[1],s.trackIds[1])}else o={type:"point",key:n,data:new N().fromArray(Ve.get(n).pos),time:Ve.get(n).time,trackId:Ve.get(n).trackId};return o?(i.push(o),s.keyStart=i[0].key,s.keyEnd=i[1].key,Me.interaction.fire(),QS(Sr.get("id")),i):[]}function CE(e,n,s,i=Cr){const r="motionPath",o=Sr.get("id"),a=Me.selection.selectedActionId;let c=Me.interaction.getPropertyTrackByElementIdAndPropKey(a,o,r);if(!c){const p=Me.interaction.getAnimationPreset(i);if(!p)return null;const E=Me.interaction.getElementTrack(p.elementTrackId),g=E.propertyTrackMap.get(r);if(c=Me.interaction.getPropertyTrack(g),!c){const T=[r];c=Me.interaction._createPropertyTrackRecursive(E,T)[0]}}let l=null;l={elementId:o,propKey:r,value:{pos:[e,n]},delta:!0,frameType:If.EXPLICIT};const h={...l,time:s};return{type:"point",key:Me.interaction.upsertKeyframeToPropertyTrack(c,h).id,data:new N(e,n),time:s,trackId:c.id}}function Db(){Mt(Kl),Mt(Ql),Mt(Zl),Mt(ql),Mt(Zu),Mt(pE),Mt(EE),Mt(gE),Mt(bS),Mt(US),Mt(GS),Mt(FS),Mt(kS)}function QS(e){const n=Me.transition.getPropertyKeyframesByElementId(e,"motionPath");if(!n||n.length===0)return;let s=0,i=null;Ve.clear(),n[0].time!==0&&(Ve.set(Cr,{id:Cr,trackId:Cr,time:0,pos:[0,0],in:[0,0],out:[0,0],mirror:0,prev:null,next:n[0].id}),i=Cr);for(let r=0;r<n.length;r++){const o=n[r],a=o.id??s++;o.frameType===1?Ve.set(a,{id:a,trackId:o.trackId,time:o.time,pos:[0,0],in:[0,0],out:[0,0],mirror:0,prev:i,next:r<n.length-1?n[r+1].id:null}):Ve.set(a,{id:a,trackId:o.trackId,time:o.time,pos:o.value.pos,in:o.value.in,out:o.value.out,mirror:o.value.mirror,prev:i,next:r<n.length-1?n[r+1].id:null}),i=a}Ts&&jS(Ts)}function Lb(){if(Me.get("editMode")===wn.SHAPE||Me.getFeature("editGradient")||Me.get("activeTool")===et.COMMENT||Me.get("mode")!==Dn.ACTION)return;const e=Me.selection.get("elements");if(e.length!==1||(yE?(Sr=Me.selection.get("cachedElements")[0],Sr||(Sr=e[0])):Sr=e[0],!Sr)||(Ts=Me.selection.get("motionPoints"),QS(Sr.get("id")),Ve.size===0))return;yr=Tn.indexer.getNode(Sr.get("id"));const n=yr.item.baseTransform.translate,s=yr.item.transform.parent,i=IE.copy(s).prepend(Tn.viewport.projectionTransform);SE.copy(IE).affine_inverse();const r=new N,o=new N,a=i.xform(new N);for(const[c,l]of Ve)r.set(l.pos[0],l.pos[1]).add(n),Bi.set(c,i.xform(r)),r.set(l.in[0],l.in[1]),o.set(l.out[0],l.out[1]),_i.set(c,{in:i.xform(r).sub(a),out:i.xform(o).sub(a)});Mb(),Pb()&&(bb(),Ub())}function Mb(){const e=Me.selection.get("hoverMotionSegment");if(e){const{keyStart:n,keyEnd:s}=e;if(!ZS(n)||!ZS(s))return;const i=Gb(n,s);NE(i,Qr.HOVER_SEGMENT_WIDTH,Qr.HOVER_SEGMENT_COLOR);const r=qS(s);NE(r,Qr.LINE_WIDTH,Qr.LINE_COLOR)}else{const n=qS();NE(n,Qr.LINE_WIDTH,Qr.LINE_COLOR)}}function Pb(){return!(!Tn.dataStore.isEditingMode||Tn.dataStore.getFeature("editOrigin")||Tn.dataStore.getFeature("editSelector")||yr.item.locked)}function bb(){const e=Tn.dataStore.selection.get("hoverMotionPoint");for(const[n,s]of Bi){if(n===Cr)continue;const i=s,r=_i.get(n).in,o=_i.get(n).out;let a=e&&e.type==="in"&&e.key===n?Ql:Kl,c=e&&e.type==="out"&&e.key===n?Ql:Kl;if(Ve.get(n).selected){for(const l of Ts)l.key===n&&l.type==="in"?e&&e.key===n&&e.type==="in"?a=Zl:a=ql:l.key===n&&l.type==="out"&&(e&&e.key===n&&e.type==="out"?c=Zl:c=ql);Ra.lineStyle(Qr.LINE_WIDTH,Qr.LINE_COLOR).drawLine(i.x,i.y,i.x+r.x,i.y+r.y).drawLine(i.x,i.y,i.x+o.x,i.y+o.y),Ra.fillStyle(Qr.SVG_COLOR).drawImageFromAtlas(a,i.x+r.x,i.y+r.y,1,1).drawImageFromAtlas(c,i.x+o.x,i.y+o.y,1,1)}}}function Ub(){for(const[e,n]of Bi){let s=yn&&yn.type==="point"&&yn.key===e?GS:bS;if(Ts){for(const i of Ts)if(i.key===e&&i.type==="point"){yn&&yn.key===e&&yn.type==="point"?s=FS:s=US;break}}e===Cr&&(s=kS),Ra.fillStyle(16777215).drawImageFromAtlas(s,n.x,n.y,1,1)}}function ZS(e){return _i.has(e)&&Bi.has(e)}function Gb(e,n){const s=_i.get(e),i=_i.get(n),r=s.in,o=s.out,a=i.in,c=i.out,l=Bi.get(e),h=Bi.get(n),d=[new Fe().initWithPoints(l,r,o),new Fe().initWithPoints(h,a,c)],p=new qe;return p.addChild(Ct.createPath(d,!1)),p}function qS(e=null){const n=new qe;let s=[];for(const[i,r]of Bi){e&&i===e&&s.length>1&&(n.addChild(Ct.createPath(s,!1)),s=[]);const o=_i.get(i),a=o.in,c=o.out;s.push(new Fe().initWithPoints(r,a,c))}return s.length>0&&n.addChild(Ct.createPath(s,!1)),n}function NE(e,n,s){const i=new ye(0,0,Tn.viewport.width,Tn.viewport.height),r=e.getBounds();if(i.containsRect(r)){const a=RI(e,[4,2.5],!1).toPathData();Ra.lineStyle(n,s).drawPath(0,0,a)}else if(i.intersects(r)){const o=d2(e,i);if(o){const c=RI(o,[4,2.5],!1).toPathData();Ra.lineStyle(n,s).drawPath(0,0,c)}}}function Fb(){BS.clear(),Ra.clear(),VS.clear(),Bi.clear(),_i.clear(),Ve.clear(),Lb()}const ed=new ye(0,0,0,0);function kb(e){const n=zS.VERT_HALF_BOX_WIDTH,s=Tn.viewport.toScreen(e);ed.set(s.x-n,s.y-n,2*n,2*n);const i=new Map([...Bi.entries()].sort((o,a)=>Ve.get(a[0]).time-Ve.get(o[0]).time)),r=new Map([..._i.entries()].sort((o,a)=>Ve.get(a[0]).time-Ve.get(o[0]).time));for(const[o,a]of i)if(o!==Cr&&ed.contains(a))return{type:"point",key:o,data:new N().fromArray(Ve.get(o).pos),time:Ve.get(o).time,trackId:Ve.get(o).trackId};for(const[o,a]of r){if(o===Cr)continue;const c=i.get(o).clone().add(a.in);if(ed.contains(c))return{type:"in",key:o,data:new N().fromArray(Ve.get(o).in),time:Ve.get(o).time,trackId:Ve.get(o).trackId};if(c.copy(i.get(o)).add(a.out),ed.contains(c))return{type:"out",key:o,data:new N().fromArray(Ve.get(o).out),time:Ve.get(o).time,trackId:Ve.get(o).trackId}}return null}function td(e,n){for(const s of e)if(s.key===n.key&&s.type===n.type)return!0;return!1}function jS(e){for(const n of e){const s=Ve.get(n.key);if(!s){console.log("The selection data cannot match the motionPathKFs due to not update yet");continue}switch(s.selected=!0,n.type){case"in":{Ve.has(s.prev)&&(Ve.get(s.prev).selected=!0);break}case"out":{Ve.has(s.next)&&(Ve.get(s.next).selected=!0);break}case"point":{Ve.has(s.prev)&&(Ve.get(s.prev).selected=!0),Ve.has(s.next)&&(Ve.get(s.next).selected=!0);break}}}}function Bb(e,n,s,i,r,o,a){if(a!==pe.NONE&&o===pe.NONE)i.copy(e),r.copy(e);else if(a===pe.NONE){if(o===pe.ANGLE||o===pe.INDEPENDENT||o===pe.ANGLE_AND_LENGTH){let c,l;if(n&&s){const h=ic(n,e,s);c=h.e1,l=h.e2,o===pe.ANGLE_AND_LENGTH&&Vb(c,e,l)}else{let h,d;if(n&&!s)h=n,d=e;else if(!n&&s)h=e,d=s;else{console.warn("Invalid motion point");return}const p=new N;if(p.copy(d).sub(h),p.equals(N.ZERO))p.set(-10,0),console.log("vector of the edge is zero when calculate the control point");else{const E=p.length();p.scale(1/E),h.equals(d)&&([p.x,p.y]=[p.y,-p.x]),p.scale(E*.2)}c=new N().copy(e).sub(p),l=new N().copy(e).add(p)}i.copy(c),r.copy(l)}}else if(a===pe.ANGLE&&o===pe.ANGLE_AND_LENGTH){const h=xE(i,e,r,o);i.copy(h[0]),r.copy(h[1])}else if(a===pe.INDEPENDENT&&o===pe.ANGLE_AND_LENGTH){const h=xE(i,e,r,o);i.copy(h[0]),r.copy(h[1])}else if(a===pe.INDEPENDENT&&o===pe.ANGLE){let c=0;if(e.equals(i)){const h=n,d=s,{e1:p}=ic(h,e,d);c=Math.sqrt(Math.pow(p.x-e.x,2)+Math.pow(p.y-e.y,2)),i.copy(p)}else if(e.equals(r)){const h=n,d=s,{e2:p}=ic(h,e,d);c=Math.sqrt(Math.pow(p.x-e.x,2)+Math.pow(p.y-e.y,2)),r.copy(p)}const l=xE(i,e,r,o,c);i.copy(l[0]),r.copy(l[1])}}function Vb(e,n,s){let i=e.x-n.x,r=e.y-n.y,o=s.x-n.x,a=s.y-n.y;const c=Math.sqrt(i*i+r*r),l=Math.sqrt(o*o+a*a);c<l?(i=i/c*l,r=r/c*l,e.x=n.x+i,e.y=n.y+r):(o=o/l*c,a=a/l*c,s.x=n.x+o,s.y=n.y+a)}function xE(e,n,s,i,r=0){const o=new N;o.copy(n).sub(e);const a=new N;a.copy(n).sub(s);let c,l,h;const d=o.length(),p=a.length();d<p?(c=s,l=e,h=i===pe.ANGLE_AND_LENGTH?p:d):(c=e,l=s,h=i===pe.ANGLE_AND_LENGTH?d:p),h<1e-5&&(h=r),o.copy(c).sub(n),o.x=-1*(c.x-n.x),o.y=-1*(c.y-n.y),o.normalize(),o.scale(h);const E=new N;return E.copy(n).add(o),l===e?[E,c]:[c,E]}function Hb(e,{commit:n=!0}={}){const s=yr.item.baseTransform.translate;for(const i of Ts)JS(i,s,e);n&&Me.commitUndo()}function JS(e,n,s){const i=Ve.get(e.key),r=new N().fromArray(i.pos).add(n),o=i.prev?new N().fromArray(Ve.get(i.prev).pos).add(n):null,a=i.next?new N().fromArray(Ve.get(i.next).pos).add(n):null,c=new N().fromArray(i.in),l=new N().fromArray(i.out);Bb(r,o,a,c.add(r),l.add(r),s,i.mirror),Me.editor.setMotionPathProps({mirror:s,x:c.x,y:c.y},{key:e.key,type:"in",time:e.time,trackId:e.trackId},{commit:!1,delta:!1}),Me.editor.setMotionPathProps({mirror:s,x:l.x,y:l.y},{key:e.key,type:"out",time:e.time,trackId:e.trackId},{commit:!1,delta:!1})}function Wb(e){const n=zS.VERT_HALF_BOX_WIDTH,s=[...Bi.entries()];s.sort((c,l)=>{const h=Ve.get(c[0]).time,d=Ve.get(l[0]).time;return h-d});const i=[],r=[];for(const[c,l]of s)r.push(c),i.push(l);let o=1/0,a=null;for(let c=0;c<i.length-1;c++){const l=r[c],h=r[c+1],d=i[c],p=i[c+1],E=_i.get(l),g=_i.get(h),T=d.clone(),A=p.clone();E&&T.add(E.out),g&&A.add(g.in);let m=1/0,O=-1;if(Xb(d,T,A,p)){const S=zb(e,d,p);m=S.distance,O=S.t}else{const S=Yb(d,T,A,p,e);m=S.d,O=S.t}m<o&&(o=m,a={points:[d,p],times:[Ve.get(l).time,Ve.get(h).time],t:O,keyStart:l,keyEnd:h,trackIds:[Ve.get(l).trackId,Ve.get(h).trackId]})}return o>n?null:a}function Yb(e,n,s,i,r){return Nr.points[0].x=e.x,Nr.points[0].y=e.y,Nr.points[1].x=n.x,Nr.points[1].y=n.y,Nr.points[2].x=s.x,Nr.points[2].y=s.y,Nr.points[3].x=i.x,Nr.points[3].y=i.y,Nr.update(),Nr.project(r)}function Xb(e,n,s,i){return $S(e,i,n)&&$S(e,i,s)}function $S(e,n,s){const i=(n.y-e.y)*(s.x-e.x)-(n.x-e.x)*(s.y-e.y);return Math.abs(i)<1e-6}function zb(e,n,s){const i=e.x,r=e.y,o=n.x,a=n.y,c=s.x,l=s.y,h=c-o,d=l-a,p=h*h+d*d;if(p===0)return{distance:Math.hypot(i-o,r-a),t:0};let E=((i-o)*h+(r-a)*d)/p;E=Math.max(0,Math.min(1,E));const g=o+E*h,T=a+E*d;return{distance:Math.hypot(i-g,r-T),t:E}}function Kb(e){ih=e}function Qb(e,n,s,i,r,o=.01){const a=3*(1-e)*(1-e)*e,c=3*(1-e)*e*e,l=a*a+o,h=a*c,d=c*c+o,p=a*n,E=c*n,g=a*s,T=c*s,A=l*d-h*h;if(Math.abs(A)<1e-8)throw new Error("Determinant is zero or near zero; cannot solve the system uniquely.");const m=(p*d-h*E)/A,O=(l*E-h*p)/A,S=(g*d-h*T)/A,y=(l*T-h*g)/A;return{deltaP1:new N(m,S),deltaP2:new N(O,y)}}const rh=8,Zr=1863400,js=16777215,vE=64,Zb=12,As={nameMaxLength:180,tagPadding:6,tagHeight:20,tagCornerRadius:6,tagBorderWidth:1,tagBorderOpacity:.1,tagBorderColor:0,tagOffset:new N(10,16),selectionWidth:2};let nd=!0,sd=!0,RE=!1;const Js=new Ce,id=new Ce,Ti=new N,wE=new N,Go=qe.create(),rd=new Bs;let q;const ce={highlightBbox:null,presenceCursor:null,presenceSelection:null,selection:null,handles:null,gradientHandles:null,gradientHandlesCover:null,text:null,selectionArea:null,snapping:null,snappingSpacing:null,guidelines:null,debug:null};let DE=!1,LE=!1;const qb=new Set;function jb(e){rU(),q=e;let n=0;QP(q,n++),qP(q,n++),ce.presenceSelection=q.overlay.createPane(n++),ce.highlightBbox=q.overlay.createPane(n++),ce.snappingSpacing=q.overlay.createPane(n++),ce.selection=q.overlay.createPane(n++),ce.handles=q.overlay.createPane(n++),ce.gradientHandles=q.overlay.createPane(n++),ce.gradientHandlesCover=q.overlay.createPane(n++),ce.text=q.overlay.createPane(n++),Eb(q,n++,n++,n++,n++),vb(q,n++,n++,n++),ce.selectionArea=q.overlay.createPane(n++),ce.snapping=q.overlay.createPane(n++),ce.guidelines=q.overlay.createPane(n++),ce.presenceCursor=q.overlay.createPane(n++),ce.debug=q.overlay.createPane(n++),ob(q,n++),JP(q,n++),ce.editOrigin=q.overlay.createPane(n++),EU(),q.dataStore.eam.on(Y.TOGGLE_INTERFACE,()=>{LE=!LE}),q.dataStore.eam.on(Y.TOGGLE_RULER,()=>{DE=!DE})}function Jb(){nd=!0,uE(),q.dataStore.isEditingMode&&uE()}function $b(){sd=!0,CS()}function eU(){nd=!1,jP()}function tU(){sd=!1,ZP()}function nU(){return sd}function sU(){return nd}function iU(){RE=!0}function rU(){window.__Panes__||(window.__Panes__={setUIScreenNameEnabled:Jb,setUIGridEnabled:$b,setUIScreenNameDisabled:eU,setUIGridDisabled:tU,getUIGridEnabled:nU,getUIScreenNameEnabled:sU,setOriginEnable:iU})}function oU(){eP(),qb.clear(),sd&&CS(),nd&&q.dataStore.isEditingMode&&!q.dataStore.isTableView&&uE(),PU(),lU(),q.dataStore.get("activeTool")!==et.COMMENT&&(_U(),aU(),q.dataStore.selection.get("textRange")===null&&(ce.handles.clear().lineStyle(1.5,Zr).fillStyle(16777215),hU()&&(uU(),dU()))),pU(),cU(),gU(),Ib(),q.dataStore.getFeature("editSelector")||Fb(),xU(),DU(),lb(),DE||LE||!q.dataStore.isEditingMode&&!q.dataStore.isInspectingMode||q.dataStore.isPrototypeMode?sb():(nb(),ce.guidelines.clear(),NS(q,ce.guidelines)),RE=q.dataStore.getFeature("editOrigin")}function aU(){if(ce.selection.clear().lineStyle(1.5,Zr),od)return;const e=q.dataStore.get("editMode"),n=q.dataStore.get("activeTool"),s=q.dataStore.getFeature("editGradient");if(!(e===wn.SHAPE||s)){if(q.selection.containsMultiple)if(n===et.SCALE){for(const{element:i,node:r}of q.selection.iter())i.isLineElement()||bE(ce.selection,i,r);for(const{element:i,node:r}of q.selection.iter())lh(ce.selection,i,r)}else{const i=q.selection.bounds.clone(),{width:r,height:o}=i,a=Lo(r),c=Lo(o);if(a==="f0"&&(i.width=0,i.x+=r*.5),c==="f0"&&(i.height=0,i.y+=o*.5),wa(ce.selection,i),a==="!0"&&c==="!0")for(const{element:l,node:h}of q.selection.iter())lh(ce.selection,l,h)}else if(q.selection.single){const{element:i,node:r}=q.selection.single;lh(ce.selection,i,r),!od&&!i.isLineElement()&&bE(ce.selection,i,r)}}}function cU(){if(q.snapping.updateThreshold(q.viewport.scale),ce.snapping.clear().lineStyle(1,16711680),!q.snapping.isSnappingUIDataDirty())return;const e=Js.reset().prepend(q.viewport.projectionTransform);if(ce.snapping.appendTransform(e),q.snapping.axisDiagonalCount>0){const c=(q.viewport.width+q.viewport.height)*2,l=new N,h=new N;for(let d=0;d<q.snapping.axisDiagonalCount;d++)l.copy(q.snapping.axisDiagonalVec[d]).scale(c).add(q.snapping.startOrigin),h.copy(q.snapping.axisDiagonalVec[d]).scale(c).negate().add(q.snapping.startOrigin),ce.snapping.drawLine(l.x,l.y,h.x,h.y)}const n=q.snapping.snapToElementXUI,s=q.snapping.snapToElementYUI,r=3/e.get_scale().x;let o=16777215,a=-16777215;if(n.size>0)for(const[c,l]of n.entries()){o=16777215,a=-16777215;for(const[h]of l.entries())o=o>h?h:o,a=a>h?a:h,ce.snapping.drawLine(c-r,h-r,c+r,h+r),ce.snapping.drawLine(c+r,h-r,c-r,h+r);ce.snapping.drawLine(c,o,c,a)}if(s.size>0)for(const[c,l]of s.entries()){o=16777215,a=-16777215;for(const[h]of l.entries())o=o>h?h:o,a=a>h?a:h,ce.snapping.drawLine(h-r,c-r,h+r,c+r),ce.snapping.drawLine(h+r,c-r,h-r,c+r);ce.snapping.drawLine(o,c,a,c)}ce.snapping.resetTransform()}function lU(){if(!q.snapping.isSnappingUIDataDirty())return;const e=Js.reset().prepend(q.viewport.projectionTransform);ce.snappingSpacing.clear(),ce.snappingSpacing.appendTransform(e);const n=q.snapping.spacingAreaUIMap,s=q.snapping.spacingVerticalVec,i=q.snapping.spacingHorizontalVec,r=q.snapping.spacingVertical,o=q.snapping.spacingHorizontal;ce.snappingSpacing.fillStyle(16711680,.2);for(const h of n.values())ce.snappingSpacing.drawSolidRect(h.x,h.y,h.width,h.height);if(ce.snappingSpacing.resetTransform(),!o&&!r)return;const a=3*q.viewport.pixelRatio/q.viewport.scale,c=new N,l=new N;ce.snappingSpacing.lineStyle(1,14437212),o&&(c.set(i.x,i.y),l.set(i.x+o,i.y),q.viewport.projectionTransform.xform(c,c),q.viewport.projectionTransform.xform(l,l),ce.snappingSpacing.drawLine(c.x,c.y,l.x,l.y),c.set(i.x,i.y-a),l.set(i.x,i.y+a),q.viewport.projectionTransform.xform(c,c),q.viewport.projectionTransform.xform(l,l),ce.snappingSpacing.drawLine(c.x,c.y,l.x,l.y),c.set(i.x+o,i.y-a),l.set(i.x+o,i.y+a),q.viewport.projectionTransform.xform(c,c),q.viewport.projectionTransform.xform(l,l),ce.snappingSpacing.drawLine(c.x,c.y,l.x,l.y),c.set(i.x+o*.5,i.y),q.viewport.projectionTransform.xform(c,c),e1(c.x,c.y,o,!0)),r&&(c.set(s.x,s.y),l.set(s.x,s.y+r),q.viewport.projectionTransform.xform(c,c),q.viewport.projectionTransform.xform(l,l),ce.snappingSpacing.drawLine(c.x,c.y,l.x,l.y),c.set(s.x-a,s.y),l.set(s.x+a,s.y),q.viewport.projectionTransform.xform(c,c),q.viewport.projectionTransform.xform(l,l),ce.snappingSpacing.drawLine(c.x,c.y,l.x,l.y),c.set(s.x-a,s.y+r),l.set(s.x+a,s.y+r),q.viewport.projectionTransform.xform(c,c),q.viewport.projectionTransform.xform(l,l),ce.snappingSpacing.drawLine(c.x,c.y,l.x,l.y),c.set(s.x,s.y+r*.5),q.viewport.projectionTransform.xform(c,c),e1(c.x,c.y,r,!1))}function e1(e,n,s,i){const r=s.toString(),o=9,a=4,c=4.5,l=2,h=new N().fromArray(ce.snappingSpacing.measureTextImage(r,o,"left","top"));if(i){const d=e-h.x*.5-l,p=n+c,E=h.x+l*2,g=h.y+l*2;ce.snappingSpacing.fillStyle(14437212,1).drawSolidRectTexture(d,p,E,g,a);const T=d+l,A=p+(g-h.y)*.5;ce.snappingSpacing.fillStyle(js,1).drawTextImage(T,A,r,{fontSize:o,h_align:"left",v_align:"top"})}else{const d=e-h.x-c-l*2,p=n-h.y*.5-l,E=h.x+l*2,g=h.y+l*2;ce.snappingSpacing.fillStyle(14437212,1).drawSolidRectTexture(d,p,E,g,a);const T=d+l,A=p+(g-h.y)*.5;ce.snappingSpacing.fillStyle(js,1).drawTextImage(T,A,r,{fontSize:o,h_align:"left",v_align:"top"})}}const oh=(e,n,s=0)=>{const i=e.xform(n);id.reset().rotate(s).translate(i.x,i.y),ce.handles.appendTransform(id),ce.handles.drawSolidRect(-8*.5,-8*.5,rh,rh).drawRect(-8*.5,-8*.5,rh,rh),ce.handles.resetTransform()},t1=(e,n,s,i)=>{if(i&&i.item.isEmpty){const a=e.xform(n.center);id.reset().translate(a.x,a.y),ce.handles.appendTransform(id),ce.handles.drawEllipseShadow(0,0,2,2),ce.handles.resetTransform();return}const r=s&&!s.get("locked"),o=q.selection.all(a=>a.element.isLocked());if((r||!s)&&!o){const a=i?i.item.transform.saveWorld.get_rotation():0;s&&s.isLineElement()?fU(s,e,oh,n,a):(oh(e,Ti.set(n.left,n.top),a),oh(e,Ti.set(n.left,n.bottom),a),oh(e,Ti.set(n.right,n.top),a),oh(e,Ti.set(n.right,n.bottom),a))}};function hU(){return!(od||!q.dataStore.selection.get("elements").length||q.dataStore.getFeature("editGradient")||q.dataStore.get("editMode")!==wn.ELEMENT&&q.dataStore.get("editMode")!==wn.MOTION_PATH||q.dataStore.getFeature("editSelector"))}function uU(){if(!q.dataStore.get("hideOrigin"))for(const{element:e,node:n}of q.selection.iter()){const s=e.isLocked(),i=e.get("elementType")===Le.SCREEN,r=e.get("id")===GE;if(!i)if(RE&&!s){const o=r?_S:gS;n1(ce.handles,n,o,1,1)}else n1(ce.handles,n,TS,.5,1)}}function dU(){if(!q.dataStore.isEditingMode)return;let e;if(q.dataStore.get("activeTool")===et.SCALE)for(const n of q.selection.iter()){if(e=n.node.boundsLocal_zero,wc(e,n.node.item.transform.world))continue;Js.copy(n.node.item.transform.world);const i=Js.prepend(q.viewport.projectionTransform);t1(i,e,n.element,n.node)}else{const n=q.selection.single;if(n===null){Js.reset(),e=q.selection.bounds.clone();const{width:i,height:r}=q.selection.bounds,o=Lo(i),a=Lo(r);o==="f0"&&(e.width=0,e.x+=i*.5),a==="f0"&&(e.height=0,e.y+=r*.5)}else Js.copy(n.node.item.transform.world),e=n.node.boundsLocal_zero.clone();if(!wc(e,Js)){const i=Js.prepend(q.viewport.projectionTransform);t1(i,e,n==null?void 0:n.element,n==null?void 0:n.node)}}}function fU(e,n,s,i,r=0){const o=e.get("geometry").get("mesh"),a=o.edges.values().next().value,c=o.getVertPos(a.v.id),l=o.getVertPos(a.w.id),h=Math.sign(l.x-c.x),d=Math.sign(l.y-c.y);h*d>0?(s(n,Ti.set(i.left,i.top),r),s(n,Ti.set(i.right,i.bottom),r)):(s(n,Ti.set(i.right,i.top),r),s(n,Ti.set(i.left,i.bottom),r))}const ah=new N,ch=new N,ME=new Ce;function wc(e,n){const s=rh/q.viewport.projectionTransform.a;ah.set(e.width,0),ch.set(0,e.height),ME.copy(n).rotate(-n.get_rotation()),ME.basis_xform(ah,ah),ME.basis_xform(ch,ch);const i=Math.abs(ah.x)<Xt&&Math.abs(ch.y)<Xt,r=Math.abs(ah.x)<=s+1e-6&&Math.abs(ch.y)<=s+1e-6;return!i&&r}function n1(e,n,s,i,r){e.fillStyle(16777215,r);const o=n.item.transform.worldPivot;q.viewport.projectionTransform.xform(o,o),e.drawImageFromAtlas(s,o.x,o.y,i,i)}let sn=null;function s1(e){sn=e}function pU(){if(ce.gradientHandles.clear(),ce.gradientHandlesCover.clear(),!sn)return;const e=sn.getGradientTransform();if(!e)return;const n=q.selection.first,s=q.dataStore.getFeature("editGradient");if(n===null||!s||!sn||!q.selection.single)return;const i=new N;let r,o;if(n.element.get("elementType")===Le.PATH&&n.element.get("geometryType")===gn.LINE){const{x:y,y:v,width:R,height:M}=n.node.boundsVisualLocal;o=new N(R,M),r=new N(-y,-v)}else{const{width:y,height:v}=n.node.boundsLocal;o=new N(y,v),r=eE(n)}const c=Js.set(...e).affine_inverse().scale(o.x,o.y).translate(-r.x,-r.y).prepend(n.node.item.transform.world).prepend(q.viewport.projectionTransform);ce.gradientHandles.appendTransform(c);const l=ce.gradientHandles.transform.xform(sn.bottom),h=q.viewport.toWorld(l),d=ce.gradientHandles.transform.xform(sn.center),p=q.viewport.toWorld(d),E=ce.gradientHandles.transform.xform(sn.left),g=q.viewport.toWorld(E);i.x=g.distance_to(p)/(.5*o.x),i.y=h.distance_to(p)/(.5*o.y);const T=ce.gradientHandles.transform.clone(),A=Js.reset().affine_inverse().prepend(q.viewport.projectionTransform);if(ce.gradientHandles.transform.copy(A),ce.gradientHandlesCover.transform.copy(A),sn.isLinear&&(i.y*=.5,i.x=i.y),sn.isAngular){ce.gradientHandles.transform.copy(T);const y=new Ce().set(...sn.getGradientTransform()).decompose(),v=y.scale.sign(),R=n.node.item.transform.world.get_rotation()-(y.rotation+Math.PI*.5);ce.gradientHandles.lineStyle(sn.referenceSize,js).drawEllipseShadow(sn.center.x,sn.center.y,v.x,v.y,R).lineStyle(sn.referenceSize,js),ce.gradientHandles.transform.copy(A)}else ce.gradientHandles.lineStyle(sn.referenceSize*2,js).drawLineShadow(p.x,p.y,h.x,h.y).lineStyle(sn.referenceSize,js).drawLine(p.x,p.y,h.x,h.y).lineStyle(sn.referenceSize,js);sn.isLinear||PE(g),PE(h),PE(p);const m=sn.getGradientStops(),O=sn.activeGradientStopIdx;ce.gradientHandles.lineStyle(sn.stopOutlineSize,js);const S=new N;for(let y=m.length-1;y>=0;y--)y!==O&&i1(m[y],S,sn.stopSize,T);ce.gradientHandles.lineStyle(sn.activeStopOutlineSize,js),m[O]&&i1(m[O],S,sn.activeStopSize,T),ce.gradientHandles.resetTransform(),ce.gradientHandlesCover.resetTransform()}function EU(){Mt(TS),Mt(gS),Mt(_S),Mt(KP),Mt(AS),Mt(mS),Mt(OS),Mt(IS),Mt(SS),Mt(yS)}const PE=e=>{const s=1/q.viewport.scale*sn.handleSize/vE;ce.gradientHandles.fillStyle(js).drawImageFromAtlas(IS,e.x,e.y,s,s)};function i1(e,n,s,i){sn.getColorStopPos(e.position,n);const r=i.xform(n),o=q.viewport.toWorld(r),a=1/q.viewport.scale,c=a*s/vE,l=a*s/Zb,h=a*s/vE;ce.gradientHandles.fillStyle(js).drawImageFromAtlas(mS,o.x,o.y,h,h).drawImageFromAtlas(AS,o.x,o.y,l,l).fillStyle(mp(e.color),e.color.a).drawImageFromAtlas(OS,o.x,o.y,c,c),ce.gradientHandles.lineStyle(sn.referenceSize,js).drawEllipseShadow(o.x,o.y,a*s,a*s,!0,!0)}function gU(){if(ce.text.clear(),document.activeElement.id!=="input")return;const e=q.dataStore.selection.get("textRange");e&&(e.start===e.end?yU(ce.text):SU(ce.text)),ce.text.resetTransform()}function _U(){ce.highlightBbox.clear(),q.view instanceof cE&&(TU(),AU()),mU(),OU()}function TU(){const e=q.view;for(const n of e.cells)for(const s of n)ce.highlightBbox.lineStyle(1,65535),wa(ce.highlightBbox,s.worldBounds),ce.highlightBbox.fillStyle(16777215,.1),ce.highlightBbox.transform.copy(q.viewport.projectionTransform),ce.highlightBbox.drawSolidRect(s.worldBounds.x,s.worldBounds.y,s.worldBounds.w,e.padding),ce.highlightBbox.drawSolidRect(s.worldBounds.x,s.worldBounds.y+s.worldBounds.h-e.padding,s.worldBounds.w,e.padding),ce.highlightBbox.drawSolidRect(s.worldBounds.x,s.worldBounds.y+e.padding,e.padding,s.worldBounds.h-2*e.padding),ce.highlightBbox.drawSolidRect(s.worldBounds.x+s.worldBounds.w-e.padding,s.worldBounds.y+e.padding,e.padding,s.worldBounds.h-2*e.padding),ce.highlightBbox.fillStyle(16777215,1).drawTextImage(s.worldBounds.x+15,s.worldBounds.y+15,s.actionName||"Design",{font:"Inter",fontSize:12,h_align:"left",v_align:"top"}),ce.highlightBbox.resetTransform()}function AU(){ce.highlightBbox.lineStyle(2,16711680);const n=q.view.activeCell;if(!n)return;const{x:s,y:i,width:r,height:o}=n.worldBounds,a=10,c=new ye(s+a,i+a,r-2*a,o-2*a);wa(ce.highlightBbox,c)}function mU(){ce.highlightBbox.lineStyle(2,Zr);const e=q.dataStore.selection;let n=e.get("hover");if((!n||e.isSelected(n))&&(n=e.get("elements").find(i=>i.get("id")===GE),ce.highlightBbox.lineStyle(3,Zr)),!n)return;const s=q.indexer.getNode(n.get("id"));Ue(s)||lh(ce.highlightBbox,n,s)}function OU(){ce.highlightBbox.lineStyle(2,Zr);const n=q.dataStore.selection.get("dragOver");if(!n)return;const s=q.indexer.getNode(n.get("id"));Ue(s)||lh(ce.highlightBbox,n,s)}function lh(e,n,s=q.indexer.getNode(n.get("id"))){var r;if(Ue(s))return;const i=n.get("elementType");if(n.isLineElement())r1(e,n,s);else if(s.item.type==="text"&&(((r=q.selection.single)==null?void 0:r.element)!==n||q.dataStore.selection.get("textRange")===null))IU(e,s);else if(s.item.sizeFlag.w==="f0"){const o=s.boundsLocal_zero.clone();o.width=0,wa(e,o,s.item.transform.world)}else if(s.item.sizeFlag.h==="f0"){const o=s.boundsLocal_zero.clone();o.height=0,wa(e,o,s.item.transform.world)}else i===Le.PATH||n.isContainer&&n.isComputedGroup?r1(e,n,s):wa(e,s.boundsLocal_zero,s.item.transform.world)}function r1(e,n,s){const i=Js.copy(s.item.transform.world).prepend(q.viewport.projectionTransform);let r=null;if(s.item.isBooleanGroup()||s.item.isMaskGroup()){const o=s.item;r=(o.base.modVector||o.base.vector).path}else if(n.get("geometryType")===gn.POLYGON||n.get("geometryType")===gn.LINE){const o=n.get("geometry").get("mesh");r=zh(o)}else{const o=s.item;r=o.base.mods[1]&&o.base.mods[1][2].toPathData()||o.base.vector.path}if(r){rd.commands=r.commands,rd.vertices=[];for(let o=0;o<r.vertices.length/2;o++)i.xform(Ti.set(r.vertices[o*2],r.vertices[o*2+1]),wE),rd.vertices.push(wE.x,wE.y);e.drawPath(0,0,rd)}}function bE(e,n,s){let i=s;if(!s&&n&&(i=q.indexer.getNode(n.get("id"))),s){const r=i.boundsLocal_zero.clone();wa(e,r,i.item.transform.world)}}function IU(e,n){const i=q.view.getOrCreateDinoTree(n.id).text_node_id;if(!i)return;const r=UI(i);if(r===0)return;const o=Q2(i),a=Js.copy(n.item.transform.world).prepend(q.viewport.projectionTransform);let c=0;for(let l=0;l<r;l++){const h=a.xform(new N(o[c++],o[c++])),d=a.xform(new N(o[c++],o[c++]));e.drawLine(h.x,h.y,d.x,d.y)}}function SU(e){const n=q.selection.single.node;if(!n)return;const s=q.dataStore.getById(n.id).get("size").width;e.clear().lineStyle(2,Zr).fillStyle(Zr,.4);const r=q.view.getOrCreateDinoTree(n.id).text_node_id;if(!r||UI(r)===0)return;const a=Z2(r),c=Math.floor(a[0]);if(c===0)return;e.transform.copy(n.item.transform.world).prepend(q.viewport.projectionTransform);let l=1;for(let h=0;h<c;h++){const d=new ye(a[l++],a[l++],a[l++],a[l++]);e.drawSolidRect(d.x,d.y,s<d.width?s:d.width,d.height)}e.transform.reset()}function yU(e){const n=q2();if(!n||!q.dataStore.selection.get("textRange"))return;const s=q.indexer.getNode(q.view.getParent(n));if(!s)return;const i=s.item.fillLayers.length===1&&s.item.fillLayers[0].paint.type===0?mp(s.item.fillLayers[0].paint.params.fill_color):0;e.clear().lineStyle(1.75,i).fillStyle(i,1);const r=j2();e.transform.copy(s.item.transform.world).prepend(q.viewport.projectionTransform),e.drawLine(r[0],r[1],r[2],r[3]),e.transform.reset()}function wa(e,n,s=Ce.IDENTITY){const i=Js.copy(s).prepend(q.viewport.projectionTransform),r=i.xform(Ti.set(n.x,n.y)),o=i.xform(Ti.set(n.x+n.width,n.y)),a=i.xform(Ti.set(n.x,n.y+n.height)),c=i.xform(Ti.set(n.x+n.width,n.y+n.height));qe.destroy(Go),Go.moveTo(r.x,r.y),Go.lineTo(o.x,o.y),Go.lineTo(c.x,c.y),Go.lineTo(a.x,a.y),Go.lineTo(r.x,r.y),Go.close(),e.drawPath(0,0,Go.toPathData())}let cr,UE;function CU(e,n=!0){cr=e,UE=n}function NU(){cr=null,UE=null}function xU(){if(ce.selectionArea.clear().lineStyle(1,Zr).fillStyle(Zr,.25),cr){const e=Js.reset().prepend(q.viewport.projectionTransform);ce.selectionArea.appendTransform(e),UE?ce.selectionArea.drawSolidRect(cr.x,cr.y,cr.width,cr.height):ce.selectionArea.drawRect(cr.x,cr.y,cr.width,cr.height),ce.selectionArea.resetTransform()}}let GE=null,od=!1;function vU(e){GE=e}function FE(e){od=e}const Da=new Map,RU=60;function wU(){const e=window.PresenceManager.tabId,n=window.PresenceManager.getUsers().filter(i=>i.tabId!==e),s=new Date().getTime();for(const i of n)if(!Da.has(i.tabId)&&i.cursor){const r=q.viewport.toScreen(new N().copy(i.cursor));Da.set(i.tabId,{pos:r,prev:new N().copy(i.cursor),curr:new N().copy(i.cursor),timer:s,ratio:0,done:!0})}else if(Da.has(i.tabId)&&!i.cursor)Da.delete(i.tabId);else if(Da.has(i.tabId)&&i.cursor){const r=Da.get(i.tabId),o=q.viewport.toScreen(r.curr),a=q.viewport.toScreen(r.prev);if(r.prev.equals(r.curr))r.pos=q.viewport.toScreen(r.curr);else if(!r.done){const c=s-r.timer;r.timer=s,r.ratio+=c/RU,r.done=r.ratio>=1;const l=Math.min(Math.max(r.ratio,0),1);r.pos.x=(1-l)*a.x+l*o.x,r.pos.y=(1-l)*a.y+l*o.y;continue}r.pos=o,r.prev=r.curr,r.timer=s,r.curr=new N().copy(i.cursor),r.ratio=0,r.done=!1}}function DU(){wU();const e=window.PresenceManager.isPresenceShow,n=q.dataStore.isVersionPreviewMode,s=q.dataStore.isPrototypeMode;if(n||!n&&!e||s)return;const i=window.PresenceManager.tabId,o=window.PresenceManager.getUsers().filter(a=>a.tabId!==i);o.length!==0&&(LU(i)||o.forEach(a=>MU(a)))}function LU(e){return window.PresenceManager.users.has(e)&&q.dataStore.get("mode")===Dn.ACTION}function MU({user:e,cursor:n,mode:s,tabId:i,color:r,idleTime:o,isVersionPreviewMode:a}){if(!e||!n||s===Dn.ACTION||o||a)return;const c=Da.get(i).pos,l=(parseInt(r.substring(1),16)<<8)/256;ce.presenceCursor.transform.clone(ce.selection.transform),bU(c,l),UU(c,e.username,l)}function PU(){const e=q.dataStore.isVersionPreviewMode,n=window.PresenceManager.isPresenceShow;if(e||!e&&!n)return;const s=window.PresenceManager.tabId,r=window.PresenceManager.getUsers().filter(o=>o.tabId!==s);if(r.length!==0)for(let o=0;o<r.length;++o){const a=r[o];if(a.idleTime)continue;const c=(parseInt(a.color.substr(1),16)<<8)/256;if(ce.presenceSelection.lineStyle(q.viewport.pixelRatio===1?As.selectionWidth+1:As.selectionWidth,c),a.selections)for(let l=0;l<a.selections.length;l++){const h=q.dataStore.getById(a.selections[l]),d=q.indexer.getNode(a.selections[l]);d&&bE(ce.presenceSelection,h,d)}}}const bU=(e,n)=>{ce.presenceCursor.fillStyle(js).drawImageFromAtlas(yS,e.x,e.y,1,1),ce.presenceCursor.fillStyle(n).drawImageFromAtlas(SS,e.x,e.y,1,1)},UU=(e,n,s)=>{const r=e.clone().add(As.tagOffset),o=new N().fromArray(ce.presenceCursor.measureTextImage(n,12,"left","top")),a=GU(n,o.x*q.viewport.pixelRatio,12),c=new N().fromArray(ce.presenceCursor.measureTextImage(a,12,"left","top")),l=r.clone().add(As.tagPadding,(As.tagHeight-c.y)*.5);ce.presenceCursor.fillStyle(s).drawSolidRectTexture(r.x,r.y,c.x+As.tagPadding*2,As.tagHeight,As.tagCornerRadius).lineStyle(As.tagBorderWidth,As.tagBorderColor,As.tagBorderOpacity).drawRectTexture(r.x,r.y,c.x+As.tagPadding*2,As.tagHeight,As.tagBorderWidth,As.tagCornerRadius);const h={fontSize:12,h_align:"left",v_align:"top"};ce.presenceCursor.fillStyle(js).drawTextImage(l.x,l.y,a,h)},GU=(e,n,s)=>{let i=e;if(n>As.nameMaxLength){i="...";const r=new N().fromArray(ce.presenceCursor.measureTextImage("...",s,"left","top"));i="";for(let o=0;o<e.length;o++)if(i+=e[o],new N().fromArray(ce.presenceCursor.measureTextImage(i,s,"left","top")).x>As.nameMaxLength-r.x){i+="...";break}}return i};function o1(e,n=new N){const{skew:s,scale:i,rotation:r,translation:o}=e.decompose(),a=new Ce().translate_right(n.x,n.y).rotate_right(r).skew_right(wt(s.x),wt(s.y)).scale_right(i.x,i.y).translate_right(-n.x,-n.y);return o.sub(a.get_origin()),{position:o,scale:i,skew:s,rotation:r}}function a1(e,n){const s=n.sub(e);let i=0,r;return o=>{const a=o.sub(e),c=Math.trunc(s.angle_to(a)*$x)*ev,l=Math.abs(c)<tv;if(r!==void 0&&!(i===0&&l)){const p=Math.sign(r),E=Math.sign(c);let g=0;p===-1&&E===1?g=-1:p===1&&E===-1&&(g=1),l&&(g*=-1),i+=g}c!==0&&(r=c);const d=Math.PI*Math.sign(i)*Math.abs(i%2);return{delta:c+d+i*Math.PI,direction:a}}}const c1=new N,kE=new N,BE=new N,VE=new N,Cn={},FU={isMultipleOf90:!0,isMultipleOf180:!0};function kU(e,n,s,i,r){const o=[],a=new N(1,1);Cn.size=new N(Math.max(Es,s.width),Math.max(Es,s.height)),Cn.position=new N(s.x,s.y),Cn.center=Cn.size.clone().scale(.5).add(s.x,s.y),Cn.origin=new N(.5,.5),Cn.transform=new Ce(1,0,0,1,s.x,s.y);for(const{element:h,node:d}of n){const p={referencePoint:new N(...h.get("referencePoint")),contentAnchor:new N(...h.get("contentAnchor")),scale:new N(...h.get("scale")),size:new N(...h.get("size")),skew:new N(...h.get("skew")),translate:new N(...h.get("translate")),rotation:h.get("rotation"),parentWorld:d.item.transform._parent.clone(),parentWorldInv:d.item.transform._parent.clone().affine_inverse(),element:h,node:d,sizeFlag:{...d.item.sizeFlag},scaleFlag:{...d.item.scaleFlag}};o.push(p)}const c=Cn.size.x/Cn.size.y;return c1.copy(Cn.size),kE.copy(r),VE.copy(r),BE.copy(r).sub(Cn.position),(h,d,p,E,g=!0,T=!0)=>{const A=E&&p?E.clone().sub(e.anchor):E,m=E?A:e.anchor,O=(m.x===0||m.x===1)&&m.y===.5,S=new N(1-m.x,1-m.y),y=h.clone();a.x=Math.sign(S.x-.5),a.y=Math.sign(S.y-.5);const v=y.clone();i.updateSnapMovingData(!1),i.vs.selection.updateBounds(),i.setResizeSelectedElementOAB(m);const R=S.clone().multiply(c1),M=Cn.position.clone().add(R);VE.copy(M);const L=S.clone().sub(m);L.set(Math.abs(L.x),Math.abs(L.y)),L.multiply(BE.x-R.x,BE.y-R.y);const P=m.x===.5||m.y===.5;if(g){const se=i.snapResizeElementToPixelGrid(v,kE,M,P,!0);v.copy(se),se.sub(L.x,L.y)}if(T){const se=i.comparingVerticesWithResize(v,kE,M,m,g,FU,Pc.ResizeTypes.RESIZE_ELEMENTS,d);v.copy(se),v.sub(L.x,L.y),y.copy(v)}const k=Es,Q=y.clone().sub(VE),b=p?2:1,X=S.clone().sub(m).multiply(Q).multiply(b,b),K=X.clone().add(Cn.size);K.x<Xt&&(K.x=k),K.y<Xt&&(K.y=k),d&&c!==0&&!Number.isNaN(c)&&(m.y===.5||m.x!==.5&&X.x>=X.y?K.y=K.x/c:K.x=K.y*c);const V=VU(m,K);if(p){const se=S.clone().sub(m).divide(2,2),ue=K.clone().sub(Cn.size).multiply(se);V.sub(ue)}const J=K.clone().divide(Cn.size),ge=o[0].element.dataStore;ge.beginChangeGroup();for(const se of o){const ue=se.element;ue.isLocked()||l(J,se,d,K,V,ue,O)}ge.endChangeGroup()};function l(h,d,p,E,g,T,A){const m=new Ce().scale_right(h.x,h.y).rotate_right(d.rotation).skew_right(d.skew.x,d.skew.y),{rotation:O,scale:S,skew:y}=m.decompose(),v=new N().copy(d.size).multiply(S),R=d.contentAnchor.clone().multiply(S),M=d.referencePoint.clone().multiply(S),L=d.translate.clone();p||(d.sizeFlag.w==="f0"&&(L.x+=d.size.x*.5),d.sizeFlag.h==="f0"&&(L.y+=d.size.y*.5));const P=d.parentWorld.xform(L),k=Cn.size.clone().scale(.5).add(Cn.position),b=P.sub(k).divide(Cn.size).add(Cn.origin).multiply(E).add(g);d.parentWorldInv.xform(b,b),p||(v.x>0&&v.x<Xt&&(b.x-=v.x*.5),v.y>0&&v.y<Xt&&(b.y-=v.y*.5));const X=d.scaleFlag.x==="0"||p&&d.sizeFlag.w==="f0",K=d.scaleFlag.y==="0"||p&&d.sizeFlag.h==="f0";X&&(v.x=d.size.x,R.x=d.contentAnchor.x,M.x=d.contentAnchor.x),K&&(v.y=d.size.y,R.y=d.contentAnchor.y,M.y=d.contentAnchor.y),T.isText&&(d.node.item.resizingMode===eo[kt.AUTO_WIDTH]&&Math.abs(d.size.x-v.x)>.01&&d.element.set("resizingMode",kt.AUTO_HEIGHT),Math.abs(d.size.y-v.y)>.01&&d.element.set("resizingMode",kt.FIXED)),A?T.sets({width:v.x,contentAnchorX:R.x,referencePointX:M.x,skew:new N().copy(y),rotation:O,translateX:b.x}):T.sets({size:new N().copy(v),contentAnchorX:R.x,contentAnchorY:R.y,referencePointX:M.x,referencePointY:M.y,skew:new N().copy(y),rotation:O,translateX:b.x,translateY:b.y})}}function BU(e,n,s,i){const r=[];for(const{element:a}of e){const c=a.get("rotation");r.push({rotation:c,element:a})}const o=a1(n,s);return(a,{shift:c})=>{const{delta:l}=o(a),h=r[0].element.dataStore;h.beginChangeGroup();for(const{rotation:d,element:p}of r){if(p.isLocked()||p.get("elementType")===Le.SCREEN)continue;let E=d+l;if(c){const g=E%ns[15];E-=g>=ns[15]*.5?g-ns[15]:g}p.set("rotation",E,{updateType:Gs.USER_EDITING})}i("rotate"),h.endChangeGroup()}}function VU(e,n){const s=e.clone().multiply(Cn.size),i=Cn.transform.xform(s),r=Cn.origin.clone().sub(e).multiply(n),o=Cn.transform.basis_xform(r),a=i.clone().add(o);return n.clone().multiply(Cn.origin).clone().negate().add(a)}const dn=new N,HE=new N,WE=new N,La=new N,Ma=new N,l1=new N,h1=new N;let u1=0;const ad=new Ce,cd=new Ce,ld=new Ce,YE=new N,HU=new N,hh=new N;let XE=null,qr=null,jr=null;const uh={isMultipleOf90:!1,isMultipleOf180:!1},cs={w:"!0",h:"!0"},Fo={x:"!0",y:"!0"};let ms=null,Os=null,d1=null,hd=!1,ud=!1;function WU(e,n,s,i,r,o,a){if(XE=e,jr=i,ms=n,Os=s,hd=o,ud=a,qr=new N(1,1),dn.set(...ms.get("size")),Ma.set(...ms.get("contentAnchor")),La.set(...ms.get("referencePoint")),ms.isComputedGroup?YU(Os,HE,ad,cd):(HE.copy(Os.item.transform.getPivotOffset()),ad.copy(Os.item.transform.local),cd.copy(Os.item.transform.world)),WE.copy(HE).divide(dn),zE(WE,Es*.5,Es*.5),l1.set(...ms.get("scale")),h1.set(...ms.get("skew")),u1=ms.get("rotation"),d1=dn.x/dn.y,Os.item.transform.local.basis_determinant()===0){const{translate:c,scale:l,skew:h,rotation:d}=Os.item.transform,p=Os.item.transform.getPivotOffset();ld.reset().append(Os.parent.item.transform.world.clone().affine_inverse()).translate_right(p.x,p.y).scale_right(l.x===0?0:1/l.x,l.y===0?0:1/l.y).skew_right(wt(-h.x),wt(-h.y)).rotate_right(-d).translate_right(-c.x,-c.y)}else ld.copy(cd).affine_inverse();return hh.copy(r),uh.isMultipleOf90=jr.isMultipleOf90Degree(Os.item.transform.world.get_rotation()),uh.isMultipleOf180=uh.isMultipleOf90&&jr.isMultipleOf180Degree(Os.item.transform.world.get_rotation()),cs.w=Os.item.sizeFlag.w,cs.h=Os.item.sizeFlag.h,Fo.x=Os.item.scaleFlag.x,Fo.y=Os.item.scaleFlag.y,YE.set(0,0),ld.xform(hh,YE),KU}function YU(e,n,s,i){n.copy(La).add(Ma);const{translate:r,rotation:o,scale:a,skew:c}=e.item.transform;s.reset().translate_right(r.x,r.y).rotate_right(o).skew_right(wt(c.x),wt(c.y)).scale_right(a.x,a.y).translate_right(-n.x,-n.y),i.copy(e.item.transform.parent).append(s)}function XU(e,n,s,i){const r=n.item.transform.worldPivot,o=e.get("rotation"),a=a1(r,s);return(c,{shift:l})=>{const{delta:h}=a(c);let d=o+h;if(l){const p=d%ns[15];d-=p>=ns[15]*.5?p-ns[15]:p}e.dataStore.beginChangeGroup(),e.set("rotation",d,{updateType:Gs.USER_EDITING}),e.dataStore.endChangeGroup(),i("rotate")}}function zU(e,n,s,i,r,o,a,c,l,h){const d=s.xform(e);h.copy(d).sub(n);const p=l?2:1,E=r.clone().sub(o).multiply(h).multiply(p,p),g=E.clone().add(i);return a&&c!==0&&!Number.isNaN(c)&&(o.y===.5||o.x!==.5&&Math.abs(E.x)>=Math.abs(E.y)?g.y=g.x/c:g.x=g.y*c),g}function zE(e,n,s){Number.isFinite(e.x)||(e.x=n),Number.isFinite(e.y)||(e.y=s)}const KU=(e,n,s,i,r=!0,o=!0,a=!1)=>{const c=!s,l=i&&s?i.clone().sub(XE.anchor):i,h=i?l:XE.anchor,d=new N(1-h.x,1-h.y);qr.x=Math.sign(d.x-.5),qr.y=Math.sign(d.y-.5);const p=YE.clone();c&&(cs.w==="f0"&&(p.x+=dn.x*.5*qr.x),cs.h==="f0"&&(p.y+=dn.y*.5*qr.y));const E=l1.clone(),g=h1.clone(),T=u1,A=d.clone().multiply(dn),m=cd.xform(A),O=h.x===.5||h.y===.5;if(jr.updateSnapMovingData(!1),jr.vs.selection.updateBounds(),jr.setResizeSelectedElementOAB(h),r){jr.updateMoved(e.clone().sub(hh));const J=jr.snapResizeElementToPixelGrid(e,hh,m,O,uh.isMultipleOf90);e.copy(J)}if(o){const J=jr.comparingVerticesWithResize(e,hh,m,h,r,uh,Pc.ResizeTypes.RESIZE_ONE_ELEMENT,n);e.copy(J)}const S=n&&cs.w!=="f0"&&cs.h!=="f0"&&cs.w!=="t0"&&cs.h!=="t0"&&Fo.x!=="0"&&Fo.y!=="0",y=zU(e,p,ld,dn,d,h,S,d1,s,HU);y.x<Xt&&(y.x=Es),y.y<Xt&&(y.y=Es),Fo.x==="0"&&(y.x=dn.x),Fo.y==="0"&&(y.y=dn.y),n&&(cs.w==="f0"&&cs.h==="f0"&&Fo.x!=="0"&&Fo.y!=="0"?y.y=y.x*(E.x/(E.y===0?1:E.y)):(cs.w==="f0"&&(y.x=dn.x),cs.h==="f0"&&(y.y=dn.y)));const v=La.clone().multiply(y).divide(dn);zE(v,La.x,La.y);const R=Ma.clone().multiply(y).divide(dn);zE(R,Ma.x,Ma.y),hd&&(R.x=Ma.x+La.x+dn.x*.5-v.x-Es*.5-(y.x>Xt?Es*.5:0)),ud&&(R.y=Ma.y+La.y+dn.y*.5-v.y-Es*.5-(y.y>Xt?Es*.5:0));const M=y.clone();hd&&(M.x=dn.x),ud&&(M.y=dn.y);const L=h.clone().multiply(dn),P=WE.clone().multiply(M);c&&(cs.w==="f0"&&(P.x+=dn.x*.5*qr.x),cs.h==="f0"&&(P.y+=dn.y*.5*qr.y),y.x<Xt&&(P.x-=Es*.5*qr.x),y.y<Xt&&(P.y-=Es*.5*qr.y)),hd&&(P.x-=y.x>Xt?Es*.5:0),ud&&(P.y-=y.y>Xt?Es*.5:0);const k=ad.xform(L),Q=h.clone().multiply(M).negate().add(P);cs.w==="t0"&&(Q.x=0),cs.h==="t0"&&(Q.y=0);const b=ad.basis_xform(Q),X=k.clone().add(b);if(s){const J=d.clone().sub(h).divide(2,2),ge=y.clone().sub(dn).multiply(J);X.sub(ge);const se=new N(ms.get("translate").x,ms.get("translate").y);se.equals(X)&&X.copy(se)}const K=y.clone().abs();ms.isText&&(Os.item.resizingMode===eo[kt.AUTO_WIDTH]?(dn.x!=K.x&&ms.set("resizingMode",kt.AUTO_HEIGHT),dn.y!=K.y&&ms.set("resizingMode",kt.FIXED)):Os.item.resizingMode===eo[kt.AUTO_HEIGHT]&&dn.y!=K.y&&ms.set("resizingMode",kt.FIXED)),ms.dataStore.beginChangeGroup();const V={scale:new ne(E),skew:new ne(g),rotation:T,width:K.x,height:K.y};cs.w!=="t0"&&(V.translateX=X.x,V.referencePointX=v.x,V.contentAnchorX=R.x),cs.h!=="t0"&&(V.translateY=X.y,V.referencePointY=v.y,V.contentAnchorY=R.y),ms.sets(V,{updateType:Gs.USER_EDITING}),ms.dataStore.endChangeGroup()},Jr=N,vs={RESIZE:0,ROTATE:1},Ws={TOP_LEFT:new Jr(0,0),TOP:new Jr(.5,0),TOP_RIGHT:new Jr(1,0),RIGHT:new Jr(1,.5),BOTTOM_RIGHT:new Jr(1,1),BOTTOM:new Jr(.5,1),BOTTOM_LEFT:new Jr(0,1),LEFT:new Jr(0,.5),CENTER:new Jr(.5,.5)},it={TOP_LEFT:{type:vs.RESIZE,anchor:Ws.BOTTOM_RIGHT,cursorRot:ns[45]},TOP_RIGHT:{type:vs.RESIZE,anchor:Ws.BOTTOM_LEFT,cursorRot:-ns[45]},BOTTOM_RIGHT:{type:vs.RESIZE,anchor:Ws.TOP_LEFT,cursorRot:ns[45]},BOTTOM_LEFT:{type:vs.RESIZE,anchor:Ws.TOP_RIGHT,cursorRot:-ns[45]},TOP:{type:vs.RESIZE,anchor:Ws.BOTTOM,cursorRot:ns[90]},RIGHT:{type:vs.RESIZE,anchor:Ws.LEFT,cursorRot:ns[0]},BOTTOM:{type:vs.RESIZE,anchor:Ws.TOP,cursorRot:ns[90]},LEFT:{type:vs.RESIZE,anchor:Ws.RIGHT,cursorRot:ns[0]},TOP_LEFT_ROTATE:{type:vs.ROTATE,anchor:Ws.BOTTOM_RIGHT,cursorRot:-ns[90]},TOP_RIGHT_ROTATE:{type:vs.ROTATE,anchor:Ws.BOTTOM_LEFT,cursorRot:ns[0]},BOTTOM_RIGHT_ROTATE:{type:vs.ROTATE,anchor:Ws.TOP_LEFT,cursorRot:ns[90]},BOTTOM_LEFT_ROTATE:{type:vs.ROTATE,anchor:Ws.TOP_RIGHT,cursorRot:ns[180]}};function QU(e,n){const{getCurrentState:s,setState:i}=n,{dataStore:r,viewport:o,snapping:a}=e;let c=null,l=null,h=null,d=null,p=null;const E=new N;let g=null;const T=new Map,A={w:"!0",h:"!0"},m={currentTool:null,ignoreActiveTool:!1,setHandle:V=>{c=it[V]},resizeStart:(V,J,ge)=>{if(c&&c.type===vs.RESIZE){const se=e.selection.single,ue=r.get("activeTool");switch(m.currentTool=m.ignoreActiveTool?et.SELECT:ue,m.currentTool){case et.SELECT:if(se===null)g=kU(c,e.selection.iter(),e.selection.bounds.clone(),a,o.toWorld(V.mousePos));else{let te=!1,ie=!1;A.w=se.node.item.sizeFlag.w,A.h=se.node.item.sizeFlag.h;const re=se.element,{width:fe,height:Ne}=re.get("size"),At=re.get("contentAnchor"),Ke=re.get("referencePoint"),St={};if(fe>0&&fe<Xt){const _t=At.x+(Ke.x-fe*.5);if(Math.abs(_t)>1)te=!0;else{const ni=_t*fe*mu-(Ke.x-fe*.5);St.contentAnchorX=ni}}if(Ne>0&&Ne<Xt){const _t=At.y+(Ke.y-Ne*.5);if(Math.abs(_t)>1)ie=!0;else{const ni=_t*Ne*mu-(Ke.y-Ne*.5);St.contentAnchorY=ni}}const hn=r.drawInfo.getFixedPositionByChanges(re.get("id"),St);hn&&(St.translateX=hn[0]||hn.x,St.translateY=hn[1]||hn.y,se.element.sets(St)),g=WU(c,se.element,se.node,a,o.toWorld(V.mousePos),te,ie)}m.resizeUpdate=O;break;case et.SCALE:K(V,J,ge);break}}else V.handled=!1},resizeUpdate:()=>{},resizeEnd:(V=!0)=>{if(m.currentTool===et.SCALE&&(d&&(d=null),p&&(p=null),T.clear()),m.currentTool===et.SELECT){const J=e.selection.single;if(J){const ge=J.element,{width:se,height:ue}=ge.get("size"),te=ge.get("contentAnchor"),ie=ge.get("referencePoint"),re={};if(se>0&&se<Xt&&A.w==="!0"){const Ke=(te.x+(ie.x-se*.5))/se/mu-(ie.x-se*.5);re.contentAnchorX=Ke}if(ue>0&&ue<Xt&&A.h==="!0"){const Ke=(te.y+(ie.y-ue*.5))/ue/mu-(ie.y-ue*.5);re.contentAnchorY=Ke}const fe=r.drawInfo.getFixedPositionByChanges(ge.get("id"),re);fe&&(re.translateX=fe[0]||fe.x,re.translateY=fe[1]||fe.y,J.element.sets(re))}}m.resizeUpdate=()=>{},m.currentTool=null,m.ignoreActiveTool=!1,a.setEndSnapping(),a.endSnapMovingElementToElement(),V&&(r.commitUndo(),r.isDesignMode&&e.updateUpdateLevel(ds.UPDATE_ALL_NEED_BBOX_RECALC))},rotateStart:V=>{if(c&&c.type===vs.ROTATE){const J=e.selection.single,ge=r.get("activeTool")===et.SCALE?l.node.item.transform.worldPivot:e.selection.bounds.center;m.rotateUpdate=J===null?BU(e.selection.iter(),ge,o.toWorld(V.mousePos),i):XU(J.element,J.node,o.toWorld(V.mousePos),i)}else V.handled=!1},rotateUpdate:()=>{},rotateEnd:()=>{m.rotateUpdate=()=>{},r.commitUndo(),r.isDesignMode&&e.updateUpdateLevel(ds.UPDATE_ALL_NEED_BBOX_RECALC)}};r.selection.on(me.SELECT,()=>{r.selection.isEmpty()&&r.get("activeTool")!==et.PEN&&i("default")}),r.on(me.DEFAULT_CHANGES,V=>{if(V.has("activeTool")){if(V.get("activeTool").value!==et.SCALE)return;if(c&&c.type!==vs.ROTATE){const ge=e.selection.single.node.item.transform.saveWorld.get_rotation();i("scale",ge+c.cursorRot)}}}),r.eam.on(Y.HOVER_BOX_HANDLE,V=>{const J=e.selection.single,ge=r.get("activeTool"),se=s();if(h=null,J===null)if(ge===et.SCALE){let te=[];for(const ie of e.selection.iter())te=[{...ie},...te];h=M1(te,V.mousePos)}else{const te=e.selection.bounds.clone(),{width:ie,height:re}=te,fe=Lo(ie),Ne=Lo(re);fe==="f0"&&(te.width=0,te.x+=ie*.5),Ne==="f0"&&(te.height=0,te.y+=re*.5),h=iG(te,V.mousePos)}else h=M1([J],V.mousePos);l=null,c=null,h&&(l=h.item,c=h.handle);const ue=e.selection.all(te=>te.element.isLocked());if(c&&!ue){const te=e.selection.all(re=>re.element.get("elementType")===Le.SCREEN),ie=e.selection.all(re=>re.element.get("locked")&&re.element.get("elementType")!==Le.SCREEN);if(c.type===vs.ROTATE){if(te||ie){r.eam.changeHover(Gt.NONE),i("default");return}r.eam.changeHover(Gt.ROTATE_HANDLE),i("rotate")}else{if(l&&l.element.isLineElement())i(ge===et.SCALE&&l?"crossScale":"crossMove");else{let fe=(l?l.node.item.transform.saveWorld.get_rotation():0)+c.cursorRot;if(l){const Ne=l.element.get("skew"),At=l.node.item.transform.world.get_scale(),Ke=Ws.CENTER.clone().sub(c.anchor).multiply(2,2).abs();fe-=Ne[0]*Ke.y/(Ke.x+Ke.y),fe+=Ne[1]*Ke.x/(Ke.x+Ke.y),!$s(c.anchor.x,.5,.001)&&!$s(c.anchor.y,.5,.001)&&(At.x<0&&(fe+=Math.PI*.5),At.y<0&&(fe+=Math.PI*.5),Math.abs(Math.floor((Ne[0]+Math.PI*.5)/Math.PI)%2)===1&&(fe+=Math.PI*.5),Math.abs(Math.floor((Ne[1]+Math.PI*.5)/Math.PI)%2)===1&&(fe+=Math.PI*.5))}if(ge===et.SCALE){if(te||ie){r.eam.changeHover(Gt.NONE),i("default");return}i("scale",fe)}else!r.selection.get("hoverMotionPoint")&&!r.selection.get("hoverMotionSegment")&&i("resize",fe)}r.eam.changeHover(Gt.RESIZE_HANDLE)}}else se.secondState||i("default")});const O=(V,J,ge,se)=>{g(o.toWorld(V.mousePos),J.shift,J.alt,void 0,ge,se)},S=new Ce,y=new N,v=new N,R=new N,M=new N,L=new N,P=new N,k=new N,Q=new N,b=new N,X=new N,K=(V,J=!0,ge=!0)=>{p=new N(Ws.CENTER.x-c.anchor.x,Ws.CENTER.y-c.anchor.y);const se=e.selection,ue=l.node,te=l.element,ie=e.snapping,re=c.anchor.x===.5||c.anchor.y===.5;d=o.toWorld(V.mousePos);const fe={isMultipleOf90:ie.isMultipleOf90Degree(ue.item.transform.rotation),isMultipleOf180:ie.isMultipleOf180Degree(ue.item.transform.rotation)},Ne=ie.getScalingClickPoint(p,ue);E.copy(Ne),T.clear();for(const{element:St,node:hn}of se.iter()){const _t=St.get("scale");T.set(St.get("id"),{sizeFlag:hn.item.sizeFlag,scaleX:_t.x,scaleY:_t.y})}const At=ie.isScalingSnapToPixelGrid(ue,re);if(ue.item.transform.world.basis_determinant()===0){const{translate:St,skew:hn,rotation:_t}=ue.item.transform,qn=ue.item.transform.getPivotOffset();S.reset().append(ue.parent.item.transform.world.clone().affine_inverse()).translate_right(qn.x,qn.y).skew_right(-hn.x,-hn.y).rotate_right(-_t).translate_right(-St.x,-St.y)}else S.copy(ue.item.transform.world.clone().affine_inverse());y.set(te.get("scale").x,te.get("scale").y),v.set(te.get("size").width,te.get("size").height);const Ke=y.y*v.y===0?0:y.x*v.x/(y.y*v.y);m.resizeUpdate=(St,hn)=>{ie.updateSnapMovingData(),ie.vs.selection.updateBounds(),ie.setResizeSelectedElementOAB(c.anchor,ue);const _t=o.toWorld(St.mousePos);ie.updateMoved(_t.clone().sub(d));let qn=_t.x-d.x,ni=_t.y-d.y;if(qn!==0||ni!==0){if(r.beginChangeGroup(),J&&At){const On=ie.snapScaleElementToPixelGrid(_t,d,E,re,fe.isMultipleOf90);_t.copy(On),qn=_t.x-d.x,ni=_t.y-d.y}if(ge){const On=ie.comparingVerticesWithResize(_t,d,E,c.anchor,J,fe,Pc.ResizeTypes.SCALE_ONE_ELEMENT,hn.shift);On.sub(d),qn=On.x,ni=On.y}const ys=new N(1,1),Hi=$s(y.x,0,.001)&&$s(y.y,0,.001),Xo=!$s(y.x,0,.001)&&!$s(y.y,0,.001),jn=hn.shift;if(jn&&(Hi||Xo))if(re)ys.x=c.anchor.x===.5?0:ys.x,ys.y=c.anchor.y===.5?0:ys.y;else{const On=S.xform(_t),{width:Wi,height:Yn}=te.get("size"),Rs=te.get("contentAnchor"),no=te.get("referencePoint"),so=(no.x+Rs.x)/Wi,ws=(no.y+Rs.y)/Yn,Rr=new N(so,ws),si=On.sub(Rr).abs();si.y*Ke<si.x?ys.x=0:ys.y=0}R.set(1-c.anchor.x,1-c.anchor.y),Q.set(qn,ni),S.basis_xform(Q,M),Xo&&M.multiply(y.x,y.y),M.multiply((R.x-.5)*2,(R.y-.5)*2);for(const{element:On}of se.iter()){if(On.get("elementType")===Le.SCREEN||On.isLocked())continue;const{scaleX:Wi,scaleY:Yn,sizeFlag:Rs}=T.get(On.get("id")),no=$s(Wi,0,.001)&&$s(Yn,0,.001),so=!$s(Wi,0,.001)&&!$s(Yn,0,.001),ws=Wi===0?1e-12:Wi,Rr=Yn===0?1e-12:Yn;X.set(Wi,Yn);let{width:si,height:zo}=On.get("size");const Ko=On.get("contentAnchor"),xd=On.get("referencePoint"),ka=(xd.x+Ko.x)/si,Qo=(xd.y+Ko.y)/zo;if(b.set(ka,Qo),si*=ws,zo*=Rr,P.copy(R),k.copy(b),P.x===0&&(P.x=1-P.x,k.x=1-k.x),P.y===0&&(P.y=1-P.y,k.y=1-k.y),P.x===k.x&&(k.x=1-k.x),P.y===k.y&&(k.y=1-k.y),L.copy(M).multiply(Math.sign(P.x-k.x),Math.sign(P.y-k.y)),!$s(P.x,.5,.001)){const wr=Math.sign(P.x-k.x)*L.x;X.x=(si+wr-si*k.x)/(si*(1-k.x))*ws}if(!$s(P.y,.5,.001)){const wr=Math.sign(P.y-k.y)*L.y;X.y=(zo+wr-zo*k.y)/(zo*(1-k.y))*Rr}if(jn&&(so||no)&&Rs.w==="!0"&&Rs.h==="!0"){const wr=no?zo/si:Wi/Yn;ys.x===0?X.x=X.y*wr:X.y=X.x/wr}jn&&!no&&($s(Wi,0,.001)&&(X.x=0),$s(Yn,0,.001)&&(X.y=0)),jn&&no&&(Rs.w==="f0"||Rs.h==="f0"||Rs.w==="t0"||Rs.h==="t0")&&(X.x=0,X.y=0),(Rs.w==="f0"||Rs.w==="t0")&&(X.x=Wi),(Rs.h==="f0"||Rs.h==="t0")&&(X.y=Yn),On.set("scale",X,{updateType:Gs.USER_EDITING})}r.endChangeGroup()}}};return m}function $s(e,n,s){return Math.abs(e-n)<=s}const KE=tt(),xr={VERT_HALF_BOX_WIDTH:8,ORIGIN_HALF_BOX_WIDTH:8,RESIZE_HANDLES_HALF_BOX_WIDTH:4,ROTATE_HANDLES_RADIUS:14,MOVE_LINE_RADIUS:.5,GUIDELINE_WIDTH:4},f1=2.5;let fn;class ZU{constructor(){$e(this,"node_bank",new Map);$e(this,"root","")}addNewNode(n,s){this.node_bank.set(s.id,s);const i=s.item.transform.parent;QE(n,this,s.id,i),ZE(n,this.node_bank,s.id,!1),qE(n,this.node_bank,s.id)}addScreenNode(n,s,i,r,o){this.addNewNode(n,s);const a=S1(n,s,i,r,o);n.screen_name.set(s.id,a)}}class qU{constructor(){$e(this,"transform",new Map);$e(this,"bounds",new Map);$e(this,"screen_name",new Map);$e(this,"locked",new Map);$e(this,"hidden",new Map)}}class jU{constructor(n){$e(this,"state",{compute:new qU,scene:new ZU,hovered:null,guidelines:{horizontal:{map:new Map,sortedDataWorld:[],isDirty:!1},vertical:{map:new Map,sortedDataWorld:[],isDirty:!1}}});this.visualServer=n,fn=n}update(){QE(this.state.compute,this.state.scene,this.state.scene.root,Ce.IDENTITY),ZE(this.state.compute,this.state.scene.node_bank,this.state.scene.root,!0),qE(this.state.compute,this.state.scene.node_bank,this.state.scene.root)}updateScreenNameBounds(){$U(this.state.compute,this.state.scene.node_bank)}updateGuidelines(){eG(this.state)}}function JU(e,n,s,i){const o=n.node_bank.get(s).item.transform.local.clone(),a=i.clone().append(o),c=i.clone().append(o).affine_inverse();let l=e.transform.get(s);l||(l={local:o,world:a,worldInv:c},e.transform.set(s,l)),l.local.copy(o),l.world.copy(a),l.worldInv.copy(c)}function QE(e,n,s,i,r=!1,o=!1){const a=n.node_bank.get(s),c=r||a.item.locked;e.locked.set(s,c);const l=o||!a.item.visible;e.hidden.set(s,l),JU(e,n,s,i);const d=e.transform.get(s).world;for(let p=0;p<a.children.length;p++)QE(e,n,a.children[p].id,d,c,l)}function ZE(e,n,s,i=!1){const r=n.get(s),o=e.transform.get(s),a=r.boundsLocal.clone(),c=o.world.xform_rect(a),l=r.subtreeBounds;if(e.bounds.has(s)){const h=e.bounds.get(s);h.local.copy(a),h.world.copy(c),h.visualWorld.copy(l)}else e.bounds.set(s,{world:c.clone(),visualWorld:l.clone(),local:a.clone(),subtree:c.clone()});if(i)for(let h=0;h<r.children.length;h++)ZE(e,n,r.children[h].id,!0)}function qE(e,n,s){const i=n.get(s),r=e.bounds.get(s);if(i.children.length===0){r.subtree.copy(r.visualWorld);return}const o=r.visualWorld.clone();for(let a=i.children.length-1;a>=0;a--){qE(e,n,i.children[a].id);const c=e.bounds.get(i.children[a].id);o.merge_with(c.subtree)}r.subtree.copy(o.clone())}function $U(e,n){for(const s of e.screen_name){const i=s[0],r=fn.dataStore.getById(i),o=r.get("visible")&&!r.get("locked"),a=fn.dataStore.workspace.get("scale"),c={fontSize:12,h_align:"left",v_align:"top"},h=fn.overlay.panes[0].measureTextImage(r.get("name"),c.fontSize,c.h_align,c.v_align),d=n.get(i),p=S1(e,d,o,a,h);e.screen_name.set(i,p)}}function eG(e){e.guidelines.horizontal.isDirty&&(e.guidelines.horizontal.sortedDataWorld=Array.from(e.guidelines.horizontal.map.entries()),e.guidelines.horizontal.sortedDataWorld.sort((n,s)=>n[1]-s[1]),e.guidelines.horizontal.isDirty=!1),e.guidelines.vertical.isDirty&&(e.guidelines.vertical.sortedDataWorld=Array.from(e.guidelines.vertical.map.entries()),e.guidelines.vertical.sortedDataWorld.sort((n,s)=>n[1]-s[1]),e.guidelines.vertical.isDirty=!1)}const ei=(e,n)=>{const s=f1/fn.viewport.scale;return Zn.set(e.x-s,e.y-s,e.width+s*2,e.height+s*2),Zn.contains(n)};function Dc(e,n,s,i){const r=f1/fn.viewport.scale,o=[],a=30,c=n.get(s);for(let l=0;l<360/a;l++)o.push(new N(i.x+r*Math.cos(l*a*Math.PI/180),i.y+r*Math.sin(l*a*Math.PI/180)));for(let l=0;l<o.length;l++)if(c.item.type==="text"){const d=fn.view.getOrCreateDinoTree(s).text_node_id;if(!d)return!1;const E=e.transform.get(s).worldInv.xform(i);if(fn.dataStore.selection.get("textRange")&&ei(c.boundsLocal,new N(E.x,E.y))||KE.isPointInText(d,E.x,E.y))return!0}else if(p1(e,n,s,o[l]))return!0;return!1}function p1(e,n,s,i){const r=fn.dataStore.getById(s);let o=!1;if(r.isLineElement()){const T=xr.MOVE_LINE_RADIUS/fn.viewport.projectionTransform.a,A=e.transform.get(s),m=r.get("geometry").get("mesh"),O=Array.from(m.edges.values());for(let S=0;S<O.length;S++){const y=A.world.xform(m.getVertPos(O[S].v.id)),v=A.world.xform(m.getVertPos(O[S].w.id));JE.setP(y,v);const R=JE.nearest(i);JE.eval(R.t).subtract(i).length_squared()<=T&&(o=!0)}}let a=n.get(s);a.item.isMaskGroup()&&a.children.length&&(a=a.children[a.children.length-1]);const{x:c,y:l}=a.item.transform.size;if(c<Xt&&l<Xt)return!1;const p=e.transform.get(a.id).world.clone().clone().affine_inverse().xform(i),E=tG(a.item,p);return a.item.fillLayers.length===0&&a.item.strokeLayers.length!==0?a.item.isContainerNormalGroup()?E>0||o:E===3||o:E>0||o}function tG(e,n){const s=fn.view.getOrCreateDinoTree(e.id);for(let i=0;i<s.strokes.children.length;i++)if(KE.isPointInStroke(s.strokes.children[i].path_id,s.strokes.children[i].stroke_data_id,n.x,n.y))return 3;return KE.isPointInPath(s.path_id,n.x,n.y)?2:0}function dd(e,n,s,i,r,o,a=!1){var T;const c=e.locked.get(i),l=e.hidden.get(i);if(c||l)return null;const h=s.get(i),d=n,p=e.bounds.get(i);if(h.parent&&h.parent.item.isMaskGroup()&&h.id===h.parent.children[h.parent.children.length-1].id&&!a)return null;const g=h.item.isMaskGroup()||h.item.isBooleanGroup()||h.item.clipping;if(ei(g?p.visualWorld:p.subtree,r)){const A=h.item.isContainerNormalGroup()||h.item.isMaskGroup()||h.item.isBooleanGroup();if(o||!ei(p.visualWorld,r)||d&&A){for(let m=h.children.length-1;m>=0;m--){const O=dd(e,n,s,h.children[m].id,r,!1,a);if(O!==null)return O}return d&&h.item.isContainer()&&((T=h.item.fillLayers)==null?void 0:T.length)>0&&ei(p.visualWorld,r)?i:ei(p.visualWorld,r)&&a&&Dc(e,s,i,r)?d&&A?null:i:null}else{if(!Dc(e,s,i,r)||h.item.isNormalGroup()){const m=s.get(i);if(m.item.isContainer()&&!m.item.clipping||m.item.isNormalGroup()){for(let O=m.children.length-1;O>=0;O--)if(dd(e,n,s,m.children[O].id,r,!1,a)!==null)return i}return null}return i}}return null}function nG(e,n,s,i){const r=s.first.id,o=e.scene.node_bank,a=e.scene.node_bank.get(e.scene.root);if(a.children.length===0)return;const c=a.children[0].id,l=o.get(r),h=l.item.type==="screen"?l.item.depth+1:l.item.depth,d=E1(e,o,c,n,h,i,!0),p=i;if(d){let E=o.get(d);if(!p){for(;E.item.depth>h;)E=o.get(E.parent.id);if(E.item.depth===h&&s.bounds.has_point(n)){e.hovered=E.id;return}}e.hovered=c===E.id?null:E.id}else{e.hovered=null;for(const[E,g]of e.compute.screen_name)ei(g,n)&&(e.hovered=E)}}function E1(e,n,s,i,r,o,a){var A;const c=e.compute.locked.get(s),l=e.compute.hidden.get(s);if(c||l)return null;const h=o,d=n.get(s);if(d.parent&&d.parent.item.isMaskGroup()&&d.id===d.parent.children[d.parent.children.length-1].id||d.item.depth>r&&!h)return null;const E=e.compute.bounds.get(s),g=d.item.isMaskGroup()||d.item.isBooleanGroup()||d.item.clipping,T=d.item.type==="text"&&fn.dataStore.selection.get("textRange")?E.world:E.subtree;if(ei(g?E.visualWorld:T,i)){const m=n.get(fn.selection.first.id),O=d.item.isContainerNormalGroup()||d.item.isMaskGroup()||d.item.isBooleanGroup();if(a||!ei(E.visualWorld,i)||h&&O||m.parent.id===s||d.item.isContainerNormalGroup()){if(d.item.depth+1<=r||h)for(let S=d.children.length-1;S>=0;S--){const y=E1(e,n,d.children[S].id,i,r,o);if(y!==null)return y}if(h&&d.item.isContainer()&&((A=d.item.fillLayers)==null?void 0:A.length)>0&&ei(E.visualWorld,i))return s;if(Dc(e.compute,n,s,i)&&!h){if(d.item.isNormalGroup()){for(let S=d.children.length-1;S>=0;S--)if(dd(e.compute,o,n,d.children[S].id,i,!1,!1)!==null)return s;return null}return s}else return null}else return h&&O||!Dc(e.compute,n,s,i)?null:s}return null}function g1(e,n,s,i,r=!1){const o=e.compute,a=e.scene.node_bank,c=n;let l=dd(o,n,a,i,s,!0,r),h=a.get(l);if(!c&&!r)for(;h&&h.parent.id!==i;)h=a.get(h.parent.id);if(l=h?h.id:null,!l)for(const[d,p]of o.screen_name)ei(p,s)&&(l=d);e.hovered=l}function _1(e,n,s){const i=e.compute,r=e.scene.node_bank;return A1(i,r,s,n)||s}function T1(e,n,s){const i=_1(e,n,s);e.hovered=i}function A1(e,n,s,i){const r=e.locked.get(s),o=e.hidden.get(s);if(r||o)return null;const a=n.get(s);if(!(a.item.isScreen()||a.item.isContainerNormalGroup()))return null;const l=e.bounds.get(s);if(ei(l.subtree,i)){for(let h=a.children.length-1;h>=0;h--){const d=A1(e,n,a.children[h].id,i);if(d!==null)return d}if(Dc(e,n,s,i))return s}return null}function m1(e,n,s,i=!1){if(s.size<1)return!1;const r=fn.dataStore.workspace.children[0].get("id");for(const o of s.iter()){if(i&&r===o.id)continue;const a=e.compute.bounds.get(o.id).local,l=e.compute.transform.get(o.id).world.clone().affine_inverse().xform(n);if(ei(a,l))if(o.element.isLineElement()){if(Dc(e.compute,e.scene.node_bank,o.id,n))return o.id}else return o.id}return null}function jE(e,n,s,i,r,o){this.p=new N(e,n),this.p1=new N(s,i),this.p2=new N(r,o)}jE.prototype={constructor:jE,set(e,n,s,i,r,o){return this.p.set(e,n),this.p1.set(s,i),this.p2.set(r,o),this},setP(e,n,s){return this.p.copy(e),this.p1.copy(n),this.p2.copy(s),this},isPointInside(e){const n=this.p1.clone().subtract(this.p),s=this.p2.clone().subtract(this.p);if(n.x===0&&n.y===0||s.x===0&&s.y===0)return!1;const i=e.clone().subtract(this.p);if(i.x===0&&i.y===0)return!1;const r=n.cross(s),o=n.cross(i),a=-1*r,c=s.cross(i);return Math.sign(r)===Math.sign(o)&&Math.sign(a)===Math.sign(c)&&Math.abs(r)>=Math.abs(o)&&Math.abs(a)>=Math.abs(c)}};const sG=24,O1=(e,n)=>{const s=sG/fn.viewport.projectionTransform.a,i=e.xform(n.bottomRight),r=e.xform(n.topRight),o=e.xform(n.bottomLeft),a=e.xform(n.topLeft);return i.distance(r)<s||r.distance(a)<s||a.distance(o)<s||o.distance(i)<s},iG=(e,n)=>{const s=xr.RESIZE_HANDLES_HALF_BOX_WIDTH/fn.viewport.projectionTransform.a,i=xr.ROTATE_HANDLES_RADIUS/fn.viewport.projectionTransform.a,r=fn.viewport.toWorld(n),o=Ce.IDENTITY,a=O1(o,e);if(wc(e,o))return null;const c=o.xform(e.bottomRight),l=o.xform(e.topRight),h=o.xform(e.bottomLeft),d=o.xform(e.topLeft);if(a){if(Zn.set(c.x,c.y,s,s),Zn.contains(r))return{item:null,handle:it.BOTTOM_RIGHT};if(Zn.set(l.x,l.y-s,s,s),Zn.contains(r))return{item:null,handle:it.TOP_RIGHT};if(Zn.set(h.x-s,h.y,s,s),Zn.contains(r))return{item:null,handle:it.BOTTOM_LEFT};if(Zn.set(d.x-s,d.y-s,s,s),Zn.contains(r))return{item:null,handle:it.TOP_LEFT}}else{if(Zn.set(c.x-s,c.y-s,s*2,s*2),Zn.contains(r))return{item:null,handle:it.BOTTOM_RIGHT};if(Zn.set(l.x-s,l.y-s,s*2,s*2),Zn.contains(r))return{item:null,handle:it.TOP_RIGHT};if(Zn.set(h.x-s,h.y-s,s*2,s*2),Zn.contains(r))return{item:null,handle:it.BOTTOM_LEFT};if(Zn.set(d.x-s,d.y-s,s*2,s*2),Zn.contains(r))return{item:null,handle:it.TOP_LEFT}}pt.set(d.y-l.y,l.x-d.x).normalize().multiply(s,s),It.set(pt.x,pt.y).negate(),Kt.set(d.y-h.y,h.x-d.x).normalize().multiply(s,s),pn.set(Kt.x,Kt.y).negate();const p=0,E=a?0:1;return We.setP(h.clone().add(p,0).add(pt),h.clone().add(p,0).add(It.clone().multiply(E,E)),c.clone().add(-0,0).add(pt)),We.isPointInside(r)?{item:null,handle:it.BOTTOM}:(We.setP(c.clone().add(0,p).add(pn),c.clone().add(0,p).add(Kt.clone().multiply(E,E)),l.clone().add(0,-0).add(pn)),We.isPointInside(r)?{item:null,handle:it.RIGHT}:(We.setP(d.clone().add(0,p).add(Kt),d.clone().add(0,p).add(pn.clone().multiply(E,E)),h.clone().add(0,-0).add(Kt)),We.isPointInside(r)?{item:null,handle:it.LEFT}:(We.setP(l.clone().add(p,0).add(It),l.clone().add(p,0).add(pt.clone().multiply(E,E)),d.clone().add(-0,0).add(It)),We.isPointInside(r)?{item:null,handle:it.TOP}:(We.setP(h,d,c),We.isPointInside(r)?null:c.distance_to(r)<i?{item:null,handle:it.BOTTOM_RIGHT_ROTATE}:l.distance_to(r)<i?{item:null,handle:it.TOP_RIGHT_ROTATE}:h.distance_to(r)<i?{item:null,handle:it.BOTTOM_LEFT_ROTATE}:d.distance_to(r)<i?{item:null,handle:it.TOP_LEFT_ROTATE}:null))))},Lc=[],rG=(e,n,s)=>{const i=xr.RESIZE_HANDLES_HALF_BOX_WIDTH/fn.viewport.projectionTransform.a,r=xr.ROTATE_HANDLES_RADIUS/fn.viewport.projectionTransform.a,o=fn.viewport.toWorld(s);Lc.length=0;for(let a=0;a<n.length;a++){const c=n[a],l=e.transform.get(c.node.id).world.clone(),h=c.node.boundsLocal_zero,d=O1(l,h);let p=null;if(c.element.isLineElement()){const E=c.element.get("geometry").get("mesh"),g=E.edges.values().next().value,T=E.getVertPos(g.v.id),A=E.getVertPos(g.w.id),m=Math.sign(A.x-T.x),O=Math.sign(A.y-T.y),S=new N,y=new N;m*O>0?(S.copy(l.xform(h.bottomRight)),y.copy(l.xform(h.topLeft))):(S.copy(l.xform(h.bottomLeft)),y.copy(l.xform(h.topRight))),p={signX:m,signY:O,p1:S,p2:y}}Lc.push({item:c,T:l,bbox:h,isTiny:d,lineInfo:p})}for(let a=0;a<Lc.length;a++){const{item:c,T:l,bbox:h,isTiny:d,lineInfo:p}=Lc[a];if(c.node.item.isEmpty||wc(h,l))continue;const E=l.clone().get_rotation();if(ko.reset().rotate(E),c.element.isLineElement()){const{signX:g,signY:T,p1:A,p2:m}=p;if(pt.set(i,0),It.set(0,i),ko.basis_xform(pt,pt),ko.basis_xform(It,It),Kt.copy(pt).negate(),pn.copy(It).negate(),pt.multiply(2,2),It.multiply(2,2),g*T>0){const O=A.clone().add(Kt).add(pn);if(We.setP(O,O.clone().add(pt),O.clone().add(It)),We.isPointInside(o))return{item:c,handle:it.BOTTOM_RIGHT};const S=m.clone().add(Kt).add(pn);if(We.setP(S,S.clone().add(pt),S.clone().add(It)),We.isPointInside(o))return{item:c,handle:it.TOP_LEFT}}else if(g===0){const O=A.clone().add(Kt).add(pn);if(We.setP(O,O.clone().add(pt),O.clone().add(It)),We.isPointInside(o))return{item:c,handle:it.BOTTOM_RIGHT};const S=m.clone().add(Kt).add(pn);if(We.setP(S,S.clone().add(pt),S.clone().add(It)),We.isPointInside(o))return{item:c,handle:it.TOP_LEFT}}else if(T===0){const O=m.clone().add(Kt).add(pn);if(We.setP(O,O.clone().add(pt),O.clone().add(It)),We.isPointInside(o))return{item:c,handle:it.BOTTOM_RIGHT};const S=A.clone().add(Kt).add(pn);if(We.setP(S,S.clone().add(pt),S.clone().add(It)),We.isPointInside(o))return{item:c,handle:it.TOP_LEFT}}else{const O=A.clone().add(Kt).add(pn);if(We.setP(O,O.clone().add(pt),O.clone().add(It)),We.isPointInside(o))return{item:c,handle:it.BOTTOM_LEFT};const S=m.clone().add(Kt).add(pn);if(We.setP(S,S.clone().add(pt),S.clone().add(It)),We.isPointInside(o))return{item:c,handle:it.TOP_RIGHT}}}else{const g=l.xform(h.bottomRight),T=l.xform(h.topRight),A=l.xform(h.bottomLeft),m=l.xform(h.topLeft);if(d){pt.set(i,0),It.set(0,i),ko.basis_xform(pt,pt),ko.basis_xform(It,It),Kt.copy(pt).negate(),pn.copy(It).negate();const O=g.clone();if(We.setP(O,O.clone().add(pt),O.clone().add(It)),We.isPointInside(o))return{item:c,handle:it.BOTTOM_RIGHT};const S=T.clone().add(pn);if(We.setP(S,S.clone().add(pt),S.clone().add(It)),We.isPointInside(o))return{item:c,handle:it.TOP_RIGHT};const y=A.clone().add(Kt);if(We.setP(y,y.clone().add(pt),y.clone().add(It)),We.isPointInside(o))return{item:c,handle:it.BOTTOM_LEFT};const v=m.clone().add(Kt).add(pn);if(We.setP(v,v.clone().add(pt),v.clone().add(It)),We.isPointInside(o))return{item:c,handle:it.TOP_LEFT}}else{ko.reset().rotate(E),pt.set(i,0),It.set(0,i),ko.basis_xform(pt,pt),ko.basis_xform(It,It),Kt.copy(pt).negate(),pn.copy(It).negate(),pt.multiply(2,2),It.multiply(2,2);const O=g.clone().add(Kt).add(pn);if(We.setP(O,O.clone().add(pt),O.clone().add(It)),We.isPointInside(o))return{item:c,handle:it.BOTTOM_RIGHT};const S=T.clone().add(Kt).add(pn);if(We.setP(S,S.clone().add(pt),S.clone().add(It)),We.isPointInside(o))return{item:c,handle:it.TOP_RIGHT};const y=A.clone().add(Kt).add(pn);if(We.setP(y,y.clone().add(pt),y.clone().add(It)),We.isPointInside(o))return{item:c,handle:it.BOTTOM_LEFT};const v=m.clone().add(Kt).add(pn);if(We.setP(v,v.clone().add(pt),v.clone().add(It)),We.isPointInside(o))return{item:c,handle:it.TOP_LEFT}}}}for(let a=0;a<n.length;a++){const{item:c,T:l,bbox:h,isTiny:d}=Lc[a];if(c.node.item.isEmpty||wc(h,l)||c.element.isLineElement())continue;const p=l.xform(h.bottomRight),E=l.xform(h.topRight),g=l.xform(h.bottomLeft),T=l.xform(h.topLeft),A=l.get_scale(),m=(A.x>=0?1:-1)*(A.y>=0?1:-1);pt.set(T.y-E.y,E.x-T.x).normalize().multiply(i,i).multiply(m,m),It.set(pt.x,pt.y).negate(),Kt.set(T.y-g.y,g.x-T.x).normalize().multiply(i,i).multiply(m,m),pn.set(Kt.x,Kt.y).negate();const O=!d||c.node.item.isScreen()?1:0;if(We.setP(g.clone().add(pt),g.clone().add(It.clone().multiply(O,O)),p.clone().add(pt)),We.isPointInside(o))return{item:c,handle:it.BOTTOM};if(We.setP(p.clone().add(pn),p.clone().add(Kt.clone().multiply(O,O)),E.clone().add(pn)),We.isPointInside(o))return{item:c,handle:it.RIGHT};if(We.setP(T.clone().add(Kt),T.clone().add(pn.clone().multiply(O,O)),g.clone().add(Kt)),We.isPointInside(o))return{item:c,handle:it.LEFT};if(We.setP(E.clone().add(It),E.clone().add(pt.clone().multiply(O,O)),T.clone().add(It)),We.isPointInside(o))return{item:c,handle:it.TOP}}for(let a=0;a<n.length;a++){const{item:c,T:l,bbox:h,lineInfo:d}=Lc[a];if(!(c.node.item.isEmpty||wc(h,l)||c.node.item.isScreen()))if(c.element.isLineElement()){const{signX:p,signY:E,p1:g,p2:T}=d;if(qG(o,c.node.id))continue;if(p*E>0){if(g.distance_to(o)<r)return{item:c,handle:it.BOTTOM_RIGHT_ROTATE};if(T.distance_to(o)<r)return{item:c,handle:it.TOP_LEFT_ROTATE}}else{if(g.distance_to(o)<r)return{item:c,handle:it.BOTTOM_LEFT_ROTATE};if(T.distance_to(o)<r)return{item:c,handle:it.TOP_RIGHT_ROTATE}}}else{const p=l.xform(h.bottomRight),E=l.xform(h.topRight),g=l.xform(h.bottomLeft),T=l.xform(h.topLeft);if(We.setP(g,T,p),We.isPointInside(o))continue;if(p.distance_to(o)<r)return{item:c,handle:it.BOTTOM_RIGHT_ROTATE};if(E.distance_to(o)<r)return{item:c,handle:it.TOP_RIGHT_ROTATE};if(g.distance_to(o)<r)return{item:c,handle:it.BOTTOM_LEFT_ROTATE};if(T.distance_to(o)<r)return{item:c,handle:it.TOP_LEFT_ROTATE}}}return null};function I1(e,n,s,i,r=!1){const o=[];for(let a=0,c=s.length;a<c;a++){const l=s[a],h=fn.dataStore.getById(l);if(!e.hidden.get(l)&&!(r&&e.locked.get(l)))if(h.isLineElement()){const p=e.transform.get(l),E=h.get("geometry").get("mesh"),g=Array.from(E.edges.values());for(let T=0;T<g.length;T++){const A=p.world.xform(E.getVertPos(g[T].v.id)),m=p.world.xform(E.getVertPos(g[T].w.id));if(i.intersects_segment(A,m)){o.push(l);break}}}else{const p=n.get(l),E=e.bounds.get(l).local,g=e.bounds.get(l).world;if(p.parent&&p.parent.item.clipping){const T=e.bounds.get(p.parent.id).world;g.clip_by(T)}if(g.is_zero())continue;if(i.containsRect(g))o.push(l);else if(i.overlaps(g)){let T=!1;const A=e.transform.get(l),m=A.world.xform(E.actualTopLeft()),O=A.world.xform(E.actualTopRight()),S=A.world.xform(E.actualBottomRight()),y=A.world.xform(E.actualBottomLeft()),v=[[m,O],[O,S],[S,y],[y,m]];for(let M=0;M<4;M++){const[L,P]=v[M];if(i.intersects_segment(L,P)){o.push(l),T=!0;break}}if(T)continue;const R=i.actualTopLeft();if(We.set(m.x,m.y,O.x,O.y,y.x,y.y),We.isPointInside(R)){o.push(l);continue}}}}return o}function S1(e,n,s,i,r){const a=e.transform.get(n.id).local;return new ye(a.tx,a.ty-r[1]/i,s?r[0]/i:0,s?r[1]/i:0)}function oG(e,n,s,i,r){const o=xr.VERT_HALF_BOX_WIDTH/i.scale,a=n.vertices,c=[];for(const l of a){const d=e.transform.get(s.id).world.xform(n.getVertPos(l.id));pd.set(r.x-o,r.y-o,2*o,2*o),pd.contains(d)&&c.push(l)}return c}function aG(e,n,s){const i=xr.ORIGIN_HALF_BOX_WIDTH/fn.viewport.scale,r=[];for(const o of s){const a=o.item.transform.worldPivot;pd.set(n.x-i,n.y-i,2*i,2*i),pd.contains(a)&&r.push(o)}return r}function cG(e,n,s,i,r,o=!1){const a=xr.VERT_HALF_BOX_WIDTH/i.scale,l=e.transform.get(s.id).world,h=[];for(const d of n.vertices){const p=l.xform(n.getVertPos(d.id));(o&&r.contains(p)||!o&&r.overlaps(Zn.set(p.x-a,p.y-a,2*a,2*a)))&&h.push(d)}return h}function lG(e,n){const s=e.guidelines[n.direction===ut.HORIZONTAL?"horizontal":"vertical"];s.map.set(n.id,n.position),s.isDirty=!0}function hG(e,n){Object.entries(e.guidelines).forEach(([,s])=>{s.map.has(n)&&(s.map.delete(n),s.isDirty=!0)})}function uG(e,n){let s="",i="";if(e.guidelines.horizontal.sortedDataWorld.length){const r=n.y,o=fd(e.guidelines.horizontal.sortedDataWorld,r,1);Math.abs(o[1]-r)<xr.GUIDELINE_WIDTH/fn.viewport.projectionTransform.a&&(s=o[0])}if(e.guidelines.vertical.sortedDataWorld.length){const r=n.x,o=fd(e.guidelines.vertical.sortedDataWorld,r,1);Math.abs(o[1]-r)<xr.GUIDELINE_WIDTH/fn.viewport.projectionTransform.d&&(i=o[0])}return[s,i]}function dG(e,n){let s=null,i=null;return e.guidelines.horizontal.sortedDataWorld.length&&(s=fd(e.guidelines.horizontal.sortedDataWorld,n.y,1)),e.guidelines.vertical.sortedDataWorld.length&&(i=fd(e.guidelines.vertical.sortedDataWorld,n.x,1)),{closestHorizontal:s,closestVertical:i}}function fd(e,n,s){let i=0,r=e.length-1;for(;i<=r;){const c=Math.floor((i+r)/2),l=e[c][s];if(l===n)return e[c];l<n?i=c+1:r=c-1}if(i>=e.length)return e[r];if(r<0)return e[i];const o=e[i][s],a=e[r][s];return Math.abs(o-n)<Math.abs(a-n)?e[i]:e[r]}const JE=new Ov,pd=new ye(0,0,0,0),Zn=new ye,We=new jE,pt=new N,It=new N,Kt=new N,pn=new N,ko=new Ce,fG={[et.RECTANGLE]:Le.PATH,[et.ELLIPSE]:Le.PATH,[et.PEN]:Le.PATH,[et.TEXT]:Le.TEXT,[et.CONTAINER]:Le.CONTAINER},pG={[et.RECTANGLE]:gn.RECTANGLE,[et.ELLIPSE]:gn.ELLIPSE,[et.PEN]:gn.POLYGON,[et.TEXT]:gn.TEXT,[et.CONTAINER]:void 0},EG={width:1,height:1};function gG(e,n,s,i){const{dataStore:r}=e;let o,a=!1,c=!1;const l=new N,h=new N,d=v=>{r.get("mode")!=="ACTION"&&(o=v)},p=(v=!0)=>{o&&(o=void 0,a=!1,c=!1,g=null,T=!1,i("default"),v&&r.eam.setLastGeneralTool())},E=v=>{let R;if(o===et.TEXT){const M=r.editor.cacheFontProps;R={width:0,height:Math.round(M.fontSize*M.lineHeight)}}if(c||(g=$E(v,o,e,R),e.indexer.updateTransformRecursively(e.indexer.getNode(g.get("id"))),g.get("parent").recalculateBounds()),o===et.CONTAINER){const{startPos:M,endPos:L}=c?y(T):{startPos:l,endPos:l.clone().add(100,100)};s.start({mousePos:M}),s.insideContainer=!0;const P=s.update({mousePos:L},{alt:!0},!1,!0);s.insideContainer=!1,s.end(!1),r.addElementsToContainer(r.sortElements([...P]),g),r.commitUndo(),r.isDesignMode&&e.updateUpdateLevel(ds.UPDATE_ALL_NEED_BBOX_RECALC)}};r.eam.on(Y.ACTIVATE_RECTANGLE_TOOL,()=>{d(et.RECTANGLE)}),r.eam.on(Y.ACTIVATE_CONTAINER_TOOL,()=>{d(et.CONTAINER)}),r.eam.on(Y.ACTIVATE_ELLIPSE_TOOL,()=>{d(et.ELLIPSE)}),r.eam.on(Y.ACTIVATE_TEXT_TOOL,()=>{d(et.TEXT)});let g=null,T=!1;r.eam.on(Y.START_CREATE_ELEMENT,v=>{a=!0,l.copy(v.mousePos),h.copy(v.mousePos)}).on(Y.UPDATE_CREATE_ELEMENT,(v,R,{snapToGrid:M=!0,snapToObject:L=!0})=>{c||(g=$E(l,o,e,EG,!1,M),e.updateTransformRecursively(g.get("id")),n.setHandle("BOTTOM_RIGHT"),n.ignoreActiveTool=!0,n.resizeStart(v,M,L)),c=!0,n.resizeUpdate(v,R,M,L),h.copy(v.mousePos),T=R.alt}).on(Y.END_CREATE_ELEMENT,()=>{const v=o===et.CONTAINER,R=o===et.TEXT;n.resizeEnd(!v&&(!R||c)),a&&(E(h),p())}),r.eam.on(Y.CREATE_ELEMENT_W_DEFAULT_SIZE,v=>{T=!1,l.copy(v.mousePos),h.copy(v.mousePos),E(v.mousePos),p()});let A=null,m=null;const{viewport:O}=e,S=new N;r.eam.on(Y.START_CREATE_GUIDE,v=>{m=null,A=null,l.copy(v.mousePos),v.mousePos.x<dt.size&&v.mousePos.y>=dt.size?A=ut.VERTICAL:v.mousePos.y<dt.size&&v.mousePos.x>=dt.size&&(A=ut.HORIZONTAL)}).on(Y.UPDATE_CREATE_GUIDE,(v,R,{snapToGrid:M=!0,snapToObject:L=!0})=>{const P=O.toWorld(v.mousePos);if(m){const k=e.dataStore.selection.get("hoverGuideline");M&&(A===ut.HORIZONTAL?P.y=Math.round(P.y):P.x=Math.round(P.x));const Q=P.clone();if(Q.sub(S),L){e.snapping.updateSnapMovingDataForGuides();const b=e.snapping.compareVerticesWithGuides(k,Q,M);Number.isFinite(b)&&(k.direction===ut.VERTICAL?Q.x+=b:Q.y+=b)}r.guidelines.moveMultiGuidelines([k],Q),S.add(Q)}else{A===ut.VERTICAL?v.mousePos.x>=dt.size&&(m=r.guidelines.createGuideline(A,P.x),S.copy(O.toWorld(v.mousePos))):A===ut.HORIZONTAL&&v.mousePos.y>=dt.size&&(m=r.guidelines.createGuideline(A,P.y),S.copy(O.toWorld(v.mousePos)));const k=e.dataStore.guidelines.getGuideline(m);e.dataStore.selection.set("hoverGuideline",k),r.eam.changeHover(Gt.GUIDELINE)}}).on(Y.END_CREATE_GUIDE,()=>{r.commitUndo()});function y(v){if(!v)return{startPos:l,endPos:h};const R=l.clone(),M=h.clone(),L=M.clone().sub(R);return{startPos:R.clone().sub(L),endPos:M}}}function _G(e){const n=HG(e),s=n.children.length;return{parent:n,index:s}}function $E(e,n,s,i,r=!0,o=!0){const{dataStore:a,viewport:c}=s,l=fG[n],h=c.toWorld(e);o&&h.round(),s.indexer.getActiveScreenNode().item.transform.worldInv.xform(h,h);const{parent:d,index:p}=_G(h),E=[a.createNewElement(l,h,i,pG[n])],g=a.workspace.watched.children[0];if(a.addChildrenAt(g,E,g.children.length,_n),d!==g&&!a.addChildrenAt(d,E,p,_n)){console.warn("Failed to create new element"),a.clearUndo();return}return a.selection.selectElements(E,r&&l!==Le.TEXT?{EventFlag:er.FROM_ELEMENT_CREATE}:{..._n,EventFlag:er.FROM_ELEMENT_CREATE}),l===Le.TEXT&&a.eam.activateTextEditMode(!0),E[0]}const Is=Object.freeze({NONE:-1,Vertex:0,Edge:1,Contour:2,SameAxis:3}),Vi=new ne;class TG{constructor(n){this.visualServer=n,this.mesh=void 0,this.mapEdge2TreeItem=new Map,this.dirty=!1,this.setDirtyFunc=this.setDirty.bind(this),this.onMeshChangedFunc=this.onMeshChanged.bind(this),this.positionStaticBuffer=new N,this.positionStaticBuffer2=new N,this.vertexHittest=null}assign(n,s,i){this.clear(),this.element=n,this.mesh=s,this.node=i,s||console.error("No mesh is specified to the SnappingPath"),this.createEdgeTree(),this.node.transform.on("updateWorld",this.setDirtyFunc),this.element.get("geometry").on(me.MESH_CHANGES,this.onMeshChangedFunc)}cancel(){this.clear(),this.node&&this.node.transform.off("updateWorld",this.setDirtyFunc),this.element&&this.element.get("geometry").off(me.MESH_CHANGES,this.onMeshChangedFunc),this.element=null,this.mesh=null,this.node=null}createEdgeTree(){const n=this.element.get("size");for(const s of this.mesh.edges){const i={bbox:new ye,edge:s};this.mapEdge2TreeItem.set(s,i),this._fillEdgeTreeItem(s,n,i)}}updateEdgeTree(){const n=this.element.get("size");for(const[s,i]of this.mapEdge2TreeItem)this._fillEdgeTreeItem(s,n,i)}_fillEdgeTreeItem(n,s,i){const r=this.node.transform.world,o=new ye;return n.isCurve?this._fillCurveTreeItem(n,s,r,i,o):this._fillLineTreeItem(n,s,o,r,i)}_fillCurveTreeItem(n,s,i,r,o){const a=this.mesh.getEdgeCurve(n.id),c=new N(a[0].x,a[0].y),l=new N(a[1].x,a[1].y),h=this.mesh.getVertPos(n.v.id),d=new N(h.x,h.y),p=this.mesh.getVertPos(n.w.id),E=new N(p.x,p.y);i.xform(c,c),i.xform(l,l),i.xform(d,d),i.xform(E,E),r.bezier=new Bt(d.x,d.y,c.x,c.y,l.x,l.y,E.x,E.y);const g=r.bezier.bbox();return o.set(g.x.min,g.y.min,g.x.max-g.x.min,g.y.max-g.y.min),r.bbox.copy(o),r}_fillLineTreeItem(n,s,i,r,o){const a=this.mesh.getVertPos(n.v.id),c=a.x,l=a.y,h=this.mesh.getVertPos(n.w.id),d=h.x,p=h.y,E=Math.max(c,d),g=Math.min(c,d),T=Math.max(l,p),A=Math.min(l,p),m=5;i.set(g,A,Math.max(m,E-g),Math.max(m,T-A));const O=r.xform_rect(i);return o.bbox.copy(O),o}clear(){this.mapEdge2TreeItem.clear()}update(){this.dirty&&(this.dirty=!1,this.updateEdgeTree())}setDirty(){this.dirty=!0}onMeshChanged(n){n.DELETE.size!==0||n.CREATE.size!==0?(this.clear(),this.createEdgeTree()):this.dirty=!0}snapMousePos(n,s,i){const r={type:Is.NONE,position:this.positionStaticBuffer},o={type:Is.NONE,position:this.positionStaticBuffer2};if(!i)return o;const a=this.visualServer.snapping,c=this._getThreshold(this.visualServer.viewport.scale),l=this.visualServer.snapping._convertPosToUIPanelVersion(n);return s&&l.round(),this._snapOnEdge(l,r,c),this._snapOnSameAxis(a,n,o,[{pos:l}],l,s),r.type===Is.Edge?(o.type===Is.SameAxis&&this._snapOnSameAxisEdge(a,r,o),r):o}_snapOnSameAxisEdge(n,s,i){const r=s.edge,o=this._getThreshold(this.visualServer.viewport.scale);if(n.snapToElementXUI.size>0){const a=i.position.clone().add(0,-o),c=i.position.clone().add(0,o);if(r.isCurve){const l=r._bezier.lineIntersects({p1:a,p2:c});if(l.length>0){const h=new N().copy(r._bezier.get(l[0]));if(s.position.distance_squared_to(h)<=o*o){const d=this.visualServer.snapping._convertPosToUIPanelVersion(h);s.position.copy(d),n.snapToElementXUI.has(d.x)&&(n.snapToElementXUI.get(d.x).delete(i.position.y),n.snapToElementXUI.get(d.x).set(d.y,0))}else n.snapToElementXUI.clear()}else n.snapToElementXUI.clear()}else{const{q1:l,q2:h}=N1(this.mesh,r,this.node.transform.world);let d=Qn.intersect(a.x,a.y,c.x,c.y,l.x,l.y,h.x,h.y);if(l.x-h.x===0&&i.position.x===l.x&&(d=i.position.clone()),d&&s.position.distance_squared_to(d)<=o*o){const p=this.visualServer.snapping._convertPosToUIPanelVersion(d);s.position.copy(p),n.snapToElementXUI.has(p.x)&&(n.snapToElementXUI.get(p.x).delete(i.position.y),n.snapToElementXUI.get(p.x).set(p.y,0))}else n.snapToElementXUI.clear()}}if(n.snapToElementYUI.size>0){const a=i.position.clone().add(-o,0),c=i.position.clone().add(o,0);if(r.isCurve){const l=r._bezier.lineIntersects({p1:a,p2:c});if(l.length>0){const h=new N().copy(r._bezier.get(l[0]));if(s.position.distance_squared_to(h)<=o*o){const d=this.visualServer.snapping._convertPosToUIPanelVersion(h);s.position.copy(d),n.snapToElementYUI.has(d.y)&&(n.snapToElementYUI.get(d.y).delete(i.position.x),n.snapToElementYUI.get(d.y).set(d.x,0))}else n.snapToElementYUI.clear()}else n.snapToElementYUI.clear()}else{const{q1:l,q2:h}=N1(this.mesh,r,this.node.transform.world);let d=Qn.intersect(a.x,a.y,c.x,c.y,l.x,l.y,h.x,h.y);if(l.y-h.y===0&&i.position.y===l.y&&(d=i.position.clone()),d&&s.position.distance_squared_to(d)<=o*o){const p=this.visualServer.snapping._convertPosToUIPanelVersion(d);s.position.copy(p),n.snapToElementYUI.has(p.y)&&(n.snapToElementYUI.get(p.y).delete(i.position.x),n.snapToElementYUI.get(p.y).set(p.x,0))}else n.snapToElementYUI.clear()}}}_snapOnSameAxis(n,s,i,r=[],o,a){const c=this.visualServer.viewport.rectW.clone(),l=18/this.visualServer.viewport.scale,h=this._getThreshold(this.visualServer.viewport.scale),p=this.visualServer.getRenderItemOfElement(this.element).transform.world,g=n._convertPosToUIPanelVersion(s).clone().sub(o);let T,A,m=!1,O=!1,S=h,y=h,v=s.x,R=s.y;const M=[],L=[];let P=!1,k=!1;const Q=new N;for(let b=0;b<r.length;b++){T=void 0,A=void 0;const X=r[b],K=X.id?new N().fromArray(this.mesh.getVertPos(X.id)):X.pos,V=this.visualServer.snapping._convertPosToUIPanelVersion(g.clone().add(K));X.id&&p.xform(V,V);const J=C1(c,l,V,h),ge=Ed(this.mesh,J,p);for(const te of ge){if(r.indexOf(te)!==-1||te.isFlagged(Ge.CURVE_VERT))continue;const ie=dh(this.mesh,p,te),re=this.visualServer.snapping._convertPosToUIPanelVersion(ie);if(a&&!Number.isInteger(re.x))continue;const fe=Math.abs(re.x-V.x);if(fe<=S&&fe<h){const Ne=re.x-V.x;(!P||Ne!==Q.x)&&(P&&fe!==S&&(M.length=0,n.snapToElementXUI.clear()),Q.x=Ne,S=fe,P=!0),T=re.x,n._addSnapXUIData(re.x,re.y,n.snapToElementXUI),m=!0}}const se=y1(c,l,V,h),ue=Ed(this.mesh,se,p);for(const te of ue){if(r.indexOf(te)!==-1||te.isFlagged(Ge.CURVE_VERT))continue;const ie=dh(this.mesh,p,te),re=this.visualServer.snapping._convertPosToUIPanelVersion(ie);if(a&&!Number.isInteger(re.y))continue;const fe=Math.abs(re.y-V.y);if(fe<=y&&fe<h){const Ne=re.y-V.y;(!k||Ne!==Q.y)&&(k&&fe!==y&&(L.length=0,n.snapToElementYUI.clear()),Q.y=Ne,y=fe,k=!0),A=re.y,n._addSnapYUIData(re.x,re.y,n.snapToElementYUI),O=!0}}T!==void 0&&M.push(new N(T,V.y)),A!==void 0&&L.push(new N(V.x,A))}for(const b of M)n._addSnapXUIData(b.x,b.y+Q.y,n.snapToElementXUI);for(const b of L)n._addSnapYUIData(b.x+Q.x,b.y,n.snapToElementYUI);(m||O)&&(v=s.x+Q.x,R=s.y+Q.y,i.position.set(v,R),i.type=Is.SameAxis)}snapDraggingVertex(n,s,i,r,o,a,c){const l={type:Is.NONE,position:this.positionStaticBuffer};if(!o)return l;const h=this.visualServer.snapping,d=new Map,p=new N(n.x-s.x,n.y-s.y);for(const A of i){const m=dh(a,c,A);m.add(p),d.set(A,m)}const E=this._getThreshold(this.visualServer.viewport.scale);this._snapOnSameAxis(h,n,l,i,s,r);let g=E;const T={type:Is.NONE,position:new N,sourcePos:new N};for(const[A,m]of d){const O=this._snapOnEdge(m,T,g,i);if(O<g){g=O;const S=this.mesh.getVertPos(A.id);T.sourcePos.fromArray(S),c.xform(T.sourcePos,T.sourcePos)}}return T.type===Is.Edge?(l.type===Is.SameAxis&&this._snapOnSameAxisEdge(h,T,l),T):l}_getPosAlignAxes(n,s,i,r,o){let a=i,c=i,l=0,h=0,d=!1;const E=this.visualServer.getRenderItemOfElement(this.element).transform.world;for(const T of r.values()){const A=o._convertPosToUIPanelVersion(T),m=C1(n,s,T,i),O=Ed(this.mesh,m,E);for(const v of O){if(v.isFlagged(Ge.CURVE_VERT)||r.has(v))continue;const R=dh(this.mesh,E,v),M=this.visualServer.snapping._convertPosToUIPanelVersion(R),L=Math.abs(M.x-A.x);L<a&&(a=L,l=R.x-T.x,d=!0)}const S=y1(n,s,T,i),y=Ed(this.mesh,S,E);for(const v of y){if(v.isFlagged(Ge.CURVE_VERT)||r.has(v))continue;const R=dh(this.mesh,E,v),M=this.visualServer.snapping._convertPosToUIPanelVersion(R),L=Math.abs(M.y-A.y);L<c&&(c=L,h=R.y-T.y,d=!0)}}return{alignDelta:new N(l,h),isAligned:d}}_snapOnEdge(n,s,i,r=[]){const o=[];for(const[c,l]of this.mapEdge2TreeItem)if(l.bbox.contains(n)&&o.push(l),l.bbox.height===0||l.bbox.width===0){const h=new ye(n.x,n.y).grow_to(i);l.bbox.intersects(h)&&o.push(l)}let a=i;for(const c of o){if(!c.edge)continue;const l=c.edge;if(!(r.indexOf(l.v)!==-1||r.indexOf(l.w)!==-1))if(l.isCurve){const h=c.bezier;if(!h){console.error(`No bezier found for ${l.id}`);continue}const d=h.project(n);Math.abs(d.d)<a&&(a=d.d,s.type=Is.Edge,s.edge=l,s.position.set(d.x,d.y),s.timeOnEdge=d.t)}else{this.mesh.getVertPos(l.v.id,Vi);const h=Vi.x,d=Vi.y;this.mesh.getVertPos(l.w.id,Vi);const p=Vi.x,E=Vi.y,g=new N(h,d),T=new N(p,E);if(this.node.transform.world.xform(g,g),this.node.transform.world.xform(T,T),g.equals(T))continue;const A=OO(n.x,n.y,g.x,g.y,T.x,T.y);if(a>Math.abs(A)){s.type=Is.Edge,s.edge=l,a=A,IO(n.x,n.y,g.x,g.y,T.x,T.y,s.position);const m=new N(T.x-g.x,T.y-g.y),O=new N(s.position.x-g.x,s.position.y-g.y);s.timeOnEdge=O.length()/m.length()}}}return a}findClosestLUT(n,s,i){let r,o=i;for(let a=0;a<s.length;a++){const c=s[a];c.t=a/(s.length-1);const l=n.distance_to(c);l<o&&(o=l,c.i=a,r=c)}return r}refineBinary(n,s,i,r){let o=r,a=i,c=a[o],l=1,h=Number.MAX_SAFE_INTEGER;do{const d=o===0?0:o-1,p=o===a.length-1?a.length-1:o+1,E=a[d].t,g=a[p].t,T=[],A=(g-E)/4;if(A<.001)break;T.push(a[d]);for(let m=1;m<=3;m++){const O=n.get(E+m*A);O.distance=Math.abs(s.distance_to(O)),O.distance<h&&(h=O.distance,c=O,o=m),T.push(O)}T.push(a[p]),a=T}while(l++<25);return c}constraint(n,s,i,r){let o=Number.MIN_VALUE;n.sub(s);const a=new N,c=new N;for(let l=0;l<8;l++){const h=45*l*(Math.PI/180);a.set(Math.cos(h),Math.sin(h));const d=a.dot(n);o<d&&(o=d,c.copy(a))}return i.set(o*c.x,o*c.y),i.scale(100),i.x=i.x<0?-Math.round(-i.x):Math.round(i.x),i.y=i.y<0?-Math.round(-i.y):Math.round(i.y),i.scale(.01),r&&(i.x=i.x<0?-Math.round(-i.x):Math.round(i.x),i.y=i.y<0?-Math.round(-i.y):Math.round(i.y)),i.add(s),i}_getThreshold(n){const s=Math.floor(n*100);if(s<=2)return 200;if(s<=5)return 100;if(s<=10)return 66;if(s<=25)return 21;if(s<=50)return 9;if(s<=75)return 7;if(s<=100)return 4;if(s<=200)return 3;if(s<=400)return 2;if(s<=25600)return 1}}function y1(e,n,s,i){const r=e.x+n;let o=s.y-i*2;o<e.y+n&&(o=e.y+n);const a=e.width-n;let c=i*4;return o+c>e.bottom&&(c=e.bottom-o),new ye(r,o,a,c)}function C1(e,n,s,i){let r=s.x-i*2;r<e.x+n&&(r=e.x+n);const o=e.y+n;let a=i*4;r+a>e.right&&(a=e.right-r);const c=e.height-n;return new ye(r,o,a,c)}function dh(e,n,s){const i=e.getVertPos(s.id),r=new N;return r.set(i[0],i[1]),n.xform(r,r),r}function N1(e,n,s){e.getVertPos(n.v.id,Vi);const i=Vi.x,r=Vi.y;e.getVertPos(n.w.id,Vi);const o=Vi.x,a=Vi.y,c=new N(i,r),l=new N(o,a);return s.xform(c,c),s.xform(l,l),{q1:c,q2:l}}function Ed(e,n,s){const i=[];for(const r of e.vertices){const o=e.getVertPos(r.id),a=s.xform(o);n.contains(a)&&i.push(r)}return i}let ke=null,ct=null,en=null,Pa=null,eg=!1;const Nt=new N,AG=new ye;function mG(e,n){ke=e,OG(n),IG(n),CG(n)}const x1=()=>{$u()};function v1(e){if(!e){Pa&&(Pa.off(me.MESH_CHANGES,x1),Pa=null),ct&&(ct=null),en&&(en.off("size",$u),en.off(me.TRIGGER_VECTOR_FORCE_UPDATE,$u),eg=!1,en.removeIfEmpty()),eg&&console.log("should correct the origin"),en=null,yb(),$r(),ke.snappingPath.cancel();return}en=e,en.on(me.TRIGGER_VECTOR_FORCE_UPDATE,$u),Pa=en.get("geometry"),Pa.execute("startEditing"),ct=Pa.get("mesh"),Pa.on(me.MESH_CHANGES,x1),Sb(en),ke.snappingPath.assign(en,ct,ke.getRenderItemOfElement(en))}function gd(e,n){const s=e.get("mesh"),i=n3(s,ke.getRenderItemOfElement(e),ke.viewport,n),r=[],o=1<<Ge.CONNECT_SELECTED|1<<Ge.SELECTED;for(const a of i){if(a.isFlagged(Ge.CURVE_VERT))if(a.adjacentMainVertex){if(!(a.adjacentMainVertex.flags&o)||a.adjacentMainVertex.pos.eq(a.pos))continue}else console.warn("There is a curve control without real vertex");r.push(a)}return r.length>0?r.sort((a,c)=>a.index-c.index)[0]:null}function OG(e){const n=ke.viewport,s=ke.dataStore;s.selection.on(me.SELECT_CELL,r=>{const o=r.get("vertices").before;if(o.length===1){if(!ct){console.error("Can not deselect node not in the path edit mode");return}ct.vertices.has(o[0])&&!o[0].isFlagged(Ge.CURVE_VERT)&&o[0].upperTierIDs.size===0&&ct.deleteCellsByVertex(o)}});let i;s.on("editMode",r=>{if(r===wn.SHAPE){const o=ke.selection.single;o&&o.element?(e(s.eam.states.activeTool===et.PEN?"penDefault":"default"),v1(o.element)):console.warn("Entrying ShapeState without selected element"),s.get("editMode")!==wn.SHAPE&&console.error("The editMode should be shape mode")}else i===wn.SHAPE&&(v1(null),s.get("editMode")!==wn.ELEMENT&&console.error("The editMode should be element mode"));i=r}),s.eam.on(Y.SELECT_ALL_CELLS,()=>{s.selection.get("guidelines").length?s.selection.selectGuidelines(ke.dataStore.guidelines.getAllGuidelines()):s.selection.selectVertices([...ct.vertices].filter(o=>!o.isFlagged(Ge.CURVE_VERT)))}),s.eam.on(Y.HOVER_CREATE_PATH,({mousePos:r},o,{snapToGrid:a=!0,snapToObject:c=!0})=>{sh(r.x,r.y,a)}),s.eam.on(Y.SWITCH_BEND_TOOL,({mousePos:r})=>{const o=n.toWorld(r),a=gd(ke.selection.first.element,o);s.selection.set("hoverVertex",a),a?a.isFlagged(Ge.CURVE_VERT)?(s.eam.changeHover(Gt.CURVE_CONTROL),e("convertPath")):(s.eam.changeHover(Gt.VERTEX),e("default")):e("default")}),s.eam.on(Y.HOVER_CELL,({mousePos:r},{shift:o=!1},{snapToGrid:a=!0,snapToObject:c=!0})=>{const l=s.eam.states.activeTool===et.PEN,h=s.selection.get("vertices"),d=_d(h),p=n.toWorld(r);if($r(),Uo([]),l){a&&p.round();const m=n.toScreen(p);sh(m.x,m.y,a),e("penDefault")}else e("default");if(s.get("editMode")!==wn.SHAPE)return;const E=gd(ke.selection.first.element,p);if(s.selection.set("hoverVertex",E),Rc([]),E){if(E.isFlagged(Ge.CURVE_VERT))e("default"),s.eam.changeHover(Gt.CURVE_CONTROL),OE(!1);else{let m=Gt.VERTEX;E.upperTierIDs.size>1||(m=Gt.ENDPOINT),s.eam.changeHover(m),m!==Gt.ENDPOINT?e("default"):l&&e(d?"penClose":"penOpen"),OE(l&&c)}s.selection.set("snapTarget",null);return}if(!l){s.selection.set("snapTarget",null);return}const g=ke.snappingPath.snapMousePos(p,a,c),T=g.position.clone();let A=!1;if(l&&o&&d){const m=Td(en,ct,h[0]);ke.snappingPath.constraint(p,m,T,a),Uo([[n.toScreen(m),n.toScreen(T)]]),A=!0,T.equals(g.position)||$r(),g.position.copy(T)}else Uo([]);switch(g.type){case Is.Edge:{g.edge||console.warn("The edge of the target is missing");const m=n.toScreen(g.position);sh(m.x,m.y,a),A||(s.eam.changeHover(Gt.EDGE),s.selection.set("snapTarget",g),e("penAdd"),Rc([g.edge.id]));break}case Is.SameAxis:{const m=n.toScreen(g.position);sh(m.x,m.y,a);break}case Is.NONE:if(A){const m=n.toScreen(T);sh(m.x,m.y,a)}else g.position.copy(p)}s.selection.set("snapTarget",g)}),s.eam.on(Y.SELECT_CELL,(r,{shift:o,alt:a})=>{const c=ke.dataStore.selection,l=c.get("hoverVertex");if(!l){r.handled=!1;return}if(l.isFlagged(Ge.CURVE_VERT)&&l.adjacentMainVertex&&l.adjacentMainVertex.upperTierIDs.size<1){r.handled=!1;return}if(a&&l.isFlagged(Ge.CURVE_VERT)&&ct.prepareVertexPropertyChanges(l.adjacentMainVertex.id,"mirror",pe.INDEPENDENT),o){c.toggleVertices([l]);return}c.get("vertices").includes(l)||c.selectVertices([l])}),s.eam.on(Y.DESELECT_CELL,()=>{ke.dataStore.selection.selectVertices([])}),ke.dataStore.eam.on(Y.TOGGLE_CELL_SELECTION,()=>{const r=ke.dataStore.selection,o=r.get("hoverVertex");o&&r.toggleVertices([o])}),ke.dataStore.eam.on(Y.MOVE_CELL_SELECTION_KEY,r=>{NG(r)})}function IG(e){const n=ke.dataStore,s=n.selection,i=ke.viewport;{const r=new N,o=new N;let a=!1;const c=ke.snapping,l=new N,h=new N;let d,p;n.eam.on(Y.START_DRAG_CELL,E=>{d=s.get("hoverVertex");const g=i.toWorld(E.mousePos);h.copy(Td(en,ct,d)),l.copy(g),r.copy(h),o.set(0,0),c.setSnappingOriginalPos(r),p=ke.getRenderItemOfElement(en).transform.world,Rc([])}).on(Y.UPDATE_DRAG_CELL,({mousePos:E},{shift:g},{snapToGrid:T=!0,snapToObject:A=!0})=>{$r();const m=i.toWorld(E);a=g,o.copy(m).sub(l);const O=gd(ke.selection.first.element,m);e("default"),R1(O,s,p,m,d,h,T,A,r,a)}).on(Y.END_DRAG_CELL,()=>{Uo([]),$r(),c.setEndSnapping(),n.commitUndo()})}n.eam.on(Y.DELETE_CELL,()=>{const r=s.get("vertices");r.length!==0&&(ct.deleteCellsByVertex(r),s.selectVertices([],_n),n.commitUndo())}),n.eam.on(Y.DUPLICATE_CELL,()=>{const r=s.get("vertices");if(r.length===0)return;const o=ct.closureOfCells(r),a=[],c=ke.getRenderItemOfElement(en).transform.world,l=en.get("size");for(const O of o){const S=O.save();switch(S.type=O.type,S.type){case"Vertex":{const y=ct.getVertPos(S.id);Nt.set(y[0],y[1]),c.xform(Nt,Nt),S.pos[0]=Nt.x,S.pos[1]=Nt.y}break;case"Edge":if(S.curve){const y=ct.getEdgeCurve(S.id);Nt.set(y[0][0],y[0][1]),c.xform(Nt,Nt),S.curve[0][0]=Nt.x,S.curve[0][1]=Nt.y,Nt.set(y[1][0],y[1][1]),c.xform(Nt,Nt),S.curve[1][0]=Nt.x,S.curve[1][1]=Nt.y}break}a.push(S)}const h=ke.viewport.rectW,d=Nt,p=AG;p.set();const E=new N;d.set(0,0);let g=0;const T=new N;for(let O=0;O<a.length;O++)a[O].type==="Vertex"&&(p.is_zero()?p.set(a[O].pos[0],a[O].pos[1],0,0):(T.set(a[O].pos[0],a[O].pos[1]),p.expand_to(T)),d.x+=a[O].pos[0],d.y+=a[O].pos[1],g++);d.x/=g,d.y/=g,h.intersects(p)||(E.x=h.center.x-d.x,E.y=h.center.y-d.y);const A={};for(let O=0;O<a.length;O++){const S=a[O];switch(S.type){case"Vertex":Nt.set(S.pos[0],S.pos[1]),Mc(Nt,Nt),A[S.id]=[Nt.x+E.x,Nt.y+E.y];break;case"Edge":S.curve&&(Nt.set(S.curve[0][0],S.curve[0][1]),Mc(Nt,Nt),S.curve[0][0]=Nt.x+E.x,S.curve[0][1]=Nt.y+E.y,Nt.set(S.curve[1][0],S.curve[1][1]),Mc(Nt,Nt),S.curve[1][0]=Nt.x+E.x,S.curve[1][1]=Nt.y+E.y,A[S.id]=[S.curve[0],S.curve[1]]);break}}const m=ct.duplicateCells(a,A,l.x,l.y);s.selectVertices(m,_n),n.commitUndo()})}function R1(e,n,s,i,r,o,a,c,l,h){const d=n.get("vertices"),p=ke.viewport,{delta:E,adjustedMousePos:g}=SG(e,r,p,o,a,c,i,d,s);if(h){const T=l.clone();g.add(E),ke.snappingPath.constraint(i,T,g,a),Uo([[p.toScreen(l),p.toScreen(g)]]);const A=g.sub(o);A.equals(E)||$r(),E.copy(A)}else Uo([]);o.add(E),w1(E,E),ct.moveVertex(d,E.x,E.y)}function SG(e,n,s,i,r,o,a,c,l){const h=new N,d=new N;if(o&&e&&e!==n){Rc([]);const p=Td(en,ct,e);Uo([[s.toScreen(p),s.toScreen(p)]]),h.set(p.x-i.x,p.y-i.y),d.copy(p)}else{r&&a.round();const p=ke.snappingPath.snapDraggingVertex(a,i,c,r,o,ct,l);p.type===Is.Edge&&p.edge&&p.edge.v!==n&&p.edge.w!==n?(h.set(p.position.x-p.sourcePos.x,p.position.y-p.sourcePos.y),Rc([p.edge.id]),d.copy(p.position)):(Rc([]),h.set(a.x-i.x,a.y-i.y),d.copy(a)),p.type===Is.SameAxis&&(h.set(p.position.x-i.x,p.position.y-i.y),d.copy(p.position))}return{delta:h,adjustedMousePos:d}}function $r(){ke.snapping.snapToElementXUI.clear(),ke.snapping.snapToElementYUI.clear()}function yG(e,n,s=!0,i){const r=ke.dataStore.selection.get("hoverVertex"),o=ke.dataStore.selection.get("vertices");if(!_d(o)){vc();return}if(r)r.upperTierIDs.size<2?Nb(r.id,n):vc();else{const a=ke.dataStore.selection.get("snapTarget");if(a&&a.type!==Is.Edge){const c=ke.viewport.toScreen(a.position);Cb(c.x,c.y,n)}else vc()}}function _d(e){return e.length===1&&!e[0].isFlagged(Ge.CURVE_VERT)&&e[0].upperTierIDs.size<2}function CG(e){const n=ke.viewport,s=ke.dataStore,i=s.selection;{const r=new N,o=.99;let a=null,c=null,l=null;const h=(M,L,P=!0)=>{c=null,l=null,vc(),$r();const k=ke.viewport.toWorld(M.mousePos);r.copy(k);const Q=i.get("vertices");if(en){const b=i.get("snapTarget");b&&k.copy(b.position),ct.vertices.size||(en.setBaseProp("translate",{translateX:k.x,translateY:k.y}),en.setBaseProp("dimensions",{width:0,height:0}));const X=Mc(k,Nt);let K;if(_d(Q)){const V=ct.appendLine(Q[0].id,X.x,X.y,!L);K=V.vertex,l=V.curveCtrl}else{const V=ct.edges.size?X:ke.indexer.getRootNode().item.transform.worldInv.xform(k,Nt);K=ct.startNewPath(V.x,V.y)}i.selectVertices([K],_n)}else{$E(M.mousePos,et.PEN,ke,{width:0,height:0},!1,P),ct=s.selection.get("elements")[0].get("geometry").get("mesh"),s.eam.activateShapeMode(_n),s.eam.activatePenTool(uv);const X=[...ct.vertices][0];s.selection.selectVertices([X],_n),eg=!0}},d=(M,L)=>{c=null,l=null,a=null,vc();const P=ke.viewport.toWorld(M.mousePos);r.copy(P);const k=i.get("vertices"),Q=ke.dataStore.selection.get("hoverVertex");if(_d(k))if(k[0].id===Q.id){if(k[0].unlinkedCurveControl){const b=ct.cellTable.get(k[0].unlinkedCurveControl);b&&ct.deleteCellsByVertex([b])}}else{const b=ct.connectVertices(k[0].id,Q.id,!L);b&&(l=b.curveCtrl,a=b.edge)}i.selectVertices([Q],_n)},p=M=>{const L=n.toWorld(M.mousePos);if(r.distance_to(L)<o)return;const P=i.get("vertices")[0];if(!P){M.handled=!1;return}c||(l||(l=ct.falsifyIndCurveCtrl(P)),c=ct.addIndpendentCurveCtrl(P,pe.ANGLE_AND_LENGTH)),e("default"),Mc(L,L),ct.moveIndCurveControl(c,P,l,L.x,L.y,!0)},E=M=>{const L=n.toWorld(M.mousePos);if(r.distance_to(L)<o)return;const P=i.get("vertices")[0];if(!P){M.handled=!1;return}c||(c=l?ct.falsifyIndCurveCtrl(P):ct.addIndpendentCurveCtrl(P,pe.INDEPENDENT)),e("convertPath"),Mc(L,L),ct.moveIndCurveControl(c,P,l,L.x,L.y,!0)};s.eam.on(Y.HOVER_CELL_WITH_SELECTION,(M,{toggle:L,reconnect:P},{snapToGrid:k=!1}={})=>{if(P){const Q=i.get("vertices")[0];Q&&ke.dataStore.selection.selectVertices([Q],_n)}yG(M.mousePos,!L,k)}),s.eam.on(Y.START_DRAW_PATH,(M,{modifier:L},{snapToGrid:P=!0})=>{h(M,L,P)}).on(Y.UPDATE_DRAW_PATH,M=>{p(M)}).on(Y.END_DRAW_PATH,()=>{ct&&ct.hideFakeIndCurveCtrl(),s.commitUndo()}),s.eam.on(Y.START_DRAW_PATH_ON_VERTEX,(M,{modifier:L})=>{d(M,L)}).on(Y.UPDATE_DRAW_PATH_ON_VERTEX,M=>{E(M)}).on(Y.END_DRAW_PATH_ON_VERTEX,()=>{ct&&ct.hideFakeIndCurveCtrl(),a&&(c&&ct&&ct.prepareVertexPropertyChanges(i.get("vertices")[0].id,"mirror",pe.INDEPENDENT,!0),ke.dataStore.selection.selectVertices([],_n)),s.commitUndo()});const g=(M,L,P,k,Q)=>{if(P){if(!Number.isFinite(P[0])||!Number.isFinite(P[1])){console.warn("_updateAffectedCurveControlsData get wrong control vertex posiotion druing action mode from interpolation");return}if(L&&L.x[0].id){const b=s.interaction.getKeyFrame(M),X=sR.cloneDeep(b.value);X.forEach(K=>{K.id===k&&(K.pos[0]=P[0],K.pos[1]=P[1])}),s.interaction.setKeyFrameValue(b.id,X,!1)}else Q[0]=P[0],Q[1]=P[1],en.updateBaseVertex(k,new Map([["pos",{after:P}]]))}},T=(M,L,P)=>{if(!M)return null;const k=s.transition.getStartValueWithCurrentValueAndInterval(M.x,L[0],P),Q=s.transition.getStartValueWithCurrentValueAndInterval(M.y,L[1],P);return[k,Q]},A=M=>{const L=en.get("id"),P=s.selection.selectedActionId,k=s.interaction.getFirstResponseIdByActionId(P),Q=s.interaction.getPropertyTrackMapByElementId(k,L);if(!M.edge.isCurve||!Q||!Q.has("pathMorphing"))return;const b=Q.get("pathMorphing"),X=s.interaction.getPropertyTrackKeyFrameGroupByTime(b),V=Object.keys(X).sort((Ne,At)=>Ne-At>0?1:-1).filter(Ne=>Ne<=s.transition.currentTime),J=V.length>0?V[V.length-1]:null,ge=s.transition.getPropertyWorkingInterval(L,"pathMorphing"),se=ge.get(M.originalCpV.id),ue=ge.get(M.originalCpW.id),te=s.transition.currentTime,ie=T(se,M.leftEdgeCurveControlsPos[0],te),re=T(ue,M.rightEdgeCurveControlsPos[1],te),fe=X&&X[J]?X[J][0]:null;g(fe,se,ie,M.originalCpV.id,M.leftEdgeCurveControlsPos[0]),g(fe,ue,re,M.originalCpW.id,M.rightEdgeCurveControlsPos[1])},m=new N;let O=null,S=null,y=null;const v=M=>{c=null,l=null,a=null,O=null,S=null,y=null,vc(),xb(),OE(!1);const L=ke.viewport.toWorld(M.mousePos);r.copy(L);const P=ke.dataStore.selection.get("snapTarget"),k=ke.dataStore.meshManager.prepareSplitEdgeData(ct,P.edge.id,P.timeOnEdge);k&&(s.isActionMode&&A(k),ke.dataStore.meshManager.splitEdge(ct,k),s.transition.cacheSpecificElementBaseValue(en.get("id"),"pathMorphing"),i.selectVertices([k.midVertex],_n),y=k.midVertex,m.copy(L))},R=({mousePos:M},{shift:L},{snapToGrid:P,snapToObject:k})=>{const Q=n.toWorld(M);if(r.distance_to(Q)<o)return;O||(O=Td(en,ct,y)),S||(S=ke.getRenderItemOfElement(en).transform.world),$r();const b=gd(ke.selection.first.element,Q);e("default"),R1(b,i,S,Q,y,O,P,k,m,L)};s.eam.on(Y.START_DRAW_PATH_ON_EDGE,M=>{v(M)}).on(Y.UPDATE_DRAW_PATH_ON_EDGE,(M,{shift:L},{snapToGrid:P=!0,snapToObject:k=!0})=>{R(M,{shift:L},{snapToGrid:P,snapToObject:k})}).on(Y.END_DRAW_PATH_ON_EDGE,()=>{Uo([]),$r(),ke.snapping.setEndSnapping(),s.commitUndo()})}}function NG(e){const n=ke.dataStore.selection.get("vertices");w1(e,Nt),ct.moveVertex(n,Nt.x,Nt.y),ke.dataStore.debounceCommitUndo()}function Mc(e,n){ke.getRenderItemOfElement(en).transform.worldInv.xform(e,n);const i=en.get("referencePoint");return n.subtract(i),n}function w1(e,n){return ke.getRenderItemOfElement(en).transform.worldInv.basis_xform(e,n)}function Td(e,n,s){const i=n.getVertPos(s.id),r=new N;return r.set(i[0],i[1]),ke.getRenderItemOfElement(e).transform.world.xform(r,r),r}let D1=null,fh=null;const xG=new N;function vG(e,n,s){const{dataStore:i,viewport:r}=e;D1=n,fh=e;let o=null;i.eam.on(Y.HOVER_ORIGIN,a=>{i.data.hideOrigin||i.getFeature("editOrigin")&&(o=RG(r.toWorld(a.mousePos)),vU(o),o&&(s("arrowMove"),i.eam.changeHover(Gt.ORIGIN)))});{const a=new Ce;let c=null,l=null,h=null;const d=new N,p=fh.snapping,E=new N,g=(m,O)=>{const S={},y=xG.copy(m).sub(E),v=wG(c,l),R=p.snapAxisAndDiagonal(y,O,"ORIGIN");y.copy(R),y.add(E).sub(d);const M=c.transform.worldInv.basis_xform(y),L=c.transform.scale;(L.x===0||L.y===0)&&(M.copy({x:L.x===0?0:y.x,y:L.y===0?0:y.y}),a.a=L.x===0?1:a.a,a.d=L.y===0?1:a.d);const P=v.x+M.x,k=v.y+M.y,Q=l.get("referencePoint");S.contentAnchorX=P-Q[0],S.contentAnchorY=k-Q[1];const b=i.drawInfo.getFixedPositionByChanges(l.get("id"),S);S.translateX=b.x,S.translateY=b.y,i.beginChangeGroup(),l.sets(S),i.endChangeGroup(),d.add(y)},T=m=>{o?(c=e.getRenderItem(o),l=i.getById(o),d.copy(r.toWorld(m.mousePos)),c.transform.getInnerT(a),E.copy(d),p.setSnappingOriginalPos(c.transform.worldPivot),h=g):m.handled=!1},A=()=>{h=null,p.setEndSnapping(),i.commitUndo()};i.eam.on(Y.START_DRAG_ORIGIN,T).on(Y.UPDATE_DRAG_ORIGIN,(m,{shift:O})=>h(r.toWorld(m.mousePos),O)).on(Y.END_DRAG_ORIGIN,A)}}function RG(e){const n=[];for(const i of fh.dataStore.selection.get("elements"))n.push(D1.state.scene.node_bank.get(i.get("id")));const s=s3(e,n);return s.length===0||(s.sort((i,r)=>i.item.transform.translate.distance_squared_to(e)-r.item.transform.translate.distance_squared_to(e)),fh.dataStore.getById(s[0].id).isLocked()||fh.dataStore.getById(s[0].id).get("elementType")===Le.SCREEN)?null:s[0].id}function wG(e,n){const{referencePoint:s,contentAnchor:i}=n.gets("referencePoint","contentAnchor"),r=new N;r.copy(s).add(i);const{translate:o,rotation:a,scale:c,skew:l}=e.transform;return new Ce().copy(e.transform.parent).translate_right(o.x,o.y).rotate_right(a).skew_right(wt(l.x),wt(l.y)).scale_right(c.x,c.y).translate_right(-r.x,-r.y),r}let Se,He,ph;function DG(e,n){const{dataStore:s,viewport:i}=e;Se=e,He=new jU(e),mG(Se,n),vG(Se,He,n),Kb(n),s.eam.on(Y.INCREASE_CORNER_RADIUS,()=>{const l=s.selection.get("elements");for(const h of l){if(!h.get("geometry"))return;const p=s.selection.get("vertices");if(p.length>0)for(const E of p){let g=E.cornerRadius===null?h.get("cornerRadius"):E.cornerRadius;g+=1,E.cornerRadius=g,console.log(`DEBUG: Increase corner radius: ${g}`)}else{const E=h.get("cornerRadius")+1;h.set("cornerRadius",E),console.log(`DEBUG: Increase corner radius: ${E}`)}}}),s.eam.on(Y.DECREASE_CORNER_RADIUS,()=>{const l=s.selection.get("elements");for(const h of l){if(!h.get("geometry"))return;const p=s.selection.get("vertices");if(p.length>0)for(const E of p){let g=E.cornerRadius===null?h.get("cornerRadius"):E.cornerRadius;g=Math.max(0,g-1),E.cornerRadius=g,console.log(`DEBUG: Decrease corner radius: ${g}`)}else{const E=Math.max(0,h.get("cornerRadius")-1);h.set("cornerRadius",E),console.log(`DEBUG: Decrease corner radius: ${E}`)}}}),s.eam.on(Y.SELECT_ALL_ELEMENTS,LG),s.eam.on(Y.SELECT_PARENT_ELEMENT,()=>{PG()}),s.eam.on(Y.SELECT_CHILD_ELEMENT,()=>{MG()}),s.eam.on(Y.SELECT_FIRST_ELEMENT,()=>{const l=s.workspace.children;s.selection.selectElements([l[l.length-1]])}),s.eam.on(Y.SELECT_NEXT_ELEMENT,()=>{L1("NEXT")}),s.eam.on(Y.SELECT_PREVIOUS_ELEMENT,()=>{L1("PREVIOUS")}),s.eam.on(Y.EDIT_NEXT_TEXT_ELEMENT,(l=!1)=>{if(r3(),s.selection.get("elements").length===1){const h=s.selection.get("elements")[0].get("id"),d=Se.view.getOrCreateDinoTree(h);tt().changeTextEditingNode(d.text_node_id,l)}}),s.eam.on(Y.EDIT_PREVIOUS_TEXT_ELEMENT,(l=!1)=>{if(o3(),s.selection.get("elements").length===1){const h=s.selection.get("elements")[0].get("id"),d=Se.view.getOrCreateDinoTree(h);tt().changeTextEditingNode(d.text_node_id,l)}}),s.eam.on(Y.HOVER_RULER,({mousePos:l})=>{(l.x<dt.size&&l.y>=dt.size||l.x>=dt.size&&l.y<dt.size)&&(n("ruler"),s.eam.changeHover(Gt.RULER),s.selection.set("hover",null))}),s.eam.on(Y.HOVER_GUIDELINE,({mousePos:l})=>{const h=Se.viewport.toWorld(l),[d,p]=uG(He.state,h);let E=null;if(d.length>0&&p.length>0){const g=s.guidelines.getGuideline(d),T=s.guidelines.getGuideline(p);E=g.index>T.index?g:T}else p.length>0?E=s.guidelines.getGuideline(p):d.length>0&&(E=s.guidelines.getGuideline(d));E?(n("ruler"),s.selection.set("hoverGuideline",E),s.eam.changeHover(Gt.GUIDELINE),s.selection.set("hover",null),s.selection.set("hoverMotionPoint",null)):s.selection.set("hoverGuideline",null)}),s.eam.on(Y.HOVER_ELEMENT,({mousePos:l},h)=>{const d=i.toWorld(l),p=s.getById(m1(He.state,d,e.selection,!1));if(s.eam.changeHoverSelected(p),Se.dataStore.get("activeTool")===et.TEXT&&!s.eam.states.hoverSelected){He.state.hovered=null;return}if(e.selection.anySelected)nG(He.state,d,e.selection,h.modifier);else if(s.workspace.isEmpty())He.state.hovered=null;else{let g=He.state.scene.node_bank.get(He.state.scene.root);g.item.isWorkspace()&&(g=He.state.scene.node_bank.get(g.children[0].id)),g1(He.state,h.modifier,d,g.id,!1)}const E=s.getById(He.state.hovered);s.selection.set("hover",E),E?s.eam.changeHover(Gt.ELEMENT):s.eam.states.elementSelection===yf.MULTIPLE&&Se.selection.bounds.has_point(d)&&e.dataStore.get("activeTool")!==et.SCALE&&s.eam.changeHover(Gt.MULTIPLE_SELECTION_BOUND),n("default"),h.alt&&s.eam.hoverType===Gt.ELEMENT&&E&&!E.isScreen&&s.get("editMode")===wn.ELEMENT?n("duplicate"):[et.RECTANGLE,et.ELLIPSE,et.CONTAINER,et.TEXT].includes(s.eam.states.activeTool)&&!E?n("crosshair"):s.selection.get("textRange")!==null&&(E!=null&&E.isText)?n("text"):n("default")}),s.eam.on(Y.DRAG_OVER,({mousePos:l})=>{const h=i.toWorld(l);let d=He.state.scene.node_bank.get(He.state.scene.root);d.item.isWorkspace()&&(d=He.state.scene.node_bank.get(d.children[0].id)),T1(He.state,h,d.id);const p=s.getById(He.state.hovered);s.selection.set("dragOver",p)}),s.eam.on(Y.DRAG_END,()=>{He.state.hovered=null,s.selection.set("dragOver",null)}),s.eam.on(Y.DROP_WITH_FILES,({mousePos:l})=>{const h=i.toWorld(l);let d=He.state.scene.node_bank.get(He.state.scene.root);d.item.isWorkspace()&&(d=He.state.scene.node_bank.get(d.children[0].id)),T1(He.state,h,d.id);const p=s.getById(He.state.hovered);s.selection.set("dragOver",p)}),s.eam.on(Y.DOUBLE_LEFT_CLICK,l=>{if(s.eam.states.editMode===wn.SHAPE){s.eam.activateElementEditMode();return}const h=s.selection.get("elements"),d=i.toWorld(l.mousePos);if(!e.selection.first)return;g1(He.state,l.modifier,d,e.selection.first.id,!0);const p=s.getById(He.state.hovered),E=s.selection.get("textRange")!==null,g=s.eam.states.activeTool;if(!p)return;switch(p.get("elementType")){case Le.SCREEN:case Le.CONTAINER:s.selection.set("hover",p),s.selection.selectElements([p]);break;case Le.TEXT:(!E||g!==et.TEXT||!s.eam.states.hoverSelected)&&(s.selection.set("hover",p),s.selection.selectElements([p]),s.eam.activateTextEditMode(!0));break;case Le.PATH:if(!h.includes(p)){s.selection.set("hover",p),s.selection.selectElements([p]);return}if(s.isEditingMode&&s.isActionMode){s.eam.activateShapeMode();return}if(s.selection.selectElements([p],_n),!s.isEditingMode)break;s.eam.states.isShapeMode?s.eam.activateElementEditMode():s.eam.activateShapeMode();break}l.handled=!1});const r=(l,h,d)=>{h.shift?BG(d):FG(d);const p=s.getById(m1(He.state,i.toWorld(l.mousePos),e.selection,!1));s.eam.changeHoverSelected(p)};s.eam.on(Y.SELECT_ELEMENT,r),s.eam.on(Y.DESELECT_ELEMENT,l=>{s.selection.get("hover")&&(l.handled=!1),GG()});{const l=[],h=new N,d=Se.snapping,p=new N,E=2,g=()=>{o(l),a(d),Se.selection.single&&l[0]?p.copy(l[0].position):p.set(Se.selection.bounds.x,Se.selection.bounds.y)},T=()=>{const k=s.selection.get("hover");k&&s.selection.selectSelector(k,Z_)};s.eam.on(Y.EDIT_SELECTOR,T);let A=null,m=!1,O=!1;const S=new Map,y=new Map,v=new Map;window.initKfMap=v;let R=!1;const M=(k,Q)=>{n(Q.alt?"duplicate":"default"),A=i.toWorld(k.mousePos.clone());const b=s.transition.currentTime;if(s.selection.get("elements").forEach(K=>{const{id:V,translateX:J,translateY:ge}=K.gets("id","translateX","translateY");y.set(V,[J,ge]);const se=s.selection.selectedActionId,ue=s.interaction.getFirstResponseIdByActionId(se),te=s.interaction.getCurrentElementKeyframeAtTime(ue,V,"motionPath",b);v.set(V,te?{id:te.id,value:window.structuredClone(te.value)}:null)}),g(),!l.length)return;const X=l[0].element;FE(X.get("id")),s.selection.set("hover",null)},L=(k,{alt:Q,shift:b},{snapToGrid:X,snapToObject:K})=>{if(!l.length)return;const V=i.toWorld(k.mousePos.clone()),J=V.sub(A);d.updateMoved(J);const ge=V.distance_to(A);if(m=m||ge>=E,!m)return;if(s.beginChangeGroup(),O^Q){if(n(Q?"duplicate":"default"),Q)O=!0,s.selection.get("elements").forEach(At=>{const Ke=At.get("id"),[St,hn]=y.get(Ke),_t=v.get(Ke);if(_t)At.sets({translateX:St,translateY:hn},{updateType:Gs.USER_EDITING}),s.interaction.setKeyFrameValue(_t.id,_t.value);else{const qn=s.transition.currentTime;At.sets({translateX:St,translateY:hn},{updateType:Gs.USER_EDITING});const ni=s.selection.selectedActionId,ys=s.interaction.getFirstResponseIdByActionId(ni),Hi=s.interaction.getCurrentElementKeyframeAtTime(ys,Ke,"motionPath",qn);Hi&&s.interaction.deleteKeyFrame(Hi.id)}}),s.clipboard.duplicate(dv).forEach((At,Ke)=>{S.set(At,Ke)});else{const Ne=s.selection.get("elements"),At=Array.from(y.keys()).map(Ke=>s.getElement(Ke));s.selection.selectElements(At,{commit:!1}),s.selection.get("elements").forEach(Ke=>{const[St,hn]=y.get(Ke.get("id"));Ke.sets({translateX:St+J.x,translateY:hn+J.y},{updateType:Gs.USER_EDITING})}),s.deleteElements(Ne,{commit:!1,updateType:Gs.USER_EDITING}),O=!1,S.clear()}g(),FE(l[0].element.get("id"))}const ue=p.clone(),te=i.toWorld(k.mousePos);h.copy(A);const ie=te.clone().sub(h);X&&(ie.x!==0&&(h.x=Math.round(h.x),te.x=Math.round(te.x)),ie.y!==0&&(h.y=Math.round(h.y),te.y=Math.round(te.y)));const re=te.clone().sub(h),fe=d.snapAxisAndDiagonal(re,b,"ELEMENT");if(re.copy(fe),X){const Ne=d.snapElementsPosToGrid(ue,ie);re.add(Ne)}if(K){d.updateSnapMovingData(!0);const Ne=d.comparingVertices(re,X);re.add(Ne)}s.selection.get("elements").forEach(Ne=>{const At=O?S.get(Ne.get("id")):Ne.get("id"),[Ke,St]=y.get(At);if(O){const _t=s.getElement(At).getBaseValue("translate");Ne.setBaseProp("translate",{translateX:_t.translateX+re.x,translateY:_t.translateY+re.y}),s.isActionMode&&(Ne.computedStyle.reload(),s.transition.prepareActionTransition(),s.transition.forceUpdateAnimation())}else Ne.sets({translateX:Ke+re.x,translateY:St+re.y},{updateType:Gs.USER_EDITING})}),s.endChangeGroup(),R=!0},P=()=>{m=!1,O=!1,FE(null),y.clear(),v.clear(),s.commitUndo(),d.setEndSnapping(),d.endSnapMovingElementToElement(),R&&s.isDesignMode&&s.drawInfo.vs.updateUpdateLevel(ds.UPDATE_ALL_NEED_BBOX_RECALC),R=!1};s.eam.on(Y.START_DRAG_ELEMENT,M).on(Y.UPDATE_DRAG_ELEMENT,L).on(Y.END_DRAG_ELEMENT,P),s.eam.on(Y.START_DRAG_MULTI_ELEMENTS,M).on(Y.UPDATE_DRAG_MULTI_ELEMENTS,L).on(Y.END_DRAG_MULTI_ELEMENTS,P)}s.eam.on(Y.MOVE_ELEMENT_SELECTION_KEY,t3),s.eam.on(Y.MOVE_MOTION_POINTS_SELECTION_KEY,e3),ph=new a3(Se),s.eam.on(Y.SWITCH_TEXT_ELEMENT,ph.switchTextElement.bind(ph)),s.eam.on(Y.RESUME_TEXT_EDIT_MODE,ph.resumeTextEditMode.bind(ph));function o(l){var h;l.splice(0);for(const{element:d}of Se.selection.iter()){if(d.get("elementType")===Le.SCREEN)continue;const p=(h=sg(d))==null?void 0:h.get("id"),E=new N,g=new N;p?(Se.drawInfo.toWorldPosition(p,d.get("position"),E),Se.drawInfo.toWorldPosition(p,d.get("translate"),g)):(E.copy(d.get("position")),g.copy(d.get("translate"))),l.push({translate:g,position:E,element:d,parentId:p})}}function a(l){Se.selection.updateBounds(),l.setSnappingOriginalPos(Se.selection.bounds.center),l.setSelectedElementOAB()}(()=>{const l={hoveredGuideline:null,isShiftPressed:!1,hasChangedSelection:!1,initPositionScreen:new N,lastPositionScreen:new N,lastPosition:new N},h=(O,S)=>{const{dataStore:y,viewport:v}=e,R=v.toWorld(O.mousePos);l.initPositionScreen.copy(O.mousePos),l.lastPositionScreen.copy(O.mousePos),l.hoveredGuideline=y.selection.get("hoverGuideline");const M=y.selection.get("guidelines");l.hasChangedSelection=!1,l.lastPosition.copy(R),l.hoveredGuideline.direction===ut.HORIZONTAL?l.lastPosition.y=l.hoveredGuideline.position:l.lastPosition.x=l.hoveredGuideline.position,S.shift&&(M.length>0||S.modifier)?(y.selection.toggleGuidelines([l.hoveredGuideline]),l.hasChangedSelection=!0):S.modifier&&(y.selection.selectGuidelines([l.hoveredGuideline]),l.hasChangedSelection=!0),l.isShiftPressed=S.shift},d=(O,S,{snapToGrid:y=!0,snapToObject:v=!0})=>{if(!l.hoveredGuideline){console.warn("No guides hovered");return}const{dataStore:R,viewport:M}=e;l.lastPositionScreen.copy(O.mousePos),l.lastPositionScreen.x<dt.size||l.lastPositionScreen.x>M.rect.width||l.lastPositionScreen.y<dt.size||l.lastPositionScreen.y>M.rect.height?R.eam.setCursorOverlay({cursor:"not-allowed",behindCanvas:!1}):(R.eam.setCursorOverlay(null),n("ruler"));const L=M.toWorld(O.mousePos);y&&(l.hoveredGuideline.direction===ut.HORIZONTAL?L.y=Math.round(L.y):L.x=Math.round(L.x));const P=R.selection.get("guidelines"),k=L.clone();if(k.sub(l.lastPosition),v){Se.snapping.updateSnapMovingDataForGuides();const Q=Se.snapping.compareVerticesWithGuides(l.hoveredGuideline,k,y);Number.isFinite(Q)&&(l.hoveredGuideline.direction===ut.VERTICAL?k.x+=Q:k.y+=Q)}P.length>0&&P.indexOf(l.hoveredGuideline)!==-1?R.guidelines.moveMultiGuidelines(P,k):R.guidelines.moveMultiGuidelines([l.hoveredGuideline],k),l.lastPosition.add(k),l.isShiftPressed=S.shift},p=()=>{if(l.lastPositionScreen.distance_to(l.initPositionScreen)<=4&&!l.hasChangedSelection){const O=[l.hoveredGuideline];l.isShiftPressed?s.selection.toggleGuidelines(O):s.selection.selectGuidelines(O)}else if(l.hoveredGuideline&&(l.lastPositionScreen.x<dt.size||l.lastPositionScreen.x>i.rect.width||l.lastPositionScreen.y<dt.size||l.lastPositionScreen.y>i.rect.height)){const O=e.dataStore.selection.get("guidelines").map(S=>S.id);O.indexOf(l.hoveredGuideline.id)===-1?(e.dataStore.guidelines.deleteGuidelines([l.hoveredGuideline.id]),e.dataStore.selection.set("hoverGuideline",null),e.dataStore.eam.states.endHover()):(e.dataStore.selection.clearGuidelines({commit:!1}),e.dataStore.guidelines.deleteGuidelines(O))}s.commitUndo()},E=()=>{const O=e.dataStore.selection.get("guidelines").map(S=>S.id);e.dataStore.selection.clearGuidelines({commit:!1}),e.dataStore.guidelines.deleteGuidelines(O),s.commitUndo()},g=()=>{const O=s.selection.get("hoverGuideline");O&&(s.selection.selectGuidelines([O]),s.commitUndo())},T=O=>{const{dataStore:S,viewport:y}=e,v=y.toWorld(O.mousePos);l.initPositionScreen.copy(O.mousePos),l.lastPositionScreen.copy(O.mousePos),l.hoveredGuideline=S.selection.get("hoverGuideline"),l.hasChangedSelection=!1,l.lastPosition.copy(v),l.hoveredGuideline.direction===ut.HORIZONTAL?l.lastPosition.y=l.hoveredGuideline.position:l.lastPosition.x=l.hoveredGuideline.position},A=(O,S,{snapToGrid:y=!0,snapToObject:v=!0})=>{if(!l.hoveredGuideline){console.warn("No guides hovered");return}const{dataStore:R,viewport:M}=e;l.lastPositionScreen.copy(O.mousePos),l.lastPositionScreen.x<dt.size||l.lastPositionScreen.x>M.rect.width||l.lastPositionScreen.y<dt.size||l.lastPositionScreen.y>M.rect.height?R.eam.setCursorOverlay({cursor:"not-allowed",behindCanvas:!1}):(R.eam.setCursorOverlay(null),n("ruler"));const L=M.toWorld(O.mousePos);y&&(l.hoveredGuideline.direction===ut.HORIZONTAL?L.y=Math.round(L.y):L.x=Math.round(L.x));const P=L.clone();if(P.sub(l.lastPosition),v){Se.snapping.updateSnapMovingDataForGuides();const k=Se.snapping.compareVerticesWithGuides(l.hoveredGuideline,P,y);Number.isFinite(k)&&(l.hoveredGuideline.direction===ut.VERTICAL?P.x+=k:P.y+=k)}R.guidelines.moveMultiGuidelines([l.hoveredGuideline],P),l.lastPosition.add(P)},m=()=>{l.hoveredGuideline&&(l.lastPositionScreen.x<dt.size||l.lastPositionScreen.x>i.rect.width||l.lastPositionScreen.y<dt.size||l.lastPositionScreen.y>i.rect.height)&&(e.dataStore.guidelines.deleteGuidelines([l.hoveredGuideline.id]),e.dataStore.selection.set("hoverGuideline",null),e.dataStore.eam.states.endHover()),s.commitUndo()};return{init:()=>{s.eam.on(Y.START_MOVE_GUIDE,h).on(Y.UPDATE_MOVE_GUIDE,d).on(Y.END_MOVE_GUIDE,p).on(Y.DELETE_GUIDELINES,E).on(Y.DIRECTLY_SELECT_GUIDE,g).on(Y.START_MOVE_GUIDE_WO_SELECT,T).on(Y.UPDATE_MOVE_GUIDE_WO_SELECT,A).on(Y.END_MOVE_GUIDE_WO_SELECT,m)}}})().init()}function tg(e){return!e.get("locked")}function LG(){const e=Se.dataStore.selection,n=e.get("elements"),s=e.get("guidelines");if(n.length){let i;for(const r of n){const o=r.get("parent");if(!i)i=o;else{if(i===o)continue;e.selectElements(Se.dataStore.workspace.children.filter(tg));return}}e.selectElements(i.children.filter(tg))}else s.length?e.selectGuidelines(Se.dataStore.guidelines.getAllGuidelines()):e.selectElements(Se.dataStore.workspace.children.filter(tg))}function MG(){const e=Se.dataStore.selection.get("elements");if(!e.length)return;const n=[];e.forEach(s=>{switch(s.get("elementType")){case Le.CONTAINER:case Le.SCREEN:n.push(...s.children);break;default:n.push(s)}}),n.length&&Se.dataStore.selection.selectElements(n)}function PG(){const e=Se.dataStore.selection.get("elements");if(!e.length)return;const n=[];e.forEach(s=>{const i=sg(s);i.get("type")!==Us.WORKSPACE&&n.push(i)}),n.length&&Se.dataStore.selection.selectElements(n)}function L1(e){const n=Se.dataStore.selection.get("elements"),s=e==="NEXT"?bG:UG;if(n.length===0){const i=Se.dataStore.workspace.children;Se.dataStore.selection.selectElements([s(i)])}else{const i=n[0].get("parent");if(n.length===1){if(i.children.length>1){const r=i.children.indexOf(n[0]);Se.dataStore.selection.selectElements([s(i.children,r)])}}else n.every(r=>r.get("parent")===i)&&(e==="NEXT"?Se.dataStore.selection.selectElements(n.slice(0,1)):Se.dataStore.selection.selectElements(n.slice(-1)))}}function bG(e,n=-1){for(let s=n+1;s<e.length;s++)if(e[s].get("visible"))return e[s];for(let s=0;s<n;s++)if(e[s].get("visible"))return e[s]}function UG(e,n=e.length){for(let s=n-1;s>=0;s--)if(e[s].get("visible"))return e[s];for(let s=e.length-1;s>n;s--)if(e[s].get("visible"))return e[s]}function GG(){Se.dataStore.selection.clearAllExceptAction()}function FG(e){const n=Se.dataStore.selection,s=n.get("hover");(n.get("elements").length>1||!(s!=null&&s.isText))&&Se.dataStore.eam.activateTextEditMode(!1),n.selectElements(s?[s]:[],e),kG()}function kG(){const e=Se.dataStore.eam;(Se.dataStore.getFeature("editGradient")||e.states.isTextMode)&&e.activateElementEditMode()}function BG(e){const n=Se.dataStore.selection.get("hover");n&&Se.dataStore.selection.toggleElements([n],e)}function VG(e){XG(e)}function HG(e){let n=He.state.scene.node_bank.get(He.state.scene.root);n.item.isWorkspace()&&(n=He.state.scene.node_bank.get(n.children[0].id));const s=_1(He.state,e,n.id);return Se.dataStore.getById(s)}function WG(e){He.state.scene.root=e.id}function YG(e){He.state.scene.addNewNode(He.state.compute,e)}function XG(e){const n=Se.dataStore.getById(e.id),s=n.get("visible")&&!n.get("locked"),i=Se.dataStore.workspace.get("scale"),r=Se.overlay.panes[0],o={fontSize:12,h_align:"left",v_align:"top"},a=r.measureTextImage(n.get("name"),o.fontSize,o.h_align,o.v_align);He.state.scene.addScreenNode(He.state.compute,e,s,i,a)}function zG(){Se.indexer.root&&He.updateScreenNameBounds()}function KG(){Se.indexer.root&&He.updateGuidelines()}function QG(){Se.indexer.root&&He.update()}function ZG(e){He.state.compute.bounds.delete(e),He.state.compute.transform.delete(e),He.state.scene.node_bank.delete(e)}function qG(e,n){return p1(He.state.compute,He.state.scene.node_bank,n,e)}function jG(e){const n=He.state.compute,s=He.state.scene.node_bank,i=[];let r=s.get(He.state.scene.root);if(r.item.isWorkspace()&&(r=s.get(r.children[0].id)),e.containsRect(n.bounds.get(r.id).world))i.push(r.id);else{const c=s.get(r.id);for(let l=0;l<c.children.length;l++)i.push(c.children[l].id)}const o=I1(n,s,i,e,!0),a=new Set;for(const c of o)a.add(Se.dataStore.getById(c));return a}function Eh(e){const n=He.state.compute,s=He.state.scene.node_bank,i=[];for(const[a,c]of s)i.push(a);const r=I1(n,s,i,e),o=new Set;for(const a of r)o.add(Se.dataStore.getById(a));return o}function ng(e){lG(He.state,e)}function JG(e){hG(He.state,e)}function $G(e){return dG(He.state,e)}function sg(e){const n=e.get("parent");return n.get("type")===Us.DATA_STORE?null:n.get("elementType")===Le.GROUP?n.get("parent"):n}function e3(e){Se.dataStore.editor.setMotionPathProps(e,null,{delta:!0,commit:!1}),Se.dataStore.debounceCommitUndo()}function t3(e){var r;const n=Se.dataStore.selection.get("elements"),s=Se.dataStore.selection.get("guidelines");if(n.includes(Se.dataStore.workspace.children[0]))return;Se.dataStore.beginChangeGroup();const i=new N;if(s.length)Se.dataStore.guidelines.moveMultiGuidelines(s,e);else if(n.length)for(const o of n){if(o.isLocked())continue;const a=(r=sg(o))==null?void 0:r.get("id"),c=new N(...o.get("computedStyle").data.translate);a?Se.drawInfo.toWorldPosition(a,c,i):i.copy(c);const l=new N().copy(c).add(e);o.sets({translateX:l.x,translateY:l.y},{updateType:Gs.USER_EDITING})}Se.dataStore.endChangeGroup(),Se.dataStore.debounceCommitUndo()}function M1(e,n){return rG(He.state.compute,e,n)}function n3(e,n,s,i){return oG(He.state.compute,e,n,s,i)}function s3(e,n){return aG(He.state.compute,e,n)}function i3(e,n,s,i,r=!1){return cG(He.state.compute,e,n,s,i,r)}function r3(){const e=Se.dataStore.selection.get("elements"),n=(s,i=-1)=>{for(let r=i+1;r<s.length;r++)if(s[r].get("visible")&&s[r].isText)return s[r];for(let r=0;r<i;r++)if(s[r].get("visible")&&s[r].isText)return s[r];return null};if(e.length===0){const s=Se.dataStore.workspace.children,i=n(s);if(i)return Se.dataStore.selection.selectElements([i]),i.get("id")}else{const s=e[0].get("parent");if(e.length===1){if(s.children.length>1){const i=s.children.indexOf(e[0]),r=n(s.children,i);if(r)return Se.dataStore.selection.selectElements([r]),r.get("id")}}else if(e.every(i=>i.get("parent")===s))return Se.dataStore.selection.selectElements(e.slice(0,1)),e[0].get("id")}return null}function o3(){const e=Se.dataStore.selection.get("elements"),n=(s,i=s.length)=>{for(let r=i-1;r>=0;r--)if(s[r].get("visible")&&s[r].isText)return s[r];for(let r=s.length-1;r>i;r--)if(s[r].get("visible")&&s[r].isText)return s[r];return null};if(e.length===0){const s=Se.dataStore.workspace.children,i=n(s);i&&Se.dataStore.selection.selectElements([i])}else{const s=e[0].get("parent");if(e.length===1){if(s.children.length>1){const i=s.children.indexOf(e[0]),r=n(s.children,i);r&&Se.dataStore.selection.selectElements([r])}}else e.every(i=>i.get("parent")===s)&&Se.dataStore.selection.selectElements(e.slice(-1))}}class a3{constructor(n){this.visualServer=n}switchTextElement(){var s;const n=this.visualServer.dataStore.selection.get("hover");if(n!=null&&n.isText){const i=(s=this.visualServer.dataStore.selection.get("elements"))==null?void 0:s[0],r=i!=null&&i.isText?i.get("id"):null,o=n!=null&&n.isText?n.get("id"):null;o&&r&&o!==r&&this.visualServer.dataStore.selection.selectElements([n]),document.activeElement.id!=="input"&&document.getElementById("input").focus(),this.visualServer.dataStore.drawInfo.changeTextEditingNode(o,!1)}else this.visualServer.dataStore.eam.activateTextEditMode(!1),this.visualServer.dataStore.commitUndo()}resumeTextEditMode(){var s;this.visualServer.dataStore.eam.activateTextEditMode(!0);const n=(s=this.visualServer.dataStore.selection.get("elements"))==null?void 0:s[0];n!=null&&n.isText&&(document.activeElement.id!=="input"&&document.getElementById("input").focus(),this.visualServer.dataStore.drawInfo.changeTextEditingNode(n.get("id"),!1))}}const lr=.01,Ad=2,P1={ELEMENT:100,ORIGIN:40,POINT:40},st=class st{constructor(n){this.vs=n,this.threshold=5,this.startOrigin=new N,this.startSnapping=!1,this.axisDiagonalVec=[new N,new N],this.axisDiagonalCount=0,this.firstSnapXToGrid=!0,this.firstSnapYToGrid=!0,this.lastSnapToGridPos=new N,this.moved=!1,this.otherElementsVertices=new Map,this.selectedVertices=new Map,this.snapToElementXUI=new Map,this.snapToElementYUI=new Map,this.isXSnapping=!1,this.isYSnapping=!1,this.snapAreaOnXLeftLUT=new Map,this.snapAreaOnXRightLUT=new Map,this.snapAreaOnYTopLUT=new Map,this.snapAreaOnYBottomLUT=new Map,this.spaceOnXLUT=new Map,this.spaceOnYLUT=new Map,this.spacingAreaUIMap=new Map,this.spacingLength=new N(-1,-1),this.selectedBoundsWorld=new ye,this.boundsForResize=new ye,this.hoverNodeTransform=null,this.spacingVerticalVec=new N,this.spacingVertical=0,this.spacingHorizontalVec=new N,this.spacingHorizontal=0,this.xOfAllVertices=[],this.yOfAllVertices=[],this.xHighlightGuide=[],this.yHighlightGuide=[]}updateThreshold(n){const s=Math.floor(n*100);s<=2?this.threshold=200:s<=5?this.threshold=100:s<=10?this.threshold=66:s<=25?this.threshold=21:s<=50?this.threshold=9:s<=75?this.threshold=7:s<=100?this.threshold=4:s<=200?this.threshold=2:s<=400?this.threshold=1:s<=25600&&(this.threshold=.5)}updateMoved(n){!n.is_zero()&&!this.moved&&(this.moved=!0)}resetInterfaceData(){this.axisDiagonalCount=0}setSnappingOriginalPos(n){this.startOrigin.copy(n),this.startSnapping=!0}setEndSnapping(){this.startSnapping=!1,this.axisDiagonalCount=0,this.firstSnapXToGrid=!0,this.firstSnapYToGrid=!0,this.moved=!1,this.xHighlightGuide.length=0,this.yHighlightGuide.length=0}isSnappingUIDataDirty(){return this.axisDiagonalCount>0||this.snapToElementXUI.size||this.snapToElementYUI.size||this.spacingAreaUIMap.size}snapAxisAndDiagonal(n,s,i="ELEMENT"){const r=n.clone();if(s){const o=n.clone().abs();o.x<=P1[i]||o.y<=P1[i]?o.x<=Op&&o.y<=Op?this._setAxisDiagonalAngle(0,90):o.y-o.x>Op?(r.set_x(0),this._setAxisDiagonalAngle(90)):(r.set_y(0),this._setAxisDiagonalAngle(0)):n.x>0&&n.y>0?(this._setAxisDiagonalAngle(-45),o.x>=o.y?r.set(o.x,o.x):r.set(o.y,o.y)):n.x<0&&n.y>0?(this._setAxisDiagonalAngle(45),o.x>=o.y?r.set(-o.x,o.x):r.set(-o.y,o.y)):n.x<0&&n.y<0?(this._setAxisDiagonalAngle(-45),o.x>=o.y?r.set(-o.x,-o.x):r.set(-o.y,-o.y)):n.x>0&&n.y<0&&(this._setAxisDiagonalAngle(45),o.x>=o.y?r.set(o.x,-o.x):r.set(o.y,-o.y))}else this._setAxisDiagonalAngle(null,null);return r}snapElementsPosToGrid(n,s=new N){const i=new N;return s.x!==0&&n.x!==Math.round(n.x)&&(i.x=Math.round(n.x)-n.x),s.y!==0&&n.y!==Math.round(n.y)&&(i.y=Math.round(n.y)-n.y),i}snapResizeElementToPixelGrid(n,s,i,r,o){if(r&&!o)return n.clone();const a=n.clone().sub(s),c=n.clone(),l=s.clone().sub(i);let h=Math.round(n.x);return this.firstSnapXToGrid?(a.x!==0&&(c.x=Math.round(i.x)+l.x),this.firstSnapXToGrid=!1):c.x=h+l.x,h=Math.round(n.y),this.firstSnapYToGrid?(a.y!==0&&(c.y=Math.round(i.y)+l.y),this.firstSnapYToGrid=!1):c.y=h+l.y,this.lastSnapToGridPos.copy(c),this.lastSnapToGridPos}snapScaleElementToPixelGrid(n,s,i,r,o){if(!this.moved)return s.clone();if(r&&!o)return n.clone();const a=n.clone().sub(s),c=n.clone(),l=s.clone().sub(i);let h=Math.round(n.x);return this.firstSnapXToGrid?(a.x!==0&&(c.x=Math.round(i.x)+l.x),this.firstSnapXToGrid=!1):c.x=h+l.x,h=Math.round(n.y),this.firstSnapYToGrid?(a.y!==0&&(c.y=Math.round(i.y)+l.y),this.firstSnapYToGrid=!1):c.y=h+l.y,c}getClosestDistanceToGrid(n,s,i,r,o){const a=s.clone(),c=new N,l=new N,h=o.getVertPos(n.id);return l.set(h[0],h[1]),i.world.xform(l,l),c.copy(l).round().sub(l),a.sub(c).round(),c.x!==0&&(a.x+=c.x),c.y!==0&&(a.y+=c.y),a}setResizeSelectedElementOAB(n,s){this.selectedVertices.clear();const i=this.vs.selection,r=i.single?i.single.id:null,o=r?this.vs.indexer.getNode(r).boundsLocal_zero:i.bounds,a=r?this.vs.indexer.getNode(r).item.transform.world:Ce.IDENTITY,c=r&&this.vs.indexer.getNode(r).item.isComputedGroup();this._getResizeDraggingSideData(this.selectedVertices,i.single,o,a,n,c),s?(this.boundsForResize.copy(s.boundsLocal_zero),this.hoverNodeTransform=s.item.transform):(this.selectedBoundsWorld.copy(o),i.single&&(this.boundsForResize.copy(o),this.hoverNodeTransform=this.vs.indexer.getNode(r).item.transform,this.selectedBoundsWorld=a.xform_rect(this.selectedBoundsWorld)))}setSelectedElementOAB(){var o,a;this.selectedVertices.clear();const n=this.vs.selection,s=n.single?n.single.id:null,i=n.single?(o=this.vs.indexer.getNode(s))==null?void 0:o.boundsLocal_zero:n.bounds,r=n.single?(a=this.vs.indexer.getNode(s))==null?void 0:a.item.transform.world:Ce.IDENTITY;this._getElementOABAndCenterData(this.selectedVertices,n.single,i,r),this.selectedBoundsWorld.copy(i),n.single&&(this.selectedBoundsWorld=r.xform_rect(this.selectedBoundsWorld))}updateSnapMovingData(n=!1){this.otherElementsVertices.clear(),this.snapAreaOnXLeftLUT.clear(),this.snapAreaOnXRightLUT.clear(),this.snapAreaOnYTopLUT.clear(),this.snapAreaOnYBottomLUT.clear();const s=this.vs.selection,i=this.vs.viewport.rectW.clone(),r=18/this.vs.viewport.scale,o=s.bounds.x-this.threshold*2<i.x+r?i.x+r:s.bounds.x-this.threshold*2,a=i.y+r,c=o+s.bounds.width+this.threshold*4>i.right?i.right-o:s.bounds.width+this.threshold*4,l=i.height-r,h=new ye(o,a,c,l),d=i.x+r,p=s.bounds.y-this.threshold*2<i.y+r?i.y+r:s.bounds.y-this.threshold*2,E=i.width-r,g=p+s.bounds.height+this.threshold*4>i.bottom?i.bottom-p:s.bounds.height+this.threshold*4,T=new ye(d,p,E,g),A=s.bounds.x<i.x+r?i.x+r:s.bounds.x,m=i.y+r,O=o+s.bounds.width>i.right?i.right-o:s.bounds.width,S=i.height-r,y=new ye(A,m,O,S),v=i.x+r,R=s.bounds.y<i.y+r?i.y+r:s.bounds.y,M=i.width-r,L=p+s.bounds.height>i.bottom?i.bottom-p:s.bounds.height,P=new ye(v,R,M,L),k=s._selected,Q=new Set;for(const J of k){const ge=this.vs.indexer.getNode(J);ge.parent&&Q.add(ge.parent.id)}const b=Eh(h),X=Eh(y);this._getElementsCornerAndCenterData(k,b,this.otherElementsVertices,n,!1,Q,X,s.bounds);const K=Eh(T),V=Eh(P);this._getElementsCornerAndCenterData(k,K,this.otherElementsVertices,n,!0,Q,V,s.bounds)}comparingVertices(n,s=!0){const i=new N,r=new N,o=new N,a=new N;this.snapToElementXUI.clear(),this.xHighlightGuide.length=0,this.snapToElementYUI.clear(),this.yHighlightGuide.length=0,this.isXSnapping=!1,this.isYSnapping=!1;for(const[l,h]of this.selectedVertices.entries())for(const d of h.entries()){const p=d[0];i.set(l,p);const E=this._convertPosToUIPanelVersion(i),g=E.clone().add(n);this._searchGuides(g,a,!1,!1);const T=Number.isInteger(E.x)||!s,A=Number.isInteger(E.y)||!s;for(const[m,O]of this.otherElementsVertices.entries())for(const S of O.entries()){const y=S[0];r.set(m,y);const v=this._convertPosToUIPanelVersion(r),R=Number.isInteger(v.x)||!s,M=Number.isInteger(v.y)||!s;o.copy(v).sub(E).sub(n),T&&R&&Math.abs(o.x)<=this.threshold&&(this.isXSnapping?Math.abs(a.x)>Math.abs(o.x)&&(this.snapToElementXUI.clear(),this.xHighlightGuide.length=0,a.x=o.x):(a.x=o.x,this.isXSnapping=!0)),A&&M&&Math.abs(o.y)<=this.threshold&&(this.isYSnapping?Math.abs(a.y)>Math.abs(o.y)&&(this.snapToElementYUI.clear(),this.yHighlightGuide.length=0,a.y=o.y):(a.y=o.y,this.isYSnapping=!0)),this.isXSnapping&&a.x===o.x&&this._addSnapXUIData(v.x,v.y,this.snapToElementXUI),this.isYSnapping&&a.y===o.y&&this._addSnapYUIData(v.x,v.y,this.snapToElementYUI)}}this.spacingAreaUIMap.clear(),this.spacingHorizontal=0,this.spacingVertical=0;const c=this.selectedBoundsWorld.clone();return c.x+=n.x,c.x+=a.x,c.y+=n.y,c.y+=a.y,this._moveSnapSpacing(c,a,s),this._updateMoveSnappingUI(a,n),a}_updateMoveSnappingUI(n,s){this.isXSnapping||this.snapToElementXUI.clear(),this.isYSnapping||this.snapToElementYUI.clear();const i=new N;for(const[r,o]of this.selectedVertices.entries())for(const a of o.entries()){const c=a[0];i.set(r,c);const l=this._convertPosToUIPanelVersion(i);i.copy(l),i.add(n).add(s);const h=this._convertPosToUIPanelVersion(i);i.copy(h),this.snapToElementXUI.has(i.x)&&this.snapToElementXUI.get(i.x).set(i.y,0),this.snapToElementYUI.has(i.y)&&this.snapToElementYUI.get(i.y).set(i.x,0)}}comparingVerticesWithResize(n,s,i,r,o=!0,a={isMultipleOf90:!1,isMultipleOf180:!1},c,l=!1){const h=new N(.5,.5).sub(r);if((h.x===0||h.y===0)&&!a.isMultipleOf90)return this.snapToElementXUI.clear(),this.snapToElementYUI.clear(),this.xHighlightGuide.length=0,this.yHighlightGuide.length=0,this.isXSnapping=!1,this.isYSnapping=!1,n.clone();const p=new N,E=new N,g=new N,T=new N,A=s.clone().sub(i),m=this._convertPosToUIPanelVersion(n.clone().sub(A));this.snapToElementXUI.clear(),this.snapToElementYUI.clear(),this.xHighlightGuide.length=0,this.yHighlightGuide.length=0,this.isXSnapping=!1,this.isYSnapping=!1;let O=r.y===.5,S=r.x===.5;a.isMultipleOf90&&!a.isMultipleOf180&&([O,S]=[S,O]);for(const[y,v]of this.selectedVertices.entries())for(const R of v.entries()){const M=R[0];p.set(y,M);const L=this._convertPosToUIPanelVersion(p),P=Number.isInteger(L.x)||!o,k=Number.isInteger(L.y)||!o;this._searchGuides(m,T,S,O);for(const[Q,b]of this.otherElementsVertices.entries())for(const X of b.entries()){const K=X[0];E.set(Q,K);const V=this._convertPosToUIPanelVersion(E),J=Number.isInteger(V.x)||!o,ge=Number.isInteger(V.y)||!o;O||S?(L.x=this.selectedVertices.size===1?m.x:L.x,L.y=this.selectedVertices.size===1?L.y:m.y,g.copy(V).sub(L)):g.copy(V).sub(m),P&&J&&Math.abs(g.x)<=this.threshold&&!S&&(this.isXSnapping?Math.abs(T.x)-Math.abs(g.x)>fs&&(T.x=g.x,this.snapToElementXUI.clear(),this.xHighlightGuide.length=0):T.x=g.x,this.isXSnapping=!0),k&&ge&&Math.abs(g.y)<=this.threshold&&!O&&(this.isYSnapping?Math.abs(T.y)-Math.abs(g.y)>fs&&(T.y=g.y,this.snapToElementYUI.clear(),this.yHighlightGuide.length=0):T.y=g.y,this.isYSnapping=!0),this.isXSnapping&&T.x===g.x&&this._addSnapXUIData(V.x,V.y,this.snapToElementXUI),this.isYSnapping&&T.y===g.y&&this._addSnapYUIData(V.x,V.y,this.snapToElementYUI)}}if(m.add(T),this.spacingAreaUIMap.clear(),this.spacingHorizontal=0,this.spacingVertical=0,!l){const y=st.getGripPointFromVector(h),v=this._updateCompareBoundsInGeneral(c,y,m);this._resizeSnapSpacing(h,v,T,o),this._updateSnappingUIResize(S,O,m),m.copy(n).add(T)}return m}_searchGuides(n,s,i,r){const{closestHorizontal:o,closestVertical:a}=$G(n);if(!i&&a!==null){const c=a[1]-n.x;Math.abs(c)<=this.threshold&&(this.isXSnapping?Math.abs(s.x)>Math.abs(c)&&(this.snapToElementXUI.clear(),this.xHighlightGuide.length=0,s.x=c,this.xHighlightGuide.push(a[0])):(s.x=c,this.isXSnapping=!0,this.xHighlightGuide.push(a[0])))}if(!r&&o!==null){const c=o[1]-n.y;Math.abs(c)<=this.threshold&&(this.isYSnapping?Math.abs(s.y)>Math.abs(c)&&(this.snapToElementYUI.clear(),this.yHighlightGuide.length=0,s.y=c,this.yHighlightGuide.push(o[0])):(s.y=c,this.isYSnapping=!0,this.yHighlightGuide.push(o[0])))}}_updateSnappingUIResize(n,s,i){this.isXSnapping||this.snapToElementXUI.clear(),this.isYSnapping||this.snapToElementYUI.clear();const r=new N;for(const[o,a]of this.selectedVertices.entries())for(const c of a.entries()){const l=c[0];r.set(o,l);const h=this._convertPosToUIPanelVersion(r);r.copy(h),n||s?(this.snapToElementXUI.has(i.x)&&this.snapToElementXUI.get(i.x).set(r.y,0),this.snapToElementYUI.has(i.y)&&this.snapToElementYUI.get(i.y).set(r.x,0)):(this.snapToElementXUI.has(i.x)&&this.snapToElementXUI.get(i.x).set(i.y,0),this.snapToElementYUI.has(i.y)&&this.snapToElementYUI.get(i.y).set(i.x,0))}}_updateCompareBoundsInGeneral(n,s,i){let r;if(n===st.ResizeTypes.RESIZE_ELEMENTS)r=st.resizeRect(this.selectedBoundsWorld,s,i);else if(n===st.ResizeTypes.RESIZE_ONE_ELEMENT)if(!this.hoverNodeTransform||!this.hoverNodeTransform.rotation)r=st.resizeRect(this.selectedBoundsWorld,s,i);else{const o=this.hoverNodeTransform.worldInv.xform(i),a=st.resizeRect(this.boundsForResize,s,o);r=this.hoverNodeTransform.world.xform_rect(a)}else if(this.hoverNodeTransform){const o=this.hoverNodeTransform.worldInv.xform(i),a=st.scaleRect(this.boundsForResize,s,o,this.hoverNodeTransform.getPivotOffset());r=this.hoverNodeTransform.world.xform_rect(a)}else console.warn("Invalid in comparingVerticesWithResize");return r}_resizeSnapSpacing(n,s,i,r){if(n.x>=lr||n.x<=-.01){this._generateAllSpacing(!0,s);const o=Array.from(this.spaceOnXLUT.keys()).sort((h,d)=>h-d),a=n.x>=lr?st.IgnoreNonContactDir.LEFT:st.IgnoreNonContactDir.RIGHT,c=this.isXSnapping?fs:Ad,l=st._compareSpacing(s.left,s.right,this.snapAreaOnXLeftLUT,this.snapAreaOnXRightLUT,o,c,c,a);if(l){const h=this._updateResizeExtraDeltaBySpacing(n,l,i,s,!0,r);h>0&&this._snapSpacingUpdateUIXaxis(s,l,h)}}if(n.y>=lr||n.y<=-.01){this._generateAllSpacing(!1,s);const o=Array.from(this.spaceOnYLUT.keys()).sort((h,d)=>h-d),a=(n.y>=lr,st.IgnoreNonContactDir.RIGHT),c=this.isYSnapping?fs:Ad,l=st._compareSpacing(s.top,s.bottom,this.snapAreaOnYTopLUT,this.snapAreaOnYBottomLUT,o,c,c,a);if(l){const h=this._updateResizeExtraDeltaBySpacing(n,l,i,s,!1,r);h>0&&this._snapSpacingUpdateUIYaxis(s,l,h)}}}_updateResizeExtraDeltaBySpacing(n,s,i,r,o,a){let c=0;const l=(o?n.x:n.y)>=lr;if(s.leftBounds&&s.rightBounds){if(c=st.roundToUIPanelVersion(l?s.leftSpace:s.rightSpace),a&&!Number.isInteger(c))return-1;o?i.x+=l?s.rightSpace-c:c-s.leftSpace:i.y+=l?s.rightSpace-c:c-s.leftSpace}else c=this._updateEtractDeltaByNonContactedSpacing(s,o,i,r,a);return c}_moveSnapSpacing(n,s,i){const r=this.isXSnapping?fs:Ad;this._generateAllSpacing(!0,n);const o=Array.from(this.spaceOnXLUT.keys()).sort((h,d)=>h-d);let a=st._compareSpacing(n.left,n.right,this.snapAreaOnXLeftLUT,this.snapAreaOnXRightLUT,o,r*2,r);if(a){const h=this._updateMoveExtraDeltaBySpacing(a,s,n,!0,i);h>0&&this._snapSpacingUpdateUIXaxis(n,a,h)}const c=this.isYSnapping?fs:Ad;this._generateAllSpacing(!1,n);const l=Array.from(this.spaceOnYLUT.keys()).sort((h,d)=>h-d);if(a=st._compareSpacing(n.top,n.bottom,this.snapAreaOnYTopLUT,this.snapAreaOnYBottomLUT,l,c*2,c),a){const h=this._updateMoveExtraDeltaBySpacing(a,s,n,!1,i);h>0&&this._snapSpacingUpdateUIYaxis(n,a,h)}}_updateMoveExtraDeltaBySpacing(n,s,i,r,o){let a=0;if(n.leftBounds&&n.rightBounds){if(a=st.roundToUIPanelVersion((n.leftSpace+n.rightSpace)*.5),o&&!Number.isInteger(a))return-1;r?s.x+=a-n.leftSpace:s.y+=a-n.leftSpace}else a=this._updateEtractDeltaByNonContactedSpacing(n,r,s,i,o);return a}_updateEtractDeltaByNonContactedSpacing(n,s,i,r,o){if(o&&!Number.isInteger(n.nonContactSpacing))return-1;const a=n.nonContactSpacing;return n.leftBounds?s?i.x+=a-(r.left-n.leftBounds.right):i.y+=a-(r.top-n.leftBounds.bottom):s?i.x+=n.rightBounds.left-r.right-a:i.y+=n.rightBounds.top-r.bottom-a,a}_snapSpacingUpdateUIXaxis(n,s,i){let r=null,o=null;if(s.leftBounds&&(r=st.createHorizontalRect(s.leftBounds,!0,i,n),st.addToDisplay(this.spacingAreaUIMap,r),this.spacingHorizontalVec.x=s.leftBounds.right,this.spacingHorizontalVec.y=n.y+n.height*.5,this.spacingHorizontal=i),s.rightBounds&&(o=st.createHorizontalRect(s.rightBounds,!1,i,n),st.addToDisplay(this.spacingAreaUIMap,o),s.leftBounds||(this.spacingHorizontalVec.x=s.rightBounds.left-i,this.spacingHorizontalVec.y=n.y+n.height*.5,this.spacingHorizontal=i)),this.spaceOnXLUT.has(i)){const a=this.spaceOnXLUT.get(i);for(const c of a){const l=st.createHorizontalRect(c[0],!0,i,c[1]);r&&r.overlaps(l)||o&&o.overlaps(l)||st.addToDisplay(this.spacingAreaUIMap,l)}}}_snapSpacingUpdateUIYaxis(n,s,i){if(this.spaceOnYLUT.has(i)){const r=this.spaceOnYLUT.get(i);for(const o of r){const a=st.createVerticalRect(o[0],!0,i,o[1]);s.leftBounds&&s.leftBounds.overlaps(a)||s.rightBounds&&s.rightBounds.overlaps(a)||st.addToDisplay(this.spacingAreaUIMap,a)}}s.leftBounds&&(st.addToDisplay(this.spacingAreaUIMap,st.createVerticalRect(s.leftBounds,!0,i,n)),this.spacingVerticalVec.x=n.x+n.width*.5,this.spacingVerticalVec.y=s.leftBounds.bottom,this.spacingVertical=i),s.rightBounds&&(st.addToDisplay(this.spacingAreaUIMap,st.createVerticalRect(s.rightBounds,!1,i,n)),s.leftBounds||(this.spacingVerticalVec.x=n.x+n.width*.5,this.spacingVerticalVec.y=s.rightBounds.top-i,this.spacingVertical=i))}static getGripPointFromVector(n){const{x:s,y:i}=n;return Math.abs(s)<lr&&Math.abs(i)<lr?null:i<=-.01?s<=-.01?An.TOP_LEFT:s>=lr?An.TOP_RIGHT:An.TOP:i>=lr?s<=-.01?An.BOTTOM_LEFT:s>=lr?An.BOTTOM_RIGHT:An.BOTTOM:s<=-.01?An.LEFT:s>=lr?An.RIGHT:null}static resizeRect(n,s,i){const r=n.clone();switch(s){case An.TOP_LEFT:r.width=n.right-i.x,r.height=n.bottom-i.y,r.x=i.x,r.y=i.y;break;case An.TOP:r.height=n.bottom-i.y,r.y=i.y;break;case An.TOP_RIGHT:r.width=i.x-n.x,r.height=n.bottom-i.y,r.y=i.y;break;case An.RIGHT:r.width=i.x-n.x;break;case An.BOTTOM_RIGHT:r.width=i.x-n.x,r.height=i.y-n.y;break;case An.BOTTOM:r.height=i.y-n.y;break;case An.BOTTOM_LEFT:r.width=n.right-i.x,r.height=i.y-n.y,r.x=i.x;break;case An.LEFT:r.width=n.right-i.x,r.x=i.x;break}return r}static scaleRect(n,s,i,r){const o=n.clone();let a=1,c=1;switch(s){case An.TOP_LEFT:a=(r.x-i.x)/(r.x-n.x),c=(r.y-i.y)/(r.y-n.y);break;case An.TOP:c=(r.y-i.y)/(r.y-n.y);break;case An.TOP_RIGHT:a=(i.x-r.x)/(n.x+n.width-r.x),c=(r.y-i.y)/(r.y-n.y);break;case An.RIGHT:a=(i.x-r.x)/(n.x+n.width-r.x);break;case An.BOTTOM_RIGHT:a=(i.x-r.x)/(n.x+n.width-r.x),c=(i.y-r.y)/(n.y+n.height-r.y);break;case An.BOTTOM:c=(i.x-r.x)/(n.x+n.width-r.x);break;case An.BOTTOM_LEFT:a=(r.x-i.x)/(r.x-n.x),c=(i.y-r.y)/(n.y+n.height-r.y);break;case An.LEFT:a=(r.x-i.x)/(r.x-n.x);break}return Number.isFinite(a)&&(o.width*=a,o.x=r.x+(o.x-r.x)*a),Number.isFinite(c)&&(o.height*=c,o.y=r.y+(o.y-r.y)*c),o}static createHorizontalRect(n,s,i,r){const o=s?n.right:n.left-i,a=Math.min(r.top,n.top),c=Math.max(r.bottom,n.bottom)-a;return new ye(o,a,i,c)}static createVerticalRect(n,s,i,r){const o=Math.min(r.left,n.left),a=s?n.bottom:n.top-i,c=Math.max(r.right,n.right)-o;return new ye(o,a,c,i)}static addToDisplay(n,s){const i=s.hash();n.has(i)||n.set(i,s)}endSnapMovingElementToElement(){this.otherElementsVertices.clear(),this.selectedVertices.clear(),this.snapToElementXUI.clear(),this.snapToElementYUI.clear(),this.spacingAreaUIMap.clear(),this.spacingHorizontal=0,this.spacingVertical=0}isBoundingBoxAlignAxis(n){return!n.single||this.isMultipleOf90Degree(n.first.node.item.transform.rotation)}isScalingSnapToPixelGrid(n,s){const i=this.isMultipleOf90Degree(n.item.transform.world.get_rotation());return!s||s&&i}getScalingClickPoint(n,s){const i=s.item.transform.size.clone().abs(),r=c3.set(n.x*i.x,n.y*i.y).add(s.boundsLocal.center);return s.item.transform.world.xform(r,r),r}snapScalingToPixelGrid(n,s,i,r,o,a){const c=n.clone(),l=Math.cos(i);return c.divide(o),!s.single&&!this.isMultipleOf90Degree(i)&&c.divide(Math.abs(l),Math.abs(l)),a&&c.multiply(r),c}flipSnapEdge(n,s,i,r,o){const a=s.clone(),c=n.x>0?(100-i.x)/i.x:i.x/(100-i.x),l=n.y>0?(100-i.y)/i.y:i.y/(100-i.y),h=new N(r,o).sign(),d=s.clone().sign();return h.x!==d.x&&(a.x=s.x*c),h.y!==d.y&&(a.y=s.y*l),a}getSnapGridPos(){return this.lastSnapToGridPos}isMultipleOf90Degree(n){const s=n%(Math.PI*.5)<vn?0:n;return Number.isInteger(s%(Math.PI*.5))}isMultipleOf180Degree(n){const s=n%Math.PI<vn?0:n;return Number.isInteger(s%Math.PI)}_setAxisDiagonalAngle(n,s=null){this.axisDiagonalCount=s?2:1,this._setAxisDiagonalVec(n,0),this._setAxisDiagonalVec(s,1)}_setAxisDiagonalVec(n,s){switch(n){case 0:this.axisDiagonalVec[s].set(1,0);break;case 45:this.axisDiagonalVec[s].set(-1,1);break;case 90:this.axisDiagonalVec[s].set(0,1);break;case-45:this.axisDiagonalVec[s].set(1,1);break;default:this.axisDiagonalVec[s].set(0,0);break}}_getElementsCornerAndCenterData(n,s,i,r,o,a,c,l){var h;for(const d of s){const p=this._checkParentIdNotInclude(d,n,r),E=!this._isComputedGroupAncestorOfAnyInList(d,n),g=d.get("id"),T=this.vs.indexer.getNode(g);if(!d.isHidden()&&p&&E&&!n.has(g)){const A=T.boundsWorldAABB_zero;this._addPointDataToMap(A.center.x,A.center.y,i),this._addPointDataToMap(A.left,A.top,i),this._addPointDataToMap(A.right,A.top,i),this._addPointDataToMap(A.left,A.bottom,i),this._addPointDataToMap(A.right,A.bottom,i),a.has((h=this.vs.indexer.getNode(d.get("id")).parent)==null?void 0:h.id)&&c.has(d)&&!l.overlaps(A)&&(o?(this.snapAreaOnXLeftLUT.set(A.left,A),this.snapAreaOnXRightLUT.set(A.right,A)):(this.snapAreaOnYTopLUT.set(A.top,A),this.snapAreaOnYBottomLUT.set(A.bottom,A)))}}}_checkParentIdNotInclude(n,s,i){let o=this.vs.indexer.getNode(n.get("id"));for(;!o.item.isScreen()&&o.parent;){if(s.has(o.id)&&(o.item.type!=="container"||i))return!1;o=o.parent}return!0}_isComputedGroupAncestorOfAnyInList(n,s){const i=this.vs.indexer.getNode(n.get("id"));if(!n.isComputedGroup)return!1;for(const r of s){let a=this.vs.indexer.getNode(r);for(;i.item.depth<a.item.depth;){if(a.parent===i)return!0;a=a.parent}}return!1}_getElementOABAndCenterData(n,s,i,r){const o=new N(i.x+i.width,i.y),a=new N(i.x+i.width,i.y+i.height),c=new N(i.x,i.y+i.height),l=new N(i.x,i.y),h=new N(i.x+i.width*.5,i.y+i.height*.5);if(s){const d=r.xform_rect(i);o.copy(d.topRight),a.copy(d.bottomRight),c.copy(d.bottomLeft),l.copy(d.topLeft),h.copy(d.center)}this._addPointDataToMap(h.x,h.y,n),this._addPointDataToMap(o.x,o.y,n),this._addPointDataToMap(a.x,a.y,n),this._addPointDataToMap(c.x,c.y,n),this._addPointDataToMap(l.x,l.y,n)}_getResizeDraggingSideData(n,s,i,r,o,a){const c=new N(.5,.5).sub(o),l=new N(i.width,i.height),h=c.x===0?new N(i.width*.5,0):new N(0,i.height*.5),d=c.x===0||c.y===0,p=new N,E=new N;if(l.multiply(c),d){const g=i.center.clone().add(l);if(s)if(a){const T=s.element.get("referencePoint"),A=c.x===0?new N(T.x,0):new N(0,T.y);p.set(0,0).add(l).add(A),E.set(0,0).add(l).sub(A)}else p.set(i.width*.5,i.height*.5).add(l).add(h),E.set(i.width*.5,i.height*.5).add(l).sub(h);else p.copy(g).add(h),E.copy(g).sub(h);r.xform(p,p),r.xform(E,E),this._addPointDataToMap(p.x,p.y,n),this._addPointDataToMap(E.x,E.y,n)}else s?p.set(i.width*.5+l.x,i.height*.5+l.y):p.copy(i.center).add(l),r.xform(p,p),this._addPointDataToMap(p.x,p.y,n)}_addPointDataToMap(n,s,i){if(i.has(n))i.get(n).set(s,0);else{const r=new Map;r.set(s,0),i.set(n,r)}}_addSnapXUIData(n,s,i){this._addPointDataToMap(n,s,i)}_addSnapYUIData(n,s,i){this._addPointDataToMap(s,n,i)}_removePointDelta(n,s){const i=[];for(const[,r]of n.entries()){for(const[o,a]of r.entries())r.get(o)!==0&&(r.has(o-a+s)||i.push(o),r.set(o-a+s,s));for(const o of i)r.delete(o);i.length=0}}_convertPosToUIPanelVersion(n){const s=n.clone();return s.scale(100),s.round(),s.scale(.01),s}static roundToUIPanelVersion(n){return Math.round(n*100)/100}_generateAllSpacing(n,s){const i=n?this.spaceOnXLUT:this.spaceOnYLUT;i.clear();const r=Array.from((n?this.snapAreaOnXLeftLUT:this.snapAreaOnYTopLUT).entries()).sort((a,c)=>a[0]-c[0]),o=r.length;for(let a=0;a<o;a++){let c=a+1;for(;c<o&&r[c][0]<=(n?r[a][1].right:r[a][1].bottom);)c++;for(;c<o;){if(!s.overlaps(r[a][1],fs)&&!s.overlaps(r[c][1],fs)){const l=st.roundToUIPanelVersion(r[c][0]-(n?r[a][1].right:r[a][1].bottom));i.has(l)?i.get(l).push([r[a][1],r[c][1]]):i.set(l,[[r[a][1],r[c][1]]])}c++}}}static _compareSpacing(n,s,i,r,o,a,c,l){if(!i.size&&!r.size)return null;const h=Array.from(i.keys()).sort((m,O)=>m-O),d=Array.from(r.keys()).sort((m,O)=>m-O);let p=st._searchInsertPosition(d,n,!0),E=st._searchInsertPosition(h,s,!1);for(;p>-1&&d[p]>=n;)p--;for(;E<h.length&&h[E]<=s;)E++;let g=null,T=null,A=-1;if(p>=0&&E<h.length){const m=n-d[p],O=h[E]-s;if(Math.abs(m-O)<=a)return{leftSpace:m,rightSpace:O,leftBounds:r.get(d[p]),rightBounds:i.get(h[E])}}if(p>=0&&l!==st.IgnoreNonContactDir.LEFT){const m=n-d[p],O=st._binarySearchWithTolerance(o,m,c);O>-1&&(g=r.get(d[p]),A=o[O])}if(E<h.length&&l!==st.IgnoreNonContactDir.RIGHT){const m=h[E]-s,O=st._binarySearchWithTolerance(o,m,c);if(O>-1){const S=o[O];(A<0||S<A)&&(T=i.get(h[E]),g=null,A=S)}}return A!==-1?{leftBounds:g,rightBounds:T,nonContactSpacing:A}:null}static _binarySearchWithTolerance(n,s,i){let r=0,o=n.length-1;for(;r<=o;){const a=Math.floor((r+o)/2),c=n[a];if(Math.abs(c-s)<=i)return a;c<s?r=a+1:o=a-1}return-1}static _searchInsertPosition(n,s,i){let r=0,o=n.length-1,a=-1;for(;r<=o;){const c=r+Math.floor((o-r)*.5);i?n[c]<s?(a=c,r=c+1):o=c-1:n[c]>s?(a=c,o=c-1):r=c+1}return a}updateSnapMovingDataForGuides(){this.xOfAllVertices.length=0,this.yOfAllVertices.length=0;const n=this.vs.viewport.rectW.clone(),s=18/this.vs.viewport.scale;n.x+=s,n.y+=s,n.width-=s,n.height-=s;const i=Eh(n);for(const r of i){const o=r.get("id"),a=this.vs.indexer.getNode(o);if(!r.isHidden()&&!r.isScreen){const c=a.boundsWorldAABB_zero;this.xOfAllVertices.push(st.roundToUIPanelVersion(c.center.x)),this.xOfAllVertices.push(st.roundToUIPanelVersion(c.left)),this.xOfAllVertices.push(st.roundToUIPanelVersion(c.right)),this.yOfAllVertices.push(st.roundToUIPanelVersion(c.center.y)),this.yOfAllVertices.push(st.roundToUIPanelVersion(c.top)),this.yOfAllVertices.push(st.roundToUIPanelVersion(c.bottom))}}}compareVerticesWithGuides(n,s,i=!0){if(!n)return 1/0;const r=n.direction===ut.VERTICAL?this.xOfAllVertices:this.yOfAllVertices,o=n.direction===ut.VERTICAL?s.x:s.y;let a=1/0;for(const c of r){if(i&&!Number.isInteger(c))continue;const l=c-n.position-o;Math.abs(l)<=this.threshold&&(a=Math.min(a,l))}return a}};$e(st,"ResizeTypes",Object.freeze({RESIZE_ONE_ELEMENT:1,RESIZE_ELEMENTS:2,SCALE_ONE_ELEMENT:3})),$e(st,"IgnoreNonContactDir",Object.freeze({NONE:-1,LEFT:1,RIGHT:2}));let Pc=st;const c3=new N,An=Object.freeze({TOP_LEFT:0,TOP:1,TOP_RIGHT:2,RIGHT:3,BOTTOM_RIGHT:4,BOTTOM:5,BOTTOM_LEFT:6,LEFT:7});class l3 extends al.EventEmitter{constructor(n){super(),this.x=0,this.y=0,this.width=256,this.height=256,this.scale=1,this.pixelRatio=window.devicePixelRatio,this.canvas=n,this.projectionTransform=new Ce,this.invProjectionTransform=new Ce,this.reset()}reset(){return this.x=0,this.y=0,this.width=256,this.height=256,this.scale=1,this.pixelRatio=window.devicePixelRatio,this.projectionTransform.identity(),this.invProjectionTransform.identity(),!0}setTransform(n){this.x=n.x,this.y=n.y,this.scale=n.scale,this.updateTransforms()}get rect(){return new ye(0,0,this.width,this.height)}get rectW(){return this.toWorldRect(this.rect)}get realWidth(){return Math.floor(this.width*this.pixelRatio)}get realHeight(){return Math.floor(this.height*this.pixelRatio)}updateTransforms(){this.projectionTransform.set(this.scale,0,0,this.scale,this.x,this.y),this.invProjectionTransform.copy(this.projectionTransform).affine_inverse(),this.emit("update")}resize(){const n=this.canvas.parentElement;if(!n)return;const s=n.getBoundingClientRect(),i=Math.ceil(s.width),r=Math.ceil(s.height);this.width===i&&this.height===r&&this.pixelRatio===window.devicePixelRatio||(this.width=i,this.height=r,this.pixelRatio=window.devicePixelRatio,this.canvas.style.width=`${this.width}px`,this.canvas.style.height=`${this.height}px`,this.width*this.height!==0&&(this.canvas.width=this.realWidth,this.canvas.height=this.realHeight,this.emit(me.VIEWPORT_RESIZE),this.emit("update"),window.dispatchEvent(new Event("resize"))))}toScreen(n){return this.projectionTransform.xform(n)}toWorld(n){return this.invProjectionTransform.xform(n)}toScreenRect(n){return this.projectionTransform.xform_rect(n)}toWorldRect(n){return this.invProjectionTransform.xform_rect(n)}getZoom(){return this.scale}setZoom(n){const s=this.rectW;this.scale=ps.clamp(n,e2,t2),this.moveTo(s),this.emit(me.VIEWPORT_ZOOM_CHANGE,n)}offsetPos(n){this.x+=n.x,this.y+=n.y,this.updateTransforms()}zoomAroundPos(n,s){const i=this.toWorld(n);this.setZoom(this.scale*s);const r=this.toScreen(i),o=n.clone().sub(r);this.offsetPos(o)}isContainedBy(n){return n.containsRect(this.rectW)}containsRect(n){return this.rectW.containsRect(n)}focus(n,s=25,i=.5,r=.5){let o,a,c,l;typeof s=="number"?(o=s,a=s,c=s,l=s):(o=s.left??25,a=s.top??25,c=s.right??25,l=s.bottom??25);const h=this.width-(o+c),d=this.height-(a+l);this.scale=Math.min(h/n.width,d/n.height);const p=n.clone();this.moveTo(p,i,r,{left:o,top:a,right:c,bottom:l})}moveTo(n,s=.5,i=.5,r){const o=this.rect;if(r){const l=(r.left-r.right)/2,h=(r.top-r.bottom)/2;o.x+=l,o.y+=h}const a=b1(o,s,i),c=b1(n,s,i).scale(this.scale);this.x=a.x-c.x,this.y=a.y-c.y,this.updateTransforms()}}function b1(e,n,s){return new N(e.x+n*e.width,e.y+s*e.height)}const gh={add:{"1x":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAApCAYAAABUdSs8AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAANASURBVHgB7VdLSxtRFJ5X3g9qHo0J1kabFoLFCimFQhcGt7XQhYuCW1fuXYmPlSsX/gZ3LgT7J9y3BLpMS2nRQlXEpDHJ3H6f3qnjYGqSGbtpPrjcx0zmfPec75x7oygDDDDAAAP871CV3qEKIa4mqqpwjl4ofUBTeoQ0ppbLZf3w8HC8VCoZ6+vrJNXPZvqCCqO+XC4XNk2zur+/X5yYmPBjXfsnJKSRYDweT2As2u325729vcl8Ph9cW1u7exI0kslkIhhmSQBz0Wq1vuzs7EyRxNzcnH7XJPRUKhVD/1BcqvEaCcyDSh/a6hr0QCKRiAeDwbxFwEliZGQk1G04DMUjwCC7B8vLy+/Rv1laWvpUqVSaGJuSpDdgjOkBDMfsHlAcnqAwMb8QptJfvbkZ/CA1gBDcSMBOYnd39xmFiTXdXrzcwhJhRwIWifPz848bGxv5QqEQoOcUj6Df5gEnia2trVEWK0/SU8Y05syC1dVV0QnNZvPD9vZ21hMv8CNOD9B4rVb7Pj8//84wjFdoL30+3wu0qUAg8DgSiQyn0+moJODOC04RWsYXFhbe4vEkDeLZOMZjoVBoNBwO5+4BlhhdE5C7iPHjJFCv178tLi6+xtoTtCxaGi0VjUbTsVgsyZRlYcKaIcPnDiTAswA7yzYaja8rKysz9AYN0hh3a48/fhKnADvVg54Z4WPi4OCgjTg3UO1mNjc3K3D7MeJc0zSNggvwPV5UCBALoiIaaCpIXNwbXGUDf8z7AIYhCot6oEc4hstTIPPIEidBTWCclieozxMCdKfUgo/ionFn6lkE7OB7JC/c1gNrFyTCKkex3VaU5PO0zAbPjmtNKvx+Nx7A2rB1VCseQbU8gFgXMC9BnGU7AfRltOdofJ5yesDVfUBc3pDbiG0D02OMTdwRrx17qIanuq7/BLFTZEo9mUy2q9Xqn3dcuUKmmonU/AUv1GDsBGl4YpG7MKBpR1zHJfasWCw2Zmdn20J4dDbb1Mxe51Udu8zIcDyV50CG69Y54MwAtx4QV1yEmc1mm6iQZ36//xhrP9AfcT40NNRiAeN7/f6D6ooP1T09PW1QaDI7KDifJ6dgD9CsJtPtr7fj35vpJCsip8dCAAAAAElFTkSuQmCC","2x":"data:image/png;base64,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"},arrowMove:{"1x":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAuCAYAAABJcBuEAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAQXSURBVHgB7VhNTBNBFJ6lP2yhrRYLCBSoWCVKAo0YExIPoBw4KAkHDiZcOQAhhBi4iPyciMYEiEc1HLgQSEAMRwjcOAISEk+gRisQCOXCX6Hr+5aZUiogbLde7JdMdma3O+9737z3ZraMxRFHHHHE8b9DYpeHpCjK8UCSGMZ0VZgGJLBLghuTysrKDGtra3nFxcXGrq4ukNLijCZIZNSUmZmZFAwGv87MzNwpKCgw0/2Ef0KCG5HtdnsK9ZXDw8NvY2NjhW63W+7s7Iw9CRhJT09Ppm4GCNBYOTg4+D40NOQFierqakOsSRicTqeNrrnKUTSeIEFjmWmIrQsDCqSkpNhlWXYLApEkXC6X5aLLYWQ6gQzikt3W1vaJrpWtra1fFhcXA9QPcpL6AGsMBah7I1wBFqEEApPGamAybfXmdGBCxAAtwakEwkmMjIwUITDpniG8eEULEYRnEhAk9vf3F7q7u90ejycRyjGdYPibApEk+vr6clCsdElPvqZ/ZEFHR4dyFgKBwOeBgYEMXVTAJJEKwPj29vavmpqaZ0aj8SG1EpPJ9ICaNzEx8VZycvL11NRUKycQnQqRQSiM19bWVtHjQhjEM+q7LRZLTlJSUobD4bgigjFqAtwLEMgFgZ2dHV9DQ8MTunebWha1NJL7ns1mu3aVgLLNjRv58kUHEMCk8Gxvb+9He3v7YyKTB5lhdGJioox2Sf/GxsZrEKBX5NLSUiMPQN2CUN0Nm5qa8kGEDDthfHx8vHx9fX2LDCqzs7PK6urqG8hPvzfrVpDgCc4D1LUgFmCA4BDGvV6vGpjkfIgEja+EnRlYVAABeANZaSijLE9OTj6ic8FWf3+/GpRQoKenR70CQgmQiFoJeAASIAAFsObwvLe3N5T3MDw1NaX2l5eXTyjB1QsFo5aoxJEwYXp62jw4OHifJP9YXl5u39zcPPXHfr+fVVVVMZ/P95xIvCRCFiKh/dCCFyElajxkh7dYb1xFwxixIMaUhuo9qLGysvKCprFEk5ISz+u0paWlt5AXk2PNITsajIvx6Oio+hyxsbu7+5Pul9C7VnZUlLQRgAJIO+rnLywsvAMJEXCRMSACEwWrpaWlgqpjFk7UmvcFEYCo7TSZi24Vzs3NfQgPOBCA5yIwYbyxsfEp/fYm6gdPSc2ZIIlagCwgEtm06RTNz8+/h3Gst1hz4XldXV0l7REeFCx2fEqKDnySEAnqh0gI49ikhHF67hTfDkwniM8xEz8jugQJSknV8/r6esju4fEi63kqUiGKEpaDk8gym813KSZeNTc3V9A4j5oqO9NjKz4HCbzC2axWayqCkzapTBo7xNdSLI0DksgO6svIEKSaOIyetwHpyUr93wCf6vRBos47PDwcfkiNPUR95x5fyLnftYHDLHbe9hgAAAAASUVORK5CYII=","2x":"data:image/png;base64,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"},convertPath:{"1x":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAiCAYAAAA+stv/AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAKfSURBVHgB7VY7ixpRFL7j+BifiChmxWSNCEGUZMHKUgKBEEznP0hvpYWIjzSCjb1gZWchmO3SaGcpJIgBJWwSE4ISYbMSXV+Tc8xoHLFYr/sodj643HOv45zvfOfcc4cQCRIkSJBw38GQ/cHwPP9/wTAE1zDzhAIysicEZ0wgEGB7vZ7T5/PJ0+k0kqIJhgoMOFXYbDbNYrE4q9frbo/Ho4R92a2QEJxwBoPBBDY/n8+/VCqVpw6Hg0ulUjdPAp1YrVYtmEdIANb8bDb7WiqVTpBEKBRib5oEazab9TAf8/+qUUQC1hyhqK0rAxUwmUwGjuMcKwLbJOx2u/qq6ZCTa0AulyNwEtB8GI/H38H8OhqNfmo2m1OwFwLJ6wHmGBUA8/FKgWq1yjcaDd5oNK6VwMKE35aFSej6zW7gC7EGIAUiAoPB4PM2iXK5/AwLE55hN5vXoVgVoYhANpuNttvt95skJpPJx0wm43C5XCpUbtfLqGsAFBCtdTrdyO12v+10OjMg9BI6JW57Y7HYqUajeZXP538C3wVty15DyKl+8xSgAsVi8Q3YHoVCcdLtdk/5DUyn0w+FQsG2S4W9FYDKZiAFZDgcigoLOuNYrVafgylzOp1R8JtEchDxSC6X/wYVLrxeL/4Hx1qFvRsG9H2RhMlkkvj9/h+tVutsNBr9AWXOVSpVH6Lug+NfLMtewDxWKpXzWq1GDi5GQUY9RPsI5R2Px98jkcgL2LPB0MDAi0mF7dpisehwYGPCfSF9hxPAl4OkRxDlt0Qi8RyiPobKN+KtuDr3+JxAlt3oiof3A8HB8jYMh8NPtFrtA3R+WxfR8jrG7wEw1SgvqoGR0zqnykkwGJyDw0m/37+Es38J9gwuIaozTiXXdqQHN5e7xF/f0Gr1SjENsAAAAABJRU5ErkJggg==","2x":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABDCAYAAAAs/QNwAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAcWSURBVHgB7VpLaFRXGD73ziOTTGLMi7QhhICpC120abqIFWqsFdKFRSkRunBVC0Jpl12UgrGLLrrooi10ZXHro4UERKSC4gPciKJIwcQXJIsweSeTzMx99ftuzhlvpvOIkLmZifeDw5177rmP/zv//53/nDNCBAgQIECAAAECBAgQIECAAAECBAgQIECAAAHeFGhiC+A4Tva9mqY5YgvhCwEegx0YrMk6Gu8evU3lZd/gFwHuu2jc0NCQfvHiRWd4eFg8fvxY27t3b5aB06dP25KgLfWKTYf0AB1G6ziGBgYGwqurq1/id4QFpITkNc0bHtsFrlHSwDBKpKenpwZ1zuLi4lc4j/Fc5BAhtgtkj2o0Du4e7e7ujrW1tdU7EolE4hSu13d2dtbyOn6HtxUJyv37+vro7rH29vb4jh07mh0PJicnv25qamrE9TgJYoiQBD/CQRc+AL2vpVIpDcaH0ul0xLbtkPd6R0fH7w8fPjzR2NgYTSaT4YmJidCNGzd0CmK5SfCFAAKGa1NTU5plWaHl5eWoqj9z5ox7RAj89uDBgxNoF11YWIiAAIqljuvVHQqyB0NS6Brq6+vbamtru5T7swncPRsOz58//xZ1zdQJHHkPhbOqNcElACWG0hiPx9tx7PYSIPKQQJ2QJLiaQCJzkqbqAMWMIwDFjUIHAt5C9a5cAkQOCePj4y4JFE16D0kQa2RWV67AjyUBHOZIQF1d3ds1NTU9+QgQRUjAtSifU1XGE4oAegBOFQHvFCJA5AkHjA5NJIF5QtUlS14CdgKoyksAjUabgiSgbh0JOPclT9gMaDJ+YyoE8Ht3LgHnzp2joQVJePny5Teoa0KJy4yRJFSFMGqyx2Iy28vrASRA9nZJEpQwqnCodE/IDoMqBFAKElCKBBkOO5E91gmPMFYsCUoDhMwDZAgUJWAjnkAyvSRUrCd4RdAzDO4uRMDly5f/nJ2dfbZRElBfR03wJEuvRYJvcwFCfRzy/YJtME9YOnTo0Pfz8/PPYLy4fv264JHgKpKaO3R1df16/vz59/EzOjc3F+bk6fjx48qeivIEVwPUMFhsFCAuXbr0SzgcHuzt7f0chj0t5gmYWC1cvXr1YxUOniGycjRBfoibCYpXiVBBAkZGRn4GAQdRBvr7+z+DJ4yXIuHatWsH5QijFlUqRxNyNUCUGAavXLnyE84/ROnncf/+/Z9iejxWjASsL8zfunVrAHUNakHFkzZvLQnKA1QqLEoQgN78MRKJ9KG8h/pelA9g0CdYP3zC6wgLlwhVFEjCnTt3PhLrE6WSGld2EZRL4cI0TQ0ekK0u1B6GW4ZhZHBfCqer0Wh0FQKXOHr06CkI5BMKP0VRFc97Gvft2zf66NGjd7GqxCU4rkIXfRcRFj4By1xuzgoNECsrKwXbIfYtGG1kgFgsZnMpDR4Tvn37ttXc3PzFyZMnOxH3XC5zsLBigjADU+wMrqUwczSQIaZevHihtbS0qEcWzZV9I4C9hVh2h0AY9L/rmPGtfVA4bOu6noFxaRhpkzB4eAj7CBYuG2fPnn0q5AoROLLwLBPtDJQ02qRbW1vTEFxx7949ceTIET4yuyuV77vKHgKOnKygV1w9kL2/7mOwIyTg4u5vXF/AwQIJJshIo4dTOK6iLglSkjB6GcU9sjlDhQiFQgZItOgZ9BzPOxxRxAvK7gHevT5+XG4I0HgZq2JsbOyPwcHBf+AlJt0Zwmeg2kGvanR1wMSaoqvuiHP3wbDdbmhoIGE2QwftbHiFA91RRhfdaiv7EMGPBXSEQAQhUIOeq8XHx1E/7m138+bN4cOHD/8FQ5Lo8SR6kQJIPbBxztUhDcmOjvtD09PT2eENse+g920ajnsdesGePXss7j/KUaboDrRvGuABP8b2VtD4AwcO/I2eY9xnoPYmCtsw7i0Mg1w2F0tLSzTaAAE6xM4dWXg/CWKvY7PVodiCABKvdporQwT5kewJCptYM8zF3bt3f4DxIzQePZhGb1LRTYSKDWMshIdLFpMeFNciCJyNVHnd87nLzOGW4XThwoUNGe8X3ESIyQmXuRGvLTCugyns/fv3v2NShLILbbq4ZO6d5nrSWc3zLHX0FpHnfEMouwc4a3+EoHvy1EYyZMKV9dHR0aFjx479y0oQYkHc6PYZnBoQPQu96XpJTk/mHte9SlQipA6t2xzFcSc8oZW7RPjditLCeULOHoAvK79+DIOaFCQbJIiZmRkBQwX2CZnZaSgCCyAO3N/k+A2xsxAqjryn7L3qSyJEN6aIodcdJEQWjDcxLBpwfQPjfQa9noHgmRA2k8ZjCLP8+vOUH3mA+x6C2+SJREKTRjIsBEnhOVUcSVHJcXuz4ctsUAkZjUR82/JPUhaHM54r42XbyhSzTUJ2c9N59b8hVf/mQC1VOdW43b3d8B9OH00KpJcmKgAAAABJRU5ErkJggg=="},crossMove:{"1x":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAARJSURBVHgB7VdbS1xXFN7nOBdHa3W8dDp2vEahrVBnGGgf4oOKP0AEaSgt1V4SWkLxuemD/0BaaMW2RDG1U9QHpY0gCvqoefCKeAPvJIq2jlXHUZM5/b7D2e1BrNGTyZsLFmfP2mvv/a3r3iPENV2TBdI0jaxgqJi+wgopwhqptbW1ytLSkhqNRpWZmZlnABDTN1QUa0guS42NjWowGLRnZ2cnnZycPDg6OvrF4/EkY8rBOWHdqIuJriaXl5fbMjMzUyKRyK9tbW0aeX9/P5QGKioqcor/whJ/ALQ8PT391YODgxAPppjM8d7e3m8Yp4EdMi9EvIgbIuYJtFweDoO16upqnTmWniBAAo0LAGkJY5ufn5+4uLj4EWSa3+/XxsfHNch15piy3d1dbXZ29mOscYETxIuGQ8bc5/O51tfXP3C5XDkLCws/EAQ8sSUBcEzZ3Nxcc2JiYj6q40OCoCcsJ6Y8PCsr6xUkXAetW11d/RZTpc3NzXdHR0fbJYCRkZEHLS0td+12e+nKysp3BMM1DEdJSYnDAHBpELoy0ZtjTheTQqHQJ5gPwu33TSG4j8ODHR0dn8oQycR0u92p0CcI9bxw2M5DAMsTpqamXGtray3d3d23GhoaxNDQkDg+Pn6Mzd9F43kPte+X+jk5Of6JiYnbHKMxPWltbfVWVFTw5/vYQ8vLy7vj9Xqj+H36XADIdrWrq8sJy/XD6+rqBDJd9Pb2krOhckfqDg8Py2HAYLMRgmtBtxA6gR7xGUCxWz4166lnztfbK9xmg7V2q/3dTNwDHdMOtm1vb6vPqwrFqOE0p9NZtLGx8Tvcqdc5S+3w8HCTCUfe3NyckjmwtbU1KeWsCOpyDddyD+x3g50SX/tZAOoZtFphYWEM8T1VVTVaUFDwTWVlZV9TU5Oor68XSUlJnrGxsUdlZWU/YuMxuQ4lOk4Z8uBRcnLya9TlmqqqqofY72usi4TD4VOEN3aZy0phTzeyNw8cwAF/ENz09PRPyPYAMvz25OTkz9IDHLe3t38O3SB1WLJcA10mai74St2RSqpRv2loPtzg7b6+vgbWObrh90adP5EAcCM+poxNyuFwvNPf3/8Vvm9inc8w5H8PV8+R0UUxuOspQEQAIAy3/llTU9MzMDBwE73hy0AgIObn51+XC9ABvZQVFxd/MTg4eBNV0wMAf2FqDyGI4PvM2PfK9O/dn5KSksE2i+TrkYlpvowo4xw9lpqa6mb7Zid90atZXiYJBAFPeDAuQV0/5IGGVfrhjDmsfgu/s8Au3gFxexcYG9kYTyMnAhIEmWPISsE+3h1Xsdx2GSWjdGIZGRnRnZ0d3SuolHvLy8t6WaFc72E+jMvn79zc3GMAoFzEldjR6FZWh+EJH5sV+Aam35DZ/lKeY2Yy7ncHb0p83exwdLu4oNQuIito+ULiU1y/Nyhg9+zs7Iy99Cf5WSDC9MdEXJNF+gcCK6IVrtlQQQAAAABJRU5ErkJggg==","2x":"data:image/png;base64,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"},crossScale:{"1x":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAQxSURBVHgB7VfbS1RdFN9nnIvjfH7OeMEvv8lbgpVoM2hEPSnUuwhCTEY++BB0wZ570D9BEjSbQGG6oT4olSDio+KDKKLiDbygmKHlmDpeqDn9fqezaxCddJreXLA4e9bee+3fuu49QpzSKUVAqqqSFQyVkK+IhBQRGRnKy8uV2dlZw+7urjI+Pv4NAIKaQkWJDMlxqba21lBYWGhKS0uL29/f9+3s7LxITU21YcrMORG5UeGJriYXFxcbk5OT4wOBwKuWlhaVvLm5+doOysnJsYhfYYk+AFqemJj479bW1mseTDGZ442NjTcY28FmmRciWkSFiHkMLZeHw2C1tLRUY46lJwiQQKMCQFrC2GZmZsbOzMzchkx1uVzq8PCwCrnGHFO2vr6uTkxM3MEeKzhG/Gk4ZMydTqd1cXHRY7Vaz05OTjYSBDzxUQLgmDIc/jQ2NjYT1VFBEPRExIkpD09JSfkHCfeS1s3Pzz/BlKuhoeHBwMCATwLguLGx8aHJZHLj8HqC4R6GIy8vz6wDOBSE4RCZtrioqMg4NjZmnZub87a2tnpKSkpERkbGA5/PVwSXL+Xn59/w+/3ahoKCgutDQ0OLXq/3clZW1n232y24B3ufLS8vMxxaThw3HJrlodnOJGOcUfPLo6OjXn5pOeV0Fsehc1x7MDHpicMAGA8KkO2GtrY2Cw5vam9vv1lZWSmQ6aKzs5N8BkuquA6HClio7aHF8MYZHFol9cAIwb2gmwsLCwI9ogpeZLf8KsKEQGuvDofDuLe3Zzqqv9P1OOzI36FEHeiYJrBxdXXV8LswKHoN2y0WS87S0tLb5ubmnyFgtvf19b3it6amRnM/5zimrL+//yW/MgTcSx1Yd87+A6EpLACiZcNhb0fJOZHVl+C+91TEOifV1dU98ng8t7e3t1cY++rqamb8h4qKilv19fWPZJ/gHpTuO7PZnB8XF8fQ2ahbHIMU9nSEIQHjDLCbiqh4ZGTkOUBdYRkODg62yDLkuKmp6R7WXmEismS5B2tdkKWDT9Qducig168dnqCCi11dXdWsc9mIpAfI9ABlnKPXuru7H8Ly89jn1A058vDD+gBjG4S7vgJEAAD8NpvtU1lZWUdPT89VhOcus356ejpVbpiamvqPstzc3Lu9vb3XUDUdAPAZUxvZ2dkBfL/pek9MP+/++Pj4JLbZlZWVDpmYoZcRZZyjxxISEhxs3+wnf3o1y+4VQxDwBK3Ok4mpWxWacBfwOwVs5R0QtXeBrsjIeOo54ZYgyBxDdgns5N1xEsuNx1mkv/OCSUlJu2tra5pXUCmP0QmDnEP/f4x5P1rul/T09D0AoFxEldgj6FZWh+4JJ5sV+Bym/5fZ/leeY6Gk3+9mvo7wdbDD0e0iTKmFo0jQ8oXEp7h2b1CAUgvi+g3+9Sf5QSAi5I+JOKUI6Ttf070TaUngygAAAABJRU5ErkJggg==","2x":"data:image/png;base64,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"},crosshair:{"1x":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMISURBVHgB7VZNaxpRFH1vZnRiovkkDSSBlhCyCV2kKS1k0SRtaHeBLJLf0KyyKl0m2RT6D/IfsnRdVGhLUYRSEBVBQUEQqdDo6Oh89dypI0GcJiOYlQcu83y+N/e8+865ytgYY4wxBCzL4n1TnA0JiXkEJb+8vKSEAsX29jZbW1szNzc3rfPzc4tzbrFR4uLiQkAyf7lcftdoND5RVCqVtyDi65IaOaTFxcVgrVb7HIlELAoaLy0tTbF/FfV0HZ4Z46S8Wq1KzWbTH4vFGEW73ZZarZbMhtCCZwKqqlIS0TCM3t5OpyNBG8KDEEilUiwYDAq3CZAwKaAN5hWuLnCsBlULe3t7vF6v82QyyXHXPojOd5sAjU3TlEBOXl9f5zMzM2YoFLKwz7zLGa4EyGrhcFgslUpv5ubmXiGBTUjTNJHuHwleOGsXFhZeZrPZj5OTkx1RFE1BECwKRVFi+/v7X3AYw42EGwFOdoPaZbz0dSKR+EBi60c0GnWGz7vRw+7uLtva2hLS6fRXJFepUIMS/U8DHKeVSOFsSNBeEihdodsa15dTh8vn81Ymk/mxvLx8dXR05HPERne+urr6DMue0trT09NfxWLxJ8pul1+SJEOWZQ174/Q9KuWZgEUiCgQC2uHhYQTdLoE52e/304vIcoF4PP7eIYCumNzZ2blCqVv4aCIMEFFBRJmentbOzs4MXOn9CSABPUg4Gp7K/Px8G91OxKlsteu6HpqYmOg462mMhL9RcgXEdTjGhHANOgDIaUju6oKBGkBiZ6hjs4rkTVxJY2Nj4wY9oAGlK6iG7iyiclNyWLSONX8wdXNwcNBAchWHoXXebejYpsveRA+w50kbsNwgWxnoDxrCTnh9fd1/GG8E3EDNCGW2xUZWI5D3KSl1QuqUXjCMxSwk1AuFwreVlRV7fy6X+z47O6uzh8Dx8bGIxxS08Ajie4zxExrTHEJkHuG5AvTPBz/HbXQ4hvumDsdgNR1W1SA4864774fnn8+uRfnJyUnPQSS4bvLR/h0bY4xR4C+vmoRqLg1k2wAAAABJRU5ErkJggg==","2x":"data:image/png;base64,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"},default:{"1x":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAiCAYAAAA+stv/AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAJHSURBVHgB7VZNj9JQFH2dltKChdhAkIpjdYgjIXFM2BkTIW7FxAUbWbNiwY4V4WPFmh/AH2BBgn+CvYbEpRqjCewh5aP1HiwRm5k4UzoTk+lJXt59j9J73rn33VvGfPjw4cPHbQfHrg7Osqw/C45jWNNsMRc4YleE7YwrFAr8dDp9nMvlhE6nA1JuDuMKHDkNaJoWMk3zy3g8zmSzWZH2j26EhO1EikQiKtnWZrP5OhqNnum6LrXb7esnASeJRCJMZhIEaG2t1+tvg8HgOUiUSiX+uknwsVhMofmh9Tsb/yJBa4m5yK1LAwqoqhqRJEnfEXCSSKVS8mXDITCPQA4xPWg0Gh9ofluv1z9PJpMV2aZN0hsgxlCAzEf7CjCHEkhMWm8Tk7mrN+cDL0QOUAjOJbBPYjgcniExaY/fL16HYpeEFxLYkVgul5+63a6eTqeDUI55BP5fCjhJ9Hq9YxQrT66nHVPFeQtarZZ1EVar1cd+v695ogJe4lQAzufz+c9yufxeEIRXNF7SeBEIBHKiKD4NhUIa/pPP53HrDlPBmYQ755VK5R39fBYMBk9pnJB9gmdkWb6Pso3eQXvCwWGwZVToxccgsFgsflSr1Te094RGkoZKI4qrCqLxePwOChPtiXb4DgMIoBeQrEnDML43m83XOKmiKDGcEp2SHuMhty05v1cVPUvCbTes1Wqn4XD4XjQavXtTjWjbju1TypAXauCKuXXuKibFYnFDDpez2czIZDIG2WtqQqabzzJXcjlP6vZ78L/AL+lpU4KejmnsAAAAAElFTkSuQmCC","2x":"data:image/png;base64,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"},duplicate:{"1x":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAjCAYAAAD8BaggAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAALFSURBVHgB7ZbLihpBFIbL8TqjjqNojMFkzMTchEkMQsIQAobsQhaBIBKQ7HQjKLh0oS7cim/hwoXgwmdwKSQPYO6JD+D90jm/XS2tyThMaycE/OFQF7q7vjp16pxmbKeddtppp53+b2mYMq2+J7AtaY9dXoDRRCKRvU6nc0J9Lf+ORmZMEASlm1UEpCc7mM1mH5vN5n3qGwBWKBQApiPQW2j5WF3xnZtsNpud+sJ0Ov3UaDROaW6fzOjxeBaggUBgDsqUh8bF4rs2k10DEI2FyWTyuVKpPDoiWa1WpxzU5/OZ6HhVhdpzOp1Wam9gYWoXUOVy+YzGJ3LQarUaZKL31Dk+eMjhcBxS1ycBSVDD4fBrKpV6uQpaq9Ue0njuKTWCHe4/NJlMS0ASQL/f/y7N03H9BsVUiKk5ENnNVSAJCgJMu91eguLHt10oHtTW84AkKMBAq1DwlN/vN7ItxtSFQEzmqT9B1ev1B/TMHEr8xIZAuGUUQ2uB1kGNRqMPxWLxGFAI8k2hJA8tBXU+nxfOU6vVEihFLYECqlQqXWdi1lceT1IMyT0EmG63+zMajb7TarWLax8MBteCjsfj93R8brZhPC0BYUFc9Xg8/obmH+t0uqdy0F6v9yMWi72l8TOyM71e/4Ra3Da/xWK5glKzUSbnL1sYz9SDweBbMpl8ReN7ZCiqp3LQRCLx2mAwoNbdxiaoRezgqOCZIzLjRkWYA6GWeZCZs9nsCyRJ7JbmXIyXDoAia8MTWNxut9uYmL+sfEMHTLxpuk2z97zak9nT6fRds9l8FUWVL4DFPBQbX3K53HPqH+OvgD+vY+Jxw1b/oZQLuwmFQrgZ+y6Xy+J2u+EtA+ZQ2al/lMlk7jDxSOAVI1Pz94N/XNolwOY7RxyEw2H0AWX2er2o8PrLxodicp7MNCRh5VvSMciT5D/XX/ufVl2/AMMW8m/DjDj6AAAAAElFTkSuQmCC","2x":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEcAAABFCAYAAAAYePsUAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAcKSURBVHgB7Vpba1RXFF6ZzC2ZmUwSkyajqY1mtCXRNpqmFwslrTQ/IOiDTzbYQumNQqF9aKkp9Af4B9pY8Lngk1hEQRARjQq++CCIiPjgg6mgoiQ5Xd8+a53s2c4kEy9z0f3B8uzss89x1ne+tfaVyMPDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8NBC/4JgqBFy9bfDYU41Q7G+ZmZmRYYA+Wongw/AaH+lYKqhMmI8bWVLf7w4cMDfE2gvHfv3la5p8yUqIqeVNtLxaASA6WCkBRkcu/evS+5nC4Wiym+JkGSEoArDM9ZxMX0nnVtXlhfG4oBMene3t5sILhz585XXJctFArtw8PDSQoJjInpc0ZpExMTcbnfCiLpJVCRfnFDDFsmn893BRZu3br1TVdXVx73pE3cMhBmlHb//v0v5H5qbGwM72uVdzcnRDlwAE7C+U621wIHN2/e/Lajo6Ob72VJQg02MDDQhjpXaWztEo6qtKZEC0JAHIFT69jWq7OcTyKCbty48R1U1d3d3cFtMn19fSAT5RKl3b59+2uuU6UZgpyE3hwQ5Sg5ObZeto3qKJrYBF2/fv17ruth66JQZSCzr5zS0EYITEk+aj6CKMwNIAcq6GMbtMkhh6CrV6/+wHX90raQTqc3VlIahSQagiRJN0+IWTkHiRShAKeHXHLIIejKlSs/ghS2Qb5XrKQ0IcjkKuntmocgDSu2tPRI/alUqliOHHIcv3Dhws9c9xbbtpWUhlBEruL6jCZp5KCgCcZBhpzBwUFVToHJ2VKJHHIcP3369G9cN7aa0jTEkIOEIB11N+S8zQD+IBdIl4wEW2BbkRxyHD9+/Pgf1SjNzUEUdvMNPZpukUSpYVUVOeQ47rafnZ2tliDNQQ1NDn5oVWFFKxCk9UA1BFkDxYacapTrraomhxzH9+/fH5FTLUG0HGINqSATVmyd7e3tVYcVrUCQjVUI0ilJqszSSH0RyLKD9lYgZy1hRavkoGoVpCNparBxUNSVrzUh0xoJOnjwYNl2165dw5QECtJZf8MoKOqtSBIyPQM59JQE6aSWnIEi1ROBjJCdsNr6LOTQUxJ07Nix3VQaYnVP0tH0gZ6iK6fnSNDi4uJ/ShA546DA2Q0Barn7UDW4NyLZmaga8/PzND09TZcvX37inr6LCeuYnJz8hwma2rdv3xye4clqMDIyskjLpNcUT4yQVwort5teC+7evRuMjo6uqjQo6MSJE5/g98i0xoRXUIcpRklYZTKZioNAhILi7NmzR5jUz/fs2TM9NTV1QOs5dxljhURlN7x4ll7RFCDozJkzH1M4BjJLHeVCqxYw0wd8qUoJ2Sbm/Pnzf8fjceSGT9l2c3nSbd/Z2fnMSltaWprndaNdJIv6bu/1wnMOvobsYpp/Hjx4QExOSWwzMVFeuHjx4uHx8fG/uLhAIRGxhYWFhPte5Av7uXPnzh05dOjQv62trYv8/wVqsVhsCfcTicQCrK2t7TGr9zF364+Y4Mf9/f2P5JUYrOrvrVnucRe7SsY5tmIuXboEUj5gG2N7h2072w526v2VlMaLYodZXRNsH/G9D7n9e3wdF8O7dnKdvg+LZ0NsAxSuVWPpFsrBB6j5uEfJMbNyyTlDrsSxZiPObE8mk3CgiC6fy8Nc3mGTYxMzNzc3y6TsYuffFQK2UUgA7E2EMF+34H1sm9jeYNtA4fo0uvRsPVcP3XFOyQI7cOrUqRmu28FEjLAzQ5YDr1P4lUfKKY2T8p8UKm2UbVjaDnLo4LkNfMU71nOeW48rhSsCr7Gt45DCwlsOvZW19lzzhGzIkR8ACZdszXCv9AuJ3HkxfZM4gjaQPIiEo1srKY0JfVvUsVGcx7PYzunqFHBZr3nZE8MWkc6z7C3ounTluuOZzeVy60AAulLOMT/BMSy4U6iWgjgGB/LYAZUljs02MSdPnvydQ2gnE4MQKopCQAoIMLuhMn5Ji7WJ6d8p+T26pVy3fXebnHZJyr1Hjx79jEJVwKAWyN3kABwq4GtGvjbqI6Xx2ORXWs4rm+VZEJoTQpKywWcOINCy85HJoFSv9dulCHNoyUECfFk43ZPNZjV84FweE0KZoKakbU7uRUqjMLlqXlKl5SSpJqylCPcsj5Zj1EBLpiVHUOC8zIrheIdYFl/dWu/V0xVQUInSkGwRlkwsFBWt8kEtgZzpoWZBsDwk11Nd5vASW5uoRA8vmfhXqeOIidyPlAbjnNUjpzHMQQJpo8RQ00F+dHS6SwhIyBmbuLXHbe8xoQ7qMYedSFTW09OjPQ3yiy45NP0BJltBasaxwDnrJ3/HlEQZBrg9TbLhFsyfB4LSA5RAOedsgsxZQlWa2AufRTcy4y0VykDgXF8IGnIlEAiWzyTrZFNDLmrzyp1Z9mgS/A8v5d7OXsjUKwAAAABJRU5ErkJggg=="},grab:{"1x":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAANwSURBVHgB7VY9SFtRFL7vJ///PxoSLCQxhZZQKhiQbIJdpS7SrThVoYNOXdWhXToodCilBXGpg4PZSmmLgu3UwUXpJELEDBYbo0Ki+bn9TnqfvEYTk6hbPjjcm/fuPfd83znnvjDWQQcdtAHOuVTzSGJtQm52IR2qmW6vMjo6qszMzNS+uzkIpxIOkQcHB9X+/n5DPB434pkVNg57ArOIZyoFpe1h1wUcVQMQzoOwF7AJh8Phx7g0OTnJ5+bmOOavYc8pIKvVGqQgbyoAcqKEQiFi+3FlZYVPT0/TgW98Pt8vLkBLdcGswxwwCkIm5dpODfkmNi6Xy4Ofn7PZbPXAoaGh42g0eqwFEA6HufYuFovtYu192ITRaLwn1JDrKdKwCCVJYoVCQcrlcrTu5+LiYvX58PCwvVKp2PVr3W73uU+v1/t1YWHhLQJ/n06nTayddOiq2mS327sMBsMAmB8RS2JLrDX09fVxvRo4XFMjjXrxkY96ZOsqMDs7KyUSCarqrpOTk4lisTiwurr6aW1tTc+2ln0V6BZ2eHjItre3M1BKRVDURawVEHM1EAjYMH6n4qMiw/x4amqqym5nZ+ec9cbGxoV5KpWi9a9sNlsAo7nVQqTFBqfTiXR6dzXnJK1e7kYAY64oylNKH7VxywHQJpG/l+RMA9JwPtfUGBsb+28kjIyMcNRNgkiwfy3ZGqh9kFu3yWSK4efS/Pz8BZbI9aWjKMA9s9kchYJOuq5bOhz7GV0gmFINhMDkIRxltF6/KgBSCftSFovljvDR9DdHg9aCBmKAMYx8PtNLXC8AKs7e3t6MqqqPsK8bSrR3DwglJHJAtYBU3JVl+d1l9aAfKUisG4f8Ebhw0geMXee7QKno6emxoJq7cbXSFfuhVgmqDy0wYo91cWo/9L9ZpLJ9iFQodCfQlw7zB0jLHrUkGR2MZ19gP2hO7zAPU+oE+4ZoShoKAlDg1JrP512wx5C5C69k3HQc+V4vlUpH+J1ErexD/m8ej+comUyeLS8vl68dgLYOd4Mhk8lYTk9PbeVymUZqrwoOLOOjVUHVVxDYGeolHwwGC5ubm0UEzhs5bjY/lF6Gfi7hv0EeRZnDYQe4JvbB9DcOP/D7/X+gTJaYRyKR/NbWVpndAiRRVIrIr0qXjJgrOqv+CeGcsw46uAp/AfTlkTMRc7nzAAAAAElFTkSuQmCC","2x":"data:image/png;base64,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"},grabbing:{"1x":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAL3SURBVHgB7VY7SFthFL65N4+bxCRGkgghDcG4FNMq2Ap2Urq1uPkYCsXBpZPupRDH0kGXznZwsoNI6Sx06CY4xKEuGgqBLk3Sax423vv7fSF/UMGQ1yT54HDO/Z/nnP87J1GUAQYYYICHAiGE1LZO9tnbXXjzYBswNzenGoZRH/P5fGJ+fr6+bHNzU8gtSr/QuFydnp52JBIJHbbX6XSmoHch32A/hX4NWYlGo57x8XEXbC2dTqudZuQ+qBAn5AWcKMzMzPyGnTk7OxMU2MX19XWxtbVF+xPkHeTxxMSEc2lpSVN6hI2Rh0IhH+zvvDCfz4vh4WEhgaw0bawRdAZOZt1ud4xO8AylC9h4HtMYi8XcQ0NDEVVVv9ABYmdnp3np/v5+02YWCOwTDofjGZ+EZyjdgO/H6GGmwuHwT0a6sbEh2gHX2e322Ubm7iV7S8+Wl5fVo6MjJyJ/u7e3N4voFaS+OX9+fl7Xx8fHtzRRKBRYLWXLsmzgQecVwfSj1Oi5H5K+mWaJ1dXVusa6W1rauq4nRkZGuF/rOAOsdepgMEh9enBwoHSCXC73C0eY4IFJPihdgp77GAn07uHhYVsZ2N7eFni29x6PJ4p9bqVFFbTiADexxGpVAIT6vLi4eCrfncBcXU9OTjY150HAH4j8a7lcroLEV0q3XVFWAZmMmo5rmvYqmUzmZClKsC/IMbIf61aw/hGO8PbciFjDbCaBQCDocrmSGHojUy8vh1N/KLQ5h2y9RN8IsyWLfrViHoYfnRDs52NjY0W+N2Vqaorp/Yg3/0AbpC3i+wnZ36iilmjLO0YBqKOjo/rFxYWvVCoF8MZeTGm1Ws2CfUWNbwtZquLbQL8w1tbWLpFBq2cH5DrwwZ7NZnVwUjdN01WpVDhuer1eC04JpJ2emqiay0gk8j+TydTw3ZKA7fZoPreysLBgplKpCkhp+P3+PDLyF78TeVxeREUUkZ1/8XjcAGeqJycntXYO7oYgtjtaNOy7kfbvD8kADxrXPOLlPgoRGlwAAAAASUVORK5CYII=","2x":"data:image/png;base64,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"},penAdd:{"1x":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAArCAYAAAAOnxr+AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAASOSURBVHgB7ZjLSxxJHMd7nPdTHUfdjGZ1d02WXWGZ4K7Xlbh7WgTBFZa9OP4BCx72KOpxwYu3PeyCSkgEI6ghJEdByCkHwSCCgaj4iM84k+DEMXZXvt9OVWg678SeeJgfFNVVXd31qd+rqlvTilKUohSlKEUpSlHOgLi0DxQhhAuiDQwMvHy2v79fmC9zuYR2hsTV2dnpXltbu4DSjHawvr4+gNrLfiyghIth0T6nSAD/0tLSb7gWuq6v5nK5q4D+c3R0tCaZTIZw39fS0uKxAH8y9EeZvqamJri5uRkB5P3W1tYYNKp1dXVpgNPy+fydg4ODa/Pz87Pd3d0PfD6fUVFRobe1tel8vpBu4pJaO7e+vj7a09PDCQVgRVlZmWhvbxcjIyNieXlZHB8f38tms/9S+5WVlRGMCzQ1NXkL4hqcgD4ZDoerx8fH0zMzMyYgQScnJ8Xw8LAJy75UKiXgs4JjDMPIHB0d3RwbG0sSVjsFd3gnaGNjoy8Wi8U7Ojp+3N3dfUwowhB2bm5OKGEfNU5gtZDV1dW/aBEGnea0MLpRRQOBwFeZTOauMjch7bBKhoaGTGgs7H8srEy5gOakcILa2tpgKBRKImj+IUQ6nTaB3gRL7SLYBIJtnW6D1zClOQ+Kyh+NRhO9vb2/IMpNn1RCSOW3BFTCPo6dnZ39ncElLeOsME+Wl5eX+v3+BgTJBrVlh+KaGExKaHq2kXOH6OO473Hc/AyG6urqMC7PI0CuEIAgShg47KMGrebnAvb29rLT09O/8nkZVM7BKvOjVE1MTHSpqH+bEJyPMgsQFi7wMzOIo3mVL6b5GcFofntycmKmKWrV6gJ2SFWo8f39/f+YqqSvOuoCJQwKpKm6ra2tKXveZCbgDmWH5KawsbFxA9d1KBHHQYXcpSKRSCVgLk9NTf29uLh4HYeUhwQkEIHtkCsrK7dwBvgB6e0c+kK0DBetTl7aaYsyP7WK3PgFMsAFr9ebQmnGpGnA3mYwUcNWSNy/hHYd3UaeGwLMyw0NDfR5ryO7Fl/KXYYTcWIm82AweB7QF3H7Ul9fX/fOzs4T+qSETNFVOJZRn0gkolZf5qKlhk9Xsypi6WfysEGthEtLS8u5c8HE3w0ODv4B7V6lubGIL2UABqlNuE0VAV+8Sgi6ERddiABzUctSK2FOTDhosR7tpISkucPY2SrQ/7UVlG32cyF8h+O7F+fmJNLvIvF4PMaaWrSb2wpq6+MZ9vTd4DWwnICB4ZbFQ7OiTii4NxUKzxK4DtBCjp4J+bkhgXRUBjTMAzThPXIhL8vr2hjrxsJMbTp+eFXfRqyxXQp+Q8FvdfjiRVz/hCzQah2P9mWMbeb9w8ND3ePxcMNwHtQq3KH4oYcUlsO5NOt2ux8BKmMdg3YWqe0RgLNIX085nlbxaAUUmhQgOqI5v729bQBGVzuRMjfgM4REesshEJ9hrPE5f2yYKYyBxfQFDX4DN/ieNdvyh4bjefR9xaVyrTxEV6HE5Zb6SkoqqOntQrOiyuOD79nCwkIJgs1AbcANdP7fOmti/vIR7/j18xwhEWTtASnMcgAAAABJRU5ErkJggg==","2x":"data:image/png;base64,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"},penClose:{"1x":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAApCAYAAABHomvIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAR3SURBVHgB7ZjLS1xXHMfPHZ33OD6m1mY01YJJUKFMsGRbre2qCIIVSjeOf0DBRZei7triQjelpQmohERQQQ0hWQpCVlkIRhAMRsVHxPcYfIzjnZPv93qOGYY8SOKNWcwPDudx7zn3c3+vc+4VIiMZyUhGMpKRjGTkLWKI9xQppQERnZ2dZ3M7OjqktZhhSPEZiNHU1JS1tLR0BeUG+t6ysjIPaifHAe7gS7CIixD1YPfs7OzPaEvTNBcPDg7uAPa3/v7+4nA47MN1V01NTXYK6AfDfpCJi4uLvaurqwHAPa2rqwtCg6K5uVkASsTj8Uc7Ozt3p6amJlpaWp65XK5kKBQy6+vrTc7/FO5gKC1dAmRfa2srHyQBKfPy8mRDQ4Ps6+uT8/Pz8vj4+EksFvuX2i4sLAzgPk91dbXTVhfgwvQ5v99fNDg4GB0fH7fACDgyMiJ7e3stSI5FIhEJn5S8J5lM7h4dHd0fGBgIE1J8hNnfCVhVVeUKBoMFjY2N321sbOwRhhCEnJyclFo4Rg0TVL/A4uLi77QAg0nYJYxWVDkej+eb3d3dx9qshEuH1NLT02PB4oVu4YXytKmFHcKFS0pKvD6fL4xg+IsPj0ajFsibIKlNBJFEEC3TPbAMU5N9gKjcOTk5X7S1tf2IqLV8TgvhtF8STAvHeO/ExMQvDBplCXuEeS4/Pz/X7XaXw/lXqJ10GL4Lg0QLTcw+cmYPfRjXs20zM528qKjIj+ZlOP5tPpgAWhgQHKPGUs1M8M3NzdjY2NhPnK+C5fwhtZlRvhweHm7WUfw2ITCnMqoJCVN/z4xgS17kgjQzIxLdaycnJ1a6oRZTTZ0Opws1vLW1dZMpR/miLaZ20NmRbkrX1tZG0/MeI5s7Sjock/nKyso9tEtRArYBSrWrBAKBQkD8MDo6+sfMzMwQDg/PCUYQgqbDLSwsPMAe/S3S1CWMeW1L2trM1CJy21eI6CtOpzOCcgMPjQLyIYOEGk2Fw/Xr6JcyC5SXl9OPz45paJ+vP3Jh7gpM3PRHJmGv13sZsFdx+Xp7e3vL+vr6C/qcgovQJXJzc/M5hxbQNe530dwqaMS5iI5ALqwOAdSInwDcaWDKiq6url+hzTs0K+C/5jXc46Pm9/b2/uRBggWu8Q9TD9exc682uDhNT1D6J6GgtTL0wzQrai8K4f7jHq53Hba3t7f/Vvk1W9gpNBG1qnwsUFBQEETtY96jObFNhnDgjaUGEUE5hnZIzTNso+SHFSCTqBPonkAz1nhlZaUYGhrKgq/SHQROQ2dzTlMq3sLnc2H7tExs35nsFNJK0miahGWBBi3v39/fFwia293d3YKfDITD54DAKX0MviiXl5cv5gtRqgMvTcxIn5ubu5tIJF6wTE9P/4+xa+KViS8GUAeQyp1XmXrQjxCOyZtBotKNzZHyGlFmN1HHEeHi8PDwGIHhRAoyHA5HAtEer6ioiCtXMC7m41qcarK2tjYLvpaFg4bBgvxoIjcmsaebn8VfCrVb6A97R0r7TF4CC4FGHxlDeiUAAAAASUVORK5CYII=","2x":"data:image/png;base64,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"},penDefault:{"1x":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAkCAYAAAAD3IPhAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAN2SURBVHgB7VbfS1NhGD4r93vul63lprlgFiHExPA2yboKQTAhutn2BwRedCnqZeDN7rqI0BEmmOCMqEth0FUXgl0IBulwM/EHbgWi4vb1PKfzyRpp5Y51swc+zjnfOd95n/M+z/t+R1FqqKGGGmqooYZjYVD+EkIIA6CMjIwcrR0eHhbqywwGofxjGPr7+8+vrq62YnTi2hoKhSw4GjkPkudImEM5a2hBzEtLS/dwLorFYmZ3d3cCxB4mk8lgIBCw4b6pq6urrozUHxE7lUzBYNC6trbmAJFP3d3dTmRGiUajCggo+/v773d2dl4uLCyk4/H4Z5PJVGpoaCj29PQUuV5vSQ3a1zdms9nkwMAAXypASLjdbtHb2yvGx8fF8vKyODg4+FgoFJ4yiz6fz4HnLB0dHUbdZORL6BG73e6fmpqKzc3NqSRIZmZmRoyNjamEOBeJRAQ8JPhMqVTK7+3tvZmcnAyQkHIKVX5Jpq2tzeR0Or19fX03Nzc3vzIwA5LQ/Py8kOAcM0dSkmwmk3nEzNLoih5g1eBQb7FYruTz+Q9SGhKpJCSRSCRUYhsbG89dLpdHyqVUC76kqanJarPZAjDqEwaKxWJq0OMIMUswuIDBs5QYr2E70IcMDub6+voLg4ODd1A9qkckSET6iCQkOMdn0+n0fRpay3D1YB/xeDwus9kchjFz/OrKwORNA0tQJl6jJyXoOdyv00UqGtDv99tx2gxTvmAQBpOgWTnHTJRLRZJbW1uF2dnZu1yvGbk6QlIqjIvT09NRWU0ngeS4lNVFQpDrFiuz6r7DxZQKX+rG5bXDw0O1xJmdcrkqicjBzG1vbz9jmWveqVquczQiSrxlfX09VdlXWGHsxJVE2BhzudxrnLdgOHQhI7Ru7HA4fAh4O5VKPV5cXHyFjfMLSTAoSVUSWVlZeYs96wZaQyPmrLo0QCkVs4PecQmV1Wo0GiMYnQgQA6F3NDAzVU4E99tx3eL1ep30DM712av4Veym1J6dlQ3NarU2g9hV3G4fGhqKo+t+o0c0IhHKSq+RiC7VJCErgbprGyArzE5i7NCQ4/ro6OgDZGmC0oDoZc30Jt32pxNgYBDKR1L0EwkgGyFcByiNRvjMiRwB2VI31HA4zMAOjYSN2ZO/ppVrzvQ/Vfz4ef/ptxNzpf/x435ESB5/VzHfAUyDqbXE82JSAAAAAElFTkSuQmCC","2x":"data:image/png;base64,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"},penOpen:{"1x":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAApCAYAAABHomvIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAARjSURBVHgB7VjLS1RRHD53dN7j+JjMGi0NrFAhJoy2adYqBMGEaOP4BwQuWoq6q3DjoigqUIsSVFAjaikIrVoIJgiGqfhIfI+BOo4zp++73WPD0IPMqy7mg8N53HPO/e7v8Z0zI0QSSSSRRBJJJJHEH6CJf4SUUgNEc3Pz7tqmpiapb6ZpUhwBaDU1NSnT09NnUS6j7ywoKHCgtnIcxC38CBZxGDBebB8bG7uBtoxGo1MbGxuvQPZ2R0dHrt/vd+G5raysLDWO6J7J7snFubm5zrm5OQ/Ifa6oqPDCgqK2tlaAlAiHwx9WV1dfDw8PD9bV1X2x2Wwxn88XraysjHL9QYSDZljpJEi219fX80USJGVGRoasqqqS7e3tcmJiQm5vb38KhUKPae3s7GwP5jlKS0utpoYAN2bMud3unK6uruDAwIBOjAR7e3tlW1ubTpJjgUBAIiYl58RisbWtra23nZ2dfpIU/+H2vxIsKSmxeb3erOrq6kuLi4vrJEMSJDk0NCQVOEYLk6j6gKmpqTv0AJNJmAVmK6o0h8NxZm1t7aNyK8klklRobW3VyeKDnuODMpSrhRngxnl5eU6Xy+VHMtzny4PBoE7kdyRpTSSRRBLNMDywDaXJPIKo7GlpaccaGhquIWv1mFMgORWXJKbAMc4dHBy8yaQxPGEOqHOZmZnpdru9EME/S+skkuG3MEkU6GL2oZmtjGE8TzXNzQzynJwcN5qnEPgv+WISUGBCcIwWi3cziS8tLYX6+/uvc72RLPtPUrkZ5XhPT0+tyuI/gYS5lFlNknD1FSqCKbrIDelmZiS653d2dnS5oRXjXZ1IThVaeHl5+Rklx4hFU1xtYbBDbvLn5+f7EnWPmc0TJZEcxXx2dvYN2vkoHtMISuNU8Xg82SBxta+v7+7o6Gg3Lg9fSYxESDSR3OTk5Duc0RcgUycx5jRNtJWbaUVo2wlk9Fmr1RpAuYyXBkHyPZOEFo0nh+cX0c+nChQWFjKOd69paO9vPHJjngoUbsYjRdjpdJ4C2XN4fLGxsbFuYWHhG2POIBdgSKSnp2dyDT2gasy30d1G0oh9gcpAbmxcAmgRNwnwpIEri1paWm7Bmq/oVpA/zWeY46Ll19fX7/EiwYLQeETp4T5mntUaN6frSZTxSVKwWgH6froVtROF5J7wDFenDtsrKysPDH1NFWaCLqJVjRjzZGVleVG7qHt0J45JHy68IRJjQrGQKMcwz2es00xjyR9WIBlDHUF3B5bRx4uLi0V3d3cKYpXhIHAb2l3zQ1LxFS6XDcenedexeKiMVLFqxBZdfGJ8fPyhkiJaj22c0y/4TJh52/kbYbqZLmamg+TrSCTyjWVkZOQpxs6Lny4+eCjtRNNtaOc5Sg/6AZKjeDNJDLkxOVN+Af6aA6Kow8hwsbm5uY3EsEKCNIvFEkG2h4uKisKwstSni0MCLVleXp4yMzOTgouGxgJ9jEIbYzjTo0fiXwrjtFA/7C1x7V18B1UTQJWXHh7YAAAAAElFTkSuQmCC","2x":"data:image/png;base64,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"},resize:{"1x":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMTSURBVHgB7VVLSxtRFL4zyeSdNMaobQipizQtxtKI2y60YFeFWmiwSxddtEJL/Ae6aZfZ1irooqUF3Qh2lYVuXYigiAsf4INCkeAzRk0m0++LEwlpogldlebAYWbO/e53zj2PO0LUpS51qcu/IJqmSbVga8HLN5HhIRUTVyLX7fLw8LBE0blrCqYsaVdXl7G1tdVyfHz8MhgMmvldSsz3oaEhOlSIPTg4iOLd0tnZqej22oMoOPd6vc50Ov1lf39fOzk5+YAlO+2lAdDW0tJiPzo6+ohv7fT09KvH43GFw2GTHkDVQeTBjJ7O4fTbxMSEFolEyKstLi4+x7qD2SA5n9SmpibH/Pz8C2KI5Z7Dw8PvDQ0Nt4BnEHK5chjLRYDTGJaWlqxbW1ufp6am+mKxmJidnRXn5+c/caone3t7jxVFUYmVZVnL5XJSJpMxpFIpMzHj4+O+7u5uLvdtb29rgUDgjc/nS+M7c2MA0WhUnpycNOPkI3Te398vent7xfT0NNUHyHtRheAQgnshrxCEQJZeI6gcvrPFuNIpkDY3N2WkzYiTKEiZ+Fshx8XFhQI1InN/lKG0Jqy9cWFhwW42m70bGxvxRCLxbHBwMF+CUCj0a3l5OYH0Z5l6TBtLzqnTVFWVUQZje3v707W1tWaWIB6Pi56enhm/3x9zu91JTEcK+CzxFaNFCQzsZqvV6oejR+iDH6jpVROOjo6+hT1iMpnC0DYqtoZh6xgbGxsoNCH37OzszGD9oc1muwOMjdyiCpHY1Xr33oV2kIjEKysrI8hMCIQ+p9PpdblcHqw3Qr204flgdXX1E0eWexgobAGoi1MlqhzF/C2mz68bmSBBG0rxDs7vORyOZmYINpNOquhYO9eACc7NzQ3geR82v36Qqp1fCW8wEvMyIbHdbr+NUzdinPKpLL2IxOVE2aAe4pkhvDv1IOXrTnudyCAwJJNJQzablSwWS259fV2FQ/XyuhfFzcTb0LC7u2s4OzuTiUXzqWhetWLTVSGFO19mRgo/pwo/GKno5yXV+lesS13q8v/Kbx4phRKwTn8GAAAAAElFTkSuQmCC","2x":"data:image/png;base64,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"},rotate:{"1x":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAQlSURBVHgB7VZNS1xXGD4zc2fGGZ0PP1KKmVCbTlro0EZqaGt0oavQCtWNuCgUQYqr5i+oK7sRXWhjsMUPGChR3A1ZxY+9QY0YDCpqFF2I3x+jjjMnz3O9R+4iCc7NZBHwhcs995xz3/d5n/Oe5xwhru3aPmWTUtr4iA8wu0jTVNDm5ma7DdbS0qK3MWQJzJV/UM4rKysda2trjoWFBT1oYWGhcLlcKU3TZCgUSo6NjaUkJ9tsUmTCjMC2iooKDcG8y8vLvxwdHf1zfn7+WhqWSCReHB8fR0dGRiKYm1VbW+vA244h8UGm6A6Hw+6enp7Q/v5+987OjgTlsqioiN71p7i4WNbX18ulpSW5t7f3qL+//yb6nVwayyDUOtNRV1fXLWbZ19enB25qapKjo6OKADk5OakDCAaDsqOjQ56dnc20tbXdwr8uw4cl02kvKCjw7e7uPqZjBmeWm5ubk52dnQ9LS0sfYF5Zd3f3X+h/yjHOIdDt7e3H/Jc+RBq1dmlEjqLyDAwM3KNjZsf31NTUf06n8x4K71u32x3G1Dtso6+EYwoEl2p6evo3+hAWdpsgcgQNwtET0ssHBRhDoLsYLsrJybkRNMzn8xVkZWV9gf67yPw5a4TP1tZWT25ubgD9abOgFx6DxOPxlywyrjPY+JPB6ZTjBr0a23gHCIJzWB9kAXWzSh+RSMSVrkZwssfr9RbKizLWi41UM1t8u40Kt5l3Csdqamp+NP9DH2h70y1GTvZ6PJ6Q2VldXd0PpNzI/NKM7Bx5eXl+sPClNBkBUD/excA7UVHh6Pv09HQddAoonGhoaPgGO8LMkl1lxjVHsMTJyckRVPBrPBGACdvt9sT6+npKvCfTt5nEj5TTFLbcMxSgGB8fF2VlZQ+xpk4Uo1ZSUqItLi5+NTg4qGGeBoD2QCCQxNaLY85udnb2Ngp2HyzGMTeJOeLKptYUzRvDw8N/cEspDdjY2Gjz+/15pBvK2JpMJldisdh3xnZzG/95SLvR5xQXspxeERp6zjW9jcDR3t7eSxDcmsi4dnV1tYPfNCzN3wRlAHCazgNrx7USItD5WXV19U8HBwev2tvbdUGiJnBb0tS5QCCKDYIwAFgLbrpo6FLM3VBVVXV/fn7+fwYiAGqDMA4j9ShQMzMz97HuTsvZm1mgiKAZIAjoQKSxsbF6ZWUlBsoXFANKqA4PD+ei0eivmB/MCACYzQTCh8r+nDWB9veo8J8nJib6VNbQ/X/ZD6A3yVqmAOimloM1QRkmEBxEd+bm5h4x69bW1t8xHiFLFCrUhH4pyRgABYJsUAUJhLI7NDT0wDgRbxMU3j6ype6I4iOZLrvMEm8/NcE48bzi4tRLS/MdwoLxeMDVK4WtmczPzz8DgER5efn57OxsCrfkzFxGrwDCZj4RxbVZtDdwnJDZRD9PwAAAAABJRU5ErkJggg==","2x":"data:image/png;base64,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"},scale:{"1x":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMwSURBVHgB7VXPSxRhGJ6Zndnf2SrK1rrUQhtBVu5ml2566yjUktBFKIiEwL/AH5fsLBZ5EBUyBb1IdfKgF72JJxEU1HW3lkVERdFdd2em55lmZBE33W7RvPDxfvPO+z3v870/ZgTBFltsseVfEF3XxUp8K/GXLgKDEkuBy4Gbdqm3t1ekmNgVkTkXtLm5WY5EIu6Dg4Nn0WjUxWeC9/T0MICDK5FIGAt7hb57e3sJ7N1NTU2K6Vc5CSt4bW3tlePj48+7u7v64eHhO7zyh8NhTygU8q6srDxOpVJPgsGgj7a6ujo/gr/HWf3o6GispqamqqGhwWkSuDQJw5nsGRxBx0dGRvRYLEZcfX5+/unQ0NAjVVWTGxsbOolxT9vc3FyCPvTlmf39/Ynq6uqrwCMJ6bLlMG5O9kj7BIECgYC+tLSk53K5H2trax/y+XwaqTXsTBb3hUIhtbq6+hHZ+klfvuNZYIyTBDNxHgH5rAG1lCYnJ124+eDU1NTz9vZ2obW1VZienuYKwaWDfggqIAPGmXg8LiD1YQR9Y+HgEgLPQtq2trYE9M+rlpYWDc/F0nhnp0BcX1+XwFjGLRUwFs4TBBMQrOxzqRDj5OREwZK3t7cvLINRe+iAy+WKptPpr8PDw6clQFay6IEv1N3d3Ub6+Y572hYWFsaorRLwLDHgdyvwm6HyRwJky3FiV3s8nrCiKI3JZPI7gawm7O/v70Rq29DlGTYgG5H7rq6ulwMDA51WE/IMJuSb0+m87/V6rwPeZ47qhSJy3s3uvYkVJxCBl5eXBwH4gKAgFx8dHX3d19f3Aj4PYbsH3YjR/ERiPAOfGGw3sKrMzF5uCrAkc34DyAQB7s7MzLxFWW7jud7n812Drd7tdkegI7RBB6lZOoxjB/Qd2MLmRcoGL8uIXzBMg5zJZNxoIDcSIEEKCJoHuKppmojRk9BYIkqmZbNZdjhT7PL7/Q58jTWMYB43zy0uLqqwaxURMEUCgGNnZ8dRLBZFWZb1zc3NIshpWCJqeuoIsjpGT8J7mb4gquHrqM7Ozqogowt/KdbPxPj2Wz+nMp0slvy8xEr/irbYYsv/K78ADLbk2M0TFOAAAAAASUVORK5CYII=","2x":"data:image/png;base64,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"},comment:{"1x":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACEAAAAgCAYAAACcuBHKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAANESURBVHgB7VY/SFtBHL73Yp75R00Qk5RmkFaXmhZBFzc72KF0cFFwcy1C1LWLunV1dXEoUsQWXIJDEIV2EUQkRUpLqG0sgkMwSaPGJO9dvy++J6FFyUucSj447t7d737vu9+/OyHuDoqUstrm5+dV65u9Ob5xY5toAuZPhKIoYnh42BGNRtWDgwMSUK+mFaO7u1t2dnbq4+PjBubYpLhLmCT4Q62rq8t3cnLyqlQqfTQMI4s1yZ7fnIeMl3KWlUSzsMxOAjipKx6PPymXy8mtrS05Ojoq/X4/T1vt+c15Xdd/Uo7yJvHmiNC/5olcGxsbTyuVSnpmZqb645sa1ylHeRIZGxtzWO5sFOrAwICzo6MjUA+BWiJwz2dYyN/X16c1RYKnCIVC3sPDwxhNXQ8Bq1Ge+zD2Ug/12c4Osh8cHFQvLi7ag8HgxOzs7PVaf3+/QAz8s2d9fV3s7+9Xx4uLi2JlZWUCVny7trZWwpSuigaQyWQc+Xxec7lcj7e3t+1sFZTnvlwup/X09DQcoCpd4Xa7I/KqAtluBPY/wNhDfY24Q6IIUYmKOpBHjN3LZrPVtb/dUesGC5AXSNffcOe1FWy7Y2FhwTKfUSgUvqJSCjug/Pn5+Rccwqqg9kFDMM89Hs/9ZDL5Bqe1nR07OzuvMQ4hJtrRK7bdQVdQmc/n02HS/Onpad17p6enxdDQ0DEy4wNaKZVKGfK2m+0m0BI8AUgEQSAxOTlZlwVAQIL0cSwWe8GgxpzXrLr2QRKRSMTt9XrDl5eXv+BjSSLLy8vytrsDKf1tamrqJdLzISsm1q8rpm13MDCRFcrq6mpU07QHiUSicHR09CmdTn9H7p8tLS09DwQCj9ra2nwo6QVkTmpvby+O6/y9w+HIO53OHDgUR0ZGdNO1jb0nVFWVm5ubP3Z3d5/BpBkoVi2FON073KjUq2Ce0V+GfBGkCnDHWTgcLsJypbm5OaZ6VZ/takUT9vb2aqiaLvysHVap1n8+YEiE35DhHEu7gSzSQaYIK5VwaZVxX1RMAvYDspYELx7egowNcVX13Ga6uZi+rKh85LDnGpqz5jHT/IOGSiyFZq+ytx461hvTWjPnRAsttNBCC/8N/gDQTw4VRAv8rQAAAABJRU5ErkJggg==","2x":"data:image/png;base64,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"},arrowCurve:{"1x":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAuCAYAAABAm7v+AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAARNSURBVHgB7VhNSJRBGJ51f9x1f3RF8YdNV9PKzFwSAsODEkRBRB0kAg8ekggPetGT+HOIvQQmdEpwDyKEB8OgQxf/Ar0oQil1EbeIdlHBdkFFV3d6n3VGvzal3P1WCfaFYWa+Wb/3med95n3nk7GkJS1pSUta0v5v07CTm4ZzfjjRaBjm1HOmgqWwE5pwrqmrq9OurKwUV1VV6Xp6egAyls2pYhoCoc/Pz08Lh8PemZmZsvLycgM9TzkTUMKp0WazZdKY7+3tfR0dHb3qdDqN3d3dpw8KTnNycsw0zAMgmvPd3d1vw8PDLoCqr6/XnjYobVZWlpX6Qr6v7t9A0dzIYtBmzAaGMjMzbUaj0SkBRYNyOBymWMOnYyoZAUB3rqOj4y3199rb278sLi6GaBwWoBNj0AgYomGRkiEWxRSETvOI0Fls+e7fDA6gIQrZkYCUoEZGRiohdHqmVSZTtU2K+lhAEtTOzs4nt9vtLCkpSQWzLEGm/RtD0aD6+voKkDwTkg6EJqzRp6yrq4sfZ6FQ6OPg4GBeQljCS6MZApjNzU1fQ0PDI51OV0OtWq/XX6fmSk1NLTWbzbnZ2dkWAUhdlhSijjAkwTQ1NT2g5QoCUII1GheaTKZzaWlpeXa7PV2KW3VAYpdWclYAQFtbWz+am5vv0rNSarnUMrAO0GAFRViA0Ylwq2sAhFqGnW9vb3/v7Oy8ifBZrdYsOMdNgO0zIVskDwlBa+RYNhaviV1Gqn1LS8tF6CM9Pd2uLKzSOX4rfp+CNbTa2lodGhOMxQ0KLxAsmBASsCXzjAQDh+KOZML61NTU5f7+fgfNbV6v987GxsYzutw9lJsQwFhMBod4gdCSHs7lTgUbAGteW1t7SjnoA13ifi4vL3NxdwpgjPyEPhgMulGIBWOxM6XUgIJygDGMjY2VA8j4+DgnRzwjI4MTE5H0gB5zjNEDIEKPv+MqJ028zEAgrqCGgQE47+3t5evr65xC5AdD8/Pz3OVyHYCDQYPiFKpzAqVmcAMIBAKvJRgAmZub81RXV9+mn92gVoO5DBnALS0tvQQgdngriNvATAqO+9DQUBWcIRTop6enX9DaNYPBcImS5XlqF2hcMTAw8GRhYeEVlZLHSKIImTgAqoQsohtUdGLnvcfj4Y2NjZxO0jsqG5VInnCITI2e2MihnFUIgOhl7lKlximOvw0VHSJGqNBPTk520fMiAMHuFbnHiFRBLCKb2+QJUy1BQoyzs7P3AYIprhx+v/8NjXOVd2tFWtDKxKjqF4qg2TIxMVGvBNTa2sp9Pp/HYrFk0/xYbchEqCog0E/DQqr2n6EfHPPV1dUgMVFLz+0ipKdjoB8hgVDp9JRBNxS+521tbbdIzA4BNmHX1j9M5h/hOBcVn/piugXkQ8yobyyRXxtHAWL7x14PpnD/EZ9HkWIb6+dP3DuQGZbEHemJMU5HHTfJMP53dBZ24FWNk/ML4OG1G0C2Rt4AAAAASUVORK5CYII=","2x":"data:image/png;base64,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"},ruler:{"1x":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACUAAAAvCAYAAABkBQNlAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAT7SURBVHgB7VhfSGRVHL7jnXFmnMZ/KbO6M+u0aLVY27hGEG2oRYi1BCVCL4YQvmSg+GAv4j8WhEL8AyY+iA9ihIJgD4Eg6EPki6EUYuiDGZWgqIOC/8bx9n3Xc+o27LLu3Dv4sPODyzn33HvP+c73+87vd85VlKQlLWlJS1rSni2zKU9vNk3T/rux2RTeo9QUiyxFeUoTAGwVFRXq9vb27dLSUntnZyeBxjNBy8wGII78/Py0i4uL3xcWFu4UFxenoj3l2oCJgV3p6enZqGvRaHRzenr6bjAYdHV0dFwPMA7s8/k8qOYRFO618/PzPyYmJkIEVlNTo14HMDUnJ8eLskC7VPz/gOHepcShVVNGprKzs9NdLldQgooF5vf73WZcaVcsMoBgEWhtbf0e5YctLS2/raysRFC/UC6BJ86oGTKF6gtGppQYxqampl7DvS5+Jb54eHXjINQU3PdIUEZgclWiTTUG3ESYFPpjQUlgZ2dnv3Z3dwcLCwudZFhJoKlPYioWWH9//y0G2ISFCqERb+zqa29v1x5nkUjkl7GxsbyEscWOY5kioKOjo63a2tpP7Hb7fVxvOhyON3CFnE5nkcfjuZGbm/ucAKWzJVizhrlYoUtA9fX1H+HxqwBRSBZRL3C73YG0tLS8rKysDCF4uwCmyjhmiUtFp14MeIugjo+P/25oaHiAtiJcN3Bl8jmBkx0mbgZTtDkJbGRkJB/fPJydnfWhzaFYkcgJirmPDJyenv7Z1tb2Llnzer05BMAdBF5T+V55eTmDs4OrjyC3trY+ZwJfWlrSDg8Phwgaz+2mQQmh67uExsbGl6iXjIyMLGMyFoOkcMWRpbW1tQ9OTk5+nJub0wBUy8zM1Pb39zWI/55g0Rxb/Fiw4eZMyRoHl4AImgwRZE9PTwB6+5YAmpqa9EUxOjqq13nh2U+cEPszDYoDC205CID3EgzanAMDA/6Dg4Pu3d3dMGMVAOoLgiXZIkiytbGxoWGT+DEnZlyZcQOT4GSJZu4+Paurqw+oGw5OEBy8r69Pj1dsC4VCer23t1d3JdMRvsuRwdUMYzLGpAhXpi0uLt6nbihiDiZZ4SU1RKPbWOd7nB+fg9Gv2IdiZh/G2Qi6nYODgwGuJKkbApCukkA4sDTje2QLTB1sbm62c3XS/XEzJdzlDIfDX+LwEKZ7OIicudwmU9RGk+9h1erg1tfXv6uqqnoLMe8mvmV4iHs3YZOxamdn52uCIBi6Q+ok1qSW+Izv4bulrq6uT1NTU+8ixhUAKAOuUzHjPkP+C0JHf3EwKWYOzoFpXF1GfTEdDQ0NfYGceA/dFDEAc8PI4CpYin/1yRMNaR8fH/+Mg0sxy8sYCnBoPVxeXh55B4bP7+A7P8osZgCpI82CHGgTs3seLnh5b2/vZxkQqSMCrKur08EB8A9lZWXv4d1XyCzTEeoerlpDUlassH91hfrN5ubm92VApLvoKupmeHi4Ac9DAHMbpU/sWOUu1Pqjvkw3FCm3K2BknFqibmZmZh5CN6V47UVc+crlzsEtIn7iDxEiofqqq6tfR+L9prKy8m24lLoJoD1b6kYRK+sq7JhFze9VJGYX9khupBcnSg26OYXLTpBsIyUlJec4oEYV/a/R1X4XmaaSbM3Pz6eApVSAsqmqqmGpRwlmcnIyroOoFf7V+4B4uX/SDGDloSK+Di0wYz+m1/c/7W6jSV2/UuYAAAAASUVORK5CYII=","2x":"data:image/png;base64,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"},rulerDelete:{"1x":"data:image/png;base64,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","2x":"data:image/png;base64,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"},selectorEdit:{"1x":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAiCAYAAAA+stv/AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAKPSURBVHgB7VZPi1JRFL9PX+NT5ymJYppT1kAiSgV+gJRWoSYN6MqtizBGQnAp+gGaRUtBcNFGF4IVFX0B94GQrSqqEd01pr5R3+sce06NjDHeN38W835wuPfdd333d37n3HMkRIUKFSpUXHQwZHUwkiT9fWAYgs8wSoQCGrIi5MOYUCik7Xa7NwOBAFssFpEUjTNUYODQS06n0yCK4udms+n1+XxrsK45ExLyIZzJZLLAXJpOp18ajcZtt9vNFQqF0yeBh9jtdiNMHUhg501fmkwmX2u12l0kEY/HtadNQmu1WnkYryMB13bnEAlY5whFbh0bqIDFYjFxHOeeE1gk4XK59McNB0tOCDvv+jhsbG9tvYTxYS6X+9hqtcYwF8GkEyMAH515NRqNmP+R0Ol0kVgs9gmU2Acjy0isHCu4cpJGo5EgBEe+RxLP3482wuHw63q97qlUKvMreuT+lRUAbxhIQlRg6Z65Ek8ikRftdjtaLpd3E4kErk0VE5hjmQKHSaz7s9nsK4PBEC6VSh1QQaQt2QfA7IaBX7wFz97uScswHo8/gApOrBGL36NKQgxBv98/SMKnD4zk8T1tJ5lMZqvV6nfyR2r0VgD7xbLsT1Bhz+/342/Q6FVABbAQgQI30Dv0fDAY7KZSqUfw+g5kvwdsE+abuEev11/Fso29Ax1WXCVlGXn48DUkMBwOf6TT6Qis3QJzgFnAzFiskKjNZlvHwgRra3L4lAEJYC8ASR2CIHzL5/P30VOe563oJXZK2KYNBoMsGs7/qYrKe4TsxawbZjIZj9FovGI2my+fVSOatWPZSz3Ki2rg/wHaw6liEo1Gp3Dgfq/XE7xerwDzCTQhqjtOJdeip4qLy3niN23hSfilugeDAAAAAElFTkSuQmCC","2x":"data:image/png;base64,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"}},U1=new Set(["duplicate"]),Bo="cursor-";function G1(e,n,s){return`.${e} { cursor: image-set(url(${n})1x, url(${s})2x) 15 15, auto; }`}function F1(e,n){return new Promise((s,i)=>{const r=new Image;r.src=e,r.onload=()=>{const o=document.createElement("canvas");o.width=r.width,o.height=r.height;const a=o.getContext("2d");if(a){a.translate(o.width/2,o.height/2),a.rotate(n),a.drawImage(r,-r.width/2,-r.height/2);const c=o.toDataURL();s(c)}else i("Failed to get canvas context")},r.onerror=()=>i("Failed to load cursor image")})}document.addEventListener("DOMContentLoaded",()=>{const e=document.createElement("style"),n=Object.keys(gh).map(s=>G1(`${Bo}${s}`,gh[s]["1x"],gh[s]["2x"])).join(" ");e.innerHTML=n,document.body.appendChild(e)});const k1=new RegExp(`${Bo}(\\w+)`,"g");class h3{constructor(){this.currentClass="",this.currentState=null,this.currentRotation=0,this.secondState=null,this.nextRotateId=0,this.existingRotatedCursors=new Map,H.get(H.Events.MOUSE_LEAVE).on("trigger",()=>{this.updateCursorState(this.currentState)})}updateCanvasContainerClass(n,s,i){n.classList.forEach(a=>{a.startsWith(Bo)&&n.classList.remove(a)}),U1.forEach(a=>{n.classList.remove(`${Bo}${a}`)});const r=s.match(k1);let o=!0;i&&(o=i.match(k1)),!(!r||!o)&&(n.classList.add(s),i&&n.classList.add(i))}async updateCursorState(n,s=0){const i=document.getElementById("canvas-container");if(!i)return;const r=U1.has(n);if(!(!this.secondState&&this.currentState===n&&this.currentRotation===s)&&(r?this.secondState=n:(this.currentState=n,this.currentRotation=s,this.secondState=null),n!==null))if(r){const o=`${Bo}${this.currentState}`,a=`${Bo}${n}`;this.updateCanvasContainerClass(i,o,a)}else n==="resize"||n==="scale"?await this.setRotatedCursor(i,n,s):(this.currentClass=`${Bo}${n}`,this.updateCanvasContainerClass(i,this.currentClass))}async setRotatedCursor(n,s,i){try{const r=`${s}-${i}`;if(this.currentClass=this.existingRotatedCursors.get(r),!this.currentClass){const[o,a]=await Promise.all([F1(gh[s]["1x"],i),F1(gh[s]["2x"],i)]);this.currentClass=`${Bo}${s}-${this.nextRotateId++}`,this.secondState=null;const c=document.createElement("style");c.innerHTML=G1(this.currentClass,o,a),document.body.appendChild(c),this.existingRotatedCursors.set(r,this.currentClass)}this.updateCanvasContainerClass(n,this.currentClass)}catch(r){console.error("Failed to create rotated cursor:",r)}}}function u3(e){return e&&e.getFeature("editSelector")?"selectorEdit":"default"}const d3=(e,n=null)=>{const s=new h3;return{setState:(i,r=0)=>{let o=i;i==="default"&&(o=u3(n)),s.updateCursorState(o,r)},getCurrentState:()=>({firstState:s.currentState,secondState:s.secondState})}};class f3{constructor(n){this.visualServer=n,this.dataStore=n.dataStore,this.viewport=n.viewport,this._zoom=!1,this._fullyInside=!1,this._remove=!1,this.insideContainer=!1,this._startPos=new N,this._endPos=new N,this._area=new ye,this.start=this.start.bind(this),this.update=this.update.bind(this),this.end=this.end.bind(this),this.selectNodesInSelectionArea=this.selectNodesInSelectionArea.bind(this),this.updateSelectionWithViewportChange=this._updateSelectionWithViewportChange.bind(this)}_updateSelectionWithViewportChange(){const n=this._updateSelectionArea();this.dataStore.get("editMode")===wn.ELEMENT?this.selectNodesInSelectionArea(n):this.dataStore.get("editMode")===wn.SHAPE&&this.selectVerticesInSelectionArea(n)}selectNodesInSelectionArea(n){this.dataStore.selection.addElements([...n],_n),this._removeElementsOutOfSelectionArea(n)}selectVerticesInSelectionArea(n){this._remove?this.dataStore.selection.selectVertices([...n],_n):this.dataStore.selection.addVertices([...n],_n)}start(n){this._zoom=!1,this._startPos.copy(this.viewport.toWorld(n.mousePos)),this._endPos.copy(n.mousePos),this.viewport.on("update",this.updateSelectionWithViewportChange)}update(n,s,i=!1,r=!1){return this._updateConfigsWithModifiers(s,i),this._endPos.copy(n.mousePos),this._updateSelectionArea(r)}end(n=!0){this.viewport.off("update",this.updateSelectionWithViewportChange),NU(),this._zoom?this._area.has_no_area()||this.viewport.focus(this._area):n&&this.dataStore.get("undo").commit()}_updateConfigsWithModifiers({shift:n=!1,alt:s=!1}={sfift:!1,alt:!1},i){this._zoom=i,n&&s?(this._fullyInside=!0,this._remove=!1):!n&&s?(this._fullyInside=!0,this._remove=!0):n&&!s?(this._fullyInside=!1,this._remove=!0):(this._fullyInside=!1,this._remove=!0)}_updateSelectionArea(n){this._area.set(this._startPos.x,this._startPos.y,0,0),this._area.expand_to(this.viewport.toWorld(this._endPos)),CU(n?null:this._area,!this._zoom);const s=this.dataStore.get("editMode");if(s===wn.ELEMENT)return jG(this._area);if(s===wn.SHAPE){const i=new Set,r=this.visualServer.getRenderItemOfElement(this.visualServer.snappingPath.element),o=i3(this.visualServer.snappingPath.mesh,r,this.viewport,this._area,this._fullyInside);for(const a of o)a.isFlagged(Ge.CURVE_VERT)||i.add(a);return i}}_canBeSelect(n,s,i,r){const o=s.get("type")===Us.WORKSPACE||s.get("elementType")===Le.SCREEN&&i.has(s)&&!r.has(s),a=s.get("elementType")===Le.CONTAINER&&!r.has(s),c=this.insideContainer?o||a:o,l=!this._fullyInside||this._fullyInside&&n.isInside(this._area);return c&&l}_removeElementsOutOfSelectionArea(n){if(this._remove)if(n.size===0)this.dataStore.selection.clearAllExceptAction(_n);else{const i=this.dataStore.selection.get("elements").filter(r=>!n.has(r));this.dataStore.selection.removeElements(i,_n)}}}const vr={size:20,alpha:.75,fade:{duration:200,ease:"easeInOutSine",wait:3e3},minSize:30};let ba=null,ig,bc=0;const _h=new ye;function p3(e,n={}){let s=-(n.x/n.scale+e.x)*n.width/e.width,i=-(n.y/n.scale+e.y)*n.height/e.height;const r=n.width*(n.width/(n.scale*e.width)),o=n.height*(n.height/(n.scale*e.height)),a=Math.max(r,vr.minSize),c=Math.max(o,vr.minSize);s-=Math.max(0,a-r)*.5,i-=Math.max(0,c-o)*.5,_h.set(s,i,a,c)}function B1(e){return Math.round(_h.width)<e.width||Math.round(_h.height)<e.height}function E3(e,n){const{viewport:s,dataStore:i}=e;ig=n,cb(_h),i.eam.on(Y.HOVER_SCROLLBAR,o=>{if(o.handled=!1,ba=null,B1(s)){const{x:a,y:c}=o.mousePos,{left:l,right:h,bottom:d,top:p}=_h,E=vr.size;s.width-E<a&&a<s.width&&p<c&&c<d?ba="y":s.height-E<c&&c<s.height&&l<a&&a<h&&(ba="x"),W1()}ba?i.eam.changeHover(Gt.SCROLLBAR):i.eam.changeHover(i.selection.get("hover")?Gt.ELEMENT:Gt.NONE),ab(ba)});const r=new N;i.eam.on(Y.START_MOVE_SCROLLBAR,o=>{if(!ba){o.handled=!1;return}r.copy(o.mousePos),ig("grabbing"),V1()}).on(Y.UPDATE_MOVE_SCROLLBAR,({mousePos:o})=>{const a=r.sub(o),c=e.root.bounds.world;ba==="y"?(a.x=0,a.y=a.y*c.height*s.scale/s.height):(a.x=a.x*c.width*s.scale/s.width,a.y=0),s.offsetPos(a),r.copy(o)}).on(Y.END_MOVE_SCROLLBAR,()=>{ig("default"),H1()}),s.on("update",()=>{var a,c;const o=(c=(a=e==null?void 0:e.root)==null?void 0:a.bounds)==null?void 0:c.world;p3(o,s),B1(s)&&W1()})}let rg;function V1(){rg&&window.clearTimeout(rg)}function H1(e=0){V1(),rg=window.setTimeout(T3,vr.fade.wait+e)}function W1(){_3(),H1(vr.fade.duration)}class Y1{constructor(){this._easings=new Map,this._easings.set("easeInOutSine",function(n){return n<.5?(1-Math.cos(n*Math.PI))*.5:Math.sin((n-.5)*Math.PI)*.5+.5}),this._animating=!1,this._reverse=!1,this._doAnimationHandler=this._doAnimation.bind(this)}animate(n,s,i,r=!1){this._duration=n,this._easing=this._easings.get(s),this._callback=i,this._reverse=r,this._startTime=-1,this._animating||(this._animating=!0,window.requestAnimationFrame(this._doAnimationHandler))}_doAnimation(n){this._animating=!1,this._startTime<0&&(this._startTime=n);let s=Math.min((n-this._startTime)/this._duration,1);this._reverse&&(s=1-s);const i=this._easing(s);this._reverse&&(s=1-s);const r=this._callback(i,s,this._duration)&&s<1;!this._animating&&r&&(this._animating=!0,window.requestAnimationFrame(this._doAnimationHandler))}}const X1=new Y1,g3=new Y1;function _3(){const e=bc,n=vr.alpha;X1._animating||X1.animate(vr.fade.duration,vr.fade.ease,s=>(bc=n*s+e*(1-s),DS(bc),!0))}function T3(){const e=bc,n=0;g3.animate(vr.fade.duration,vr.fade.ease,s=>(bc=n*s+e*(1-s),DS(bc),!0))}var Qt;(function(e){e.LOAD="LOAD",e.EXEC="EXEC",e.FFPROBE="FFPROBE",e.WRITE_FILE="WRITE_FILE",e.READ_FILE="READ_FILE",e.DELETE_FILE="DELETE_FILE",e.RENAME="RENAME",e.CREATE_DIR="CREATE_DIR",e.LIST_DIR="LIST_DIR",e.DELETE_DIR="DELETE_DIR",e.ERROR="ERROR",e.DOWNLOAD="DOWNLOAD",e.PROGRESS="PROGRESS",e.LOG="LOG",e.MOUNT="MOUNT",e.UNMOUNT="UNMOUNT"})(Qt||(Qt={}));const A3=(()=>{let e=0;return()=>e++})(),m3=new Error("ffmpeg is not loaded, call `await ffmpeg.load()` first"),O3=new Error("called FFmpeg.terminate()");class I3{constructor(){ia(this,Oi,null);ia(this,Yo,{});ia(this,to,{});ia(this,Ga,[]);ia(this,Fa,[]);$e(this,"loaded",!1);ia(this,Nd,()=>{Ot(this,Oi)&&(Ot(this,Oi).onmessage=({data:{id:n,type:s,data:i}})=>{switch(s){case Qt.LOAD:this.loaded=!0,Ot(this,Yo)[n](i);break;case Qt.MOUNT:case Qt.UNMOUNT:case Qt.EXEC:case Qt.FFPROBE:case Qt.WRITE_FILE:case Qt.READ_FILE:case Qt.DELETE_FILE:case Qt.RENAME:case Qt.CREATE_DIR:case Qt.LIST_DIR:case Qt.DELETE_DIR:Ot(this,Yo)[n](i);break;case Qt.LOG:Ot(this,Ga).forEach(r=>r(i));break;case Qt.PROGRESS:Ot(this,Fa).forEach(r=>r(i));break;case Qt.ERROR:Ot(this,to)[n](i);break}delete Ot(this,Yo)[n],delete Ot(this,to)[n]})});ia(this,Ys,({type:n,data:s},i=[],r)=>Ot(this,Oi)?new Promise((o,a)=>{const c=A3();Ot(this,Oi)&&Ot(this,Oi).postMessage({id:c,type:n,data:s},i),Ot(this,Yo)[c]=o,Ot(this,to)[c]=a,r==null||r.addEventListener("abort",()=>{a(new DOMException(`Message # ${c} was aborted`,"AbortError"))},{once:!0})}):Promise.reject(m3));$e(this,"load",({classWorkerURL:n,...s}={},{signal:i}={})=>(Ot(this,Oi)||(Ph(this,Oi,n?new Worker(new URL(n,typeof document>"u"&&typeof location>"u"?require("url").pathToFileURL(__filename).href:typeof document>"u"?location.href:bt&&bt.tagName.toUpperCase()==="SCRIPT"&&bt.src||new URL("index.umd.cjs",document.baseURI).href),{type:"module"}):new Worker(new URL("/assets/worker-BAOIWoxA.js",typeof document>"u"&&typeof location>"u"?require("url").pathToFileURL(__filename).href:typeof document>"u"?location.href:bt&&bt.tagName.toUpperCase()==="SCRIPT"&&bt.src||new URL("index.umd.cjs",document.baseURI).href),{type:"module"})),Ot(this,Nd).call(this)),Ot(this,Ys).call(this,{type:Qt.LOAD,data:s},void 0,i)));$e(this,"exec",(n,s=-1,{signal:i}={})=>Ot(this,Ys).call(this,{type:Qt.EXEC,data:{args:n,timeout:s}},void 0,i));$e(this,"ffprobe",(n,s=-1,{signal:i}={})=>Ot(this,Ys).call(this,{type:Qt.FFPROBE,data:{args:n,timeout:s}},void 0,i));$e(this,"terminate",()=>{const n=Object.keys(Ot(this,to));for(const s of n)Ot(this,to)[s](O3),delete Ot(this,to)[s],delete Ot(this,Yo)[s];Ot(this,Oi)&&(Ot(this,Oi).terminate(),Ph(this,Oi,null),this.loaded=!1)});$e(this,"writeFile",(n,s,{signal:i}={})=>{const r=[];return s instanceof Uint8Array&&r.push(s.buffer),Ot(this,Ys).call(this,{type:Qt.WRITE_FILE,data:{path:n,data:s}},r,i)});$e(this,"mount",(n,s,i)=>{const r=[];return Ot(this,Ys).call(this,{type:Qt.MOUNT,data:{fsType:n,options:s,mountPoint:i}},r)});$e(this,"unmount",n=>{const s=[];return Ot(this,Ys).call(this,{type:Qt.UNMOUNT,data:{mountPoint:n}},s)});$e(this,"readFile",(n,s="binary",{signal:i}={})=>Ot(this,Ys).call(this,{type:Qt.READ_FILE,data:{path:n,encoding:s}},void 0,i));$e(this,"deleteFile",(n,{signal:s}={})=>Ot(this,Ys).call(this,{type:Qt.DELETE_FILE,data:{path:n}},void 0,s));$e(this,"rename",(n,s,{signal:i}={})=>Ot(this,Ys).call(this,{type:Qt.RENAME,data:{oldPath:n,newPath:s}},void 0,i));$e(this,"createDir",(n,{signal:s}={})=>Ot(this,Ys).call(this,{type:Qt.CREATE_DIR,data:{path:n}},void 0,s));$e(this,"listDir",(n,{signal:s}={})=>Ot(this,Ys).call(this,{type:Qt.LIST_DIR,data:{path:n}},void 0,s));$e(this,"deleteDir",(n,{signal:s}={})=>Ot(this,Ys).call(this,{type:Qt.DELETE_DIR,data:{path:n}},void 0,s))}on(n,s){n==="log"?Ot(this,Ga).push(s):n==="progress"&&Ot(this,Fa).push(s)}off(n,s){n==="log"?Ph(this,Ga,Ot(this,Ga).filter(i=>i!==s)):n==="progress"&&Ph(this,Fa,Ot(this,Fa).filter(i=>i!==s))}}Oi=new WeakMap,Yo=new WeakMap,to=new WeakMap,Ga=new WeakMap,Fa=new WeakMap,Nd=new WeakMap,Ys=new WeakMap;var z1;(function(e){e.MEMFS="MEMFS",e.NODEFS="NODEFS",e.NODERAWFS="NODERAWFS",e.IDBFS="IDBFS",e.WORKERFS="WORKERFS",e.PROXYFS="PROXYFS"})(z1||(z1={}));const S3=new Error("failed to get response body reader"),y3=new Error("failed to complete download"),C3="Content-Length",N3=e=>new Promise((n,s)=>{const i=new FileReader;i.onload=()=>{const{result:r}=i;r instanceof ArrayBuffer?n(new Uint8Array(r)):n(new Uint8Array)},i.onerror=r=>{var o,a;s(Error(`File could not be read! Code=${((a=(o=r==null?void 0:r.target)==null?void 0:o.error)==null?void 0:a.code)||-1}`))},i.readAsArrayBuffer(e)}),K1=async e=>{let n;if(typeof e=="string")/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(e)?n=atob(e.split(",")[1]).split("").map(s=>s.charCodeAt(0)):n=await(await fetch(e)).arrayBuffer();else if(e instanceof URL)n=await(await fetch(e)).arrayBuffer();else if(e instanceof File||e instanceof Blob)n=await N3(e);else return new Uint8Array;return new Uint8Array(n)},x3=async(e,n)=>{var r;const s=await fetch(e);let i;try{const o=parseInt(s.headers.get(C3)||"-1"),a=(r=s.body)==null?void 0:r.getReader();if(!a)throw S3;const c=[];let l=0;for(;;){const{done:p,value:E}=await a.read(),g=E?E.length:0;if(p){if(o!=-1&&o!==l)throw y3;n&&n({url:e,total:o,received:l,delta:g,done:p});break}c.push(E),l+=g,n&&n({url:e,total:o,received:l,delta:g,done:p})}const h=new Uint8Array(l);let d=0;for(const p of c)h.set(p,d),d+=p.length;i=h.buffer}catch(o){console.log("failed to send download progress event: ",o),i=await s.arrayBuffer()}return i},Q1=async(e,n,s=!1,i)=>{const r=s?await x3(e,i):await(await fetch(e)).arrayBuffer(),o=new Blob([r],{type:n});return URL.createObjectURL(o)};class Z1{constructor(){}static getEstimatedSize(){}addFrame(){}getData(){}encode(){}end(){}cancel(){}}class v3 extends Z1{constructor(n){super(),this.ffmpeg=n,this._width=0,this._height=0,this._frameRate=0,this._speed=0,this._loop=!0,this._index=0,this._onProgressHandler=null}init(n){this._width=n.width,this._height=n.height,this._frameRate=n.fps,this._speed=n.speed,this._loop=n.loop,this._index=0,this._onProgressHandler=null}static getEstimatedSize({width:n,height:s,fps:i,duration:r,transparency:o,loop:a,speed:c}){const p=a?19:0,E=256*3,g=.05,T=r/c,A=i*T;return(14+(18+n*s*(o?4:3)*g)*A+E+p)/1024}async addFrame(n){const s=await K1(n);await this.ffmpeg.writeFile(`${this._index}.png`,s),this._index++}getData(){return this.ffmpeg.readFile("output.gif")}encode(n=()=>{}){let s=!0;return this._onProgressHandler=({progress:i})=>{s?i===1&&(s=!1):n(Math.min(i,1)*100*.5+50)},this.ffmpeg.on("progress",this._onProgressHandler),this.ffmpeg.exec(["-i","%d.png","-vf","palettegen","palette.png"]).then(()=>this.ffmpeg.exec(["-framerate",`${this._frameRate}`,"-i","%d.png","-i","palette.png",`${this._loop?"-ignore_loop":"-loop"}`,`${this._loop?0:-1}`,"-filter_complex",`[0:v]setpts=${1/this._speed}*PTS[v];[v][1:v]paletteuse`,"output.gif"]))}end(){if(!this.ffmpeg.loaded)return;this._onProgressHandler&&(this.ffmpeg.off("progress",this._onProgressHandler),this._onProgressHandler=null);const n=[this.ffmpeg.deleteFile("output.gif").catch(()=>{}),this.ffmpeg.deleteFile("palette.png").catch(()=>{})];for(let s=0;s<=this._index;s++)n.push(this.ffmpeg.deleteFile(`${s}.png`).catch(()=>{}));Promise.all(n).then(()=>{this.ffmpeg.terminate()}).catch(s=>{console.error("Error during cleanup:",s),this.ffmpeg.terminate()})}cancel(){this.end()}}const q1={[la.ULTRA]:2,[la.HIGH]:23,[la.MEDIUM]:36,[la.LOW]:49};class R3 extends Z1{constructor(n){super(),this.ffmpeg=n,this._width=0,this._height=0,this._frameRate=0,this._speed=0,this._quality=0,this._index=0,this._onProgressHandler=null}init(n){this._width=n.width,this._height=n.height,this._frameRate=n.fps,this._speed=n.speed,this._quality=q1[n.quality],this._index=0,this._onProgressHandler=null}static getEstimatedSize({width:n,height:s,fps:i,duration:r,speed:o,videoQuality:a}){const c=r/o,l=8,h=4,d=q1[a];return .05*(n*s*h*l*i*c)/(8*1024*d)}async addFrame(n){const s=await K1(n);await this.ffmpeg.writeFile(`${this._index}.png`,s),this._index++}getData(){return this.ffmpeg.readFile("output.mp4")}encode(n=()=>{}){return this._onProgressHandler=({progress:s})=>{n(Math.min(s,1)*100*.5+50)},this.ffmpeg.on("progress",this._onProgressHandler),this.ffmpeg.exec(["-framerate",`${this._frameRate}`,"-i","%d.png","-c:v","libx264","-crf",`${this._quality}`,"-filter:v",`pad=ceil(iw/2)*2:ceil(ih/2)*2,setpts=${1/this._speed}*PTS,scale=out_color_matrix=bt709:out_range=tv`,"-pix_fmt","yuv420p","-bsf:v","h264_metadata=video_full_range_flag=0:colour_primaries=1:transfer_characteristics=1:matrix_coefficients=1","output.mp4"])}end(){if(!this.ffmpeg.loaded)return;this._onProgressHandler&&(this.ffmpeg.off("progress",this._onProgressHandler),this._onProgressHandler=null);const n=[this.ffmpeg.deleteFile("output.mp4").catch(()=>{})];for(let s=0;s<=this._index;s++)n.push(this.ffmpeg.deleteFile(`${s}.png`).catch(()=>{}));Promise.all(n).then(()=>{this.ffmpeg.terminate()}).catch(s=>{console.error("Error during cleanup:",s),this.ffmpeg.terminate()})}cancel(){this.end()}}function og(e){return{width:0,height:0,pixels:null,error:new Error(e)}}const w3=Zs.hex(0);async function D3(e,{pixels:n,width:s,height:i}){const r=document.createElement("canvas");return r.width=s,r.height=i,r.getContext("2d").putImageData(new ImageData(new Uint8ClampedArray(n),s,i),0,0),new Promise(a=>r.toBlob(a,`image/${e}`))}function L3(){const e=_g.instance(),n=e.root.id;if(!e.indexer.getNode(n))throw console.warn(`Node with rootID ${n} not found.`),new Error(`Node with rootID ${n} not found.`);return e.updateNodes(),{VS:e,rootID:n}}async function M3(e="png",n=null,s=w3,i=null){const{rootID:r}=L3(),{pixels:o,width:a,height:c}=await P3(r,s,n,i);if(!o)throw console.warn(`Failed to render snapshot for rootID ${r}.`),new Error(`Failed to render snapshot for rootID ${r}.`);return D3(e,{pixels:o,width:a,height:c})}function P3(e,n,s=null,i=null,r=1e4){return new Promise(o=>{const a=_g.instance(),c=a.indexer.getNode(e);if(!c){o(og(`cannot take snapshot of non-exist element "${e}"`));return}const l=tt();l.setCaptureBackgroundColor(n.r,n.g,n.b,n.a);const h=s?s.x:i.w,d=s?s.y:i.h,p=a.view.getOrCreateDinoTree(c.id);l.capture(p.root_id,i.x,i.y,i.w,i.h,h,d);const E=new Date().getTime(),g=setTimeout(()=>{console.warn("renderSnapshot timed out"),md.delete(E),o(og("renderSnapshot timed out"))},r);md.set(E,(T,A)=>{if(clearTimeout(g),md.delete(E),T===null||A===0)o(og("Capture failed with null pointer or zero length"));else{const m=l.readU8Array(T,A);o({pixels:m,width:h,height:d})}})})}const md=new Map,b3=(e,n)=>{for(const[,s]of md.entries())s&&s(e,n)},Od={ROOT:"root",RESIZE:"resize"};class U3{constructor(){this._paused=!1,this.dirty={[Od.ROOT]:!0,[Od.RESIZE]:!1}}get paused(){return this._paused}_updateDirty(n,s){this.dirty[n]=s}updateRootDirty(n){this._updateDirty(Od.ROOT,n)}updateResizeDirty(n){this._updateDirty(Od.RESIZE,n)}pause(){this._paused=!0}resume(){this._paused=!1}}const Ai=new U3,G3=()=>{Ai.pause()},j1=()=>{Ai.resume()},J1=()=>new Promise(e=>requestAnimationFrame(e)),F3=(e,n=0)=>{const s=Math.pow(10,n);return Math.round(e*s)/s};class k3{constructor(n,s){this.visualServer=n,this.dataStore=s,this._encoder=null,this.init()}init(){this.onProgress=()=>{},this.onComplete=()=>{},this._rafId=null,this._isEnabled=!1,this._ctx=null,this._imageData=null,this._imageSize={width:0,height:0},this.type=null,this.settings={startTime:0,currTime:0,endTime:0,iterTime:0,fps:30,loop:!0,speed:1,quality:la.HIGH,transparent:!1,gifTransparentColor:NaN},this.exportFile=null}setEncoder(n){this._encoder=n}get width(){return this._imageSize.width}get height(){return this._imageSize.height}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1,this.end(),j1()}setMediaType(n){this.type=n}setOutputSize(n,s){this._imageSize.width=n,this._imageSize.height=s}updateSetting(n){this.settings={...this.settings,...n},this.settings.currTime=this.settings.startTime}async start(n,s,i){this.onProgress=n,this.onComplete=s,G3(),await this.processNextFrame(i),j1()}processNextFrame(n){return new Promise(s=>{const i=async()=>{await this.frameProcessingLoop(s,n)};this._rafId=window.requestAnimationFrame(i)})}async frameProcessingLoop(n,s){if(!this._isEnabled){this._encoder.cancel(),this.end(),n();return}if(await this._captureScreen(this.settings.currTime,s),await this._encoder.addFrame(this._imageData),this.settings.currTime<=this.settings.endTime){this.settings.currTime+=this.settings.iterTime;let i=(this.settings.currTime-this.settings.startTime)/(this.settings.endTime-this.settings.startTime)*100*.5;i=Math.min(i,100*.5),this.onProgress(i),await this.processNextFrame(s)}else this._encoder.encode(this.onProgress).then(()=>{this._encoder.getData().then(i=>{this.onComplete(i),this._encoder.end(),this.end()}).catch(i=>{console.error("Error during getData:",i),this.end()})}).catch(i=>{console.error("Error during encoding:",i),this.end()});n()}async _captureScreen(n,s){this.dataStore.transition.setPlayheadTime(n,!0,!1),await J1();{const r=new Zs(0,0,0,0);this.type===Eo.GIF&&!this.settings.transparent&&r.set_with_array([0,0,0,1]),this._imageData=await M3("png",void 0,r,s)}}end(){H.resume(),this.dataStore.transition.resume(),this.dataStore.editor.reloadPropertiesAndStates(new Map([["mode",""]])),window.cancelAnimationFrame(this._rafId)}clear(){this.init()}}class B3{constructor(n,s){$e(this,"onRecordProgress",null);$e(this,"loadFFmpeg",async()=>{await this.ffmpeg.load({coreURL:await Q1(`${window.location.origin}${Kp.baseUrl}/ffmpeg/ffmpeg-core.js`,"text/javascript"),wasmURL:await Q1(`${window.location.origin}${Kp.baseUrl}/ffmpeg/ffmpeg-core.wasm`,"application/wasm"),classWorkerURL:`${window.location.origin}${Kp.baseUrl}/ffmpeg/worker.js`})});this.visualServer=n,this.dataStore=s,this.ffmpeg=new I3,this._encoder=null,this.recorder=new k3(n,s),this.init()}init(){this.type=null,this.exportFile=null,this.recorder.init()}enable(){this.recorder.enable(),this.dataStore.forceUpdateLayerListToRenderer(),this.loadFFmpeg()}disable(){this.recorder.disable()}setOutputSize(){this.recorder.setOutputSize(this.dataStore.workspace.children[0].get("size").width,this.dataStore.workspace.children[0].get("size").height)}async setMediaType(n){this.type=n,this.recorder.setMediaType(n),this.type===Eo.MP4&&this.updateRecordSetting({transparent:!1}),await this._initEncoder(),this.recorder.setEncoder(this._encoder)}updateRecordSetting(n){this.recorder.updateSetting(n)}async _initEncoder(){await this.loadFFmpeg();const n={width:this.recorder.width,height:this.recorder.height,fps:this.recorder.settings.fps,speed:this.recorder.settings.speed,quality:this.recorder.settings.quality,loop:this.recorder.settings.loop};switch(this.type){case Eo.GIF:{this._encoder=new v3(this.ffmpeg),this._encoder.init(n);break}case Eo.MP4:{this._encoder=new R3(this.ffmpeg),this._encoder.init(n);break}}}async recordCanvas(n,s,i){const r=XP(this.dataStore.drawInfo.vs,i,n2);await this.recorder.start(n,o=>{this.handleExportCompletion(o),s()},r.worldBoundsAABB)}createBlob(n){let s;switch(this.type){case Eo.GIF:s={type:"image/gif"};break;case Eo.MP4:s={type:"video/mp4"};break}return new Blob([n],s)}handleExportCompletion(n){this.exportFile=URL.createObjectURL(this.createBlob(n))}clear(){this.init()}}let Pt;const Ua=.01;function V3(e){Pt=e}class ti{constructor(){}static _doAlignElement(n,s){if(n.length===1){const i=n[0],r=Pt.dataStore.getParentOf(i);if(!r)return;const o=Pt.getRenderItemOfElement(i),a=o.transform.local.xform_rect(o.bounds.local),c=Pt.getRenderItemOfElement(r).bounds.local.clone(),l=ti._alginBound(s,o.transform.translate,c,a);Pt.dataStore.beginChangeGroup(),i.sets({translateX:l.x,translateY:l.y}),Pt.dataStore.commitUndo(),Pt.dataStore.endChangeGroup()}else{const i=ti._snapToPixelGrid(s);Pt.dataStore.beginChangeGroup();for(const r of n){const o=Pt.getRenderItemOfElement(r),a=o.transform.parent.xform(o.transform.translate),c=ti._alginBound(s,a,i,o.bounds.world);Pt.dataStore.data.snapToPixelGrid&&(s===jt.MIDDLE?c.y=Math.round(c.y):s===jt.CENTER&&(c.x=Math.round(c.x)));const l=o.transform.parent.clone().affine_inverse().xform(c);l.x=this.roundToDecimal(l.x,2),l.y=this.roundToDecimal(l.y,2),r.sets({translateX:l.x,translateY:l.y})}Pt.dataStore.commitUndo(),Pt.dataStore.endChangeGroup()}}static _alginBound(n,s,i,r){const o=s.clone();switch(n){case jt.LEFT:o.x+=i.x-r.x;break;case jt.RIGHT:o.x+=i.right-r.right;break;case jt.TOP:o.y+=i.top-r.top;break;case jt.BOTTOM:o.y+=i.bottom-r.bottom;break;case jt.MIDDLE:o.y+=i.y+i.height*.5-(r.y+r.height*.5);break;case jt.CENTER:o.x+=i.x+i.width*.5-(r.x+r.width*.5);break}return o}static _snapToPixelGrid(n){const s=Pt.selection.bounds.clone();if(Pt.dataStore.data.snapToPixelGrid)switch(n){case jt.LEFT:s.x=Math.ceil(s.x);break;case jt.RIGHT:s.width=Math.floor(s.right)-s.x;break;case jt.TOP:s.y=Math.ceil(s.y);break;case jt.BOTTOM:s.height=Math.floor(s.bottom)-s.y;break;case jt.MIDDLE:case jt.CENTER:break}return s}static _doAlignVertices(n,s){const i=Pt.dataStore.selection.get("vertices");if(!i.length)return;const r=n[0].get("geometry").get("mesh"),{pathXform:o,pathXformInv:a}=ti._getPathTransform(n[0]),c=new ye;if(i.length===1){for(const p of r.getVertices())this._expandWorldBound(p,o,c);const l=i[0],h=o.xform(l.pos);ti._alignVertexByDirection(s,h,c);const d=a.xform(h);r.situateVertexToPos(l,d.x,d.y)}else{ti._setupPointShape(i,r),r.applyChanges(r.changes);const l=ti._getVerticesWorldPositionsAndUpdateBounds(i,o,c);for(const{vertex:h,worldPos:d}of l){ti._alignVertexByDirection(s,d,c);const p=a.xform(d);r.situateVertexToPos(h,p.x,p.y)}}Pt.dataStore.beginChangeGroup(),r.applyChanges(r.changes),r.fire(),Pt.dataStore.commitUndo(),Pt.dataStore.endChangeGroup()}static _setupPointShape(n,s){if(!n[0].isFlagged(Ge.CURVE_VERT))return;const i=new Map;for(const r of n)if(r.isFlagged(Ge.CURVE_VERT)){if(!r.adjacentMainVertex){console.warn("Please check file, a curve control does not attach a real vertex");continue}const o=r.adjacentMainVertex.id;i.has(o.id)?s.prepareVertexPropertyChanges(o,"mirror",pe.INDEPENDENT):i.set(o.id)}}static _getVerticesWorldPositionsAndUpdateBounds(n,s,i){const r=[];for(const o of n){const a=new N;new N().set(o.pos[0],o.pos[1]),s.xform(o.pos,a),r.push({vertex:o,worldPos:a}),i.is_zero()?(i.x=a.x,i.y=a.y):i.expand_to(a)}return r}static _getPathTransform(n){const s=Pt.getRenderItemOfElement(n),{translate:i,rotation:r,scale:o,skew:a,contentAnchor:c}=s.transform,l=s.transform.parent.clone().translate_right(i.x,i.y).rotate_right(r).skew_right(wt(a.x),wt(a.y)).scale_right(o.x,o.y).translate_right(-c.x,-c.y),h=l.clone().affine_inverse();return{pathXform:l,pathXformInv:h}}static _alignVertexByDirection(n,s,i){switch(n){case jt.LEFT:s.x=i.left;break;case jt.RIGHT:s.x=i.right;break;case jt.TOP:s.y=i.top;break;case jt.BOTTOM:s.y=i.bottom;break;case jt.MIDDLE:s.y=i.center.y;break;case jt.CENTER:s.x=i.center.x;break}}static _doDistributeElement(n,s){if(n.length<3)return;const i=this._preorderTraversalWithIndex(Pt.dataStore.workspace,n),r=s===$a.HORIZONTAL,o=n.map((p,E)=>({element:p,bounds:Pt.getRenderItemOfElement(p).bounds.world.clone(),index:i[E]})).sort((p,E)=>r?Math.abs(p.bounds.left-E.bounds.left)<Ua?p.index-E.index:p.bounds.left-E.bounds.left:Math.abs(p.bounds.top-E.bounds.top)<Ua?p.index-E.index:p.bounds.top-E.bounds.top),a=o.reduce((p,E)=>Math.min(E.bounds.left,p),Number.MAX_VALUE),c=o.reduce((p,E)=>Math.min(E.bounds.top,p),Number.MAX_VALUE);for(const p of o)p.bounds.offset(-a,-c);let l=0;for(let p=1;p<o.length;p++){const E=o[p-1],g=o[p];l+=r?g.bounds.left-E.bounds.right:g.bounds.top-E.bounds.bottom}l/=n.length-1,l=this.roundToDecimal(l,2);const h=-o.reduce((p,E)=>Math.min(r?E.bounds.width:E.bounds.height,p),Number.MAX_VALUE);if(l<h){Pt.dataStore.eam.showNotification("info","file:alignment.distribute.error");return}Pt.dataStore.beginChangeGroup();const d=o[0].bounds;for(let p=1;p<o.length;p++){const E=o[p],g=Pt.getRenderItemOfElement(E.element).transform,T=new N(0,0);if(r?T.x=l-(E.bounds.left-d.right):T.y=l-(E.bounds.top-d.bottom),p===o.length-1&&(r&&T.x>0||!r&&T.y>0))break;const m=g.parent.clone().affine_inverse().basis_xform(T);E.element.sets({translateX:g.translate.x+m.x,translateY:g.translate.y+m.y}),d.copy(E.bounds),d.offset(T.x,T.y)}Pt.dataStore.commitUndo(),Pt.dataStore.endChangeGroup()}static _doDistributeVertices(n,s){const i=s===$a.HORIZONTAL,r=Pt.dataStore.selection.get("vertices");if(r.length<3)return;const o=n[0].get("geometry").get("mesh"),{pathXform:a,pathXformInv:c}=ti._getPathTransform(n[0]),l=new ye,h=ti._getVerticesWorldPositionsAndUpdateBounds(r,a,l),d=this.roundToDecimal((i?l.width:l.height)/(r.length-1),2);if(Math.abs(d)<Ua)return;const p=h.sort((E,g)=>Math.abs(E.worldPos.x-g.worldPos.x)<Ua&&Math.abs(E.worldPos.y-g.worldPos.y)<Ua?E.vertex.index-g.vertex.index:i?Math.abs(E.worldPos.x-g.worldPos.x)<Ua?E.worldPos.y-g.worldPos.y:E.worldPos.x-g.worldPos.x:Math.abs(E.worldPos.y-g.worldPos.y)<Ua?E.worldPos.x-g.worldPos.x:E.worldPos.y-g.worldPos.y);ti._setupPointShape(r,o),o.applyChanges(o.changes);for(let E=1;E<p.length-1;E++){const{vertex:g,worldPos:T}=p[E];i?T.x=p[0].worldPos.x+E*d:T.y=p[0].worldPos.y+E*d;const A=c.xform(T);o.situateVertexToPos(g,A.x,A.y)}Pt.dataStore.beginChangeGroup(),o.applyChanges(o.changes),o.fire(),Pt.dataStore.commitUndo(),Pt.dataStore.endChangeGroup()}static align(n){const s=Pt.dataStore,i=s.selection.get("elements");s.get("editMode")===wn.ELEMENT?this._doAlignElement(i,n):s.get("editMode")===wn.SHAPE&&this._doAlignVertices(i,n),s.commitUndo()}static distribute(n){const s=Pt.dataStore,i=s.selection.get("elements");s.get("editMode")===wn.ELEMENT?this._doDistributeElement(i,n):s.get("editMode")===wn.SHAPE&&this._doDistributeVertices(i,n),s.commitUndo()}static _preorderTraversalWithIndex(n,s){const i=[];if(!n)return i;const r=[n];let o=0;for(;r.length>0;){const a=r.pop(),c=s.indexOf(a);if(c!==-1&&(i[c]=o++),!!a.children)for(let l=0;l<a.children.length;l++)r.push(a.children[l])}return i}static roundToDecimal(n,s){const i=Math.pow(10,s);return Math.round(n*i)/i}static _expandWorldBound(n,s,i){const r=new N;return new N().set(n.pos[0],n.pos[1]),s.xform(n.pos,r),i.is_zero()?(i.x=r.x,i.y=r.y):i.expand_to(r),i}}const H3=30,W3=1;let Ss,Pn,G,mn,hr,mi,ur;function Y3(e){Ss=e,G=e.dataStore,mn=e.viewport,Pn=d3(Ss.canvas,G),DG(Ss,Pn.setState),hr=QU(Ss,Pn),mi=new f3(Ss),aP(Ss,Pn.setState),E3(Ss,Pn.setState),gG(Ss,hr,mi,Pn.setState),V3(Ss),ur=new B3(Ss,G),j3(),z3(),K3(),q3();const n=new Set,s=()=>{const r=new Set(G.selection.get("elements"));for(const o of r)n.has(o)||n.add(o);for(const o of n)r.has(o)||n.delete(o)},i=r=>{switch(r){case Qs.EDITING:{Pn.setState("default"),s();break}case Qs.VIEWING:case Qs.VERSIONING:{Pn.setState("default");break}}};G.on("state",i),i(G.get("state")),G.selection.on(me.SELECT,s)}function $1(e,n={}){const{padding:s=25}=n,i=e.clone();mn.focus(i,{left:s+dt.size,top:s+dt.size,right:s,bottom:s})}const Vo={ALL:"ALL",WIDTH:"WIDTH",HEIGHT:"HEIGHT"};function Th(e=Vo.ALL,n={}){const s=Ss.indexer.getActiveScreenNode();if(s){const i=s.boundsWorldAABB.clone();e===Vo.WIDTH?(i.y+=i.height/2,i.height=0):e===Vo.HEIGHT&&(i.x+=i.width/2,i.width=0),$1(i,n)}}function X3(){Ss.selection.size>0?$1(Ss.selection.bounds):Th(Vo.ALL)}function ey(){mn.moveTo(Ss.selection.bounds)}function z3(){const e=[.02,.03,.06,.13,.25,.5,1,2,4,8,16,32,64,128,256],n=E=>e.find(g=>g>E),s=E=>e.findLast(g=>g<E);G.eam.on(Y.ZOOM_IN,()=>{const E=mn.getZoom(),g=n(E);g!==void 0&&mn.setZoom(g)}),G.eam.on(Y.ZOOM_OUT,()=>{const E=mn.getZoom(),g=s(E);g!==void 0&&mn.setZoom(g)}),G.eam.on(Y.ZOOM_RESET,()=>{mn.setZoom(1)}),G.eam.on(Y.ZOOM_FIT_CONTENT,E=>{Th(Vo.ALL,E)}),G.eam.on(Y.ZOOM_FIT_WIDTH,E=>{Th(Vo.WIDTH,E)}),G.eam.on(Y.ZOOM_FIT_HEIGHT,E=>{Th(Vo.HEIGHT,E)}),G.eam.on(Y.ZOOM_FIT_SELECTION,()=>{X3()}),G.eam.on(Y.ZOOM_CENTER_SELECTION,()=>{ey()}),G.eam.on(Y.ZOOM_TO_VALUE,E=>{G.workspace.watched.set("scale",E)}),G.eam.on(Y.ALIGN,E=>{ti.align(E)}),G.eam.on(Y.DISTRIBUTE,E=>{ti.distribute(E)}),G.eam.on(Y.COPY,E=>{G.clipboard.copy(E)}),G.eam.on(Y.PASTE,E=>{G.clipboard.paste(E)}),G.eam.on(Y.CUT,E=>{G.clipboard.cut(E)}),G.eam.on(Y.DUPLICATE_ELEMENT,()=>{G.clipboard.duplicate()}),G.eam.on(Y.UNDO,()=>{G.get("undo").undo()}),G.eam.on(Y.REDO,()=>{G.get("undo").redo()}),G.eam.on(Y.EXIT_EDITOR,()=>{Pn.setState(null)}),G.eam.on(Y.ACTIVATE_SELECT_TOOL,()=>{Pn.setState("default")}),G.eam.on(Y.ACTIVATE_SCALE_TOOL,()=>{Pn.setState("default")}),G.eam.on(Y.ACTIVATE_HAND_TOOL,()=>{Pn.setState("grab")}),G.eam.on(Y.ACTIVATE_RECTANGLE_TOOL,()=>{Pn.setState("crosshair")}),G.eam.on(Y.ACTIVATE_ELLIPSE_TOOL,()=>{Pn.setState("crosshair")}),G.eam.on(Y.ACTIVATE_CONTAINER_TOOL,()=>{Pn.setState("crosshair")}),G.eam.on(Y.ACTIVATE_PEN_TOOL,()=>{Pn.setState("penDefault")}),G.eam.on(Y.ACTIVATE_TEXT_TOOL,()=>{Pn.setState("crosshair")}),G.eam.on(Y.ACTIVATE_COMMENT_TOOL,()=>{Pn.setState("comment")});let i=G.get("mode");G.eam.on(Y.SWITCH_MODE,E=>{i=E}),G.eam.on(Y.EXPORT_MEDIA,async E=>{const{fileName:g,mediaType:T,quality:A,transparent:m,loop:O,speed:S,fps:y,start:v,end:R,actionId:M}=E;G.set("mode",Dn.ACTION,Xh),ur.enable(),H.pause(),G.transition.hold(),G.transition.prepareActionTransition(),await J1();const L=(v===void 0?0:v)*1e3,P=(R===void 0?0:R)*1e3,k=y===void 0?H3:y,Q=S===void 0?W3:S,b=1e3/k*Q,X=G.interaction.getElementIdByActionId(M);ur.setOutputSize(),ur.updateRecordSetting({startTime:L,endTime:P,iterTime:b,speed:Q,fps:y,quality:A,transparent:m,loop:O}),await ur.setMediaType(T);const K=se=>{G.eam.exportProgress(F3(se,1))},V=()=>{ur.exportFile&&G.eam.exportFinish(ur.exportFile,{fileName:g,type:T}),ur.clear()},J=G.drawInfo.vs.root.id,ge=X;G.drawInfo.vs.view.cleanup(),G.drawInfo.vs.setRoot(ge),G.drawInfo.vs.view.setup(G,ge),await ur.recordCanvas(K,V,M),G.drawInfo.vs.setRoot(J),G.drawInfo.vs.view.setup(G,J),G.set("mode",i,Xh)}),G.eam.on(Y.CANCEL_EXPORT_MEDIA,()=>{G.set("mode",i,Xh),ur.disable(),ur.clear()});let r=null;const o=new Set,a=new N,c=E=>{o.clear(),E.x<0&&o.add("left"),E.y<0&&o.add("top"),E.x>mn.width&&o.add("right"),E.y>mn.height&&o.add("bottom")},l=()=>{o.size&&(o.has("left")&&(a.x=8),o.has("right")&&(a.x=-8),o.has("top")&&(a.y=8),o.has("bottom")&&(a.y=-8),mn.offsetPos(a),a.x=0,a.y=0),r=requestAnimationFrame(l)};G.eam.on(Y.START_LEFT_CLICK_MOVE,()=>{r=requestAnimationFrame(l)}),G.eam.on(Y.UPDATE_LEFT_CLICK_MOVE,E=>{G.eam.states.hover!=="GUIDELINE"&&c(E.mousePos)}),G.eam.on(Y.END_LEFT_CLICK_MOVE,()=>{o.clear(),cancelAnimationFrame(r)});let h=0;const d=20;let p;G.eam.on(Y.START_RIGHT_CLICK_MOVE,E=>{p=E.mousePos,h=0}),G.eam.on(Y.UPDATE_RIGHT_CLICK_MOVE,E=>{p=E.mousePos,h++}),G.eam.on(Y.END_RIGHT_CLICK_MOVE,()=>{if(h<d){const E=G.selection.get("elements"),g=Ss.viewport.toWorld(p),T=G.selection.get("hover"),A=Ss.selection.bounds.has_point(g);G.selection.get("hoverGuideline")?G.eam.directlySelectGuide():T||A?(!E.includes(T)&&!A&&(G.selection.clearAllExceptAction(),G.selection.addElements([T])),G.eam.openElementContextMenu(p.clone())):G.eam.openCanvasContextMenu(p.clone())}})}function K3(){G.eam.on(Y.START_RESIZE_ELEMENT,(r,o,{snapToGrid:a,snapToObject:c})=>hr.resizeStart(r,a,c)).on(Y.UPDATE_RESIZE_ELEMENT,(r,o,{snapToGrid:a,snapToObject:c})=>hr.resizeUpdate(r,o,a,c)).on(Y.END_RESIZE_ELEMENT,hr.resizeEnd),G.eam.on(Y.START_SCALE_ELEMENT,(r,o,{snapToGrid:a,snapToObject:c})=>hr.resizeStart(r,a,c)).on(Y.UPDATE_SCALE_ELEMENT,(r,o,{snapToGrid:a,snapToObject:c})=>hr.resizeUpdate(r,o,a,c)).on(Y.END_SCALE_ELEMENT,hr.resizeEnd),G.eam.on(Y.START_ROTATE_ELEMENT,(r,o)=>hr.rotateStart(r,o)).on(Y.UPDATE_ROTATE_ELEMENT,(r,o)=>hr.rotateUpdate(mn.toWorld(r.mousePos),o)).on(Y.END_ROTATE_ELEMENT,hr.rotateEnd),G.eam.on(Y.START_ZOOM_TO_SELECTION,mi.start).on(Y.UPDATE_ZOOM_TO_SELECTION,(r,o)=>mi.update(r,o,!0)).on(Y.END_ZOOM_TO_SELECTION,mi.end);let e=new Set;const n=new Set,s=new Set;G.eam.on(Y.START_AREA_SELECT_ELEMENT,r=>{e=new Set(G.selection.get("elements")),mi.start(r)}).on(Y.UPDATE_AREA_SELECT_ELEMENT,(r,o)=>{const a=mi.update(r,o,!1);n.forEach(c=>e.delete(c)),n.clear(),s.forEach(c=>e.add(c)),s.clear(),a.forEach(c=>{e.has(c)?(s.add(c),e.delete(c)):(n.add(c),e.add(c))}),mi.selectNodesInSelectionArea(e),e.size&&G.eam.pauseAnimation()}).on(Y.END_AREA_SELECT_ELEMENT,()=>{mi.end(),e.clear(),n.clear(),s.clear()});const i=new Set;G.eam.on(Y.START_AREA_SELECT_CELL,r=>{G.selection.get("vertices").forEach(a=>i.add(a)),mi.start(r)}).on(Y.UPDATE_AREA_SELECT_CELL,(r,o)=>{const a=mi.update(r,o,!1);i.forEach(c=>{a.has(c)?a.delete(c):a.add(c)}),mi.selectVerticesInSelectionArea(a)}).on(Y.END_AREA_SELECT_CELL,()=>{mi.end(),i.clear()})}function ty(e,n){return e.containsRect(n.boundsWorldAABB)}function Q3({mousePos:e,wheelDelta:n,deltaToMult:s,useViewportAwareZoomPos:i,viewport:r,screenNode:o}){const a=n.y<0?s(n.y):1/s(n.y);let c=e;if(i&&r&&o){const l=r.toScreen(o.boundsWorldAABB.center);c=ty(r,o)?l:e}return{zoomMult:a,zoomPos:c}}let Ho;class Z3{constructor(n,s,i){this.dataStore=n,this.viewport=s,this.cursorHandler=i,this.enabled=!0,this._hasLastMousePos=!1,this._lastMousePos=new N}updateEnabledState(){if(this.dataStore.isPrototypeMode){const n=this.dataStore.drawInfo.vs.indexer.getActiveScreenNode(),s=ty(this.viewport,n);this.enabled=!s}else this.enabled=!0}startPanning(n){this.enabled&&(this._hasLastMousePos=!0,this._lastMousePos.copy(n.mousePos),this.cursorHandler.setState("grabbing"))}updatePanning(n){if(this.enabled){const{mousePos:s}=n;this._hasLastMousePos||this.startPanning(n);const i=s.clone().sub(this._lastMousePos);this.viewport.offsetPos(i),this._lastMousePos.copy(s)}}endPanning(){this.enabled&&(this._hasLastMousePos=!1)}wheelPan(n){if(this.enabled){const s=n.wheelDelta.clone().negate();this.viewport.offsetPos(s)}}}function q3(){G.eam.on(Y.ACTIVATE_PAN,()=>{Pn.setState("grab")}),G.eam.on(Y.DEACTIVATE_PAN,()=>{Pn.setState("default")}),G.eam.on(Y.COMMENT_DEACTIVATE_PAN,()=>{Pn.setState("comment")}),Ho=new Z3(G,mn,Pn),G.eam.on(Y.START_PANNING,i=>Ho.startPanning(i)).on(Y.UPDATE_PANNING,i=>Ho.updatePanning(i)).on(Y.END_PANNING,()=>{Ho.endPanning()}),G.eam.on(Y.MOVE_VIEWPORT_KEY,i=>{mn.offsetPos(i)}),G.eam.on(Y.WHEEL_PAN_VIEWPORT,i=>{Ho.wheelPan(i)});function e({event:i,deltaToMult:r,isMobile:o=!1}){const a=G.isPrototypeMode,c=o?i.pinchScale<1:i.wheelDelta.y>0;if(a&&c){const l=o?i.pinchScale:1/r(i.wheelDelta.y);s({zoomFactor:l})}else if(o){const l=i.pinchScale;mn.zoomAroundPos(i.mousePos,l)}else{const l=a?G.drawInfo.vs.indexer.getActiveScreenNode():null,{zoomMult:h,zoomPos:d}=Q3({mousePos:i.mousePos,wheelDelta:i.wheelDelta,deltaToMult:r,useViewportAwareZoomPos:a,viewport:mn,screenNode:l});mn.zoomAroundPos(d,h)}}function n({offset:i,currentZoom:r,zoomFactor:o,options:a={}}){const{minBaseMovementInPx:c=20,progressiveMovementSlowdownRatio:l=.25,maxProgressiveMovementInPx:h=40}=a,d=i.length();if(d<1)return new N(0,0);const p=Math.abs(1-o)*c,E=Math.max(.1,Math.min(1,1/r)),g=d*E*l,T=h*E,A=Math.min(g,T),m=p+A,S=i.clone().normalize().scale(m);return S.x=Math.sign(i.x)*Math.min(Math.abs(i.x),Math.abs(S.x)),S.y=Math.sign(i.y)*Math.min(Math.abs(i.y),Math.abs(S.y)),S}function s({viewPortTopLeftX:i=0,viewPortTopLeftY:r=0,zoomFactor:o}){const a=G.drawInfo.vs.indexer.getActiveScreenNode(),c=mn.toScreen(a.boundsVisualWorldAABB.center),l=mn.rect.clone();l.x+=i,l.y+=r,l.width-=i,l.height-=r;const d=l.center.clone().sub(c),p=mn.getZoom(),E=n({offset:d,currentZoom:p,zoomFactor:o});mn.setZoom(p*o),mn.offsetPos(E)}{const i=r=>1+Math.abs(r)/1e3;G.eam.on(Y.WHEEL_ZOOM_TO_POINTER,r=>{e({event:r,deltaToMult:i,isMobile:!1})})}if(G.eam.on(Y.ACTIVATE_TEXT_EDIT_MODE,()=>{const r=G.selection.get("elements")[0];r!=null&&r.isText&&G.drawInfo.setTextEditingMode(r.get("id"),G.selection.get("textRange"))}),G.eam.on(Y.DEACTIVATE_TEXT_EDIT_MODE,()=>{G.drawInfo.exitTextEditingMode()}),H.platform==="Mac"){const i="quadratic",r=o=>{switch(i){case"cubic":return(1+Math.abs(o)/150)**3;case"quadratic":return(1+Math.abs(o)/100)**2;default:return 1+Math.abs(o)/75}};G.eam.on(Y.TRACKPAD_ZOOM_TO_POINTER,o=>{e({event:o,deltaToMult:r,isMobile:!1})})}G.eam.on(Y.MOBILE_PINCH_ZOOM_TO_POINTER,i=>{i.pinchScale&&i.pinchCenter&&e({event:i,deltaToMult:o=>1+Math.abs(o)/1e3,isMobile:!0})}),mn.on(me.VIEWPORT_ZOOM_CHANGE,()=>{Ho.updateEnabledState()}),mn.on(me.VIEWPORT_RESIZE,()=>{Ho.updateEnabledState()}),G.eam.on(Y.SWITCH_DOCUMENT_MODE,()=>{Ho.updateEnabledState()})}function j3(){H.get(H.Events.MOUSE_MOVE).on("trigger",(e,n)=>{G.eam.mouseMove(e,n)}),H.get(H.Events.DELETE).on("trigger",(e,n)=>{G.eam.delete(e,n)}),H.get(H.Events.LEFT_CLICK_DOWN).on("trigger",(e,n)=>{G.eam.leftClickDown(e,n)}),H.get(H.Events.LEFT_CLICK_UP).on("trigger",(e,n)=>{G.eam.leftClickUp(e,n)}),H.get(H.Events.DOUBLE_LEFT_CLICK).on("trigger",e=>{G.eam.doubleLeftClick(e)}),H.get(H.Events.DRAG_OVER).on("trigger",e=>{G.eam.dragOver(e)}),H.get(H.Events.DRAG_END).on("trigger",e=>{G.eam.dragEnd(e)}),H.get(H.Events.DROP).on("trigger",e=>{G.eam.drop(e)}),H.get(H.Events.LEFT_CLICK_MOVE).on("start",(e,n)=>{G.eam.fire(Y.START_LEFT_CLICK_MOVE,e),G.eam.leftClickMove(e,n)}).on("update",(e,n)=>{G.eam.fire(Y.UPDATE_LEFT_CLICK_MOVE,e),G.eam.updateAction(e,n)}).on("end",()=>{G.eam.fire(Y.END_LEFT_CLICK_MOVE),G.eam.endAction()}),H.get(H.Events.MIDDLE_CLICK_MOVE).on("start",e=>{G.eam.middleClickMove(e)}).on("update",e=>{G.eam.updateAction(e)}).on("end",()=>{G.eam.endAction(),G.eam.spaceOff()}),H.get(H.Events.RIGHT_CLICK_MOVE).on("start",e=>{G.eam.fire(Y.START_RIGHT_CLICK_MOVE,e),G.eam.rightClickMove(e)}).on("update",e=>{G.eam.fire(Y.UPDATE_RIGHT_CLICK_MOVE,e),G.eam.updateAction(e)}).on("end",()=>{G.eam.fire(Y.END_RIGHT_CLICK_MOVE),G.eam.endAction(),G.eam.spaceOff()}),H.get(H.Events.SPACE).on("start",e=>{G.eam.spaceOn(e)}).on("end",()=>{G.eam.spaceOff(),G.eam.toggleAnimation(),G.eam.endAction()}),H.get(H.Events.MOVE_RIGHT).on("trigger",(e,n)=>{G.eam.arrowKey(ut.RIGHT,n)}),H.get(H.Events.MOVE_LEFT).on("trigger",(e,n)=>{G.eam.arrowKey(ut.LEFT,n)}),H.get(H.Events.MOVE_UP).on("trigger",(e,n)=>{G.eam.arrowKey(ut.UP,n)}),H.get(H.Events.MOVE_DOWN).on("trigger",(e,n)=>{G.eam.arrowKey(ut.DOWN,n)}),H.get(H.Events.SELECT_PREVIOUS_ELEMENT).on("trigger",()=>{G.eam.selectElementSibling(ut.UP)}),H.get(H.Events.SELECT_NEXT_ELEMENT).on("trigger",()=>{G.eam.selectElementSibling(ut.DOWN)}),H.get(H.Events.TEXT_MOVE_CARET_TO_LINE_START).on("trigger",()=>{G.eam.moveTextToEdge(ut.START)}),H.get(H.Events.TEXT_MOVE_CARET_TO_TEXT_START).on("trigger",()=>{G.eam.moveTextToEdge(ut.START,{modifier:!0})}),H.get(H.Events.TEXT_EXPAND_SELECTION_TO_LINE_START).on("trigger",()=>{G.eam.moveTextToEdge(ut.START,{shift:!0})}),H.get(H.Events.TEXT_EXPAND_SELECTION_TO_TEXT_START).on("trigger",()=>{G.eam.moveTextToEdge(ut.START,{modifier:!0,shift:!0})}),H.get(H.Events.TEXT_MOVE_CARET_TO_LINE_END).on("trigger",()=>{G.eam.moveTextToEdge(ut.END)}),H.get(H.Events.TEXT_MOVE_CARET_TO_TEXT_END).on("trigger",()=>{G.eam.moveTextToEdge(ut.END,{modifier:!0})}),H.get(H.Events.TEXT_EXPAND_SELECTION_TO_LINE_END).on("trigger",()=>{G.eam.moveTextToEdge(ut.END,{shift:!0})}),H.get(H.Events.TEXT_EXPAND_SELECTION_TO_TEXT_END).on("trigger",()=>{G.eam.moveTextToEdge(ut.END,{modifier:!0,shift:!0})}),H.get(H.Events.ENTER).on("trigger",e=>{G.eam.enter(e)}),H.get(H.Events.ENTER_SHIFT).on("trigger",e=>{G.eam.enter(e,{shift:!0})}),H.get(H.Events.ESCAPE).on("trigger",e=>{G.eam.escape(e)}),H.get(H.Events.WHEEL_PAN_VIEWPORT).on("trigger",(e,n)=>{G.eam.wheelPanAndZoom(e,n)}),H.get(H.Events.WHEEL_ZOOM_TO_POINTER).on("trigger",e=>{G.eam.wheelPanAndZoom(e,{modifier:!0})}),H.platform==="Mac"&&H.get(H.Events.TRACKPAD_ZOOM_TO_POINTER).on("trigger",e=>{G.eam.wheelPanAndZoom(e,{ctrl:!0})}),H.get(H.Events.MOBILE_PINCH_ZOOM_TO_POINTER).on("trigger",e=>{G.eam.wheelPanAndZoom(e,{pinch:!0})}),H.get(H.Events.MOBILE_TOUCH_PAN).on("start",e=>{G.eam.startAction(Y.START_PANNING,e)}).on("update",e=>{G.eam.updateAction(e)}).on("end",()=>{G.eam.endAction()}),H.get(H.Events.ZOOM_IN).on("trigger",e=>{G.eam.zoomIn(e)}),H.get(H.Events.ZOOM_OUT).on("trigger",e=>{G.eam.zoomOut(e)}),H.get(H.Events.ZOOM_RESET).on("trigger",()=>{G.eam.zoomReset()}),H.get(H.Events.ZOOM_FIT_CONTENT).on("trigger",()=>{G.eam.zoomFitContent()}),H.get(H.Events.ZOOM_FIT_SELECTION).on("trigger",()=>{G.eam.zoomFitSelection()}),H.get(H.Events.ZOOM_CENTER_SELECTION).on("trigger",()=>{G.eam.zoomCenterSelection()}),H.get(H.Events.ACTIVATE_SELECT_TOOL).on("trigger",()=>{G.eam.activateSelectTool()}),H.get(H.Events.ACTIVATE_SCALE_TOOL).on("trigger",()=>{G.eam.activateScaleTool()}),H.get(H.Events.ACTIVATE_HAND_TOOL).on("trigger",e=>{G.eam.activateHandTool(e)}),H.get(H.Events.ACTIVATE_RECTANGLE_TOOL).on("trigger",()=>{G.eam.activateRectangleTool()}),H.get(H.Events.ACTIVATE_CONTAINER_TOOL).on("trigger",()=>{G.eam.activateContainerTool()}),H.get(H.Events.ACTIVATE_ELLIPSE_TOOL).on("trigger",()=>{G.eam.activateEllipseTool()}),H.get(H.Events.ACTIVATE_PEN_TOOL).on("trigger",()=>{G.eam.activatePenTool()}),H.get(H.Events.ACTIVATE_COMMENT_TOOL).on("trigger",()=>{G.eam.activateCommentTool()}),H.get(H.Events.ACTIVATE_TEXT_TOOL).on("trigger",()=>{G.eam.activateTextTool()}),H.get(H.Events.TOGGLE_EYE_DROPPER_TOOL).on("trigger",()=>{G.eam.toggleEyeDropperTool()}),H.get(H.Events.GROUP_ELEMENTS).on("trigger",(e,n)=>{G.eam.groupElements(n)}),H.get(H.Events.UNGROUP_ELEMENT).on("trigger",()=>{G.eam.ungroupElements()}),H.get(H.Events.INCREASE_CORNER_RADIUS).on("trigger",()=>{G.eam.increaseCornerRadius()}),H.get(H.Events.DECREASE_CORNER_RADIUS).on("trigger",()=>{G.eam.decreaseCornerRadius()}),H.get(H.Events.SELECT_ALL).on("trigger",()=>{G.eam.selectAllByContext()}),H.get(H.Events.COPY).on("trigger",()=>{G.eam.copy()}),H.get(H.Events.PASTE).on("trigger",e=>{G.eam.paste(e)}),H.get(H.Events.CUT).on("trigger",()=>{G.eam.cut()}),H.get(H.Events.DUPLICATE).on("trigger",()=>{G.eam.duplicate()}),H.get(H.Events.UNDO).on("trigger",()=>{G.eam.undo()}),H.get(H.Events.REDO).on("trigger",()=>{G.eam.redo()}),H.get(H.Events.TOGGLE_EXPAND).on("trigger",()=>{G.eam.toggleExpand()}),H.get(H.Events.ALIGN_LEFT).on("trigger",()=>{G.eam.align(jt.LEFT)}),H.get(H.Events.ALIGN_CENTER).on("trigger",()=>{G.eam.align(jt.CENTER)}),H.get(H.Events.ALIGN_RIGHT).on("trigger",()=>{G.eam.align(jt.RIGHT)}),H.get(H.Events.ALIGN_TOP).on("trigger",()=>{G.eam.align(jt.TOP)}),H.get(H.Events.ALIGN_MIDDLE).on("trigger",()=>{G.eam.align(jt.MIDDLE)}),H.get(H.Events.ALIGN_BOTTOM).on("trigger",()=>{G.eam.align(jt.BOTTOM)}),H.get(H.Events.DISTRIBUTE_HORIZONTAL).on("trigger",()=>{G.eam.distribute($a.HORIZONTAL)}),H.get(H.Events.DISTRIBUTE_VERTICAL).on("trigger",()=>{G.eam.distribute($a.VERTICAL)}),H.get(H.Events.TOGGLE_ANIMATE_MODE).on("trigger",()=>{const e=G.isActionMode?Dn.DESIGN:Dn.ACTION,n=G.get("lastActiveAction");e===Dn.ACTION&&n?(G.isActionMode&&(G.transition.stop(),G.drawInfo.vs.updateNodes()),G.eam.switchMode(n===null?Dn.DESIGN:Dn.ACTION),G.selection.selectAction(n,{commit:!1})):e===Dn.DESIGN&&(G.eam.switchMode(e),G.selection.selectAction(null,{commit:!1})),G.commitUndo()}),H.get(H.Events.TOGGLE_ORIGIN).on("trigger",()=>{G.eam.toggleOrigin()}),H.get(H.Events.TOGGLE_RULER).on("trigger",()=>{G.eam.toggleRuler()}),H.get(H.Events.TOGGLE_ACTION_PANEL).on("trigger",()=>{G.isActionMode&&G.eam.toggleActionPanel()}),H.get(H.Events.TOGGLE_INTERFACE).on("trigger",()=>{G.eam.toggleInterface()}),H.get(H.Events.ADD_ACTION).on("trigger",()=>{G.eam.addAction()}),H.get(H.Events.TOGGLE_COMMENT_VISIBILITY).on("trigger",()=>{G.eam.toggleCommentVisibility()}),H.get(H.Events.TOGGLE_VISIBLE).on("trigger",()=>{G.eam.toggleVisible()}),H.get(H.Events.TOGGLE_LOCK).on("trigger",()=>{G.eam.toggleLock()}),H.get(H.Events.BRING_TO_FRONT).on("trigger",()=>{G.eam.bringToFront()}),H.get(H.Events.SEND_TO_BACK).on("trigger",()=>{G.eam.sendToBack()}),H.get(H.Events.MOVE_FORWARD).on("trigger",()=>{G.eam.moveForward()}),H.get(H.Events.MOVE_BACKWARD).on("trigger",()=>{G.eam.moveBackward()}),H.get(H.Events.MASK_SELECTION).on("trigger",()=>{G.eam.maskGroupElements(!0)}),H.get(H.Events.TOGGLE_PRESENCE).on("trigger",()=>{G.eam.togglePresencePreference()}),H.get(H.Events.EDIT_ORIGIN).on("trigger",()=>{const e=G.getFeature("editOrigin");G.setFeature("editOrigin",!e)}),H.get(H.Events.TOGGLE_INSPECTING).on("trigger",()=>{G.eam.toggleInspecting()}),H.get(H.Events.RESTART_PROTOTYPE).on("trigger",()=>{G.eam.restartPrototype()}),H.get(H.Events.TOGGLE_PROTOTYPE_MODE).on("trigger",()=>{G.isPrototypeMode?G.eam.exitPrototypeMode():G.eam.enterPrototypeMode()}),H.get(H.Events.EXIT_PROTOTYPE_MODE).on("trigger",()=>{G.eam.exitPrototypeMode()}),H.get(H.Events.ENTER_PROTOTYPE_MODE_FULL_SCREEN).on("trigger",()=>{G.eam.enterPrototypeModeFullScreen()})}function J3(){switch(G.get("editMode")){case wn.SHAPE:Ss.snappingPath.update();break}}function $3(e,n,s){return Math.abs(e[0]-n)>fs||Math.abs(e[1]-s)>fs}const ag=(e,n)=>{const s=e.view.getOrCreateDinoTree(n.id),i=n.fontFamily||"Noto Sans",r=n.fontSize,o=n.fontStyle,a=n.fontWeight,c=n.lineHeight,l=n.content||"",h=n.letterSpacing,d=0,p=n.horizontalAlignment,E=n.verticalAlignment;if(n.updateFlags&Z.STYLE){let b=e.dataStore.fontManager.getFontUrl(i,o,a);b||(console.warn(`cannot found the URL for ${i}-${o}-${a}`),b=e.dataStore.fontManager.getFontUrl(i,"Regular",400)),tt().fetchFont(i,b,o,a)}let g=-1;n.resizingMode!==eo[kt.AUTO_WIDTH]&&(g=n.transform.size.x);let T=-1;n.resizingMode===eo[kt.FIXED]&&(T=n.transform.size.y);const A=s.text_node_id;let m=0,O=0,S=0;const y=e.dataStore.selection.get("textRange");y?(m=y.start,O=y.end,S=y.cursor):(O=l.length,S=l.length);const{start_block:v,start_char:R,end_block:M,end_char:L,cursor_index:P,active_block_index:k}=cg(l,m,O,S);for(let b=0;b<s.fills.children.length;b++)tt().setTextDoc(s.fills.children[b].text_doc_id,l,P,k),tt().setTextStyle(s.fills.children[b].text_doc_id,i,o,a,r,h,c,d,p,E),tt().buildLayoutAndPath(s.fills.children[b].id,s.fills.children[b].text_doc_id,g,T),tt().markNodeChanged(s.fills.children[b].id);for(let b=0;b<s.strokes.children.length;b++)tt().setTextDoc(s.strokes.children[b].text_doc_id,l,P,k),tt().setTextStyle(s.strokes.children[b].text_doc_id,i,o,a,r,h,c,d,p,E),tt().buildLayoutAndPath(s.strokes.children[b].id,s.strokes.children[b].text_doc_id,g,T),tt().markNodeChanged(s.strokes.children[b].id);tt().setTextDoc(s.text_doc_id,l,P,k),tt().setTextStyle(s.text_doc_id,i,o,a,r,h,c,d,p,E),tt().buildLayoutAndPath(A,s.text_doc_id,g,T),tt().markNodeChanged(A),tt().setTextSelection(s.text_doc_id,v,R,M,L,P,k);const Q=tt().getTextPathData(A,s.text_doc_id);s.path_id?tt().setPath(s.path_id,Q):s.path_id=tt().makePath(Q)},cg=(e,n,s,i)=>{let r=0,o=0,a=0,c=0,l=0,h=0,d=0,p=0,E=-1;for(let g=0;g<=e.length;g++){if(g===i&&(l=d,h=p),g===n&&(r=d,a=p,E=s-n),E>0)E--;else if(E===0){o=d,c=p;break}g<e.length&&e[g]==`
`?(d++,p=0):p++}return s>0&&e[s-1]===`
`&&(c=0),{start_block:r,start_char:a,end_block:o,end_char:c,cursor_index:h,active_block_index:l}},ny=(e,n,s,i,r)=>{const o=n.get("resizingMode"),a=n.get("size"),c=n.get("horizontalAlignment"),l=n.get("verticalAlignment");o===kt.AUTO_WIDTH?e5(e,a,s,i,n,c,l,r):o===kt.AUTO_HEIGHT&&s5(e,a,i,n,c,l,r)};function e5(e,n,s,i,r,o,a,c){const l=r.get("id");if(e.dataStore.isDesignMode&&!e.dataStore.isPrototypeMode){if(!$3(n,s,i))return;const h={width:s,height:i,referencePointX:.5*s,referencePointY:.5*i},d=r.get("contentAnchor");n.x>=Xt&&(h.contentAnchorX=d.x*s/n.x),n.y>=Xt&&(h.contentAnchorY=d.y*i/n.y);const p=sy(e,l,h,o,a);p&&(h.translateX=p.x,h.translateY=p.y),r.sets(h,c)}else{const h={width:s,height:i},d=r.getBaseValue("referencePoint"),p=r.getBaseValue("dimensions");t5(o,a,h,s,i,d,p),r.sets(h,Uf)}}function t5(e,n,s,i,r,o,a){const c=a.width-o.referencePointX,l=a.height-o.referencePointY;switch(e){case Ri.CENTER:s.referencePointX=.5*i;break;case Ri.RIGHT:s.referencePointX=i-c;break;case Ri.LEFT:s.referencePointX=o.referencePointX;break}switch(n){case Ps.MIDDLE:s.referencePointY=.5*r;break;case Ps.BOTTOM:s.referencePointY=r-l;break;case Ps.TOP:s.referencePointY=o.referencePointY;break}}function n5(e,n,s,i,r){const o=r.height-i.referencePointY;switch(s){case Ps.MIDDLE:e.referencePointY=.5*n;break;case Ps.BOTTOM:e.referencePointY=n-o;break;case Ps.TOP:break}}function s5(e,n,s,i,r,o,a){const c=i.get("id");if(e.dataStore.isDesignMode&&!e.dataStore.isPrototypeMode){const l={height:s,referencePointY:.5*s},h=i.get("contentAnchor");n.y>=Xt&&(l.contentAnchorY=h.y*s/n.y);const d=sy(e,c,l,r,o);d&&(l.translateX=d.x,l.translateY=d.y),i.sets(l,a)}else{const l={height:s},h=i.getBaseValue("referencePoint"),d=i.getBaseValue("dimensions");n5(l,s,o,h,d),i.sets(l,Uf)}}function sy(e,n,s,i,r,o=!1){const a=i5(e,n,s);if(!a)return null;const c=o?a.baseTransform:a.transform,{contentAnchor:l,referencePoint:h,size:d,translate:p,skew:E,scale:g,rotation:T}=r5(c),A=o5(s,l,h),m=a5(s,d),{newPivotOffset:O,originPivotOffset:S}=c5(A,l,h,d,s,i,r);return l5(p,T,E,g,O,S,m)}function i5(e,n,s){const i=e.getRenderItem(n);return!i||!(s.contentAnchorX!==void 0||s.contentAnchorY!==void 0||s.width!==void 0||s.height!==void 0)?null:i}function r5(e){return{contentAnchor:e.contentAnchor,referencePoint:e.referencePoint,size:{x:e.size.x,y:e.size.y},translate:{x:e.translate.x,y:e.translate.y},skew:e.skew,scale:e.scale,rotation:e.rotation}}function o5(e,n,s){return{contentAnchorX:e.contentAnchorX??n.x,contentAnchorY:e.contentAnchorY??n.y,referencePointX:e.referencePointX??s.x,referencePointY:e.referencePointY??s.y}}function a5(e,n){let s=0,i=0;if(e.width!==void 0){const r=e.width!==0&&e.width<Xt,o=n.x!==0&&n.x<Xt;r&&!o?s=-e.width*.5:o&&!r&&(s=n.x*.5)}if(e.height!==void 0){const r=e.height!==0&&e.height<Xt,o=n.y!==0&&n.y<Xt;r&&!o?i=-e.height*.5:o&&!r&&(i=n.y*.5)}return{offsetX:s,offsetY:i}}function c5(e,n,s,i,r,o,a){const{contentAnchorX:c,contentAnchorY:l,referencePointX:h,referencePointY:d}=e,p=new N(c+h,l+d),E=new N(n.x+s.x,n.y+s.y);switch(o){case Ri.CENTER:p.x=c+h-(r.width?r.width:i.x)*.5,E.x-=i.x*.5;break;case Ri.RIGHT:p.x=c+h-(r.width?r.width:i.x),E.x-=i.x;break}switch(a){case Ps.MIDDLE:p.y=l+d-(r.height?r.height:i.y)*.5,E.y-=i.y*.5;break;case Ps.BOTTOM:p.y=l+d-(r.height?r.height:i.y),E.y-=i.y;break}return{newPivotOffset:p,originPivotOffset:E}}function l5(e,n,s,i,r,o,a){const{offsetX:c,offsetY:l}=a,h=new N(e.x,e.y),d=new Ce().translate_right(h.x,h.y).rotate_right(n).skew_right(wt(s.x),wt(s.y)).scale_right(i.x,i.y).translate_right(-r.x,-r.y),p=new Ce().translate_right(e.x,e.y).rotate_right(n).skew_right(wt(s.x),wt(s.y)).scale_right(i.x,i.y).translate_right(-o.x,-o.y),E=d.get_origin(),g=p.get_origin();return{x:c+h.x+(g.x-E.x),y:l+h.y+(g.y-E.y)}}let Be=null,lg=null;const nt=tt();function hg(){this.id=null,this.item=null,this.boundsLocal=new ye,this.boundsLocal_zero=new ye,this.boundsWorldAABB=new ye,this.boundsWorldAABB_zero=new ye,this.boundsVisualLocal=new ye,this.boundsVisualWorldAABB=new ye,this.subtreeBounds=new ye,this.subtreeBoundsVersion=0,this.pos=-1,this.parent=null,this.children=[],this.version=0,this.geometryVersion=0}hg.prototype={constructor:hg,reset(){this.id=null,this.item=null,this.boundsLocal.set(0,0,0,0),this.boundsLocal_zero.set(0,0,0,0),this.boundsVisualLocal.set(0,0,0,0),this.boundsVisualWorldAABB.set(0,0,0,0),this.boundsWorldAABB.set(0,0,0,0),this.boundsWorldAABB_zero.set(0,0,0,0),this.subtreeBounds.set(0,0,0,0),this.subtreeBoundsVersion=0,this.pos=-1,this.parent=null,this.children.length=0,this.version=0,this.geometryVersion=0},get isRoot(){return this.parent===null||this.id===Be.root.id},getFirstChild(){return this.children.length>0?this.children[0]:null},getLastChild(){return this.children.length>0?this.children[this.children.length-1]:null},getNextSibling(){return!this.parent||this.pos<0?null:this.parent.getChild(this.pos+1)},getPrevSibling(){return!this.parent||this.pos<0?null:this.parent.getChild(this.pos-1)},addChild(e){e.pos=this.children.length,this.children.push(e),e.parent=this,Sd(e,this.item.depth+1)},addChildAt(e,n){if(!(n<0||n>this.children.length)){this.children.length+=1;for(let s=this.children.length-1;s>n;s--)this.children[s]=this.children[s-1],this.children[s].pos=s;this.children[n]=e,e.pos=n,e.parent=this,Sd(e,this.item.depth+1)}},insertChildAt(e,n){const s=Math.min(n,this.children.length);if(s===this.children.length)e.pos=s,this.children.push(e);else{this.children.length+=1;for(let i=this.children.length-1;i>s;i--)this.children[i]=this.children[i-1],this.children[i].pos=i;this.children[s]=e,e.pos=s}e.parent=this,Sd(e,this.item.depth+1)},removeChild(e){const n=this.children.indexOf(e);n<0||this.removeChildAt(n)},removeChildAt(e){if(e<0||e>=this.children.length)return;const n=this.children[e];n.parent=null,n.pos=-1;const s=this.children.length-1;for(let i=e;i<s;i++){const r=this.children[i+1];r.pos=i,this.children[i]=r}this.children.length=s},getChild(e){return e<0||e>=this.children.length?null:this.children[e]},hasChildren(){return this.children.length>0},reverseChildren(){this.children=this.children.slice().reverse();for(let e=0,n=this.children.length;e<n;e++)this.children[e].pos=e},setGeometry(e,n=null){const s=this.item;if(s.freed||!s.base.vector)return;s.base.shape=qe.createFromPathData(e),s.base.shape.version=-1,s.base.vector.rect=n,s.base.setShape(0,gt.BASE,s.base.shape),s.update(Z.GEOMETRY);let i=this.parent;for(;i;)i=i.parent},calcBounds(e=!1){const n=Be.view.getOrCreateDinoTree(this.item.id);if(n.base_path_id===0)this.boundsLocal.set(0,0,0,0),this.boundsLocal_zero.set(0,0,0,0),this.boundsWorldAABB.set(0,0,0,0),this.boundsWorldAABB_zero.set(0,0,0,0);else{const s=bI(n.base_path_id);if(this.boundsLocal.set(s.x,s.y,s.w,s.h),this.item.isMaskGroup()){const r=this.children[this.children.length-1],o=Be.view.getOrCreateDinoTree(r.id),a=new ye;for(let c=0;c<o.strokes.children.length;c++){const l=o.strokes.children[c],h=GI(l.path_id,l.stroke_data_id);a.merge_with({x:h.x,y:h.y,width:h.w,height:h.h})}if(o.strokes.children.length>0){const c=r.item.transform.local.xform_rect(a);this.boundsLocal.merge_with(c)}}let i=A5(this.item,this.boundsLocal.clone());this.boundsLocal_zero.copy(i),i=this.item.transform.world.xform_rect(this.boundsLocal),this.boundsWorldAABB.set(i.x,i.y,i.width,i.height),i=this.item.transform.world.xform_rect(this.boundsLocal_zero),this.boundsWorldAABB_zero.set(i.x,i.y,i.width,i.height),this.boundsVisualWorldAABB=this.item.transform.world.xform_rect(this.boundsVisualLocal)}if(this.item.bounds.rect.copy(this.boundsLocal),this.item.bounds.visual.copy(this.boundsVisualLocal),e)for(let s=0,i=this.children,r=i.length;s<r;s++)i[s].calcBounds(!0)},calcSubtreeBounds(e=!1){const n=Be.currentVersion();if(n&&this.subtreeBoundsVersion===n)return this.subtreeBounds;if(this.item.type==="text"){const s=Be.view.getOrCreateDinoTree(this.item.id),i=nt.getTextLayoutBox(s.text_node_id),r=new ye().set(i.x,i.y,i.w,i.h),o=this.item.transform.world.xform_rect(r);this.subtreeBounds.copy(this.boundsVisualWorldAABB.merge(o))}else this.subtreeBounds.copy(this.boundsVisualWorldAABB);if(!this.item.clipping||!e)for(let s=0,i=this.children,r=i.length;s<r;s++){const o=i[s].calcSubtreeBounds(e);o.is_zero()||(this.subtreeBounds.is_zero()?this.subtreeBounds.copy(o):this.subtreeBounds.merge_with(o))}return this.item.bounds.local.copy(this.boundsLocal_zero),this.item.bounds.world.copy(this.boundsWorldAABB_zero),this.item.bounds.rect.copy(this.item.bounds.local),Be.selection.markDirty(this.item.id),n&&(this.subtreeBoundsVersion=n),this.subtreeBounds}};class h5{constructor(n){Be||(Be=n),lg||(lg=this),this.root=null,this.nodeMap=new Map}clear(){this.root&&(ug(this.root),this.root=null),this.nodeMap.clear()}connectDataStore(n){if(n.workspace.on(me.SCENE_TREE_CHANGES,(s,i={undoable:!0})=>{const{oldParents:r,newParents:o,removed:a,added:c,moved:l,reordered:h}=av(s);for(const d of a)this.deleteNode(d,r.get(d),l.size>0);for(const d of c){const p=o.get(d),g=n.getElement(p).children.indexOf(n.getElement(d)),T=this.nodeMap.get(p),A=this.createNodeFromDataStore(d);this.insertNode(A,T,g),Be.view.createDinoNode(A),Be.view.insertDinoNode(A,T,g);const m=n.getElement(d);if((m.get("elementType")===Le.CONTAINER||m.get("elementType")===Le.BOOLEAN_CONTAINER||m.get("elementType")===Le.MASK_CONTAINER)&&l.size===0&&!s.UPDATE.has(d))for(const O of n.traverseSubtree(d,!1,!0)){const S=n.getElement(O),y=S.get("parent"),v=y.children.indexOf(S),R=this.nodeMap.get(y.get("id")),M=this.createNodeFromDataStore(O);this.insertNode(M,R,v),Be.view.createDinoNode(M),Be.view.insertDinoNode(M,R,v)}this.updateTransformRecursively(A)}for(const d of l){const p=o.get(d),g=n.getElement(p).children.indexOf(n.getElement(d));this.moveNode(d,p,g);const T=r.get(d),A=Be.getRenderItem(d);if(!A){console.warn(`[SpatialCache] cannot add item (id="${A.id}") to non-exist parent (id="${d}")`);continue}A.transform._dirty=!0,A.baseTransform._dirty=!0;const m=Be.getRenderItem(p);if(m.transform._dirty=!0,m.baseTransform._dirty=!0,T){const O=Be.dataStore.getById(d);this._updateBaseValues(O,A,m,i.undoable),n.isActionMode&&(n.transition.cacheSpecificElementBaseValue(d,"motionPath"),this._updateComputedValues(O,A,m))}}for(const d of h){const p=o.get(d),E=n.getElement(p).children.indexOf(n.getElement(d));this.reorderNode(d,E)}}),n.on(me.LOAD_START,()=>{this.clear()}),n.on(me.LOAD,()=>{const s=n.workspace.watched;this.loadFromDataStore(n,s)}),n.workspace.watched){const s=n.workspace.watched;this.loadFromDataStore(n,s)}n.guidelines.on(me.GUIDELINES_CHANGES,s=>{s.CREATE.forEach(i=>{const r=n.guidelines.getGuideline(i);r&&ng(r)}),s.UPDATE.forEach((i,r)=>{const o=n.guidelines.getGuideline(r);o&&ng(o)}),s.DELETE.forEach(i=>{JG(i)})})}loadFromDataStore(n,s){const i=s.get("id"),r=this.createNodeFromDataStore(i);for(const a of n.traverseSubtree(i,!1,!0)){const c=n.getElement(a),l=c.get("parent"),h=l.children.indexOf(c),d=this.createNodeFromDataStore(a),p=this.nodeMap.get(l.get("id"));this.insertNode(d,p,h)}Be.view=new fS(Be),Be.setRoot(r.id),Be.view.setup(Be.dataStore,Be.root.id);const o=[...n.guidelines.getGuidelineListVertical(),...n.guidelines.getGuidelineListHorizontal()];for(const a of o){const c=n.guidelines.getGuideline(a);c&&ng(c)}}makeNode(n){const s=new hg;return s.id=n,s.item=Be.makeRenderItem(n),this.nodeMap.set(n,s),s}hasNode(n){return this.nodeMap.has(n)}getNode(n){return this.hasNode(n)?this.nodeMap.get(n):(console.warn(`[SpatialCache] cannot find node (id="${n}")`),null)}getRootNode(){return this.root}getWorkspaceNode(){return this.nodeMap.get(Be.dataStore.workspace.watched.get("id"))}getActiveScreenNode(){return this.getWorkspaceNode().getFirstChild()}isRoot(n){return n===this.root.id}insertNode(n,s,i){return s.insertChildAt(n,i),s.item.isComputedGroup()&&s.item.update(Z.GEOMETRY),n.item.update(Z.GEOMETRY|Z.TRANSFORM|Z.STYLE),n.item.base.mods.length=3,n}createNodeFromDataStore(n){const s=this.makeNode(n),i=Be.dataStore.getElement(n);return MP(Be,s,i),parent.version=Be.currentVersion(),s.version=parent.version,s}deleteNode(n,s,i=!1){const r=this.nodeMap.get(s);if(!r){console.warn(`[SpatialCache] cannot remove item (id="${n}") from non-exist parent (id="${s}")`);return}const o=this.nodeMap.get(n);if(!o){console.warn(`[SpatialCache] cannot remove non-exist item (id="${n}")`);return}VP(o);const a=r.item.isMaskGroup()&&r.getLastChild().id===o.id;r.removeChild(o),r.version=Be.currentVersion(),o.version=r.version,Be.view.removeDinoNode(o,r,a),i?ry(o):ug(o),(r.item.trim.enabled||r.item.isComputedGroup())&&r.item.update(Z.GEOMETRY)}moveNode(n,s,i){const r=this.nodeMap.get(s);if(!r){console.warn(`[SpatialCache] cannot find new parent (id="${s}")`);return}const o=this.nodeMap.get(n);if(!o){console.warn(`[SpatialCache] cannot find node (id="${n}")`);return}const a=o.parent,c=a.item.isMaskGroup()&&a.getLastChild().id===o.id;a.removeChild(o),a.version=Be.currentVersion(),a.item.update(Z.GEOMETRY),r.addChildAt(o,i),r.version=Be.currentVersion(),r.item.isComputedGroup()&&r.item.update(Z.GEOMETRY),o.version=a.version,o.item.update(Z.TRANSFORM|Z.GEOMETRY),o.item.base.mods.length=3,Be.view.removeDinoNode(o,a,c),Be.view.insertDinoNode(o,r,i)}reorderNode(n,s){const i=this.nodeMap.get(n);if(!i){console.warn(`[SpatialCache] cannot find item (id="${n}")`);return}if(i.pos===s)return;i.parent.version=Be.currentVersion(),i.parent.item.update(Z.GEOMETRY);const r=i.parent.children,o=s<i.pos?-1:1;for(let a=i.pos;a!==s;a+=o)r[a]=r[a+o],r[a].pos=a,r[a].version=i.parent.version;r[s]=i,i.pos=s,i.version=i.parent.version,i.item.update(Z.TRANSFORM|Z.GEOMETRY),Be.view.reorderDinoNode(i,i.parent,s)}updateTransformRecursively(n){var r;const s=(r=n.parent)==null?void 0:r.item,i=n.id===this.root.id;if(s&&!i?(s.updateFlags&Z.TRANSFORM&&n.item.update(Z.TRANSFORM),n.item.updateFlags&Z.TRANSFORM&&(n.item.transform.update(),n.item.transform.updateWorld(s.transform),n.item.bounds.updateLocal(n.item.transform.local),n.item.bounds.updateWorld(n.item.transform.world)),n.item.transform.parent.copy(s.transform.world)):(n.item.updateFlags&Z.TRANSFORM&&(n.item.transform.update(),n.item.transform.updateWorld(new Uu),n.item.bounds.updateLocal(n.item.transform.local),n.item.bounds.updateWorld(n.item.transform.world)),n.item.transform.parent.identity(),n.item.transform.world.copy(n.item.transform.local)),n.item.transform.worldInv.copy(n.item.transform.world).affine_inverse(),n.item.updateFlags&Z.TRANSFORM&&(n.item.baseTransform.update(),s?n.item.baseTransform.updateWorld(s.baseTransform):n.item.baseTransform.updateWorld(new Uu),bP(Be,n),n.item.version=Be.currentVersion()),n.children.length>0)for(let o=0,a=n.children,c=a.length;o<c;o++)this.updateTransformRecursively(a[o])}updateNodes(n){var a;if(!this.root)return;const s=this.root.getFirstChild();let i=n.map(c=>this.nodeMap.get(c.id)).filter(g5).sort(Id);Yt.log("max depth of the scene tree",i.length>=1?i[0].item.depth:"no scene node updates"),Yt.begin("node update/transform");const r=new Set;for(const c of i)r.add(c),Yt.beginSub("node update/transform"),this.updateTransformRecursively(c),Yt.endSub("node update/transform"),c.item.trim.enabled&&c.hasChildren()&&ay(r,c),T5(r,c);Yt.end("node update/transform"),i=[...r].sort(Id);for(let c=i.length-1;c>=0;c--){let l=i[c];r.add(l);let h=l,d=l.parent;for(;d&&d!==s;)d.item.isBooleanGroup()&&(r.add(d),d.item.update(Z.GEOMETRY)),d.item.isMaskGroup()&&h===d.getLastChild()&&(r.add(d),d.item.update(Z.GEOMETRY)),d.item.isNormalGroup()&&(r.add(d),d.item.update(Z.GEOMETRY)),h=l,l=d,d=d.parent}i=[...r].sort(Id);for(let c=i.length-1;c>=0;c--){const l=i[c],h=l.item;if(h.updateFlags&Z.STYLE&&(UP(Be,l),FP(Be,l)),h.updateFlags&Z.GEOMETRY){if(h.type==="text"){const d=Be.view.getOrCreateDinoTree(h.id);nt.setNodeLineHeight(d.root_id,h.lineHeight),nt.setNodeLetterSpacing(d.root_id,h.letterSpacing),nt.setNodeFontSize(d.root_id,h.fontSize),nt.setNodeTextContent(d.root_id,h.content),nt.setNodeVerticalAlignment(d.root_id,h.verticalAlignment),nt.setNodeHorizontalAlignment(d.root_id,h.horizontalAlignment),h.base.shape=qe.createFromPathData(Gi([h.transform.size.x,h.transform.size.y])),h.base.setShape(0,gt.BASE,h.base.shape),h.base.vector.clear(),h.base.modVector=null,h.base.shape.version=-1,ag(Be,h)}if(h.base.shape&&(h.base.shape.version=-1,h.trim.enabled&&!l.item.isContainerNormalGroup())){const p=h.base.getFinalShape(0,gt.SELF_TRIM).trimmed(h.trim.begin,h.trim.end,h.trim.offset,h.trim.mode);h.base.setShape(0,gt.SELF_TRIM,p),p.version=-1}}if(h.updateFlags&Z.NODE_SETTING){const d=Be.view.getOrCreateDinoTree(h.id);nt.setNodeBlend(d.root_id,BP(h.blendMode)),nt.setNodeVisible(d.root_id,h.visible),nt.setNodeOpacity(d.root_id,h.opacity)}h.version=Be.currentVersion(),l.version=h.version}Yt.begin("node update/geometry modifier"),Yt.begin("boolean"),Yt.begin("trim");const o=[];for(let c=i.length-1;c>=0;c--){const l=i[c];iy(l,o)}i=i.concat(o.filter(c=>{for(let l=0;l<i.length;l++)if(c===i[l])return!1;return!0}).sort(Id)),Yt.end("node update/geometry modifier"),Yt.end("boolean"),Yt.end("trim"),Yt.begin("node update/stroke"),Yt.begin("node update/element hit test");for(let c=i.length-1;c>=0;c--){const l=i[c],h=l.item;if(h.isNormalGroup()){let A=null;for(let m=0;m<l.children.length;m++){const O=l.children[m];if(!O.item.visible||!O.item.base.shape||O.item.base.shape.isEmpty())continue;const S=O.item.transform.local.xform_rect(O.boundsLocal);A?A.merge_with(S):A=S.clone()}A?(h.base.shape=qe.createFromPathData(Gi([A.width,A.height])),h.base.shape=h.base.shape.transform(new Ce().translate(A.x,A.y))):h.base.shape=qe.create(),h.base.setShape(0,gt.BASE,h.base.shape),h.base.vector.clear(),h.base.modVector=null,h.base.shape.version=-1}if(h.isMaskGroup()&&l.hasChildren()){const A=l.getLastChild(),m=A.item;if(m.fillLayers.length){let O=m.base.getFinalShape();if(h.type==="text"){const S=nt.getPathCmd(T.path_id),y=nt.getPathVtx(T.path_id);O=qe.createFromPathData(new Bs(y,S))}O&&(h.base.shape=O.clone().transform(m.transform.local))}else if(m.strokes.length){h.base.shape=new qe;for(let O=0;O<m.strokes.length;O++){const S=m.strokes[O].shape.clone().transform(m.transform.local);h.base.shape=h.base.shape.union(S)}}else if(m.isContainerNormalGroup()){const O=A.item.transform.local.xform_rect(A.boundsLocal);O&&(h.base.shape=qe.createFromPathData(Gi([O.width,O.height])),h.base.shape=h.base.shape.transform(new Ce().translate(O.x,O.y)))}h.base.shape||(h.base.shape=new qe),h.base.setShape(0,gt.BASE,h.base.shape),h.base.shape.version=-1}const d=((a=h.base.shape)==null?void 0:a.version)<0;if(d){h.base.shape.version=Be.currentVersion(),h.changed=!0,h.isEmpty=!1,(h.isBooleanGroup()||h.isMaskGroup())&&(h.base.vector.rect=null);const A=h.base.shape.toPathData();h.base.vector.path=A}const p=h.base.getFinalShape(),E=(p==null?void 0:p.version)<0,g=h.base.getFinalVector();if(d||E){p.version=Be.currentVersion(),h.changed=!0;const A=p.toPathData();g.path=A}(!h.base.shape||h.base.shape.isEmpty())&&(h.isEmpty=!0);const T=Be.view.getOrCreateDinoTree(h.id);{if(d){const A=h.base.shape.toPathData();T.base_path_id===0&&(T.base_path_id=nt.makePath(A)),nt.setPath(T.base_path_id,A)}if((d||E||h.updateFlags&Z.STYLE)&&ly(h),!h.clipping&&T.children.compose[0]!==null&&(nt.destroyNodeCompose(T.children.id,0),T.children.compose[0]=null,nt.reorderNode(T.children.id,2)),h.clipping&&T.children.compose[0]===null){T.children.compose[0]=new Ui,T.children.compose[0].id=nt.makeNode(nt.GROUP),T.children.compose[0].children[0]=new Ui,T.children.compose[0].children[0].id=nt.makeNode(nt.PATH),nt.addNodeChild(T.children.compose[0].id,T.children.compose[0].children[0].id);const A=nt.makeColor(0,0,0,1);nt.setNodeFillPaint(T.children.compose[0].children[0].id,nt.COLOR,A),T.children.compose[0].children[0].path_id=T.path_id,nt.setNodePath(T.children.compose[0].children[0].id,T.path_id);const{scale:m,skew:O,rotation:S,translation:y}=h.transform.world.decompose();nt.setNodeTransform(T.children.compose[0].id,y.x,y.y,S,m.x,m.y,O.x,O.y);const v=1;T.children.compose[0].comp_id=nt.makeCompose(v,T.children.compose[0].id),nt.setNodeCompose(T.children.id,0,T.children.compose[0].comp_id),nt.reorderNode(T.children.id,1)}T.children.compose[0]!==null&&(d||E)&&(nt.setPath(T.children.compose[0].children[0].path_id,g.path),nt.markNodeChanged(T.children.compose[0].children[0].id))}if(h.updateFlags&Z.GEOMETRY){Yt.beginSub("node update/stroke"),cy(h),h.meshChanged=!0,Yt.endSub("node update/stroke");const A=bI(T.path_id),m=new ye(A.x,A.y,A.w,A.h);g.bounds.copy(m);for(let O=0;O<T.strokes.children.length;O++){const S=T.strokes.children[O],y=GI(S.path_id,S.stroke_data_id);m.merge_with(new ye(y.x,y.y,y.w,y.h))}l.boundsVisualLocal.copy(m),h.bbox.copy(l.boundsVisualLocal)}l.calcBounds(!!(h.updateFlags&Z.TRANSFORM)),h.updateFlags=0}Yt.end("node update/stroke"),Yt.end("node update/element hit test"),this.root.calcSubtreeBounds(),i.length>0&&(Be._dirty=!0)}_updateBaseValues(n,s,i,r){const o=i.baseTransform,a=s.baseTransform;if(o.world.basis_determinant()===0)return;const c=o.worldInv.clone();c.append(a.world);const l=a.getPivotOffset(),{rotation:h,scale:d,skew:p,position:E}=o1(c,l);E.add(l),n.setBaseProps(u5,[E5(E),d5(d),f5(p),p5(h)],r)}_updateComputedValues(n,s,i){const r=i.transform,o=s.transform;if(r.world.basis_determinant()===0)return;const a=r.worldInv.clone();a.append(o.world);const c=o.getPivotOffset(),{rotation:l,scale:h,skew:d,position:p}=o1(a,c),E=p.clone().add(c);n.sets({scale:h,skew:d,rotation:s.autoOrient?l-s.orientRotation:l,translateX:E.x,translateY:E.y},hv)}}const ug=e=>{for(let n=0,s=e.children,i=s.length;n<i;n++)ug(s[n]);ry(e)},iy=(e,n)=>{const s=e.item;if(s.isBooleanGroup())Yt.beginSub("boolean"),_5(e),Yt.endSub("boolean"),n.push(e);else if(s.isContainerNormalGroup()){const i=[];for(let r=0,o=e.children,a=o.length;r<a;r++)iy(o[r],i);if(i.reverse(),s.trim.version<0){if(s.trim.enabled){switch(Yt.beginSub("trim"),e.item.trim.mode){case $i.INDIVIDUALLY:{const r=qe.trimMultiple(e.item.trim.begin,e.item.trim.end,e.item.trim.offset,i.map(o=>o.item.base.getFinalShape(e.item.depth-o.item.depth+1,gt.PARENT_TRIM)));for(let o=0;o<i.length;o++){s.base.mods.length=2-e.item.depth+i[o].item.depth;const a=r[o].clone();a.version=-1,i[o].item.base.setShape(e.item.depth-i[o].item.depth,gt.PARENT_TRIM,a),i[o].item.update(Z.GEOMETRY)}break}case $i.SIMULTANEOUSLY:for(let r=0,o=i.length;r<o;r++){const a=i[r],c=a.item.base.getFinalShape(e.item.depth-a.item.depth+1,gt.PARENT_TRIM).trimmed(e.item.trim.begin,e.item.trim.end,e.item.trim.offset,e.item.trim.mode);a.item.base.setShape(e.item.depth-a.item.depth,gt.PARENT_TRIM,c),a.item.update(Z.GEOMETRY)}break}Yt.endSub("trim")}else{for(let r=0,o=i.length;r<o;r++){const a=i[r];a.item.base.deleteShape(gt.PARENT_TRIM,s.depth-a.item.depth),a.item.update(Z.GEOMETRY),a.item.base.shape.version=-1}s.base.deleteShape(gt.SELF_TRIM),s.base.mods.length=2,s.update(Z.GEOMETRY),s.base.shape&&(s.base.shape.version=-1)}n.push(e),s.trim.version=Be.currentVersion()}for(let r=0,o=i.length;r<o;r++)n.push(i[r])}else if(!s.isMaskGroup()){if(s.trim.version<0){if(s.trim.enabled){const i=s.base.getFinalShape(0,gt.SELF_TRIM).trimmed(s.trim.begin,s.trim.end,s.trim.offset,s.trim.mode);i.version=-1,s.base.setShape(0,gt.SELF_TRIM,i)}else s.base.deleteShape(gt.SELF_TRIM),s.base.mods.length=2;s.trim.version=Be.currentVersion(),s.update(Z.GEOMETRY)}n.push(e)}},ry=e=>{ZG(e.id),Be.destroyRenderItem(e.id),lg.nodeMap.delete(e.id),xP(e.id),Be.view.destroyDinoNode(e)},u5=["translate","scale","skew","rotation"],dg={scaleX:0,scaleY:0},fg={skewX:0,skewY:0},oy={rotation:0},pg={translateX:0,translateY:0};function d5(e){return dg.scaleX=e.x,dg.scaleY=e.y,dg}function f5(e){return fg.skewX=e.x,fg.skewY=e.y,fg}function p5(e){return oy.rotation=e,oy}function E5(e){return pg.translateX=e.x,pg.translateY=e.y,pg}const Id=(e,n)=>e.item.depth-n.item.depth,g5=e=>!!e;function Eg(e,n){if(!e.item.visible)return;const s=e.item;if(s.isContainerNormalGroup()||s.isMaskGroup()){const i=e.children;for(let r=0,o=i.length;r<o;r++)Eg(i[r],n)}else{let i=null;if(!s.fillLayers.length&&s.strokeLayers.length)cy(s),i=s.strokes[0].shape;else if(e.item.type==="text"){const o=Be.view.getOrCreateDinoTree(e.id),a=nt.getPathCmd(o.path_id),c=nt.getPathVtx(o.path_id);i=qe.createFromPathData(new Bs(c,a))}else i=s.base.getFinalShape();const r=i.clone().transform(s.transform.world);n.push(r)}}function _5(e){const n=e.children,s=[];for(let o=0;o<n.length;o++)Eg(n[o],s);e.geometryVersion=Be.currentVersion();const i=e.item;let r=null;for(let o=0;o<s.length;o++)r=r?r[GO[i.booleanType]](s[o]):s[o];if((!r||s.length===0||r.isEmpty())&&(r=qe.create()),r.transform(i.transform.world.clone().affine_inverse()),i.base.shape=r,i.base.shape.version=-1,i.base.setShape(0,gt.BASE,r.clone()),e.item.cornerRadius>0){const o=nE(r.toPathData(),e.item.cornerRadius);i.base.setShape(0,gt.CORNER,qe.createFromPathData(o))}if(i.base.vector.clear(),i.base.modVector=null,i.trim.enabled){const o=i.base.shape.trimmed(i.trim.begin,i.trim.end,i.trim.offset,$i.INDIVIDUALLY);i.base.setShape(0,gt.SELF_TRIM,o),o.version=-1}else i.base.deleteShape(gt.SELF_TRIM);i.update(Z.GEOMETRY)}function ay(e,n){if(!(n.item.isBooleanGroup()||n.item.isMaskGroup()))for(let s=0,i=n.children,r=i.length;s<r;s++){const o=i[s];e.add(o),o.item.update(Z.GEOMETRY),ay(e,o)}}function T5(e,n){if(n.item.isBooleanGroup()||n.item.isMaskGroup()){n.item.update(Z.GEOMETRY);return}let s=n.parent?n.parent.parent:null;for(;s;)s.item.trim.enabled&&(e.add(s),s.item.update(Z.GEOMETRY),n.item.trim.version<0&&(s.item.trim.version=-1)),s=s.parent}function cy(e){for(let n=0;n<e.strokes.length;n++){const s=e.strokes[n];if(!s)break;let i=0;switch(s.style.startCap){case on.NONE:{i=0;break}case on.ROUND:{i=1;break}case on.SQUARE_SOLID:{i=2;break}}let r=0;switch(s.style.join){case bs.MITER:{r=0;break}case bs.BEVEL:{r=1;break}case bs.ROUND:{r=2;break}}{ly(e),e.type==="text"&&ag(Be,e);const o=Be.view.getOrCreateDinoTree(e.id);if(o.strokes.children[n]){o.strokes.children[n].stroke_data_id===0?(o.strokes.children[n].stroke_data_id=nt.makeStroke(s.style.width,i,r,s.style.miterLimit,s.style.dashPattern[0],s.style.dashPattern[1]),nt.setNodeStrokeData(o.strokes.children[n].id,o.strokes.children[n].stroke_data_id)):(nt.destroyStrokePathCache(o.strokes.children[n].id,o.strokes.children[n].stroke_data_id),nt.setStroke(o.strokes.children[n].stroke_data_id,s.style.width,i,r,s.style.miterLimit,s.style.dashPattern[0],s.style.dashPattern[1]),nt.markNodeChanged(o.strokes.children[n].id));const a=nt.getStrokePathCmd(o.path_id,o.strokes.children[n].stroke_data_id),c=nt.getStrokePathVtx(o.path_id,o.strokes.children[n].stroke_data_id);s.shape=qe.createFromPathData(new Bs(c,a))}}}}const Wo=new N(0,0),A5=(e,n)=>{if(Wo.set(0,0),e.isComputedGroup()){const a=Be.dataStore.getElement(e.id).get("referencePoint");Wo.set(a[0],a[1])}const s=e.sizeFlag,i=e.transform.size.x,r=e.transform.size.y;if(s.w==="f0"&&s.h==="f0"||s.w==="t0"&&s.h==="f0"||s.w==="f0"&&s.h==="t0"){const o=i*.5-Wo.x,a=r*.5-Wo.y,c=0,l=0;return new ye(o,a,c,l)}if(s.w==="f0"){const o=i*.5-Wo.x,a=-Wo.y,c=0,l=r;return new ye(o,a,c,l)}if(s.h==="f0"){const o=-Wo.x,a=r*.5-Wo.y,c=i,l=0;return new ye(o,a,c,l)}return n},Sd=(e,n)=>{e.item.depth=n;for(let s=0,i=e.children,r=i.length;s<r;s++)Sd(i[s],n+1)},ly=e=>{const n=Be.view.getOrCreateDinoTree(e.id);if(e.type!=="text"){const s=e.base.getFinalShape().toPathData();n.path_id===0&&(n.path_id=nt.makePath(s)),nt.setPath(n.path_id,s)}for(let s=0;s<n.fills.children.length;s++)n.fills.children[s].path_id===0?(n.fills.children[s].path_id=n.path_id,nt.setNodePath(n.fills.children[s].id,n.path_id)):nt.markNodeChanged(n.fills.children[s].id);for(let s=0;s<n.strokes.children.length;s++)n.strokes.children[s].path_id===0?(n.strokes.children[s].path_id=n.path_id,nt.setNodePath(n.strokes.children[s].id,n.path_id)):nt.markNodeChanged(n.strokes.children[s].id)},ls=tt();class m5{constructor(n){this.vs=n,this.pathCommands=ve}inject(){this.vs.dataStore.injectDrawInfo(this)}getCanvas(){return this.vs.canvas}convertMousePosToWorldPosition(n){return this.vs.viewport.toWorld(n)}toBaseWorldPosition(n,s,i=new N){const r=this.vs.getRenderItem(n);if(!r)throw new Error(`Invalid element ID provided ${n}`);if(this.vs.dataStore.isWorkspace(n))return i.x=s.x,i.y=s.y,i;const o=r.baseTransform.world,a=this._applyMatrix(s,o);return i instanceof N?(i.x=a.x,i.y=a.y):(i[0]=a.x,i[1]=a.y),i}toWorldPosition(n,s,i=new N){const r=this.vs.getRenderItem(n);if(!r)throw new Error(`Invalid element ID provided ${n}`);if(this.vs.dataStore.isWorkspace(n))return i.x=s.x,i.y=s.y,i;const o=r.transform.world,a=this._applyMatrix(s,o);return i instanceof N?(i.x=a.x,i.y=a.y):(i[0]=a.x,i[1]=a.y),i}vertex2World(n,s,i=new N){const r=this.vs.getRenderItem(n);if(!r)throw new Error(`Invalid element ID provided ${n}`);const o=this._getPathTransform(r),a=this._applyMatrix(s,o);return i instanceof N?(i.x=a.x,i.y=a.y):(i[0]=a.x,i[1]=a.y),i}getVerticesBoundWorld(n){const s=new Gn,i=this.vs.getRenderItemOfElement(n),r=this._getPathTransform(i),o=n.get("geometry").get("mesh"),a=new N,c=new N;for(const l of o.getVertices())a.x=l.pos[0],a.y=l.pos[1],r.xform(a,c),s.minMax([c.x,c.y]);return s}world2Vertex(n,s,i=new N){const r=this.vs.getRenderItem(n);if(!r)throw new Error(`Invalid element ID provided ${n}`);const o=this._getPathTransform(r);o.affine_inverse();const a=this._applyMatrix(s,o);return i instanceof N?(i.x=a.x,i.y=a.y):(i[0]=a.x,i[1]=a.y),i}_getPathTransform(n){const{translate:s,rotation:i,scale:r,skew:o,contentAnchor:a}=n.transform;return n.transform.parent.clone().translate_right(s.x,s.y).rotate_right(i).skew_right(wt(o.x),wt(o.y)).scale_right(r.x,r.y).translate_right(-a.x,-a.y)}toObjectPosition(n,s,i=new N,r){const o=this.vs.getRenderItem(n);if(!o)throw new Error(`Invalid element ID provided ${n}`);const a=o.transform.worldInv,c=this._applyMatrix(s,a,void 0,r);return i.x=c.x,i.y=c.y,i}getViewportBounds(n=new Gn){return n.copy(this.vs.viewport.rectW),n}getSelectionBoundsWorld(n=new Gn,s=!1){if(!s)return n.copy(this.vs.selection.bounds);const i=new ye;for(const{node:r}of this.vs.selection.iter())r.item.visible&&(i.is_zero()?i.copy(r.boundsWorldAABB):i.merge_with(r.boundsWorldAABB));return n.copy(i)}getBooleanlocalBounds(n,s,i){const r=new Gn,o=[];for(let l=0;l<i.length;l++){const h=this.vs.indexer.getNode(i[l].get("id"));Eg(h,o)}let a=null;for(let l=0;l<o.length;l++)a=a?a[GO[n]](o[l]):o[l];if(!a||a.isEmpty()){const h=this.getSelectionBoundsWorld(r).topLeft,d=new Bs;d.commands=[1],d.vertices=[h.x,h.y],a=qe.createFromPathData(d)}const c=a.getBounds();return r.copy(c)}getElementBounds(n,s=new Gn,i=!1){const r=this.vs.indexer.getNode(n.get("id"));let o=r.item.base.getFinalShape();o=o.clone().transform(r.item.transform.local);const a=o.getBounds().clone();if(i)for(let c=0;c<r.item.strokeLayers.length;c++){const l=r.item.strokes[c].style,h=r.item.base.getFinalShape();let d=M2(h,l);d=d.clone().transform(r.item.transform.local),a.merge_with(d.getBounds())}return s.copy(a)}getGradientHandlesPosition(n,s,i,r){const o=new Ce;return o.set(...r).affine_inverse().scale(n,s),{center:o.xform(i?BI:VI),bottom:o.xform(HI),left:o.xform(WI)}}centerSelection(){ey()}_applyMatrix(n,s,i=new N,r=void 0){return n instanceof N?i.set(n.x,n.y):i.set(n[0],n[1]),r&&i.add(r),s.xform(i,i),i}getMeshOutlinesForExport(n,s){const i=new Set;tT(n,i);const r=new Bs,o=(a,c)=>{const l=a.cellTable.get(c).pos;return[l[0]-s[0],l[1]-s[1]]};for(const a of i)eT(n,a,r,o,!0);return r}getFixedPositionByChanges(n,s,i){const r=this.vs.getRenderItem(n);if(!r)return null;const o=r.transform;if(s.contentAnchorX===void 0&&s.contentAnchorY===void 0&&s.width===void 0&&s.height===void 0)return null;let a,c,l;const h=o.contentAnchor;if(i===void 0){a=o.local.get_origin();const b=o.referencePoint;c=b.x,l=b.y}else{c=i.x,l=i.y;const{translate:b,rotation:X,scale:K,skew:V}=o,J=new Ce;J.translate_right(b.x,b.y).rotate_right(X).skew_right(wt(V.x),wt(V.y)).scale_right(K.x,K.y).translate_right(-h.x,-h.y).translate_right(-c,-l),a=J.get_origin()}let d=h.x,p=h.y;const E=o.size.x,g=o.size.y,T=o.translate.x,A=o.translate.y;s.contentAnchorX!==void 0&&(d=s.contentAnchorX),s.contentAnchorY!==void 0&&(p=s.contentAnchorY);let m=0,O=0;if(s.width!==void 0){const b=s.width!==0&&s.width<To,X=E!==0&&E<To;b&&!X?m=-s.width*.5:X&&!b&&(m=E*.5)}if(s.height!==void 0){const b=s.height!==0&&s.height<To,X=g!==0&&g<To;b&&!X?O=-s.height*.5:X&&!b&&(O=g*.5)}s.referencePointX!==void 0&&(c=s.referencePointX),s.referencePointY!==void 0&&(l=s.referencePointY);const S=new N(d+c,p+l),y=new N(T,A),v=o.skew,R=o.scale,M=o.rotation,P=new Ce().translate_right(y.x,y.y).rotate_right(M).skew_right(wt(v.x),wt(v.y)).scale_right(R.x,R.y).translate_right(-S.x,-S.y).get_origin(),k=m+y.x+(a.x-P.x),Q=O+y.y+(a.y-P.y);return new N(k,Q)}getChildrenPropertiesAfterResize(n,s,i,r,o){const a=new Map;if(!this.vs.getRenderItem(n.get("id")))return a;let l=s,h=i;s===0&&(l=Es),i===0&&(h=Es);const d=new N(r/l,o/h);for(const p of n.children){const E=p.get("id"),g=this.vs.getRenderItem(E),T=g.transform;if(!g)continue;const A=new Ce().scale_right(d.x,d.y).rotate_right(T.rotation).skew_right(T.skew.x,T.skew.y),{rotation:m,scale:O,skew:S}=A.decompose(),y=new N().copy(T.size).multiply(O),v=new N().copy(T.translate).multiply(d),R=new N().copy(T.contentAnchor).multiply(O),M=p.get("referencePoint"),L=new N(M[0],M[1]).multiply(O);if(p.isText){const k=this.vs.indexer.getNode(E);k.item.resizingMode===eo[kt.AUTO_WIDTH]?(Math.abs(y.x-T.size.x)>.01&&p.set("resizingMode",kt.AUTO_HEIGHT),Math.abs(y.y-T.size.y)>.01&&p.set("resizingMode",kt.FIXED)):k.item.resizingMode===eo[kt.AUTO_HEIGHT]&&Math.abs(y.y-T.size.y)>.01&&p.set("resizingMode",kt.FIXED)}const P={skew:new N(S.x,S.y),rotation:m};T.scale.x!==0&&(P.width=y.x,P.translateX=v.x,P.contentAnchorX=R.x,P.referencePointX=L.x),T.scale.y!==0&&(P.height=y.y,P.translateY=v.y,P.contentAnchorY=R.y,P.referencePointY=L.y),a.set(E,P)}return a}updateNodes(){const n=[...this.vs.updateList.values()];this.vs.indexer.updateNodes(n),this.vs.updateList.clear()}isNodePresent(n){return!!this.vs.indexer.getNode(n)}getLatestLocalBounds(n){return this.vs.indexer.getNode(n).boundsLocal}updateMotionPathPointShape(n,s){Hb(n,s)}updateMotionPointCurveControl(n,s){const i=s==="in"?"out":"in",r=new N().fromArray(n[i]),o=new N(-n[s][0],-n[s][1]);switch(n.mirror){case pe.ANGLE:{const a=r.length();o.normalize().scale(a),n[i]=[o.x,o.y];break}case pe.ANGLE_AND_LENGTH:{n[i]=[o.x,o.y];break}case pe.NONE:case pe.INDEPENDENT:break}}subdivideMotionPath(n,s){const i=new ae().initWithPointsAndHandlesN(...n),o=i.getLength()*s;return ae.subdivide(i.getValues(),i.getTimeAt(o))}getTextPathDataWithPathID(n){const i=this.vs.view.getOrCreateDinoTree(n).path_id,r=ls.getPathCmd(i),o=ls.getPathVtx(i);return new Bs(o,r)}getTextPathWithStyle(n,s,i,r){const o=this.vs.indexer.nodeMap.get(n).item,a=this.vs.view.getOrCreateDinoTree(n),c=a.text_node_id,l=a.text_doc_id,h={font_family:o.fontFamily,font_style:o.fontStyle,font_weight:o.fontWeight,font_size:s||o.fontSize,letter_spacing:r??o.letterSpacing,line_spacing:i??o.lineHeight,paragraph_spacing:o.paragraphSpacing||0,text_horizontal_alignment:o.horizontalAlignment,text_vertical_alignment:o.verticalAlignment},{commands:d,vertices:p}=tt().getTextPathWithStyle(c,l,h);return new Bs(p,d)}handleTextPaintsLayer(n,s){const i=this.vs.view.getOrCreateDinoTree(n.id);ls.setPath(i.path_id,s),n.setGeometry(s);for(let r=0;r<i.fills.children.length;r++){const o=i.fills.children[r];ls.destroyNode(o.id),o.id=ls.makeNode(ls.PATH),ls.setNodePath(o.id,i.path_id),n.item.visualServer.view.setParent(o.id,n.item.id),ls.addNodeChild(i.fills.id,o.id),ls.setNodeFillPaint(o.id,o.fill_tag,o.fill_id),ls.markNodeChanged(o.id)}for(let r=0;r<i.strokes.children.length;r++){const o=i.strokes.children[r];ls.destroyNode(o.id),o.id=ls.makeNode(ls.PATH),ls.setNodePath(o.id,i.path_id),n.item.visualServer.view.setParent(o.id,n.item.id),ls.addNodeChild(i.strokes.id,o.id),ls.setNodeStrokeData(o.id,o.stroke_data_id),ls.setNodeStrokePaint(o.id,o.stroke_tag,o.stroke_id),ls.markNodeChanged(o.id)}}getTextPathOffset(n){return qe.createFromPathData(n).getBounds()}translatePathData(n,s,i){const r=new Ce().translate(s,i);return n.applyXorm(r)}setTextEditingMode(n,s=null){const i=this.vs.view.getOrCreateDinoTree(n);if(s){const r=this.vs.dataStore.getElement(n).get("content"),{start:o,end:a,cursor:c}=s,{start_block:l,start_char:h,end_block:d,end_char:p,cursor_index:E,active_block_index:g}=cg(r,o,a,c);tt().enterTextEditingMode(i.text_node_id,l,h,d,p,E,g)}else tt().enterTextEditingMode(i.text_node_id,-1,0,0,0,0,0);document.getElementById("input").focus()}changeTextEditingNode(n,s){const i=this.vs.view.getOrCreateDinoTree(n);tt().changeTextEditingNode(i.text_node_id,s)}exitTextEditingMode(){tt().exitTextEditingMode(),document.getElementById("input").blur(),setTimeout(()=>{document.activeElement.id==="input"&&document.getElementById("input").blur()},100)}setForceDefaultCursor(n){tt().setForceDefaultCursor(n)}getUpdatedTextPathBBox(n){const s=this.vs.view.getOrCreateDinoTree(n),i=this.vs.indexer.getNode(n);return ag(this.vs,i.item),tt().getTextPathBBox(s.text_doc_id)}updateTextProperties(n,s){const i=n.get("id");if(n.get("resizingMode")===kt.FIXED||!this.vs.indexer.hasNode(i))return;if(this.vs.view.getOrCreateDinoTree(i).text_doc_id){const a=this.getUpdatedTextPathBBox(i);ny(this.vs,n,a.w,a.h,s),this.vs.indexer.getNode(i).item.update(Z.TRANSFORM),this.updateNodes()}else console.warn("No text document ID found for element:",i)}updateTextNonInterpolatableProps(n,s,i){var r;if(s.has("content")||s.has("horizontalAlignment")||s.has("verticalAlignment"))this.updateTextProperties(n,i);else if(s.has("resizingMode")){const o=s.get("resizingMode").value,a=s.get("resizingMode").original,c=(r=this.vs.dataStore.selection)==null?void 0:r.selectedActionId;switch(o){case kt.AUTO_WIDTH:this.updateTextProperties(n,i),this.vs.dataStore.interaction.deleteElementPropertyTrack(c,n.get("id"),"dimensions",!0);break;case kt.AUTO_HEIGHT:a===kt.FIXED&&(this.vs.dataStore.interaction.deleteElementPropertyTrack(c,n.get("id"),"dimensions",!0),this.updateTextProperties(n,i));break}}else(s.has("width")||s.has("height")||s.has("size"))&&this.updateTextProperties(n,i)}getAutoHeightValue(){const n=this.vs.dataStore.selection.get("elements")[0].get("id"),s=this.vs.view.getOrCreateDinoTree(n);return Math.round(100*tt().getTextAutoLineHeightValue(s.text_node_id))}updateTextRange(n,s,i){const r=this.vs.dataStore.selection.get("elements")[0].get("id"),o=this.vs.view.getOrCreateDinoTree(r),a=this.vs.dataStore.getElement(r).get("content"),{start_block:c,start_char:l,end_block:h,end_char:d,cursor_index:p,active_block_index:E}=cg(a,n,s,i);tt().setTextSelection(o.text_doc_id,c,l,h,d,p,E)}}let yd=null;const gg=tt(),O5=()=>({id:null,img:null,node_ids:new Set,texture_id:null,_dirty:!1,dino_image_id:0,pixels:[]});class I5{constructor(){this.id=`@res[${S5++}]`,this.colorStops=[]}setColorStops(n){this.colorStops.length=0;const s=[];for(const{position:i,color:r}of n){const o=[r[0],r[1],r[2],r[3]];s.push({pos:i,color:o})}this.colorStops=s.sort((i,r)=>i.pos-r.pos)}}let S5=1;class y5{static instance(){return hy}constructor(n){yd||(yd=n),this.images=new Map,this.gradients=Object.create(null),hy=this}createImageResource(n){const s=O5();return s.id=n,this.images.set(n,s),s}getImageResource(n){return this.images.get(n)}destroyImageResource(n){this.images.get(n)&&this.images.set(n,null)}loadImage(n,s){const i=this.images.get(n),r=new Image;r.onload=()=>{i.img=r,i._dirty=!0;const o=document.createElement("canvas"),a=o.getContext("2d");o.width=r.width,o.height=r.height,a.drawImage(r,0,0),i.pixels=a.getImageData(0,0,r.width,r.height).data},r.onerror=()=>{},r.crossOrigin="anonymous",r.src=s}updateImageResource(n){const s=this.images.get(n);if(s._dirty){s._dirty=!1,gg.setImageWithPixels(s.dino_image_id,s.pixels,s.img.width,s.img.height);for(const i of s.node_ids){yd.indexer.getNode(i).item.styleUpdated();const o=yd.view.getOrCreateDinoTree(i);gg.markNodeChanged(o.fills.id),gg.markNodeChanged(o.strokes.id)}}}createGradientResource(n){const s=new I5(this.gfx);return n&&(s.id=n),this.gradients[s.id]=s,s}destroyGradientResource(n){if(!this.gradients[n]){delete this.gradients[n];return}delete this.gradients[n]}getGradientResource(n){return this.gradients[n]}update(){for(const[n]of this.images)this.updateImageResource(n)}clear(){for(const n in this.images)this.destroyImageResource(n);this.images=new Map;for(const n in this.gradients)this.destroyGradientResource(n);return this.gradients=Object.create(null),!0}}let hy=null;const Uc={};class C5{constructor(n){this.vs=n,this._selected=new Set,this.bounds=new ye,this._dirtyBounds=!0}get anySelected(){return this._selected.size>0}get size(){return this._selected.size}get containsMultiple(){return this._selected.size>1}get single(){if(this._selected.size===1){const n=this._selected.values().next().value;return this._assignToTmp(n),Uc}return null}get first(){if(this._selected.size>0){const n=this._selected.values().next().value;return this._assignToTmp(n),Uc}return null}all(n){for(const s of this.iter())if(!n(s))return!1;return!0}*iter(){for(const n of this._selected)this._assignToTmp(n),yield Uc}markDirty(n){this._selected.has(n)&&(this._dirtyBounds=!0)}updateBounds(){this._dirtyBounds&&(this._dirtyBounds=!1,this.bounds.setFrom(this.vs._getWorldBoundsOf(this._selected)))}_assignToTmp(n){Uc.id=n,Uc.element=this.vs.dataStore.getById(n),Uc.node=this.vs.indexer.getNode(n)}watchDSSelection(){this.vs.dataStore.selection.on(me.SELECT,()=>{this._selected.clear();for(const n of this.vs.dataStore.selection.get("elements"))this._selected.add(n.get("id"));this._dirtyBounds=!0})}reset(){return this._selected=new Set,this.bounds.set(0,0,0,0),this._dirtyBounds=!0,!0}}let uy=null;class _g{static instance(){return uy}constructor(n,s){this.canvas=n,this.dataStore=s,this.viewport=new l3(n),this.selection=new C5(this),this.snapping=new Pc(this),this.snappingPath=new TG(this),this.drawInfo=new m5(this),this.drawInfo.inject(),this.storage=new y5(this),this.overlay=new nP(this,this.viewport),this.indexer=new h5(this),this.root=null,this.updateList=new Set,this.nodeFlagsList=new Map,this._updateLevel=ds.NONE,this.itemMap=Object.create(null),this.view=null,uy=this,this.viewModeChangeHandler=this.handleViewModeChange.bind(this),this.dataStore.on("viewMode",this.viewModeChangeHandler)}clear(){this.indexer.clear(),this.overlay.clearPanes(),this.storage.clear(),this.selection.reset(),this.viewport.reset();for(const n in this.itemMap)this.itemMap[n].clear();return this.itemMap=Object.create(null),this.updateList=new Set,this.nodeFlagsList=new Map,this.root=null,this.view.cleanup(),this.viewModeChangeHandler&&(this.dataStore.off("viewMode",this.viewModeChangeHandler),this.viewModeChangeHandler=null),!0}handleViewModeChange(n){var s;switch(this.view.cleanup(),n){case Bh.TABLE:{const i=this.dataStore.selection.get("elements"),r=this.dataStore.workspace.watched,o=((s=i==null?void 0:i[0])==null?void 0:s.get("id"))||r.get("id"),a=this.dataStore.getById(o);this.view=new cE(this),this.setRoot(a.get("id")),this.view.setup(this.dataStore,o);break}case Bh.SINGLE:default:{const i=this.dataStore.workspace.watched;this.view=new fS(this),this.setRoot(i.get("id")),this.view.setup(this.dataStore,i.get("id"));break}}}updateUpdateLevel(n){n>this._updateLevel&&(this._updateLevel=n)}currentVersion(){}setRoot(n){const s=this.indexer.getNode(n);if(!s){console.error("Cannot set root to null!");return}this.root=s.item,this.indexer.root=s,WG(s)}makeRenderItem(n){const s=new zp(n);return s.visualServer=this,this.itemMap[n]=s,s}destroyRenderItem(n){const s=this.itemMap[n];s&&(s.clear(),s.freed=!0,delete this.itemMap[n])}getRenderItem(n){return this.itemMap[n]||null}getRenderItemOfElement(n){return n?this.getRenderItem(n.get("id")):null}updateTransformRecursively(n){const s=this.indexer.getNode(n);return s?(this.indexer.updateTransformRecursively(s),this.selection.updateBounds(),!0):!1}*_getWorldBoundsOf(n){for(const s of n)yield this.indexer.getNode(s).boundsWorldAABB_zero}updateNodes(){const n=[...this.updateList.values()];this.indexer.updateNodes(n),this.updateList.clear();for(const s of this.nodeFlagsList)if(this.indexer.nodeMap.has(s[0])){const i=this.indexer.nodeMap.get(s[0]).item;i.updateFlags|=s[1],this.updateList.add(i)}this.nodeFlagsList.clear(),this.storage.update()}}let dy=0,Tg=!1,kn=null,Ag=null;const Cd=tt();let Je=null;function N5(){Ai.pause()}async function mg(){Ai.updateRootDirty(!0),Ai.resume(),Tg=!0,window.dispatchEvent(new Event("resize")),Cd.resumeApp()}const eo=Object.freeze({[kt.AUTO_WIDTH]:"auto_width",[kt.AUTO_HEIGHT]:"auto_height",[kt.FIXED]:"fixed"});Object.freeze({auto_width:kt.AUTO_WIDTH,auto_height:kt.AUTO_HEIGHT,fixed:kt.FIXED}),window.__ph__={onReady:()=>{Cd.initialized=!0,Je=new _g(Ag,kn),Cd.setBackgroundColor(12/255,12/255,12/255,1),jb(Je),H.watch(Ag),Y3(Je),v5(),Je.indexer.connectDataStore(kn),Je.selection.watchDSSelection(),kn.isLoaded?mg():kn.once(me.LOAD,mg)},onFrameBegin:()=>{Ag.style.cursor="inherit",x5(),dy++},onUpdateSceneTree:()=>{if(Ai.paused)return null;const e=R5();switch(Yt.begin("node update"),Je.updateNodes(),Je._updateLevel){case ds.UPDATE_NEED_BBOX_RECALC:Je.view.update();break;case ds.UPDATE_ALL_NEED_BBOX_RECALC:Je.view.updateAll(!0);break;case ds.UPDATE_ALL:Je.view.updateAll(!1);break;case ds.UPDATE:case ds.NONE:break}Je._updateLevel=ds.NONE,Yt.end("node update"),Yt.begin("hit test"),QG(),Yt.end("hit test"),Je.view.layout(),Yt.begin("misc update"),Je.selection.updateBounds(),e&&e()},onNodeUpdate:(e,n)=>{if(Je.view.hasParent(e)){const s=Je.view.getParent(e);Je.indexer.getNode(s).item.update(n),Je.nodeFlagsList.set(s,n)}else console.log(`cannot get phase node by dino rid ${e}`)},onTextUpdate:(e,n,s,i,r,o)=>{if(!Je.selection.single){console.log("no selection during text update");return}let c="";if(n!==0){const l=new Uint8Array(Qp().HEAPU8.buffer,e,n);c=new TextDecoder("utf-8").decode(l)}c==="\0"&&(c=""),kn.selection.updateTextRange(i,r,o,{commit:!1}),kn.editor.setProps({content:c},{commit:!1}),s||kn.debounceCommitUndo()},onExitTextEditingMode:()=>{},onCopyText:(e,n)=>{let s="";if(n!==0){const i=new Uint8Array(Qp().HEAPU8.buffer,e,n);s=new TextDecoder("utf-8").decode(i)}kn.clipboard.copy(K2.TEXT,{text:s})},onPasteText:()=>{kn.clipboard.paste()},onUndoComb:()=>{kn.eam.undo()},onRedoComb:()=>{kn.eam.redo()},onSelectionUpdate:(e,n,s,i,r,o,a)=>{const c=Je.view.getParent(e),h=Je.indexer.getNode(c).item.content,{start:d,end:p,cursor_idx:E}=w5(h,n,s,i,r,o,a);kn.selection.updateTextRange(d,p,E,{commit:!1}),kn.debounceCommitUndo()},onUpdatePageOffset:e=>{const n=Je.view.getParent(e),s=Je.indexer.getNode(n).boundsWorldAABB,i=Je.viewport.toScreenRect(s);tt().updatePageOffset(i.x,i.y)},onUpdateElementSize:(e,n,s)=>{const i=Je.view.getParent(e),r=Je.dataStore.getById(i);ny(Je,r,n,s,{flags:er.FROM_TEXT_EDIT,commit:!1})},onGetTextPathId:e=>{const n=Je.view.getParent(e);return Je.view.getOrCreateDinoTree(n).path_id},onESC:()=>{kn.eam.escape()},onTab:()=>{kn.eam.editSiblingTextElement(ut.UP)},onShiftTab:()=>{kn.eam.editSiblingTextElement(ut.DOWN)},onGetTotalCount:e=>{const n=Je.view.getParent(e);return Je.indexer.getNode(n).item.content.length},onIsPointInTextElement:(e,n,s)=>{const i=Je.view.getParent(e);if(!i)return!1;const r=Je.indexer.getNode(i),o=r.boundsWorldAABB,a=r.item.transform.world.xform(new N(n,s));return o.contains(a.x,a.y)},onPrepareCamera:()=>{if(!Ai.paused&&Tg){Je.viewport.resize();const{x:e,y:n,scale:s}=Je.viewport;return Cd.setCamera(-e,-n,s),J3(),Je.storage.update(),Yt.end("misc update"),!0}else return Yt.end("misc update"),!1},onOverlay:()=>{if(Ai.paused||!Tg)return null;if(Je.dataStore.isEditingMode&&!Je.dataStore.isTableView){const s=Je.indexer.getActiveScreenNode();VG(s),zG(),KG()}const e=Je.dataStore.get("state");(e===Qs.EDITING||e===Qs.VIEWING||e===Qs.INSPECTING||e===Qs.VERSIONING)&&oU()},onFrameEnd:()=>{},onCapture:(e,n)=>{b3(e,n)},onFontRequest:(e,n,s,i)=>{const r=new Uint8Array(Qp().HEAPU8.buffer,e,n),o=new TextDecoder("utf-8").decode(r),c={0:"Regular",1:"Italic",2:"Oblique"}[s]||"Regular";let l=Je.dataStore.fontManager.getFontUrl(o,c,i);l||(console.warn(`cannot found the URL for ${o}-${s}-${i}`),l=Je.dataStore.fontManager.getFontUrl(o,"Regular",400)),tt().fetchFont(o,l,c,i)},onZoom:e=>{kn.eam.changeZoom(e)},onZoomToFit:()=>{kn.eam.zoomFitContent()},onZoomToSelection:()=>{kn.eam.zoomFitSelection()},onZoomOut:()=>{kn.eam.zoomOut()},onZoomIn:()=>{kn.eam.zoomIn()}};function x5(){if(dy===10){const e=document.createElement("div");e.setAttribute("data-test-id","rendererReady"),document.getElementById("modal").appendChild(e)}}function v5(){const{dataStore:e,viewport:n}=Je;e.on(me.LOAD_START,N5),e.on(me.LOAD,mg),e.eam.on(Y.SWITCH_DOCUMENT_MODE,()=>{Je.view.reload(),e.isPrototypeMode&&Ai.updateRootDirty(!0)}),e.workspace.on(me.WORKSPACE_CHANGE_WATCH,()=>{Ai.updateRootDirty(!0)}),e.workspace.on("scale",s=>{n.setZoom(s)}),n.on("update",()=>{e.workspace.sets({scale:n.scale,panX:n.x,panY:n.y})})}function R5(){if(!Ai.dirty.root||!Je.dataStore.isLoaded)return;switch(Ai.updateRootDirty(!1),Ai.updateResizeDirty(!0),Je.dataStore.get("state")){case Qs.EDITING:case Qs.VIEWING:case Qs.VERSIONING:return Je.viewport.resize(),()=>Th(Vo.ALL);case Qs.PROTOTYPING:{Je.viewport.resize();return}}}function w5(e,n,s,i,r,o,a){let c=0,l=0,h=null,d=null,p=null;for(let E=0;E<=e.length&&(p===null&&l===a&&(p=c+o),l===n&&h===null&&(h=c+s),l===i&&d===null&&(d=c+r),E<e.length&&e[E]===`
`&&l++,c++,!(h!==null&&d!==null));E++);return h===null||d===null?(console.warn("Start or end index not found in the content."),null):{start:h,end:d,cursor_idx:p}}const D5={FLOAT:(e,n,s)=>n+(s-n)*e,ARRAY:(e,n,s)=>n.map((i,r)=>i+(s[r]-i)*e),VERTICES:(e,n,s)=>n.map(i=>{const r=s.find(o=>o.id===i.id);return r?{id:i.id,pos:[i.pos[0]+(r.pos[0]-i.pos[0])*e,i.pos[1]+(r.pos[1]-i.pos[1])*e]}:(console.warn(`Vertex ${i.id} not found in interpolate vertices`),i)}),MOTION_PATH:(e,n,s,i)=>{const r=[n.pos[0],n.pos[1]],o=[s.pos[0],s.pos[1]],a=n.out.slice(0,2),c=s.in.slice(0,2),l=a.every(p=>!p)?null:[r[0]+a[0],r[1]+a[1]],h=c.every(p=>!p)?null:[o[0]+c[0],o[1]+c[1]];if(!l&&!h){const p=o[0]-r[0],E=o[1]-r[1],[g,T]=n_(e,r[0],r[1],o[0],o[1]);if(p||E){const A=Math.atan2(E,p);return{pos:[g,T],in:[0,0],out:[0,0],orientRotation:A}}return{pos:[g,T],in:[0,0],out:[0,0],orientRotation:0}}else{const p=[...r,...a,...c,...o],E=new ae().initWithPointsAndHandlesN(p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7]),g=E.getLength(),T=g*e;if(e<0){const A=E.getPointAtTime(0);if(!A)throw new Error("pos is null");const m=g*Math.abs(i[1]),O=E.getTangentAtTime(0);if(!O)throw new Error("tangent is null");const S=Math.atan2(O.y,O.x);return A.add(O.scale(m*e)),{pos:[A.x,A.y],in:[0,0],out:[0,0],orientRotation:S}}else if(e>1){const A=E.getPointAtTime(1);if(!A)throw new Error("pos is null");if(!i[3])throw new Error("easing[3] is undefined");const m=g*(i[3]-1),O=E.getTangentAtTime(1);if(!O)throw new Error("tangent is null");const S=Math.atan2(O.y,O.x);return A.add(O.scale(m*(e-1))),{pos:[A.x,A.y],in:[0,0],out:[0,0],orientRotation:S}}else{const A=E.getTimeAt(T);if(A===null)throw new Error("t is null");const m=E.getPointAtTime(A);if(!m)throw new Error("pos is null");const O=E.getTangentAtTime(A);if(!O)throw new Error("tangent is null");const S=Math.atan2(O.y,O.x);return{pos:[m.x,m.y],in:[0,0],out:[0,0],orientRotation:S}}}},CONTENT_ANCHOR:(e,n,s)=>({contentAnchorX:n.contentAnchorX+(s.contentAnchorX-n.contentAnchorX)*e,contentAnchorY:n.contentAnchorY+(s.contentAnchorY-n.contentAnchorY)*e}),PAINT:(e,n,s)=>{const i={type:n.type,color:[...n.color],gradient:{stops:[],transform:[...n.gradient.transform]},image:{id:n.image.id,mode:n.image.mode}};switch(n.type){case Oe.SOLID:{i.color=[n.color[0]+(s.color[0]-n.color[0])*e,n.color[1]+(s.color[1]-n.color[1])*e,n.color[2]+(s.color[2]-n.color[2])*e,n.color[3]+(s.color[3]-n.color[3])*e];break}case Oe.GRADIENT_LINEAR:case Oe.GRADIENT_RADIAL:case Oe.GRADIENT_ANGULAR:case Oe.GRADIENT_DIAMOND:{const r=[...n.gradient.stops],o=[...s.gradient.stops],a=r.length,c=o.length;a>c?fy(r,o):c>a&&fy(o,r);const l=r.length;for(let p=0;p<l;p++)i.gradient.stops.push({position:r[p].position+(o[p].position-r[p].position)*e,color:[r[p].color[0]+(o[p].color[0]-r[p].color[0])*e,r[p].color[1]+(o[p].color[1]-r[p].color[1])*e,r[p].color[2]+(o[p].color[2]-r[p].color[2])*e,r[p].color[3]+(o[p].color[3]-r[p].color[3])*e]}),i.gradient.stops[p].position=r[p].position+(o[p].position-r[p].position)*e;const h=n.gradient.transform.length?[...n.gradient.transform]:[0,-1,1,0,0,1],d=[...s.gradient.transform];i.gradient.transform=[h[0]+(d[0]-h[0])*e,h[1]+(d[1]-h[1])*e,h[2]+(d[2]-h[2])*e,h[3]+(d[3]-h[3])*e,h[4]+(d[4]-h[4])*e,h[5]+(d[5]-h[5])*e];break}case Oe.IMAGE:{n.image.id?i.image.id=n.image.id:i.image.id=s.image.id,n.image.mode?i.image.mode=n.image.mode:i.image.mode=s.image.mode;break}}return i}},L5=()=>{const e=new lx;return Object.entries(D5).forEach(([n,s])=>{const i=K0({name:n,interpolate:s});e.register(i)}),e},fy=(e,n)=>{const s=n.slice().sort((i,r)=>i.position-r.position);for(let i=s.length;i<e.length;i++){const r=e[i].position;let o=null;if(r<=s[0].position)o=s[0];else if(r>=s[s.length-1].position)o=s[s.length-1];else for(let a=0;a<s.length-1;a++){const c=s[a],l=s[a+1],h=r-c.position,d=l.position-r;if(h>=0&&d>0){h<=d?o=c:o=l;break}}n[i]=o}},M5=L5();class P5 extends dx{constructor(){super(M5)}}window.AnimationComposer=P5});
